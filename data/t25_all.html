/* Minification failed. Returning unminified contents.
(6661,15-16): run-time error JS1300: Strict-mode does not allow assignment to undefined variables: j
(6661,43-44): run-time error JS1294: Strict-mode does not allow ++ or -- on certain objects: j
 */

(function($){var escapeable=/["\\\x00-\x1f\x7f-\x9f]/g,meta={'\b':'\\b','\t':'\\t','\n':'\\n','\f':'\\f','\r':'\\r','"':'\\"','\\':'\\\\'};$.toJSON=typeof JSON==='object'&&JSON.stringify?JSON.stringify:function(o){if(o===null){return'null';}
var type=typeof o;if(type==='undefined'){return undefined;}
if(type==='number'||type==='boolean'){return''+o;}
if(type==='string'){return $.quoteString(o);}
if(type==='object'){if(typeof o.toJSON==='function'){return $.toJSON(o.toJSON());}
if(o.constructor===Date){var month=o.getUTCMonth()+1,day=o.getUTCDate(),year=o.getUTCFullYear(),hours=o.getUTCHours(),minutes=o.getUTCMinutes(),seconds=o.getUTCSeconds(),milli=o.getUTCMilliseconds();if(month<10){month='0'+month;}
if(day<10){day='0'+day;}
if(hours<10){hours='0'+hours;}
if(minutes<10){minutes='0'+minutes;}
if(seconds<10){seconds='0'+seconds;}
if(milli<100){milli='0'+milli;}
if(milli<10){milli='0'+milli;}
return'"'+year+'-'+month+'-'+day+'T'+
hours+':'+minutes+':'+seconds+'.'+milli+'Z"';}
if(o.constructor===Array){var ret=[];for(var i=0;i<o.length;i++){ret.push($.toJSON(o[i])||'null');}
return'['+ret.join(',')+']';}
var name,val,pairs=[];for(var k in o){type=typeof k;if(type==='number'){name='"'+k+'"';}else if(type==='string'){name=$.quoteString(k);}else{continue;}
type=typeof o[k];if(type==='function'||type==='undefined'){continue;}
val=$.toJSON(o[k]);pairs.push(name+':'+val);}
return'{'+pairs.join(',')+'}';}};$.evalJSON=typeof JSON==='object'&&JSON.parse?JSON.parse:function(src){return eval('('+src+')');};$.secureEvalJSON=typeof JSON==='object'&&JSON.parse?JSON.parse:function(src){var filtered=src.replace(/\\["\\\/bfnrtu]/g,'@').replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,']').replace(/(?:^|:|,)(?:\s*\[)+/g,'');if(/^[\],:{}\s]*$/.test(filtered)){return eval('('+src+')');}else{throw new SyntaxError('Error parsing JSON, source is not valid.');}};$.quoteString=function(string){if(string.match(escapeable)){return'"'+string.replace(escapeable,function(a){var c=meta[a];if(typeof c==='string'){return c;}
c=a.charCodeAt();return'\\u00'+Math.floor(c/16).toString(16)+(c%16).toString(16);})+'"';}
return'"'+string+'"';};})(jQuery);;
/*
 * jQuery FlexSlider v2.1
 * Copyright 2012 WooThemes
 * Contributing Author: Tyler Smith
 * Modified By: Kyle Schmidt (kyle.schmidt@ualberta.ca)
 *     Reason: Added "vars" property to the "slider" object in order to access the slider properties externally
 */
(function (e) { e.flexslider = function (t, n) { var r = e(t); r.vars = e.extend({}, e.flexslider.defaults, n); var i = r.vars.namespace, s = window.navigator && window.navigator.msPointerEnabled && window.MSGesture, o = ("ontouchstart" in window || s || window.DocumentTouch && document instanceof DocumentTouch) && r.vars.touch, u = "", a, f = "vertical" === r.vars.direction, l = r.vars.reverse, c = 0 < r.vars.itemWidth, h = "fade" === r.vars.animation, p = "" !== r.vars.asNavFor, v = {}; e.data(t, "flexslider", r); v = { init: function () { r.animating = !1; r.currentSlide = parseInt(r.vars.startAt ? r.vars.startAt : 0, 10); isNaN(r.currentSlide) && (r.currentSlide = 0); r.animatingTo = r.currentSlide; r.atEnd = 0 === r.currentSlide || r.currentSlide === r.last; r.containerSelector = r.vars.selector.substr(0, r.vars.selector.search(" ")); r.slides = e(r.vars.selector, r); r.container = e(r.containerSelector, r); r.count = r.slides.length; r.syncExists = 0 < e(r.vars.sync).length; "slide" === r.vars.animation && (r.vars.animation = "swing"); r.prop = f ? "top" : "marginLeft"; r.args = {}; r.manualPause = !1; r.stopped = !1; r.started = !1; r.startTimeout = null; r.transitions = !r.vars.video && !h && r.vars.useCSS && function () { var e = document.createElement("div"), t = ["perspectiveProperty", "WebkitPerspective", "MozPerspective", "OPerspective", "msPerspective"], n; for (n in t) if (void 0 !== e.style[t[n]]) return r.pfx = t[n].replace("Perspective", "").toLowerCase(), r.prop = "-" + r.pfx + "-transform", !0; return !1 } (); "" !== r.vars.controlsContainer && (r.controlsContainer = 0 < e(r.vars.controlsContainer).length && e(r.vars.controlsContainer)); "" !== r.vars.manualControls && (r.manualControls = 0 < e(r.vars.manualControls).length && e(r.vars.manualControls)); r.vars.randomize && (r.slides.sort(function () { return Math.round(Math.random()) - .5 }), r.container.empty().append(r.slides)); r.doMath(); r.setup("init"); r.vars.controlNav && v.controlNav.setup(); r.vars.directionNav && v.directionNav.setup(); r.vars.keyboard && (1 === e(r.containerSelector).length || r.vars.multipleKeyboard) && e(document).bind("keyup", function (e) { e = e.keyCode; r.animating || 39 !== e && 37 !== e || (e = 39 === e ? r.getTarget("next") : 37 === e ? r.getTarget("prev") : !1, r.flexAnimate(e, r.vars.pauseOnAction)) }); r.vars.mousewheel && r.bind("mousewheel", function (e, t, n, i) { e.preventDefault(); e = 0 > t ? r.getTarget("next") : r.getTarget("prev"); r.flexAnimate(e, r.vars.pauseOnAction) }); r.vars.pausePlay && v.pausePlay.setup(); r.vars.slideshow && r.vars.pauseInvisible && v.pauseInvisible.init(); r.vars.slideshow && (r.vars.pauseOnHover && r.hover(function () { r.manualPlay || r.manualPause || r.pause() }, function () { r.manualPause || r.manualPlay || r.stopped || r.play() }), r.vars.pauseInvisible && v.pauseInvisible.isHidden() || (0 < r.vars.initDelay ? r.startTimeout = setTimeout(r.play, r.vars.initDelay) : r.play())); p && v.asNav.setup(); o && r.vars.touch && v.touch(); (!h || h && r.vars.smoothHeight) && e(window).bind("resize orientationchange focus", v.resize); r.find("img").attr("draggable", "false"); setTimeout(function () { r.vars.start(r) }, 200) }, asNav: { setup: function () { r.asNav = !0; r.animatingTo = Math.floor(r.currentSlide / r.move); r.currentItem = r.currentSlide; r.slides.removeClass(i + "active-slide").eq(r.currentItem).addClass(i + "active-slide"); if (s) t._slider = r, r.slides.each(function () { this._gesture = new MSGesture; this._gesture.target = this; this.addEventListener("MSPointerDown", function (e) { e.preventDefault(); e.currentTarget._gesture && e.currentTarget._gesture.addPointer(e.pointerId) }, !1); this.addEventListener("MSGestureTap", function (t) { t.preventDefault(); t = e(this); var n = t.index(); e(r.vars.asNavFor).data("flexslider").animating || t.hasClass("active") || (r.direction = r.currentItem < n ? "next" : "prev", r.flexAnimate(n, r.vars.pauseOnAction, !1, !0, !0)) }) }); else r.slides.on("click touchend MSPointerUp", function (t) { t.preventDefault(); t = e(this); var n = t.index(); 0 >= t.offset().left - e(r).scrollLeft() && t.hasClass(i + "active-slide") ? r.flexAnimate(r.getTarget("prev"), !0) : e(r.vars.asNavFor).data("flexslider").animating || t.hasClass(i + "active-slide") || (r.direction = r.currentItem < n ? "next" : "prev", r.flexAnimate(n, r.vars.pauseOnAction, !1, !0, !0)) }) } }, controlNav: { setup: function () { r.manualControls ? v.controlNav.setupManual() : v.controlNav.setupPaging() }, setupPaging: function () { var t = 1, n, s; r.controlNavScaffold = e('<ol class="' + i + "control-nav " + i + ("thumbnails" === r.vars.controlNav ? "control-thumbs" : "control-paging") + '"></ol>'); if (1 < r.pagingCount) for (var o = 0; o < r.pagingCount; o++) s = r.slides.eq(o), n = "thumbnails" === r.vars.controlNav ? '<img src="' + s.attr("data-thumb") + '"/>' : "<a>" + t + "</a>", "thumbnails" === r.vars.controlNav && !0 === r.vars.thumbCaptions && (s = s.attr("data-thumbcaption"), "" != s && void 0 != s && (n += '<span class="' + i + 'caption">' + s + "</span>")), r.controlNavScaffold.append("<li>" + n + "</li>"), t++; r.controlsContainer ? e(r.controlsContainer).append(r.controlNavScaffold) : r.append(r.controlNavScaffold); v.controlNav.set(); v.controlNav.active(); r.controlNavScaffold.delegate("a, img", "click touchend MSPointerUp", function (t) { t.preventDefault(); if ("" === u || u === t.type) { var n = e(this), s = r.controlNav.index(n); n.hasClass(i + "active") || (r.direction = s > r.currentSlide ? "next" : "prev", r.flexAnimate(s, r.vars.pauseOnAction)) } "" === u && (u = t.type); v.setToClearWatchedEvent() }) }, setupManual: function () { r.controlNav = r.manualControls; v.controlNav.active(); r.controlNav.bind("click touchend MSPointerUp", function (t) { t.preventDefault(); if ("" === u || u === t.type) { var n = e(this), s = r.controlNav.index(n); n.hasClass(i + "active") || (s > r.currentSlide ? r.direction = "next" : r.direction = "prev", r.flexAnimate(s, r.vars.pauseOnAction)) } "" === u && (u = t.type); v.setToClearWatchedEvent() }) }, set: function () { r.controlNav = e("." + i + "control-nav li " + ("thumbnails" === r.vars.controlNav ? "img" : "a"), r.controlsContainer ? r.controlsContainer : r) }, active: function () { r.controlNav.removeClass(i + "active").eq(r.animatingTo).addClass(i + "active") }, update: function (t, n) { 1 < r.pagingCount && "add" === t ? r.controlNavScaffold.append(e("<li><a>" + r.count + "</a></li>")) : 1 === r.pagingCount ? r.controlNavScaffold.find("li").remove() : r.controlNav.eq(n).closest("li").remove(); v.controlNav.set(); 1 < r.pagingCount && r.pagingCount !== r.controlNav.length ? r.update(n, t) : v.controlNav.active() } }, directionNav: { setup: function () { var t = e('<ul class="' + i + 'direction-nav"><li><a class="' + i + 'prev" href="#">' + r.vars.prevText + '</a></li><li><a class="' + i + 'next" href="#">' + r.vars.nextText + "</a></li></ul>"); r.controlsContainer ? (e(r.controlsContainer).append(t), r.directionNav = e("." + i + "direction-nav li a", r.controlsContainer)) : (r.append(t), r.directionNav = e("." + i + "direction-nav li a", r)); v.directionNav.update(); r.directionNav.bind("click touchend MSPointerUp", function (t) { t.preventDefault(); var n; if ("" === u || u === t.type) n = e(this).hasClass(i + "next") ? r.getTarget("next") : r.getTarget("prev"), r.flexAnimate(n, r.vars.pauseOnAction); "" === u && (u = t.type); v.setToClearWatchedEvent() }) }, update: function () { var e = i + "disabled"; 1 === r.pagingCount ? r.directionNav.addClass(e).attr("tabindex", "-1") : r.vars.animationLoop ? r.directionNav.removeClass(e).removeAttr("tabindex") : 0 === r.animatingTo ? r.directionNav.removeClass(e).filter("." + i + "prev").addClass(e).attr("tabindex", "-1") : r.animatingTo === r.last ? r.directionNav.removeClass(e).filter("." + i + "next").addClass(e).attr("tabindex", "-1") : r.directionNav.removeClass(e).removeAttr("tabindex") } }, pausePlay: { setup: function () { var t = e('<div class="' + i + 'pauseplay"><a></a></div>'); r.controlsContainer ? (r.controlsContainer.append(t), r.pausePlay = e("." + i + "pauseplay a", r.controlsContainer)) : (r.append(t), r.pausePlay = e("." + i + "pauseplay a", r)); v.pausePlay.update(r.vars.slideshow ? i + "pause" : i + "play"); r.pausePlay.bind("click touchend MSPointerUp", function (t) { t.preventDefault(); if ("" === u || u === t.type) e(this).hasClass(i + "pause") ? (r.manualPause = !0, r.manualPlay = !1, r.pause()) : (r.manualPause = !1, r.manualPlay = !0, r.play()); "" === u && (u = t.type); v.setToClearWatchedEvent() }) }, update: function (e) { "play" === e ? r.pausePlay.removeClass(i + "pause").addClass(i + "play").html(r.vars.playText) : r.pausePlay.removeClass(i + "play").addClass(i + "pause").html(r.vars.pauseText) } }, touch: function () { var e, n, i, o, u, a, p = !1, d = 0, v = 0, m = 0; if (s) { t.style.msTouchAction = "none"; t._gesture = new MSGesture; t._gesture.target = t; t.addEventListener("MSPointerDown", y, !1); t._slider = r; t.addEventListener("MSGestureChange", b, !1); t.addEventListener("MSGestureEnd", w, !1); var y = function (e) { e.stopPropagation(); r.animating ? e.preventDefault() : (r.pause(), t._gesture.addPointer(e.pointerId), m = 0, o = f ? r.h : r.w, a = Number(new Date), i = c && l && r.animatingTo === r.last ? 0 : c && l ? r.limit - (r.itemW + r.vars.itemMargin) * r.move * r.animatingTo : c && r.currentSlide === r.last ? r.limit : c ? (r.itemW + r.vars.itemMargin) * r.move * r.currentSlide : l ? (r.last - r.currentSlide + r.cloneOffset) * o : (r.currentSlide + r.cloneOffset) * o) }, b = function (e) { e.stopPropagation(); var n = e.target._slider; if (n) { var r = -e.translationX, s = -e.translationY; u = m += f ? s : r; p = f ? Math.abs(m) < Math.abs(-r) : Math.abs(m) < Math.abs(-s); if (e.detail === e.MSGESTURE_FLAG_INERTIA) setImmediate(function () { t._gesture.stop() }); else if (!p || 500 < Number(new Date) - a) e.preventDefault(), !h && n.transitions && (n.vars.animationLoop || (u = m / (0 === n.currentSlide && 0 > m || n.currentSlide === n.last && 0 < m ? Math.abs(m) / o + 2 : 1)), n.setProps(i + u, "setTouch")) } }, w = function (t) { t.stopPropagation(); if (t = t.target._slider) { if (t.animatingTo === t.currentSlide && !p && null !== u) { var r = l ? -u : u, s = 0 < r ? t.getTarget("next") : t.getTarget("prev"); t.canAdvance(s) && (550 > Number(new Date) - a && 50 < Math.abs(r) || Math.abs(r) > o / 2) ? t.flexAnimate(s, t.vars.pauseOnAction) : h || t.flexAnimate(t.currentSlide, t.vars.pauseOnAction, !0) } i = u = n = e = null; m = 0 } } } else { t.addEventListener("touchstart", E, !1); var E = function (s) { if (r.animating) s.preventDefault(); else if (window.navigator.msPointerEnabled || 1 === s.touches.length) r.pause(), o = f ? r.h : r.w, a = Number(new Date), d = s.touches[0].pageX, v = s.touches[0].pageY, i = c && l && r.animatingTo === r.last ? 0 : c && l ? r.limit - (r.itemW + r.vars.itemMargin) * r.move * r.animatingTo : c && r.currentSlide === r.last ? r.limit : c ? (r.itemW + r.vars.itemMargin) * r.move * r.currentSlide : l ? (r.last - r.currentSlide + r.cloneOffset) * o : (r.currentSlide + r.cloneOffset) * o, e = f ? v : d, n = f ? d : v, t.addEventListener("touchmove", S, !1), t.addEventListener("touchend", x, !1) }, S = function (t) { d = t.touches[0].pageX; v = t.touches[0].pageY; u = f ? e - v : e - d; p = f ? Math.abs(u) < Math.abs(d - n) : Math.abs(u) < Math.abs(v - n); if (!p || 500 < Number(new Date) - a) t.preventDefault(), !h && r.transitions && (r.vars.animationLoop || (u /= 0 === r.currentSlide && 0 > u || r.currentSlide === r.last && 0 < u ? Math.abs(u) / o + 2 : 1), r.setProps(i + u, "setTouch")) }, x = function (s) { t.removeEventListener("touchmove", S, !1); if (r.animatingTo === r.currentSlide && !p && null !== u) { s = l ? -u : u; var f = 0 < s ? r.getTarget("next") : r.getTarget("prev"); r.canAdvance(f) && (550 > Number(new Date) - a && 50 < Math.abs(s) || Math.abs(s) > o / 2) ? r.flexAnimate(f, r.vars.pauseOnAction) : h || r.flexAnimate(r.currentSlide, r.vars.pauseOnAction, !0) } t.removeEventListener("touchend", x, !1); i = u = n = e = null } } }, resize: function () { !r.animating && r.is(":visible") && (c || r.doMath(), h ? v.smoothHeight() : c ? (r.slides.width(r.computedW), r.update(r.pagingCount), r.setProps()) : f ? (r.viewport.height(r.h), r.setProps(r.h, "setTotal")) : (r.vars.smoothHeight && v.smoothHeight(), r.newSlides.width(r.computedW), r.setProps(r.computedW, "setTotal"))) }, smoothHeight: function (e) { if (!f || h) { var t = h ? r : r.viewport; e ? t.animate({ height: r.slides.eq(r.animatingTo).height() }, e) : t.height(r.slides.eq(r.animatingTo).height()) } }, sync: function (t) { var n = e(r.vars.sync).data("flexslider"), i = r.animatingTo; switch (t) { case "animate": n.flexAnimate(i, r.vars.pauseOnAction, !1, !0); break; case "play": n.playing || n.asNav || n.play(); break; case "pause": n.pause() } }, uniqueID: function (t) { t.find("[id]").each(function () { var t = e(this); t.attr("id", t.attr("id") + "_clone") }); return t }, pauseInvisible: { visProp: null, init: function () { var e = ["webkit", "moz", "ms", "o"]; if ("hidden" in document) return "hidden"; for (var t = 0; t < e.length; t++) e[t] + "Hidden" in document && (v.pauseInvisible.visProp = e[t] + "Hidden"); v.pauseInvisible.visProp && (e = v.pauseInvisible.visProp.replace(/[H|h]idden/, "") + "visibilitychange", document.addEventListener(e, function () { v.pauseInvisible.isHidden() ? r.startTimeout ? clearTimeout(r.startTimeout) : r.pause() : r.started ? r.play() : 0 < r.vars.initDelay ? setTimeout(r.play, r.vars.initDelay) : r.play() })) }, isHidden: function () { return document[v.pauseInvisible.visProp] || !1 } }, setToClearWatchedEvent: function () { clearTimeout(a); a = setTimeout(function () { u = "" }, 3e3) } }; r.flexAnimate = function (t, n, s, u, a) { r.vars.animationLoop || t === r.currentSlide || (r.direction = t > r.currentSlide ? "next" : "prev"); p && 1 === r.pagingCount && (r.direction = r.currentItem < t ? "next" : "prev"); if (!r.animating && (r.canAdvance(t, a) || s) && r.is(":visible")) { if (p && u) if (s = e(r.vars.asNavFor).data("flexslider"), r.atEnd = 0 === t || t === r.count - 1, s.flexAnimate(t, !0, !1, !0, a), r.direction = r.currentItem < t ? "next" : "prev", s.direction = r.direction, Math.ceil((t + 1) / r.visible) - 1 !== r.currentSlide && 0 !== t) r.currentItem = t, r.slides.removeClass(i + "active-slide").eq(t).addClass(i + "active-slide"), t = Math.floor(t / r.visible); else return r.currentItem = t, r.slides.removeClass(i + "active-slide").eq(t).addClass(i + "active-slide"), !1; r.animating = !0; r.animatingTo = t; n && r.pause(); r.vars.before(r); r.syncExists && !a && v.sync("animate"); r.vars.controlNav && v.controlNav.active(); c || r.slides.removeClass(i + "active-slide").eq(t).addClass(i + "active-slide"); r.atEnd = 0 === t || t === r.last; r.vars.directionNav && v.directionNav.update(); t === r.last && (r.vars.end(r), r.vars.animationLoop || r.pause()); if (h) o ? (r.slides.eq(r.currentSlide).css({ opacity: 0, zIndex: 1 }), r.slides.eq(t).css({ opacity: 1, zIndex: 2 }), r.wrapup(m)) : (r.slides.eq(r.currentSlide).css({ zIndex: 1 }).animate({ opacity: 0 }, r.vars.animationSpeed, r.vars.easing), r.slides.eq(t).css({ zIndex: 2 }).animate({ opacity: 1 }, r.vars.animationSpeed, r.vars.easing, r.wrapup)); else { var m = f ? r.slides.filter(":first").height() : r.computedW; c ? (t = r.vars.itemMargin, t = (r.itemW + t) * r.move * r.animatingTo, t = t > r.limit && 1 !== r.visible ? r.limit : t) : t = 0 === r.currentSlide && t === r.count - 1 && r.vars.animationLoop && "next" !== r.direction ? l ? (r.count + r.cloneOffset) * m : 0 : r.currentSlide === r.last && 0 === t && r.vars.animationLoop && "prev" !== r.direction ? l ? 0 : (r.count + 1) * m : l ? (r.count - 1 - t + r.cloneOffset) * m : (t + r.cloneOffset) * m; r.setProps(t, "", r.vars.animationSpeed); r.transitions ? (r.vars.animationLoop && r.atEnd || (r.animating = !1, r.currentSlide = r.animatingTo), t = function () { var e = !1; return function () { e || r.wrapup(m); e = !0 } } (), r.container.unbind("webkitTransitionEnd transitionend"), r.container.bind("webkitTransitionEnd transitionend", t), setTimeout(t, r.vars.animationSpeed + 200)) : r.container.animate(r.args, r.vars.animationSpeed, r.vars.easing, function () { r.wrapup(m) }) } r.vars.smoothHeight && v.smoothHeight(r.vars.animationSpeed) } }; r.wrapup = function (e) { h || c || (0 === r.currentSlide && r.animatingTo === r.last && r.vars.animationLoop ? r.setProps(e, "jumpEnd") : r.currentSlide === r.last && 0 === r.animatingTo && r.vars.animationLoop && r.setProps(e, "jumpStart")); r.animating = !1; r.currentSlide = r.animatingTo; r.vars.after(r) }; r.animateSlides = function () { r.animating || r.flexAnimate(r.getTarget("next")) }; r.pause = function () { clearInterval(r.animatedSlides); r.animatedSlides = null; r.playing = !1; r.vars.pausePlay && v.pausePlay.update("play"); r.syncExists && v.sync("pause") }; r.play = function () { r.playing && clearInterval(r.animatedSlides); r.animatedSlides = r.animatedSlides || setInterval(r.animateSlides, r.vars.slideshowSpeed); r.started = r.playing = !0; r.vars.pausePlay && v.pausePlay.update("pause"); r.syncExists && v.sync("play") }; r.stop = function () { r.pause(); r.stopped = !0 }; r.canAdvance = function (e, t) { var n = p ? r.pagingCount - 1 : r.last; return t ? !0 : p && r.currentItem === r.count - 1 && 0 === e && "prev" === r.direction ? !0 : p && 0 === r.currentItem && e === r.pagingCount - 1 && "next" !== r.direction ? !1 : e !== r.currentSlide || p ? r.vars.animationLoop ? !0 : r.atEnd && 0 === r.currentSlide && e === n && "next" !== r.direction ? !1 : r.atEnd && r.currentSlide === n && 0 === e && "next" === r.direction ? !1 : !0 : !1 }; r.getTarget = function (e) { r.direction = e; return "next" === e ? r.currentSlide === r.last ? 0 : r.currentSlide + 1 : 0 === r.currentSlide ? r.last : r.currentSlide - 1 }; r.setProps = function (e, t, n) { var i = function () { var n = e ? e : (r.itemW + r.vars.itemMargin) * r.move * r.animatingTo; return -1 * function () { if (c) return "setTouch" === t ? e : l && r.animatingTo === r.last ? 0 : l ? r.limit - (r.itemW + r.vars.itemMargin) * r.move * r.animatingTo : r.animatingTo === r.last ? r.limit : n; switch (t) { case "setTotal": return l ? (r.count - 1 - r.currentSlide + r.cloneOffset) * e : (r.currentSlide + r.cloneOffset) * e; case "setTouch": return e; case "jumpEnd": return l ? e : r.count * e; case "jumpStart": return l ? r.count * e : e; default: return e } } () + "px" } (); r.transitions && (i = f ? "translate3d(0," + i + ",0)" : "translate3d(" + i + ",0,0)", n = void 0 !== n ? n / 1e3 + "s" : "0s", r.container.css("-" + r.pfx + "-transition-duration", n), r.container.css("transition-duration", n)); r.args[r.prop] = i; (r.transitions || void 0 === n) && r.container.css(r.args); r.container.css("transform", i) }; r.setup = function (t) { if (h) r.slides.css({ width: "100%", "float": "left", marginRight: "-100%", position: "relative" }), "init" === t && (o ? r.slides.css({ opacity: 0, display: "block", webkitTransition: "opacity " + r.vars.animationSpeed / 1e3 + "s ease", zIndex: 1 }).eq(r.currentSlide).css({ opacity: 1, zIndex: 2 }) : r.slides.css({ opacity: 0, display: "block", zIndex: 1 }).eq(r.currentSlide).css({ zIndex: 2 }).animate({ opacity: 1 }, r.vars.animationSpeed, r.vars.easing)), r.vars.smoothHeight && v.smoothHeight(); else { var n, s; "init" === t && (r.viewport = e('<div class="' + i + 'viewport"></div>').css({ overflow: "hidden", position: "relative" }).appendTo(r).append(r.container), r.cloneCount = 0, r.cloneOffset = 0, l && (s = e.makeArray(r.slides).reverse(), r.slides = e(s), r.container.empty().append(r.slides))); r.vars.animationLoop && !c && (r.cloneCount = 2, r.cloneOffset = 1, "init" !== t && r.container.find(".clone").remove(), v.uniqueID(r.slides.first().clone().addClass("clone").attr("aria-hidden", "true")).appendTo(r.container), v.uniqueID(r.slides.last().clone().addClass("clone").attr("aria-hidden", "true")).prependTo(r.container)); r.newSlides = e(r.vars.selector, r); n = l ? r.count - 1 - r.currentSlide + r.cloneOffset : r.currentSlide + r.cloneOffset; f && !c ? (r.container.height(200 * (r.count + r.cloneCount) + "%").css("position", "absolute").width("100%"), setTimeout(function () { r.newSlides.css({ display: "block" }); r.doMath(); r.viewport.height(r.h); r.setProps(n * r.h, "init") }, "init" === t ? 100 : 0)) : (r.container.width(200 * (r.count + r.cloneCount) + "%"), r.setProps(n * r.computedW, "init"), setTimeout(function () { r.doMath(); r.newSlides.css({ width: r.computedW, "float": "left", display: "block" }); r.vars.smoothHeight && v.smoothHeight() }, "init" === t ? 100 : 0)) } c || r.slides.removeClass(i + "active-slide").eq(r.currentSlide).addClass(i + "active-slide"); r.vars.init(r) }; r.doMath = function () { var e = r.slides.first(), t = r.vars.itemMargin, n = r.vars.minItems, i = r.vars.maxItems; r.w = void 0 === r.viewport ? r.width() : r.viewport.width(); r.h = e.height(); r.boxPadding = e.outerWidth() - e.width(); c ? (r.itemT = r.vars.itemWidth + t, r.minW = n ? n * r.itemT : r.w, r.maxW = i ? i * r.itemT - t : r.w, r.itemW = r.minW > r.w ? (r.w - t * (n - 1)) / n : r.maxW < r.w ? (r.w - t * (i - 1)) / i : r.vars.itemWidth > r.w ? r.w : r.vars.itemWidth, r.visible = Math.floor(r.w / r.itemW), r.move = 0 < r.vars.move && r.vars.move < r.visible ? r.vars.move : r.visible, r.pagingCount = Math.ceil((r.count - r.visible) / r.move + 1), r.last = r.pagingCount - 1, r.limit = 1 === r.pagingCount ? 0 : r.vars.itemWidth > r.w ? r.itemW * (r.count - 1) + t * (r.count - 1) : (r.itemW + t) * r.count - r.w - t) : (r.itemW = r.w, r.pagingCount = r.count, r.last = r.count - 1); r.computedW = r.itemW - r.boxPadding }; r.update = function (e, t) { r.doMath(); c || (e < r.currentSlide ? r.currentSlide += 1 : e <= r.currentSlide && 0 !== e && (r.currentSlide -= 1), r.animatingTo = r.currentSlide); if (r.vars.controlNav && !r.manualControls) if ("add" === t && !c || r.pagingCount > r.controlNav.length) v.controlNav.update("add"); else if ("remove" === t && !c || r.pagingCount < r.controlNav.length) c && r.currentSlide > r.last && (r.currentSlide -= 1, r.animatingTo -= 1), v.controlNav.update("remove", r.last); r.vars.directionNav && v.directionNav.update() }; r.addSlide = function (t, n) { var i = e(t); r.count += 1; r.last = r.count - 1; f && l ? void 0 !== n ? r.slides.eq(r.count - n).after(i) : r.container.prepend(i) : void 0 !== n ? r.slides.eq(n).before(i) : r.container.append(i); r.update(n, "add"); r.slides = e(r.vars.selector + ":not(.clone)", r); r.setup(); r.vars.added(r) }; r.removeSlide = function (t) { var n = isNaN(t) ? r.slides.index(e(t)) : t; r.count -= 1; r.last = r.count - 1; isNaN(t) ? e(t, r.slides).remove() : f && l ? r.slides.eq(r.last).remove() : r.slides.eq(t).remove(); r.doMath(); r.update(n, "remove"); r.slides = e(r.vars.selector + ":not(.clone)", r); r.setup(); r.vars.removed(r) }; v.init() }; e(window).blur(function (e) { focused = !1 }).focus(function (e) { focused = !0 }); e.flexslider.defaults = { namespace: "flex-", selector: ".slides > li", animation: "fade", easing: "swing", direction: "horizontal", reverse: !1, animationLoop: !0, smoothHeight: !1, startAt: 0, slideshow: !0, slideshowSpeed: 7e3, animationSpeed: 600, initDelay: 0, randomize: !1, thumbCaptions: !1, pauseOnAction: !0, pauseOnHover: !1, pauseInvisible: !0, useCSS: !0, touch: !0, video: !1, controlNav: !0, directionNav: !0, prevText: "Previous", nextText: "Next", keyboard: !0, multipleKeyboard: !1, mousewheel: !1, pausePlay: !1, pauseText: "Pause", playText: "Play", controlsContainer: "", manualControls: "", sync: "", asNavFor: "", itemWidth: 0, itemMargin: 0, minItems: 1, maxItems: 0, move: 0, allowOneSlide: !0, start: function () { }, before: function () { }, after: function () { }, end: function () { }, added: function () { }, removed: function () { }, init: function () { } }; e.fn.flexslider = function (t) { void 0 === t && (t = {}); if ("object" === typeof t) return this.each(function () { var n = e(this), r = n.find(t.selector ? t.selector : ".slides > li"); 1 === r.length && !0 === t.allowOneSlide || 0 === r.length ? (r.fadeIn(400), t.start && t.start(n)) : void 0 === n.data("flexslider") && new e.flexslider(this, t) }); var n = e(this).data("flexslider"); switch (t) { case "play": n.play(); break; case "pause": n.pause(); break; case "stop": n.stop(); break; case "next": n.flexAnimate(n.getTarget("next"), !0); break; case "prev": case "previous": n.flexAnimate(n.getTarget("prev"), !0); break; default: "number" === typeof t && n.flexAnimate(t, !0) } } })(jQuery);
/*
* Jquery LiveSearch plugin
*
* Original Created by nakajima - https://github.com/nakajima/jquery-livesearch
*
* Modified to support special character searches by Dean Vigoren - vigoren@ualberta.ca
*
*/
(function(b){function f(a){try{if(val=this.val())return b(a).filter(function(a,d){return!!b(d).text().match(RegExp(val.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),"gi"))})}catch(c){alert(c)}return!1}b.extend(b.expr[":"],{containsi:function(a,c,e){return 0<=b(a).text().toLowerCase().indexOf((e[3]||"").toLowerCase())}});var c=function(a){this.callbacks={};a(this)};c.prototype.all=function(a){this.callbacks.all=a};c.prototype.reset=function(a){this.callbacks.reset=a};c.prototype.empty=function(a){this.callbacks.empty=a};c.prototype.results=function(a){this.callbacks.results=a};b.fn.search=function(a,g){function e(){if(result=f.call(b(this),a)){d.all&&d.all.call(this,result);var c=0<result.size()?"results":"empty";return d[c]&&d[c].call(this,result)}d.all&&d.all.call(this,b(a));return d.reset&&d.reset.call(this)}var d=(new c(g)).callbacks;b(this).live("keypress",e);b(this).live("keydown",e);b(this).live("keyup",e);b(this).bind("blur",e)}})(jQuery);;
// jquery.tweet.js - See http://tweet.seaofclouds.com/ or https://github.com/seaofclouds/tweet for more info
// Copyright (c) 2008-2012 Todd Matthews & Steve Purcell
(function (factory) {
  if (typeof define === 'function' && define.amd)
    define(['jquery'], factory); // AMD support for RequireJS etc.
  else
    factory(jQuery);
}(function ($) {
  $.fn.tweet = function(o){
    var s = $.extend({
      username: null,                           // [string or array] required unless using the 'query' option; one or more twitter screen names (use 'list' option for multiple names, where possible)
      list: null,                               // [string]   optional name of list belonging to username
      favorites: false,                         // [boolean]  display the user's favorites instead of his tweets
      query: null,                              // [string]   optional search query (see also: http://search.twitter.com/operators)
      avatar_size: null,                        // [integer]  height and width of avatar if displayed (48px max)
      count: 3,                                 // [integer]  how many tweets to display?
      fetch: null,                              // [integer]  how many tweets to fetch via the API (set this higher than 'count' if using the 'filter' option)
      page: 1,                                  // [integer]  which page of results to fetch (if count != fetch, you'll get unexpected results)
      retweets: true,                           // [boolean]  whether to fetch (official) retweets (not supported in all display modes)
      intro_text: null,                         // [string]   do you want text BEFORE your your tweets?
      outro_text: null,                         // [string]   do you want text AFTER your tweets?
      join_text:  null,                         // [string]   optional text in between date and tweet, try setting to "auto"
      auto_join_text_default: " I said, ",      // [string]   auto text for non verb: "I said" bullocks
      auto_join_text_ed: " I ",                 // [string]   auto text for past tense: "I" surfed
      auto_join_text_ing: " I am ",             // [string]   auto tense for present tense: "I was" surfing
      auto_join_text_reply: " I replied to ",   // [string]   auto tense for replies: "I replied to" @someone "with"
      auto_join_text_url: " I was looking at ", // [string]   auto tense for urls: "I was looking at" http:...
      loading_text: null,                       // [string]   optional loading text, displayed while tweets load
      refresh_interval: null,                   // [integer]  optional number of seconds after which to reload tweets
      twitter_url: "twitter.com",               // [string]   custom twitter url, if any (apigee, etc.)
      twitter_api_url: "api.twitter.com",       // [string]   custom twitter api url, if any (apigee, etc.)
      twitter_search_url: "search.twitter.com", // [string]   custom twitter search url, if any (apigee, etc.)
      template: "{avatar}{time}{join} {text}",  // [string or function] template used to construct each tweet <li> - see code for available vars
      comparator: function(tweet1, tweet2) {    // [function] comparator used to sort tweets (see Array.sort)
        return tweet2["tweet_time"] - tweet1["tweet_time"];
      },
      filter: function(tweet) {                 // [function] whether or not to include a particular tweet (be sure to also set 'fetch')
        return true;
      }
      // You can attach callbacks to the following events using jQuery's standard .bind() mechanism:
      //   "loaded" -- triggered when tweets have been fetched and rendered
    }, o);

    // See http://daringfireball.net/2010/07/improved_regex_for_matching_urls
    var url_regexp = /\b((?:https?:\/\/|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?«»“”‘’]))/gi;

    // Expand values inside simple string templates with {placeholders}
    function t(template, info) {
      if (typeof template === "string") {
        var result = template;
        for(var key in info) {
          var val = info[key];
          result = result.split('{'+key+'}').join(val === null ? '' : val);
        }
        return result;
      } else return template(info);
    }
    // Export the t function for use when passing a function as the 'template' option
    $.extend({tweet: {t: t}});

    function replacer (regex, replacement) {
      return function() {
        var returning = [];
        this.each(function() {
          returning.push(this.replace(regex, replacement));
        });
        return $(returning);
      };
    }

    function escapeHTML(s) {
      return s.replace(/</g,"&lt;").replace(/>/g,"^&gt;");
    }

    $.fn.extend({
      linkUser: replacer(/(^|[\W])@(\w+)/gi, "$1<span class=\"at\">@</span><a href=\"http://"+s.twitter_url+"/$2\">$2</a>"),
      // Support various latin1 (\u00**) and arabic (\u06**) alphanumeric chars
      linkHash: replacer(/(?:^| )[\#]+([\w\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u00ff\u0600-\u06ff]+)/gi,
                         ' <a href="http://'+s.twitter_search_url+'/search?q=&tag=$1&lang=all'+
                         ((s.username && s.username.length == 1 && !s.list) ? '&from='+s.username.join("%2BOR%2B") : '')+
                         '" class="tweet_hashtag">#$1</a>'),
      makeHeart: replacer(/(&lt;)+[3]/gi, "<tt class='heart'>&#x2665;</tt>")
    });

    function linkURLs(text, entities) {
      return text.replace(url_regexp, function(match) {
        var url = (/^[a-z]+:/i).test(match) ? match : "http://"+match;
        var text = match;
        for(var i = 0; i < entities.length; ++i) {
          var entity = entities[i];
          if (entity.url == url && entity.expanded_url) {
            url = entity.expanded_url;
            text = entity.display_url;
            break;
          }
        }
        return "<a href=\""+escapeHTML(url)+"\">"+escapeHTML(text)+"</a>";
      });
    }

    function parse_date(date_str) {
      // The non-search twitter APIs return inconsistently-formatted dates, which Date.parse
      // cannot handle in IE. We therefore perform the following transformation:
      // "Wed Apr 29 08:53:31 +0000 2009" => "Wed, Apr 29 2009 08:53:31 +0000"
      return Date.parse(date_str.replace(/^([a-z]{3})( [a-z]{3} \d\d?)(.*)( \d{4})$/i, '$1,$2$4$3'));
    }

    function extract_relative_time(date) {
      var toInt = function(val) { return parseInt(val, 10); };
      var relative_to = new Date();
      var delta = toInt((relative_to.getTime() - date) / 1000);
      if (delta < 1) delta = 0;
      return {
        days:    toInt(delta / 86400),
        hours:   toInt(delta / 3600),
        minutes: toInt(delta / 60),
        seconds: toInt(delta)
      };
    }

    function format_relative_time(time_ago) {
      if ( time_ago.days > 2 )     return 'about ' + time_ago.days + ' days ago';
      if ( time_ago.hours > 24 )   return 'about a day ago';
      if ( time_ago.hours > 2 )    return 'about ' + time_ago.hours + ' hours ago';
      if ( time_ago.minutes > 45 ) return 'about an hour ago';
      if ( time_ago.minutes > 2 )  return 'about ' + time_ago.minutes + ' minutes ago';
      if ( time_ago.seconds > 1 )  return 'about ' + time_ago.seconds + ' seconds ago';
      return 'just now';
    }

    function build_auto_join_text(text) {
      if (text.match(/^(@([A-Za-z0-9-_]+)) .*/i)) {
        return s.auto_join_text_reply;
      } else if (text.match(url_regexp)) {
        return s.auto_join_text_url;
      } else if (text.match(/^((\w+ed)|just) .*/im)) {
        return s.auto_join_text_ed;
      } else if (text.match(/^(\w*ing) .*/i)) {
        return s.auto_join_text_ing;
      } else {
        return s.auto_join_text_default;
      }
    }

    function build_api_url() {
      var proto = ('https:' == document.location.protocol ? 'https:' : 'http:');
      var count = (s.fetch === null) ? s.count : s.fetch;
      var common_params = '&callback=?';
      if (s.list) {
        return proto+"//"+s.twitter_api_url+"/1/"+s.username[0]+"/lists/"+s.list+"/statuses.json?page="+s.page+"&per_page="+count+common_params;
      } else if (s.favorites) {
        return proto+"//"+s.twitter_api_url+"/1/favorites.json?screen_name="+s.username[0]+"&page="+s.page+"&count="+count+common_params;
      } else if (s.query === null && s.username.length == 1) {
        return proto+'//'+s.twitter_api_url+'/1/statuses/user_timeline.json?screen_name='+s.username[0]+'&count='+count+(s.retweets ? '&include_rts=1' : '')+'&page='+s.page+common_params;
      } else {
        var query = (s.query || 'from:'+s.username.join(' OR from:'));
        return proto+'//'+s.twitter_search_url+'/search.json?&q='+encodeURIComponent(query)+'&rpp='+count+'&page='+s.page+common_params;
      }
    }

    function extract_avatar_url(item, secure) {
      if (secure) {
        return ('user' in item) ?
          item.user.profile_image_url_https :
          extract_avatar_url(item, false).
            replace(/^http:\/\/[a-z0-9]{1,3}\.twimg\.com\//, "https://s3.amazonaws.com/twitter_production/");
      } else {
        return item.profile_image_url || item.user.profile_image_url;
      }
    }

    // Convert twitter API objects into data available for
    // constructing each tweet <li> using a template
    function extract_template_data(item){
      var o = {};
      o.item = item;
      o.source = item.source;
      o.screen_name = item.from_user || item.user.screen_name;
      // The actual user name is not returned by all Twitter APIs, so please do not
      // file an issue if it is empty:
      o.name = item.from_user_name || item.user.name;
      o.retweet = typeof(item.retweeted_status) != 'undefined';

      o.tweet_time = parse_date(item.created_at);
      o.join_text = s.join_text == "auto" ? build_auto_join_text(item.text) : s.join_text;
      o.tweet_id = item.id_str;
      o.twitter_base = "http://"+s.twitter_url+"/";
      o.user_url = o.twitter_base+o.screen_name;
      o.tweet_url = o.user_url+"/status/"+o.tweet_id;
      o.reply_url = o.twitter_base+"intent/tweet?in_reply_to="+o.tweet_id;
      o.retweet_url = o.twitter_base+"intent/retweet?tweet_id="+o.tweet_id;
      o.favorite_url = o.twitter_base+"intent/favorite?tweet_id="+o.tweet_id;
      o.retweeted_screen_name = o.retweet && item.retweeted_status.user.screen_name;
      o.tweet_relative_time = format_relative_time(extract_relative_time(o.tweet_time));
      o.entities = item.entities ? (item.entities.urls || []).concat(item.entities.media || []) : [];
      o.tweet_raw_text = o.retweet ? ('RT @'+o.retweeted_screen_name+' '+item.retweeted_status.text) : item.text; // avoid '...' in long retweets
      o.tweet_text = $([linkURLs(o.tweet_raw_text, o.entities)]).linkUser().linkHash()[0];
      o.retweeted_tweet_text = $([linkURLs(item.text, o.entities)]).linkUser().linkHash()[0];
      o.tweet_text_fancy = $([o.tweet_text]).makeHeart()[0];

      o.avatar_size = s.avatar_size;
      o.avatar_url = extract_avatar_url(o.retweet ? item.retweeted_status : item, (document.location.protocol === 'https:'));
      o.avatar_screen_name = o.retweet ? o.retweeted_screen_name : o.screen_name;
      o.avatar_profile_url = o.twitter_base+o.avatar_screen_name;

      // Default spans, and pre-formatted blocks for common layouts
      o.user = t('<a class="tweet_user" href="{user_url}">{screen_name}</a>', o);
      o.join = s.join_text ? t('<span class="tweet_join">{join_text}</span>', o) : '';
      o.avatar = o.avatar_size ?
        t('<a class="tweet_avatar" href="{avatar_profile_url}"><img src="{avatar_url}" height="{avatar_size}" width="{avatar_size}" alt="{avatar_screen_name}\'s avatar" title="{avatar_screen_name}\'s avatar" border="0"/></a>', o) : '';
      o.time = t('<span class="tweet_time"><a href="{tweet_url}" title="view tweet on twitter">{tweet_relative_time}</a></span>', o);
      o.text = t('<span class="tweet_text">{tweet_text_fancy}</span>', o);
      o.retweeted_text = t('<span class="tweet_text">{retweeted_tweet_text}</span>', o);
      o.reply_action = t('<a class="tweet_action tweet_reply" href="{reply_url}">reply</a>', o);
      o.retweet_action = t('<a class="tweet_action tweet_retweet" href="{retweet_url}">retweet</a>', o);
      o.favorite_action = t('<a class="tweet_action tweet_favorite" href="{favorite_url}">favorite</a>', o);
      return o;
    }

    function render_tweets(widget, tweets) {
      var list = $('<ul class="tweet_list">');
      list.append($.map(tweets, function(o) { return "<li>" + t(s.template, o) + "</li>"; }).join('')).
        children('li:first').addClass('tweet_first').end().
        children('li:odd').addClass('tweet_even').end().
        children('li:even').addClass('tweet_odd');

      $(widget).empty().append(list);
      if (s.intro_text) list.before('<p class="tweet_intro">'+s.intro_text+'</p>');
      if (s.outro_text) list.after('<p class="tweet_outro">'+s.outro_text+'</p>');

      $(widget).trigger("loaded").trigger((tweets.length === 0 ? "empty" : "full"));
      if (s.refresh_interval) {
        window.setTimeout(function() { $(widget).trigger("tweet:load"); }, 1000 * s.refresh_interval);
      }
    }

    function load(widget) {
      var loading = $('<p class="loading">'+s.loading_text+'</p>');
      if (s.loading_text) $(widget).not(":has(.tweet_list)").empty().append(loading);
      $.getJSON(build_api_url(), function(data){
        var tweets = $.map(data.results || data, extract_template_data);
        tweets = $.grep(tweets, s.filter).sort(s.comparator).slice(0, s.count);
        $(widget).trigger("tweet:retrieved", [tweets]);
      });
    }

    return this.each(function(i, widget){
      if(s.username && typeof(s.username) == "string"){
        s.username = [s.username];
      }

      $(widget).unbind("tweet:render").unbind("tweet:retrieved").unbind("tweet:load").
        bind({
          "tweet:load": function() { load(widget); },
          "tweet:retrieved": function(ev, tweets) {
            $(widget).trigger("tweet:render", [tweets])
          },
          "tweet:render": function(ev, tweets) {
            render_tweets($(widget), tweets);
          }
        }).trigger("tweet:load");
    });
  };
}));
;
//Twitters generated Javascript for all of their widgets (Tweet button, follow button)
!function (d, s, id) { var js, fjs = d.getElementsByTagName(s)[0]; if (!d.getElementById(id)) { js = d.createElement(s); js.id = id; js.src = "//platform.twitter.com/widgets.js"; fjs.parentNode.insertBefore(js, fjs); } } (document, "script", "twitter-wjs");;
/*
 * jQuery-dateFormat
 * http://github.com/phstc/jquery-dateFormat
 */

(function (a) { var b = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"]; var c = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"]; var d = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"]; var e = []; e["Jan"] = "01"; e["Feb"] = "02"; e["Mar"] = "03"; e["Apr"] = "04"; e["May"] = "05"; e["Jun"] = "06"; e["Jul"] = "07"; e["Aug"] = "08"; e["Sep"] = "09"; e["Oct"] = "10"; e["Nov"] = "11"; e["Dec"] = "12"; a.format = function () { function a(a) { return b[parseInt(a, 10)] || a } function f(a) { var b = parseInt(a, 10) - 1; return c[b] || a } function g(a) { var b = parseInt(a, 10) - 1; return d[b] || a } var h = function (a) { return e[a] || a }; var i = function (a) { var b = a; var c = ""; if (b.indexOf(".") !== -1) { var d = b.split("."); b = d[0]; c = d[1] } var e = b.split(":"); if (e.length === 3) { hour = e[0]; minute = e[1]; second = e[2]; return { time: b, hour: hour, minute: minute, second: second, millis: c} } else { return { time: "", hour: "", minute: "", second: "", millis: ""} } }; return { date: function (b, c) { try { var d = null; var e = null; var j = null; var k = null; var l = null; var m = null; if (typeof b == "number") { return this.date(new Date(b), c) } else if (typeof b.getFullYear == "function") { e = b.getFullYear(); j = b.getMonth() + 1; k = b.getDate(); l = b.getDay(); m = i(b.toTimeString()) } else if (b.search(/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.?\d{0,3}[-+]?\d{2}:?\d{2}/) != -1) { var n = b.split(/[T\+-]/); e = n[0]; j = n[1]; k = n[2]; m = i(n[3].split(".")[0]); d = new Date(e, j - 1, k); l = d.getDay() } else { var n = b.split(" "); switch (n.length) { case 6: e = n[5]; j = h(n[1]); k = n[2]; m = i(n[3]); d = new Date(e, j - 1, k); l = d.getDay(); break; case 2: var o = n[0].split("-"); e = o[0]; j = o[1]; k = o[2]; m = i(n[1]); d = new Date(e, j - 1, k); l = d.getDay(); break; case 7: case 9: case 10: e = n[3]; j = h(n[1]); k = n[2]; m = i(n[4]); d = new Date(e, j - 1, k); l = d.getDay(); break; case 1: var o = n[0].split(""); e = o[0] + o[1] + o[2] + o[3]; j = o[5] + o[6]; k = o[8] + o[9]; m = i(o[13] + o[14] + o[15] + o[16] + o[17] + o[18] + o[19] + o[20]); d = new Date(e, j - 1, k); l = d.getDay(); break; default: return b } } var p = ""; var q = ""; var r = ""; for (var s = 0; s < c.length; s++) { var t = c.charAt(s); p += t; r = ""; switch (p) { case "ddd": q += a(l); p = ""; break; case "dd": if (c.charAt(s + 1) == "d") { break } if (String(k).length === 1) { k = "0" + k } q += k; p = ""; break; case "d": if (c.charAt(s + 1) == "d") { break } q += parseInt(k, 10); p = ""; break; case "MMMM": q += g(j); p = ""; break; case "MMM": if (c.charAt(s + 1) === "M") { break } q += f(j); p = ""; break; case "MM": if (c.charAt(s + 1) == "M") { break } if (String(j).length === 1) { j = "0" + j } q += j; p = ""; break; case "M": if (c.charAt(s + 1) == "M") { break } q += parseInt(j, 10); p = ""; break; case "yyyy": q += e; p = ""; break; case "yy": if (c.charAt(s + 1) == "y" && c.charAt(s + 2) == "y") { break } q += String(e).slice(-2); p = ""; break; case "HH": q += m.hour; p = ""; break; case "hh": var u = m.hour == 0 ? 12 : m.hour < 13 ? m.hour : m.hour - 12; u = String(u).length == 1 ? "0" + u : u; q += u; p = ""; break; case "h": if (c.charAt(s + 1) == "h") { break } var u = m.hour == 0 ? 12 : m.hour < 13 ? m.hour : m.hour - 12; q += parseInt(u, 10); p = ""; break; case "mm": q += m.minute; p = ""; break; case "ss": q += m.second.substring(0, 2); p = ""; break; case "SSS": q += m.millis.substring(0, 3); p = ""; break; case "a": q += m.hour >= 12 ? "PM" : "AM"; p = ""; break; case " ": q += t; p = ""; break; case "/": q += t; p = ""; break; case ":": q += t; p = ""; break; default: if (p.length === 2 && p.indexOf("y") !== 0 && p != "SS") { q += p.substring(0, 1); p = p.substring(1, 2) } else if (p.length === 3 && p.indexOf("yyy") === -1) { p = "" } else { r = p } } } q += r; return q } catch (v) { console.log(v); return b } } } } () })(jQuery); jQuery.format.date.defaultShortDateFormat = "dd/MM/yyyy"; jQuery.format.date.defaultLongDateFormat = "dd/MM/yyyy hh:mm:ss"; jQuery(document).ready(function () { jQuery(".shortDateFormat").each(function (a, b) { if (jQuery(b).is(":input")) { jQuery(b).val(jQuery.format.date(jQuery(b).val(), jQuery.format.date.defaultShortDateFormat)) } else { jQuery(b).text(jQuery.format.date(jQuery(b).text(), jQuery.format.date.defaultShortDateFormat)) } }); jQuery(".longDateFormat").each(function (a, b) { if (jQuery(b).is(":input")) { jQuery(b).val(jQuery.format.date(jQuery(b).val(), jQuery.format.date.defaultLongDateFormat)) } else { jQuery(b).text(jQuery.format.date(jQuery(b).text(), jQuery.format.date.defaultLongDateFormat)) } }) })
;
/* =============================================================
 * bootstrap-collapse.js v2.1.1
 * http://twitter.github.com/bootstrap/javascript.html#collapse
 * =============================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ============================================================ */


!function ($) {

  "use strict"; // jshint ;_;


 /* COLLAPSE PUBLIC CLASS DEFINITION
  * ================================ */

  var Collapse = function (element, options) {
    this.$element = $(element)
    this.options = $.extend({}, $.fn.collapse.defaults, options)

    if (this.options.parent) {
      this.$parent = $(this.options.parent)
    }

    this.options.toggle && this.toggle()
  }

  Collapse.prototype = {

    constructor: Collapse

  , dimension: function () {
      var hasWidth = this.$element.hasClass('width')
      return hasWidth ? 'width' : 'height'
    }

  , show: function () {
      var dimension
        , scroll
        , actives
        , hasData

      if (this.transitioning) return

      dimension = this.dimension()
      scroll = $.camelCase(['scroll', dimension].join('-'))
      actives = this.$parent && this.$parent.find('> .accordion-group > .in')

      if (actives && actives.length) {
        hasData = actives.data('collapse')
        if (hasData && hasData.transitioning) return
        actives.collapse('hide')
        hasData || actives.data('collapse', null)
      }

      this.$element[dimension](0)
      this.transition('addClass', $.Event('show'), 'shown')
      $.support.transition && this.$element[dimension](this.$element[0][scroll])
    }

  , hide: function () {
      var dimension
      if (this.transitioning) return
      dimension = this.dimension()
      this.reset(this.$element[dimension]())
      this.transition('removeClass', $.Event('hide'), 'hidden')
      this.$element[dimension](0)
    }

  , reset: function (size) {
      var dimension = this.dimension()

      this.$element
        .removeClass('collapse')
        [dimension](size || 'auto')
        [0].offsetWidth

      this.$element[size !== null ? 'addClass' : 'removeClass']('collapse')

      return this
    }

  , transition: function (method, startEvent, completeEvent) {
      var that = this
        , complete = function () {
            if (startEvent.type == 'show') that.reset()
            that.transitioning = 0
            that.$element.trigger(completeEvent)
          }

      this.$element.trigger(startEvent)

      if (startEvent.isDefaultPrevented()) return

      this.transitioning = 1

      this.$element[method]('in')

      $.support.transition && this.$element.hasClass('collapse') ?
        this.$element.one($.support.transition.end, complete) :
        complete()
    }

  , toggle: function () {
      this[this.$element.hasClass('in') ? 'hide' : 'show']()
    }

  }


 /* COLLAPSIBLE PLUGIN DEFINITION
  * ============================== */

  $.fn.collapse = function (option) {
    return this.each(function () {
      var $this = $(this)
        , data = $this.data('collapse')
        , options = typeof option == 'object' && option
      if (!data) $this.data('collapse', (data = new Collapse(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  $.fn.collapse.defaults = {
    toggle: true
  }

  $.fn.collapse.Constructor = Collapse


 /* COLLAPSIBLE DATA-API
  * ==================== */

  $(function () {
    $('body').on('click.collapse.data-api', '[data-toggle=collapse]', function (e) {
      var $this = $(this), href
        , target = $this.attr('data-target')
          || e.preventDefault()
          || (href = $this.attr('href')) && href.replace(/.*(?=#[^\s]+$)/, '') //strip for ie7
        , option = $(target).data('collapse') ? 'toggle' : $this.data()
      $this[$(target).hasClass('in') ? 'addClass' : 'removeClass']('collapsed')
      $(target).collapse(option)
    })
  })

}(window.jQuery);/* ============================================================
 * bootstrap-dropdown.js v2.1.1
 * http://twitter.github.com/bootstrap/javascript.html#dropdowns
 * ============================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ============================================================ */


!function ($) {

  "use strict"; // jshint ;_;


 /* DROPDOWN CLASS DEFINITION
  * ========================= */

  var toggle = '[data-toggle=dropdown]'
    , Dropdown = function (element) {
        var $el = $(element).on('click.dropdown.data-api', this.toggle)
        $('html').on('click.dropdown.data-api', function () {
          $el.parent().removeClass('open')
        })
      }

  Dropdown.prototype = {

    constructor: Dropdown

  , toggle: function (e) {
      var $this = $(this)
        , $parent
        , isActive

      if ($this.is('.disabled, :disabled')) return

      $parent = getParent($this)

      isActive = $parent.hasClass('open')

      clearMenus()

      if (!isActive) {
        $parent.toggleClass('open')
        $this.focus()
      }

      return false
    }

  , keydown: function (e) {
      var $this
        , $items
        , $active
        , $parent
        , isActive
        , index

      if (!/(38|40|27)/.test(e.keyCode)) return

      $this = $(this)

      e.preventDefault()
      e.stopPropagation()

      if ($this.is('.disabled, :disabled')) return

      $parent = getParent($this)

      isActive = $parent.hasClass('open')

      if (!isActive || (isActive && e.keyCode == 27)) return $this.click()

      $items = $('[role=menu] li:not(.divider) a', $parent)

      if (!$items.length) return

      index = $items.index($items.filter(':focus'))

      if (e.keyCode == 38 && index > 0) index--                                        // up
      if (e.keyCode == 40 && index < $items.length - 1) index++                        // down
      if (!~index) index = 0

      $items
        .eq(index)
        .focus()
    }

  }

  function clearMenus() {
    getParent($(toggle))
      .removeClass('open')
  }

  function getParent($this) {
    var selector = $this.attr('data-target')
      , $parent

    if (!selector) {
      selector = $this.attr('href')
      selector = selector && /#/.test(selector) && selector.replace(/.*(?=#[^\s]*$)/, '') //strip for ie7
    }

    $parent = $(selector)
    $parent.length || ($parent = $this.parent())

    return $parent
  }


  /* DROPDOWN PLUGIN DEFINITION
   * ========================== */

  $.fn.dropdown = function (option) {
    return this.each(function () {
      var $this = $(this)
        , data = $this.data('dropdown')
      if (!data) $this.data('dropdown', (data = new Dropdown(this)))
      if (typeof option == 'string') data[option].call($this)
    })
  }

  $.fn.dropdown.Constructor = Dropdown


  /* APPLY TO STANDARD DROPDOWN ELEMENTS
   * =================================== */

  $(function () {
    $('html')
      .on('click.dropdown.data-api', clearMenus)
    $('body')
      .on('click.dropdown touchstart.dropdown.data-api', '.dropdown form', function (e) { e.stopPropagation() })
      .on('click.dropdown.data-api'  , toggle, Dropdown.prototype.toggle)
      .on('keydown.dropdown.data-api touchstart.dropdown.data-api', toggle + ', [role=menu]' , Dropdown.prototype.keydown)
  })

}(window.jQuery);/* =========================================================
 * bootstrap-modal.js v2.3.2
 * http://getbootstrap.com/2.3.2/javascript.html#modals
 * =========================================================
 * Copyright 2013 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================= */


!function ($) {

  "use strict"; // jshint ;_;


 /* MODAL CLASS DEFINITION
  * ====================== */

  var Modal = function (element, options) {
    this.options = options
    this.$element = $(element)
      .delegate('[data-dismiss="modal"]', 'click.dismiss.modal', $.proxy(this.hide, this))
    this.options.remote && this.$element.find('.modal-body').load(this.options.remote)
  }

  Modal.prototype = {

      constructor: Modal

    , toggle: function () {
        return this[!this.isShown ? 'show' : 'hide']()
      }

    , show: function () {
        var that = this
          , e = $.Event('show')

        this.$element.trigger(e)

        if (this.isShown || e.isDefaultPrevented()) return

        this.isShown = true

        this.escape()

        this.backdrop(function () {
          var transition = $.support.transition && that.$element.hasClass('fade')

          if (!that.$element.parent().length) {
            that.$element.appendTo(document.body) //don't move modals dom position
          }

          that.$element.show()

          if (transition) {
            that.$element[0].offsetWidth // force reflow
          }

          that.$element
            .addClass('in')
            .attr('aria-hidden', false)

          that.enforceFocus()

          transition ?
            that.$element.one($.support.transition.end, function () { that.$element.focus().trigger('shown') }) :
            that.$element.focus().trigger('shown')

        })
      }

    , hide: function (e) {
        e && e.preventDefault()

        var that = this

        e = $.Event('hide')

        this.$element.trigger(e)

        if (!this.isShown || e.isDefaultPrevented()) return

        this.isShown = false

        this.escape()

        $(document).off('focusin.modal')

        this.$element
          .removeClass('in')
          .attr('aria-hidden', true)

        $.support.transition && this.$element.hasClass('fade') ?
          this.hideWithTransition() :
          this.hideModal()
      }

    , enforceFocus: function () {
        var that = this
        $(document).on('focusin.modal', function (e) {
          if (that.$element[0] !== e.target && !that.$element.has(e.target).length) {
            that.$element.focus()
          }
        })
      }

    , escape: function () {
        var that = this
        if (this.isShown && this.options.keyboard) {
          this.$element.on('keyup.dismiss.modal', function ( e ) {
            e.which == 27 && that.hide()
          })
        } else if (!this.isShown) {
          this.$element.off('keyup.dismiss.modal')
        }
      }

    , hideWithTransition: function () {
        var that = this
          , timeout = setTimeout(function () {
              that.$element.off($.support.transition.end)
              that.hideModal()
            }, 500)

        this.$element.one($.support.transition.end, function () {
          clearTimeout(timeout)
          that.hideModal()
        })
      }

    , hideModal: function () {
        var that = this
        this.$element.hide()
        this.backdrop(function () {
          that.removeBackdrop()
          that.$element.trigger('hidden')
        })
      }

    , removeBackdrop: function () {
        this.$backdrop && this.$backdrop.remove()
        this.$backdrop = null
      }

    , backdrop: function (callback) {
        var that = this
          , animate = this.$element.hasClass('fade') ? 'fade' : ''

        if (this.isShown && this.options.backdrop) {
          var doAnimate = $.support.transition && animate

          this.$backdrop = $('<div class="modal-backdrop ' + animate + '" />')
            .appendTo(document.body)

          this.$backdrop.click(
            this.options.backdrop == 'static' ?
              $.proxy(this.$element[0].focus, this.$element[0])
            : $.proxy(this.hide, this)
          )

          if (doAnimate) this.$backdrop[0].offsetWidth // force reflow

          this.$backdrop.addClass('in')

          if (!callback) return

          doAnimate ?
            this.$backdrop.one($.support.transition.end, callback) :
            callback()

        } else if (!this.isShown && this.$backdrop) {
          this.$backdrop.removeClass('in')

          $.support.transition && this.$element.hasClass('fade')?
            this.$backdrop.one($.support.transition.end, callback) :
            callback()

        } else if (callback) {
          callback()
        }
      }
  }


 /* MODAL PLUGIN DEFINITION
  * ======================= */

  var old = $.fn.modal

  $.fn.modal = function (option) {
    return this.each(function () {
      var $this = $(this)
        , data = $this.data('modal')
        , options = $.extend({}, $.fn.modal.defaults, $this.data(), typeof option == 'object' && option)
      if (!data) $this.data('modal', (data = new Modal(this, options)))
      if (typeof option == 'string') data[option]()
      else if (options.show) data.show()
    })
  }

  $.fn.modal.defaults = {
      backdrop: true
    , keyboard: true
    , show: true
  }

  $.fn.modal.Constructor = Modal


 /* MODAL NO CONFLICT
  * ================= */

  $.fn.modal.noConflict = function () {
    $.fn.modal = old
    return this
  }


 /* MODAL DATA-API
  * ============== */

  $(document).on('click.modal.data-api', '[data-toggle="modal"]', function (e) {
    var $this = $(this)
      , href = $this.attr('href')
      , $target = $($this.attr('data-target') || (href && href.replace(/.*(?=#[^\s]+$)/, ''))) //strip for ie7
      , option = $target.data('modal') ? 'toggle' : $.extend({ remote:!/#/.test(href) && href }, $target.data(), $this.data())

    e.preventDefault()

    $target
      .modal(option)
      .one('hide', function () {
        $this.focus()
      })
  })

}(window.jQuery);/* ===========================================================
 * bootstrap-tooltip.js v2.1.1
 * http://twitter.github.com/bootstrap/javascript.html#tooltips
 * Inspired by the original jQuery.tipsy by Jason Frame
 * ===========================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================== */


!function ($) {

  "use strict"; // jshint ;_;


 /* TOOLTIP PUBLIC CLASS DEFINITION
  * =============================== */

  var Tooltip = function (element, options) {
    this.init('tooltip', element, options)
  }

  Tooltip.prototype = {

    constructor: Tooltip

  , init: function (type, element, options) {
      var eventIn
        , eventOut

      this.type = type
      this.$element = $(element)
      this.options = this.getOptions(options)
      this.enabled = true

      if (this.options.trigger == 'click') {
        this.$element.on('click.' + this.type, this.options.selector, $.proxy(this.toggle, this))
      } else if (this.options.trigger != 'manual') {
        eventIn = this.options.trigger == 'hover' ? 'mouseenter' : 'focus'
        eventOut = this.options.trigger == 'hover' ? 'mouseleave' : 'blur'
        this.$element.on(eventIn + '.' + this.type, this.options.selector, $.proxy(this.enter, this))
        this.$element.on(eventOut + '.' + this.type, this.options.selector, $.proxy(this.leave, this))
      }

      this.options.selector ?
        (this._options = $.extend({}, this.options, { trigger: 'manual', selector: '' })) :
        this.fixTitle()
    }

  , getOptions: function (options) {
      options = $.extend({}, $.fn[this.type].defaults, options, this.$element.data())

      if (options.delay && typeof options.delay == 'number') {
        options.delay = {
          show: options.delay
        , hide: options.delay
        }
      }

      return options
    }

  , enter: function (e) {
      var self = $(e.currentTarget)[this.type](this._options).data(this.type)

      if (!self.options.delay || !self.options.delay.show) return self.show()

      clearTimeout(this.timeout)
      self.hoverState = 'in'
      this.timeout = setTimeout(function() {
        if (self.hoverState == 'in') self.show()
      }, self.options.delay.show)
    }

  , leave: function (e) {
      var self = $(e.currentTarget)[this.type](this._options).data(this.type)

      if (this.timeout) clearTimeout(this.timeout)
      if (!self.options.delay || !self.options.delay.hide) return self.hide()

      self.hoverState = 'out'
      this.timeout = setTimeout(function() {
        if (self.hoverState == 'out') self.hide()
      }, self.options.delay.hide)
    }

  , show: function () {
      var $tip
        , inside
        , pos
        , actualWidth
        , actualHeight
        , placement
        , tp

      if (this.hasContent() && this.enabled) {
        $tip = this.tip()
        this.setContent()

        if (this.options.animation) {
          $tip.addClass('fade')
        }

        placement = typeof this.options.placement == 'function' ?
          this.options.placement.call(this, $tip[0], this.$element[0]) :
          this.options.placement

        inside = /in/.test(placement)

        $tip
          .remove()
          .css({ top: 0, left: 0, display: 'block' })
          .appendTo(inside ? this.$element : document.body)

        pos = this.getPosition(inside)

        actualWidth = $tip[0].offsetWidth
        actualHeight = $tip[0].offsetHeight

        switch (inside ? placement.split(' ')[1] : placement) {
          case 'bottom':
            tp = {top: pos.top + pos.height, left: pos.left + pos.width / 2 - actualWidth / 2}
            break
          case 'top':
            tp = {top: pos.top - actualHeight, left: pos.left + pos.width / 2 - actualWidth / 2}
            break
          case 'left':
            tp = {top: pos.top + pos.height / 2 - actualHeight / 2, left: pos.left - actualWidth}
            break
          case 'right':
            tp = {top: pos.top + pos.height / 2 - actualHeight / 2, left: pos.left + pos.width}
            break
        }

        $tip
          .css(tp)
          .addClass(placement)
          .addClass('in')
      }
    }

  , setContent: function () {
      var $tip = this.tip()
        , title = this.getTitle()

      $tip.find('.tooltip-inner')[this.options.html ? 'html' : 'text'](title)
      $tip.removeClass('fade in top bottom left right')
    }

  , hide: function () {
      var that = this
        , $tip = this.tip()

      $tip.removeClass('in')

      function removeWithAnimation() {
        var timeout = setTimeout(function () {
          $tip.off($.support.transition.end).remove()
        }, 500)

        $tip.one($.support.transition.end, function () {
          clearTimeout(timeout)
          $tip.remove()
        })
      }

      $.support.transition && this.$tip.hasClass('fade') ?
        removeWithAnimation() :
        $tip.remove()

      return this
    }

  , fixTitle: function () {
      var $e = this.$element
      if ($e.attr('title') || typeof($e.attr('data-original-title')) != 'string') {
        $e.attr('data-original-title', $e.attr('title') || '').removeAttr('title')
      }
    }

  , hasContent: function () {
      return this.getTitle()
    }

  , getPosition: function (inside) {
      return $.extend({}, (inside ? {top: 0, left: 0} : this.$element.offset()), {
        width: this.$element[0].offsetWidth
      , height: this.$element[0].offsetHeight
      })
    }

  , getTitle: function () {
      var title
        , $e = this.$element
        , o = this.options

      title = $e.attr('data-original-title')
        || (typeof o.title == 'function' ? o.title.call($e[0]) :  o.title)

      return title
    }

  , tip: function () {
      return this.$tip = this.$tip || $(this.options.template)
    }

  , validate: function () {
      if (!this.$element[0].parentNode) {
        this.hide()
        this.$element = null
        this.options = null
      }
    }

  , enable: function () {
      this.enabled = true
    }

  , disable: function () {
      this.enabled = false
    }

  , toggleEnabled: function () {
      this.enabled = !this.enabled
    }

  , toggle: function () {
      this[this.tip().hasClass('in') ? 'hide' : 'show']()
    }

  , destroy: function () {
      this.hide().$element.off('.' + this.type).removeData(this.type)
    }

  }


 /* TOOLTIP PLUGIN DEFINITION
  * ========================= */

  $.fn.tooltip = function ( option ) {
    return this.each(function () {
      var $this = $(this)
        , data = $this.data('tooltip')
        , options = typeof option == 'object' && option
      if (!data) $this.data('tooltip', (data = new Tooltip(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  $.fn.tooltip.Constructor = Tooltip

  $.fn.tooltip.defaults = {
    animation: true
  , placement: 'top'
  , selector: false
  , template: '<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>'
  , trigger: 'hover'
  , title: ''
  , delay: 0
  , html: true
  }

}(window.jQuery);
/* ===========================================================
 * bootstrap-popover.js v2.1.1
 * http://twitter.github.com/bootstrap/javascript.html#popovers
 * ===========================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =========================================================== */


!function ($) {

  "use strict"; // jshint ;_;


 /* POPOVER PUBLIC CLASS DEFINITION
  * =============================== */

  var Popover = function (element, options) {
    this.init('popover', element, options)
  }


  /* NOTE: POPOVER EXTENDS BOOTSTRAP-TOOLTIP.js
     ========================================== */

  Popover.prototype = $.extend({}, $.fn.tooltip.Constructor.prototype, {

    constructor: Popover

  , setContent: function () {
      var $tip = this.tip()
        , title = this.getTitle()
        , content = this.getContent()

      $tip.find('.popover-title')[this.options.html ? 'html' : 'text'](title)
      $tip.find('.popover-content > *')[this.options.html ? 'html' : 'text'](content)

      $tip.removeClass('fade top bottom left right in')
    }

  , hasContent: function () {
      return this.getTitle() || this.getContent()
    }

  , getContent: function () {
      var content
        , $e = this.$element
        , o = this.options

      content = $e.attr('data-content')
        || (typeof o.content == 'function' ? o.content.call($e[0]) :  o.content)

      return content
    }

  , tip: function () {
      if (!this.$tip) {
        this.$tip = $(this.options.template)
      }
      return this.$tip
    }

  , destroy: function () {
      this.hide().$element.off('.' + this.type).removeData(this.type)
    }

  })


 /* POPOVER PLUGIN DEFINITION
  * ======================= */

  $.fn.popover = function (option) {
    return this.each(function () {
      var $this = $(this)
        , data = $this.data('popover')
        , options = typeof option == 'object' && option
      if (!data) $this.data('popover', (data = new Popover(this, options)))
      if (typeof option == 'string') data[option]()
    })
  }

  $.fn.popover.Constructor = Popover

  $.fn.popover.defaults = $.extend({} , $.fn.tooltip.defaults, {
    placement: 'right'
  , trigger: 'click'
  , content: ''
  , template: '<div class="popover"><div class="arrow"></div><div class="popover-inner"><h3 class="popover-title"></h3><div class="popover-content"><p></p></div></div></div>'
  })

}(window.jQuery);/* ========================================================
 * bootstrap-tab.js v2.1.1
 * http://twitter.github.com/bootstrap/javascript.html#tabs
 * ========================================================
 * Copyright 2012 Twitter, Inc.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ======================================================== */


!function ($) {

  "use strict"; // jshint ;_;


 /* TAB CLASS DEFINITION
  * ==================== */

  var Tab = function (element) {
    this.element = $(element)
  }

  Tab.prototype = {

    constructor: Tab

  , show: function () {
      var $this = this.element
        , $ul = $this.closest('ul:not(.dropdown-menu)')
        , selector = $this.attr('data-target')
        , previous
        , $target
        , e

      if (!selector) {
        selector = $this.attr('href')
        selector = selector && selector.replace(/.*(?=#[^\s]*$)/, '') //strip for ie7
      }

      if ( $this.parent('li').hasClass('active') ) return

      previous = $ul.find('.active a').last()[0]

      e = $.Event('show', {
        relatedTarget: previous
      })

      $this.trigger(e)

      if (e.isDefaultPrevented()) return

      $target = $(selector)

      this.activate($this.parent('li'), $ul)
      this.activate($target, $target.parent(), function () {
        $this.trigger({
          type: 'shown'
        , relatedTarget: previous
        })
      })
    }

  , activate: function ( element, container, callback) {
      var $active = container.find('> .active')
        , transition = callback
            && $.support.transition
            && $active.hasClass('fade')

      function next() {
        $active
          .removeClass('active')
          .find('> .dropdown-menu > .active')
          .removeClass('active')

        element.addClass('active')

        if (transition) {
          element[0].offsetWidth // reflow for transition
          element.addClass('in')
        } else {
          element.removeClass('fade')
        }

        if ( element.parent('.dropdown-menu') ) {
          element.closest('li.dropdown').addClass('active')
        }

        callback && callback()
      }

      transition ?
        $active.one($.support.transition.end, next) :
        next()

      $active.removeClass('in')
    }
  }


 /* TAB PLUGIN DEFINITION
  * ===================== */

  $.fn.tab = function ( option ) {
    return this.each(function () {
      var $this = $(this)
        , data = $this.data('tab')
      if (!data) $this.data('tab', (data = new Tab(this)))
      if (typeof option == 'string') data[option]()
    })
  }

  $.fn.tab.Constructor = Tab


 /* TAB DATA-API
  * ============ */

  $(function () {
    $('body').on('click.tab.data-api', '[data-toggle="tab"], [data-toggle="pill"]', function (e) {
      e.preventDefault()
      $(this).tab('show')
    })
  })

}(window.jQuery);;
/* ===========================================================
 * bootstrap-modalmanager.js v2.2.5
 * ===========================================================
 * Copyright 2012 Jordan Schroter.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================== */

!function ($) {

	"use strict"; // jshint ;_;

	/* MODAL MANAGER CLASS DEFINITION
	* ====================== */

	var ModalManager = function (element, options) {
		this.init(element, options);
	};

	ModalManager.prototype = {

		constructor: ModalManager,

		init: function (element, options) {
			this.$element = $(element);
			this.options = $.extend({}, $.fn.modalmanager.defaults, this.$element.data(), typeof options == 'object' && options);
			this.stack = [];
			this.backdropCount = 0;

			if (this.options.resize) {
				var resizeTimeout,
					that = this;

				$(window).on('resize.modal', function(){
					resizeTimeout && clearTimeout(resizeTimeout);
					resizeTimeout = setTimeout(function(){
						for (var i = 0; i < that.stack.length; i++){
							that.stack[i].isShown && that.stack[i].layout();
						}
					}, 10);
				});
			}
		},

		createModal: function (element, options) {
			$(element).modal($.extend({ manager: this }, options));
		},

		appendModal: function (modal) {
			this.stack.push(modal);

			var that = this;

			modal.$element.on('show.modalmanager', targetIsSelf(function (e) {

				var showModal = function(){
					modal.isShown = true;

					var transition = $.support.transition && modal.$element.hasClass('fade');

					that.$element
						.toggleClass('modal-open', that.hasOpenModal())
						.toggleClass('page-overflow', $(window).height() < that.$element.height());

					modal.$parent = modal.$element.parent();

					modal.$container = that.createContainer(modal);

					modal.$element.appendTo(modal.$container);

					that.backdrop(modal, function () {
						modal.$element.show();

						if (transition) {       
							//modal.$element[0].style.display = 'run-in';       
							modal.$element[0].offsetWidth;
							//modal.$element.one($.support.transition.end, function () { modal.$element[0].style.display = 'block' });  
						}
						
						modal.layout();

						modal.$element
							.addClass('in')
							.attr('aria-hidden', false);

						var complete = function () {
							that.setFocus();
							modal.$element.trigger('shown');
						};

						transition ?
							modal.$element.one($.support.transition.end, complete) :
							complete();
					});
				};

				modal.options.replace ?
					that.replace(showModal) :
					showModal();
			}));

			modal.$element.on('hidden.modalmanager', targetIsSelf(function (e) {
				that.backdrop(modal);
				// handle the case when a modal may have been removed from the dom before this callback executes
				if (!modal.$element.parent().length) {
					that.destroyModal(modal);
				} else if (modal.$backdrop){
					var transition = $.support.transition && modal.$element.hasClass('fade');

					// trigger a relayout due to firebox's buggy transition end event 
					if (transition) { modal.$element[0].offsetWidth; }
					$.support.transition && modal.$element.hasClass('fade') ?
						modal.$backdrop.one($.support.transition.end, function () { modal.destroy(); }) :
						modal.destroy();
				} else {
					modal.destroy();
				}

			}));

			modal.$element.on('destroyed.modalmanager', targetIsSelf(function (e) {
				that.destroyModal(modal);
			}));
		},

		getOpenModals: function () {
			var openModals = [];
			for (var i = 0; i < this.stack.length; i++){
				if (this.stack[i].isShown) openModals.push(this.stack[i]);
			}

			return openModals;
		},

		hasOpenModal: function () {
			return this.getOpenModals().length > 0;
		},

		setFocus: function () {
			var topModal;

			for (var i = 0; i < this.stack.length; i++){
				if (this.stack[i].isShown) topModal = this.stack[i];
			}

			if (!topModal) return;

			topModal.focus();
		},

		destroyModal: function (modal) {
			modal.$element.off('.modalmanager');
			if (modal.$backdrop) this.removeBackdrop(modal);
			this.stack.splice(this.getIndexOfModal(modal), 1);

			var hasOpenModal = this.hasOpenModal();

			this.$element.toggleClass('modal-open', hasOpenModal);

			if (!hasOpenModal){
				this.$element.removeClass('page-overflow');
			}

			this.removeContainer(modal);

			this.setFocus();
		},

		getModalAt: function (index) {
			return this.stack[index];
		},

		getIndexOfModal: function (modal) {
			for (var i = 0; i < this.stack.length; i++){
				if (modal === this.stack[i]) return i;
			}
		},

		replace: function (callback) {
			var topModal;

			for (var i = 0; i < this.stack.length; i++){
				if (this.stack[i].isShown) topModal = this.stack[i];
			}

			if (topModal) {
				this.$backdropHandle = topModal.$backdrop;
				topModal.$backdrop = null;

				callback && topModal.$element.one('hidden',
					targetIsSelf( $.proxy(callback, this) ));

				topModal.hide();
			} else if (callback) {
				callback();
			}
		},

		removeBackdrop: function (modal) {
			modal.$backdrop.remove();
			modal.$backdrop = null;
		},

		createBackdrop: function (animate, tmpl) {
			var $backdrop;

			if (!this.$backdropHandle) {
				$backdrop = $(tmpl)
					.addClass(animate)
					.appendTo(this.$element);
			} else {
				$backdrop = this.$backdropHandle;
				$backdrop.off('.modalmanager');
				this.$backdropHandle = null;
				this.isLoading && this.removeSpinner();
			}

			return $backdrop;
		},

		removeContainer: function (modal) {
			modal.$container.remove();
			modal.$container = null;
		},

		createContainer: function (modal) {
			var $container;

			$container = $('<div class="modal-scrollable">')
				.css('z-index', getzIndex('modal', this.getOpenModals().length))
				.appendTo(this.$element);

			if (modal && modal.options.backdrop != 'static') {
				$container.on('click.modal', targetIsSelf(function (e) {
					modal.hide();
				}));
			} else if (modal) {
				$container.on('click.modal', targetIsSelf(function (e) {
					modal.attention();
				}));
			}

			return $container;

		},

		backdrop: function (modal, callback) {
			var animate = modal.$element.hasClass('fade') ? 'fade' : '',
				showBackdrop = modal.options.backdrop &&
					this.backdropCount < this.options.backdropLimit;

			if (modal.isShown && showBackdrop) {
				var doAnimate = $.support.transition && animate && !this.$backdropHandle;

				modal.$backdrop = this.createBackdrop(animate, modal.options.backdropTemplate);

				modal.$backdrop.css('z-index', getzIndex( 'backdrop', this.getOpenModals().length ));

				if (doAnimate) modal.$backdrop[0].offsetWidth; // force reflow

				modal.$backdrop.addClass('in');

				this.backdropCount += 1;

				doAnimate ?
					modal.$backdrop.one($.support.transition.end, callback) :
					callback();

			} else if (!modal.isShown && modal.$backdrop) {
				modal.$backdrop.removeClass('in');

				this.backdropCount -= 1;

				var that = this;

				$.support.transition && modal.$element.hasClass('fade')?
					modal.$backdrop.one($.support.transition.end, function () { that.removeBackdrop(modal) }) :
					that.removeBackdrop(modal);

			} else if (callback) {
				callback();
			}
		},

		removeSpinner: function(){
			this.$spinner && this.$spinner.remove();
			this.$spinner = null;
			this.isLoading = false;
		},

		removeLoading: function () {
			this.$backdropHandle && this.$backdropHandle.remove();
			this.$backdropHandle = null;
			this.removeSpinner();
		},

		loading: function (callback) {
			callback = callback || function () { };

			this.$element
				.toggleClass('modal-open', !this.isLoading || this.hasOpenModal())
				.toggleClass('page-overflow', $(window).height() < this.$element.height());

			if (!this.isLoading) {

				this.$backdropHandle = this.createBackdrop('fade', this.options.backdropTemplate);

				this.$backdropHandle[0].offsetWidth; // force reflow

				var openModals = this.getOpenModals();

				this.$backdropHandle
					.css('z-index', getzIndex('backdrop', openModals.length + 1))
					.addClass('in');

				var $spinner = $(this.options.spinner)
					.css('z-index', getzIndex('modal', openModals.length + 1))
					.appendTo(this.$element)
					.addClass('in');

				this.$spinner = $(this.createContainer())
					.append($spinner)
					.on('click.modalmanager', $.proxy(this.loading, this));

				this.isLoading = true;

				$.support.transition ?
					this.$backdropHandle.one($.support.transition.end, callback) :
					callback();

			} else if (this.isLoading && this.$backdropHandle) {
				this.$backdropHandle.removeClass('in');

				var that = this;
				$.support.transition ?
					this.$backdropHandle.one($.support.transition.end, function () { that.removeLoading() }) :
					that.removeLoading();

			} else if (callback) {
				callback(this.isLoading);
			}
		}
	};

	/* PRIVATE METHODS
	* ======================= */

	// computes and caches the zindexes
	var getzIndex = (function () {
		var zIndexFactor,
			baseIndex = {};

		return function (type, pos) {

			if (typeof zIndexFactor === 'undefined'){
				var $baseModal = $('<div class="modal hide" />').appendTo('body'),
					$baseBackdrop = $('<div class="modal-backdrop hide" />').appendTo('body');

				baseIndex['modal'] = +$baseModal.css('z-index');
				baseIndex['backdrop'] = +$baseBackdrop.css('z-index');
				zIndexFactor = baseIndex['modal'] - baseIndex['backdrop'];

				$baseModal.remove();
				$baseBackdrop.remove();
				$baseBackdrop = $baseModal = null;
			}

			return baseIndex[type] + (zIndexFactor * pos);

		}
	}());

	// make sure the event target is the modal itself in order to prevent
	// other components such as tabsfrom triggering the modal manager.
	// if Boostsrap namespaced events, this would not be needed.
	function targetIsSelf(callback){
		return function (e) {
			if (e && this === e.target){
				return callback.apply(this, arguments);
			}
		}
	}


	/* MODAL MANAGER PLUGIN DEFINITION
	* ======================= */

	$.fn.modalmanager = function (option, args) {
		return this.each(function () {
			var $this = $(this),
				data = $this.data('modalmanager');

			if (!data) $this.data('modalmanager', (data = new ModalManager(this, option)));
			if (typeof option === 'string') data[option].apply(data, [].concat(args))
		})
	};

	$.fn.modalmanager.defaults = {
		backdropLimit: 999,
		resize: true,
		spinner: '<div class="loading-spinner fade" style="width: 200px; margin-left: -100px;"><div class="progress progress-striped active"><div class="bar" style="width: 100%;"></div></div></div>',
		backdropTemplate: '<div class="modal-backdrop" />'
	};

	$.fn.modalmanager.Constructor = ModalManager

	// ModalManager handles the modal-open class so we need 
	// to remove conflicting bootstrap 3 event handlers
	$(function () {
		$(document).off('show.bs.modal').off('hidden.bs.modal');
	});

}(jQuery);
;
/* ===========================================================
 * bootstrap-modal.js v2.2.5
 * ===========================================================
 * Copyright 2012 Jordan Schroter
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * ========================================================== */


!function ($) {

	"use strict"; // jshint ;_;

	/* MODAL CLASS DEFINITION
	* ====================== */

	var Modal = function (element, options) {
		this.init(element, options);
	};

	Modal.prototype = {

		constructor: Modal,

		init: function (element, options) {
			var that = this;

			this.options = options;

			this.$element = $(element)
				.delegate('[data-dismiss="modal"]', 'click.dismiss.modal', $.proxy(this.hide, this));

			this.options.remote && this.$element.find('.modal-body').load(this.options.remote, function () {
				var e = $.Event('loaded');
				that.$element.trigger(e);
			});

			var manager = typeof this.options.manager === 'function' ?
				this.options.manager.call(this) : this.options.manager;

			manager = manager.appendModal ?
				manager : $(manager).modalmanager().data('modalmanager');

			manager.appendModal(this);
		},

		toggle: function () {
			return this[!this.isShown ? 'show' : 'hide']();
		},

		show: function () {
			var e = $.Event('show');

			if (this.isShown) return;

			this.$element.trigger(e);

			if (e.isDefaultPrevented()) return;

			this.escape();

			this.tab();

			this.options.loading && this.loading();
		},

		hide: function (e) {
			e && e.preventDefault();

			e = $.Event('hide');

			this.$element.trigger(e);

			if (!this.isShown || e.isDefaultPrevented()) return;

			this.isShown = false;

			this.escape();

			this.tab();

			this.isLoading && this.loading();

			$(document).off('focusin.modal');

			this.$element
				.removeClass('in')
				.removeClass('animated')
				.removeClass(this.options.attentionAnimation)
				.removeClass('modal-overflow')
				.attr('aria-hidden', true);

			$.support.transition && this.$element.hasClass('fade') ?
				this.hideWithTransition() :
				this.hideModal();
		},

		layout: function () {
			var prop = this.options.height ? 'height' : 'max-height',
				value = this.options.height || this.options.maxHeight;

			if (this.options.width){
				this.$element.css('width', this.options.width);

				var that = this;
				this.$element.css('margin-left', function () {
					if (/%/ig.test(that.options.width)){
						return -(parseInt(that.options.width) / 2) + '%';
					} else {
						return -($(this).width() / 2) + 'px';
					}
				});
			} else {
				this.$element.css('width', '');
				this.$element.css('margin-left', '');
			}

			this.$element.find('.modal-body')
				.css('overflow', '')
				.css(prop, '');

			if (value){
				this.$element.find('.modal-body')
					.css('overflow', 'auto')
					.css(prop, value);
			}

			var modalOverflow = $(window).height() - 10 < this.$element.height();
            
			if (modalOverflow || this.options.modalOverflow) {
				this.$element
					.css('margin-top', 0)
					.addClass('modal-overflow');
			} else {
				this.$element
					.css('margin-top', 0 - this.$element.height() / 2)
					.removeClass('modal-overflow');
			}
		},

		tab: function () {
			var that = this;

			if (this.isShown && this.options.consumeTab) {
				this.$element.on('keydown.tabindex.modal', '[data-tabindex]', function (e) {
			    	if (e.keyCode && e.keyCode == 9){
						var elements = [],
							tabindex = Number($(this).data('tabindex'));

						that.$element.find('[data-tabindex]:enabled:visible:not([readonly])').each(function (ev) {
							elements.push(Number($(this).data('tabindex')));
						});
						elements.sort(function(a,b){return a-b});
						
						var arrayPos = $.inArray(tabindex, elements);
						if (!e.shiftKey){
						 		arrayPos < elements.length-1 ?
									that.$element.find('[data-tabindex='+elements[arrayPos+1]+']').focus() :
									that.$element.find('[data-tabindex='+elements[0]+']').focus();
							} else {
								arrayPos == 0 ?
									that.$element.find('[data-tabindex='+elements[elements.length-1]+']').focus() :
									that.$element.find('[data-tabindex='+elements[arrayPos-1]+']').focus();
							}
						
						e.preventDefault();
					}
				});
			} else if (!this.isShown) {
				this.$element.off('keydown.tabindex.modal');
			}
		},

		escape: function () {
			var that = this;
			if (this.isShown && this.options.keyboard) {
				if (!this.$element.attr('tabindex')) this.$element.attr('tabindex', -1);

				this.$element.on('keyup.dismiss.modal', function (e) {
					e.which == 27 && that.hide();
				});
			} else if (!this.isShown) {
				this.$element.off('keyup.dismiss.modal')
			}
		},

		hideWithTransition: function () {
			var that = this
				, timeout = setTimeout(function () {
					that.$element.off($.support.transition.end);
					that.hideModal();
				}, 500);

			this.$element.one($.support.transition.end, function () {
				clearTimeout(timeout);
				that.hideModal();
			});
		},

		hideModal: function () {
			var prop = this.options.height ? 'height' : 'max-height';
			var value = this.options.height || this.options.maxHeight;

			if (value){
				this.$element.find('.modal-body')
					.css('overflow', '')
					.css(prop, '');
			}

			this.$element
				.hide()
				.trigger('hidden');
		},

		removeLoading: function () {
			this.$loading.remove();
			this.$loading = null;
			this.isLoading = false;
		},

		loading: function (callback) {
			callback = callback || function () {};

			var animate = this.$element.hasClass('fade') ? 'fade' : '';

			if (!this.isLoading) {
				var doAnimate = $.support.transition && animate;

				this.$loading = $('<div class="loading-mask ' + animate + '">')
					.append(this.options.spinner)
					.appendTo(this.$element);

				if (doAnimate) this.$loading[0].offsetWidth; // force reflow

				this.$loading.addClass('in');

				this.isLoading = true;

				doAnimate ?
					this.$loading.one($.support.transition.end, callback) :
					callback();

			} else if (this.isLoading && this.$loading) {
				this.$loading.removeClass('in');

				var that = this;
				$.support.transition && this.$element.hasClass('fade')?
					this.$loading.one($.support.transition.end, function () { that.removeLoading() }) :
					that.removeLoading();

			} else if (callback) {
				callback(this.isLoading);
			}
		},

		focus: function () {
			var $focusElem = this.$element.find(this.options.focusOn);

			$focusElem = $focusElem.length ? $focusElem : this.$element;

			$focusElem.focus();
		},

		attention: function (){
			// NOTE: transitionEnd with keyframes causes odd behaviour

			if (this.options.attentionAnimation){
				this.$element
					.removeClass('animated')
					.removeClass(this.options.attentionAnimation);

				var that = this;

				setTimeout(function () {
					that.$element
						.addClass('animated')
						.addClass(that.options.attentionAnimation);
				}, 0);
			}


			this.focus();
		},


		destroy: function () {
			var e = $.Event('destroy');

			this.$element.trigger(e);

			if (e.isDefaultPrevented()) return;

			this.$element
				.off('.modal')
				.removeData('modal')
				.removeClass('in')
				.attr('aria-hidden', true);
			
			if (this.$parent !== this.$element.parent()) {
				this.$element.appendTo(this.$parent);
			} else if (!this.$parent.length) {
				// modal is not part of the DOM so remove it.
				this.$element.remove();
				this.$element = null;
			}

			this.$element.trigger('destroyed');
		}
	};


	/* MODAL PLUGIN DEFINITION
	* ======================= */

	$.fn.modal = function (option, args) {
		return this.each(function () {
			var $this = $(this),
				data = $this.data('modal'),
				options = $.extend({}, $.fn.modal.defaults, $this.data(), typeof option == 'object' && option);

			if (!data) $this.data('modal', (data = new Modal(this, options)));
			if (typeof option == 'string') data[option].apply(data, [].concat(args));
			else if (options.show) data.show()
		})
	};

	$.fn.modal.defaults = {
		keyboard: true,
		backdrop: true,
		loading: false,
		show: true,
		width: null,
		height: null,
		maxHeight: null,
		modalOverflow: false,
		consumeTab: true,
		focusOn: null,
		replace: false,
		resize: false,
		attentionAnimation: 'shake',
		manager: 'body',
		spinner: '<div class="loading-spinner" style="width: 200px; margin-left: -100px;"><div class="progress progress-striped active"><div class="bar" style="width: 100%;"></div></div></div>',
		backdropTemplate: '<div class="modal-backdrop" />'
	};

	$.fn.modal.Constructor = Modal;


	/* MODAL DATA-API
	* ============== */

	$(function () {
		$(document).off('click.modal').on('click.modal.data-api', '[data-toggle="modal"]', function ( e ) {
			var $this = $(this),
				href = $this.attr('href'),
				$target = $($this.attr('data-target') || (href && href.replace(/.*(?=#[^\s]+$)/, ''))), //strip for ie7
				option = $target.data('modal') ? 'toggle' : $.extend({ remote: !/#/.test(href) && href }, $target.data(), $this.data());

			e.preventDefault();
			$target
				.modal(option)
				.one('hide', function () {
					$this.focus();
				})
		});
	});

}(window.jQuery);
;
/**
 * UAlberta Utilities
 * Author: Kyle Schmidt - kyle.schmidt@ualberta.ca
 */

// build namespace
var UAlberta = UAlberta || {};
UAlberta.Sitecore = UAlberta.Sitecore || {};

UAlberta.Sitecore.Utilities = UAlberta.Sitecore.Utilities || (function ($) {
    'use strict';

    var WindowType = {
        Mobile: "mobile",
        Tablet: "tablet",
        Desktop: "desktop",
        Highres: "high-resolution"
    };

    var DateFormat = {
        Unix: "yyyy-MM-dd HH:mm:ss",
        UnixDateOnly: "yyyy-MM-dd",
        Long: "MMMM d, yyyy h:mm a",
        LongNoYear: "MMMM d h:mm a",
        Short: "MMMM d, yyyy",
        ShortNoYear: "MMMM d",
        TimeOnly: "h:mm a",
        Timestamp: "timestamp"
    };

    // call a function after an interval has passed
    var delay = (function () {
        var timers = {};
        return function (callback, time, id) {
            if(timers[id]) {
                clearTimeout(timers[id]);
            }
            timers[id] = setTimeout(callback, time);
        };
    })();

    // get the window type
    function getWindowType() {
        var width = $(window).width();

        if(width < 690) {
            return WindowType.Mobile;
        }
        if(width < 980) {
            return WindowType.Tablet;
        }
        if(width < 1200) {
            return WindowType.Desktop;
        }
        return WindowType.Highres;
    }

    // get date from json string
    function getDateFromJson(jsonString, format) {
        if(jsonString == undefined || format == undefined) {
            return "";
        }

        var date = new Date(parseInt(jsonString.substr(6))).getTime();

        if(format == DateFormat.Timestamp) {
            return date;
        }

        return $.format.date(date, format);
    }

    // multiselect button text
    function multiselectButtonText(options, select) {
        if (options.length == 0) {
            return 'Show All <b class="caret"></b>';
        } else if (options.length > 2) {
            return options.length + ' selected <b class="caret"></b>';
        } else {
            var selected = '';
            options.each(function() {
                selected += $(this).text() + ', ';
            });
            return selected.substr(0, selected.length -2) + ' <b class="caret"></b>';
        }
    }

    return {
        WindowType: WindowType,
        DateFormat: DateFormat,
        Delay: delay,
        GetWindowType: getWindowType,
        GetDateFromJson: getDateFromJson,
        MultiselectButtonText: multiselectButtonText
    }
})(jQuery);
;
(function ($) {
    $.fn.DeviceImageScaling = function (options) {
        var defOptions = {
            smWidth: 480,
            mWidth: 690,
            tWidth: 980,
            dWidth: 1200,
            contentID: "layoutcontainer"
        };
        defOptions = $.extend(defOptions, options);
        return this.each(function () {
            var vpWidth = $("#" + defOptions.contentID).width(), type = "";
            if (vpWidth <= defOptions.smWidth) {
                type = "smallmobile";
            }
            else if (vpWidth <= defOptions.mWidth) {
                type = "mobile";
            }
            else if (vpWidth <= defOptions.tWidth) {
                type = "tablet";
            }
            else {
                type = "desktop";
            }

            // Modified below for IE6 compatibility
            if ($(this).attr("src") !== $(this).attr("data-imgsize-" + type)) {
                $(this).attr("src", $(this).attr("data-imgsize-" + type));
            }
        });
    };
})(jQuery);;
// Build out the Name space if it doesn't all ready exist
var UAlberta = UAlberta || {};
UAlberta.Sitecore = UAlberta.Sitecore || {};

UAlberta.Sitecore.EmergencyMessage = function ($) {

    var _url = '/api/emergencymessage.json',
        _containerSelector = '#emergencyMessage',
        _timeout = 90000;

    /*
    * Get Messages
    * Retrieves any emergency messages from the web service
    *
    * containerSelector: [String] The JQuery selector string of the DOM Element to place the message in
    * timeout: [Integer] The time in milliseconds to wait for the response as well as the delay before making the request again
    */
    function getMessages(containerSelector, timeout) {
        // If the container selector is a string use the passed value
        if (typeof containerSelector == 'string') {
            _containerSelector = containerSelector;
        }

        // If the timeout is not a number use the default value of 90 seconds
        if (typeof timeout == 'number') {
            _timeout = timeout;
        }
        //Call the function and set up a repeating call to that function
        var messageInterval = setInterval(processRequest, _timeout);
        setTimeout(function () { clearInterval(messageInterval); }, 600000);
        processRequest();
    }

    /*
    * Process Request
    * Makes the ajax call to the server
    */
    function processRequest() {
        $.ajax({
            type: 'GET',
            dataType: 'json',
            contentType: 'application/json',
            url: _url,
            timeout: _timeout,
            cache: false,
            success: ajaxSuccess,
            error: ajaxError
        });
    }

    /*
    * Ajax Success
    * Processes the successful ajax call
    *
    * data: [Object] The returned object from the web service
    */
    function ajaxSuccess(data) {
        var message = '';
        if (data.MessageText != '') {
            if ($(_containerSelector).length <= 0) {
                $('header').before("<div class='emergency' id='emergencyMessage'></div>");
            }

            if (data.MessageTitle != '') {
                message = '<h1>' + data.MessageTitle + '</h1>&nbsp;&nbsp;';
            }

            message += '<p>' + data.MessageText + '</p>';

            $(_containerSelector).empty().html(message);
        } else {
            $(_containerSelector).remove();
        }
    }

    /*
    * Ajax Error
    * Processes the error event during an ajax call
    *
    * data: [Object] The returned object from the web service
    */
    function ajaxError(data) {
    }

    return {
        GetMessages: getMessages
    };
} (jQuery);;
/**
 * Placeholder Processing
 * Author: Dean Vigoren - vigoren@ualberta.ca
 *
 * Adds placeholder text to inputs for browsers that do not support that attribute.
 * Requires a placeholder css class
 *
 * This is global functionality (why it's directly under the UAlberta name space) it is not specific to sitecore but for browser compatibility
 */
var UAlberta = UAlberta || {};

UAlberta.InputPlaceholders = function ($) {
    var _isPlaceholderSupported = 'placeholder' in document.createElement('input') && 'placeholder' in document.createElement('textarea'),
        _placeholderClass = 'placeholder';

    function init(placeholderClass){
        if(!_isPlaceholderSupported){

            if(placeholderClass){
                _placeholderClass = placeholderClass;
            }

            //Get the text areas and inputs that have placeholders but do not have the placeholder class
            $('input[placeholder], textarea[placeholder]').bind({
                'focus': clearPlaceholder,
                'blur': addPlaceholder
            }).trigger('blur');

            //Functionality for when enter is pressed on the search box or the search button is clicked the placeholder is cleared
            $('.search-query').keydown(function (a) {
                a = a || window.event;
                if (a.keyCode == 13 || a.which == 13) {
                    $('.' + _placeholderClass).each(clearPlaceholder);
                }

            });
            $('.global-search-btn').click(function () {
                $('.' + _placeholderClass).each(clearPlaceholder);
            });

            //On form submit make sure to clear all placeholders
            $(document).delegate('form', 'submit',function(){
                $('.' + _placeholderClass).each(clearPlaceholder);
            });

            //Clear the placeholder when a page is reloaded
            $(window).bind('beforeunload',function(){
                $('.' + _placeholderClass).each(clearPlaceholder);
            });
        }
    }

    /*
     * Clear Placeholder
     * Removes the text from the input and removes the placeholder class
    */
    function clearPlaceholder(){
        var input = $(this);
        if(input.val() ==  input.attr('placeholder')){
            input.val('');
            input.removeClass(_placeholderClass);
        }
    }

    /*
     * Add Placeholder
     * Adds the placeholder text to the input and adds the placeholder class
     */
    function addPlaceholder(){
        var input = $(this);
        if(input.val() == '' || input.val() == input.attr('placeholder')){
            input.addClass(_placeholderClass);
            input.val(input.attr('placeholder'));
        }
        else{
            input.removeClass(_placeholderClass);
        }
    }

    return{
        initialize: init
    }
}(jQuery);;
/**
* UAlberta Global Search (Blade) 
* Author: Jason Kulatunga - jk17@ualberta.ca
*/
var UAlberta = UAlberta || {};
UAlberta.Sitecore = UAlberta.Sitecore || {};

UAlberta.Sitecore.GlobalSearch = (function ($) {


    function KeyValue(key, value) {
        this.key = key;
        this.value = value;
    }

    function search(options) {

        var value = jQuery(options.selector).val();
        if (value == "") {
            return false;
        }

        options.query = escape(value);

        var params = [];
        params.push(new KeyValue("cx", options.googleId));
        params.push(new KeyValue("q", options.query));
        params.push(new KeyValue("cof", "FORID%3A11#1150"));

        var resultUrl = options.resultUrl;

        for (var ndx in params) {
            var param = params[ndx];
            if (param && param.key && param.value) {
                resultUrl = updateQueryString(param.key, param.value, resultUrl);
            }
        }

        window.location.href = resultUrl;
        return false;

    };

    function updateQueryString(key, value, url) {
        if (!url) url = window.location.href;
        var re = new RegExp("([?|&])" + key + "=.*?(&|#|$)", "gi");

        if (url.match(re)) {
            if (value) return url.replace(re, '$1' + key + "=" + value + '$2');
            else return url.replace(re, '$2');
        } else {
            if (value) {
                var separator = url.indexOf('?') !== -1 ? '&' : '?',
                    hash = url.split('#');
                url = hash[0] + separator + key + '=' + value;
                if (hash[1]) url += '#' + hash[1];
                return url;
            } else return url;
        }
    }




    function init(customOptions) {
        var options = {};
        options.selector = '.search-query';
        options.btnSelector = '.global-search-btn';
        options.googleId = '';
        options.query = '';
        options.resultUrl = '';

        //override defaults.
        options = $.extend({}, options, customOptions);


        if (!options.resultUrl || !options.selector || !options.googleId) {
            //if missing a required value, dont attach handler.
            return;
        }

        $(options.selector).keydown(function (a) {
            a = a || window.event;
            if (a.keyCode == 13 || a.which == 13) {
                a.preventDefault();
                return search(options);
            }

        });

        $(options.btnSelector).click(function (a) {
            a.preventDefault();
            return search(options);
        });

    }

    return {
        init: init
    }
})(jQuery);;
/**
* UAlberta Sitecore Page Load
* Script that is run on every page load to provide certain site wide functionality
*/

// All functionality that needs to be called on dom ready
$(document).ready(function () {

    //Setting Global Variables
    var winHeight = $(window).height(),
        headHeight = $('header').height(),
        footerHeight = $('footer').height(),
        bodyMinHeight = winHeight - (headHeight + footerHeight + 20),
        navTitle = $('#main-nav .navigation-toggle span');

    $('.content-wrapper').css('min-height', bodyMinHeight + 'px');
    $('.heading-link').tooltip();

    // navigation
    $('.nav-toggle').on('click', function (e) {
        $(this).parent().toggleClass('expanded');
        $(this).parent().parent().toggleClass('nav-expand');
        e.stopPropagation();
        return false;
    });
    $("header .navigation-toggle").on('click', function (e) {
        $(this).toggleClass('collapsed');
        $('header .nav-wrapper').toggleClass('on');
        $('header .nav-wrapper').trigger('classToggled', 'on');
        e.stopPropagation();
        return false;
    });
    $('header .nav-wrapper').on('classToggled', function (e, className) {
        navTitle.html($(this).hasClass(className) ? 'Hide Navigation' : 'Show Navigation');
    });

    // Process all of the images on the page to load the correct resolution for the screen size
    $('img').DeviceImageScaling();
    $(window).resize(function () {
        $('img').DeviceImageScaling();
    });

    // Processes the Emergency messaging call to check for any emergency messages to be displayed
    UAlberta.Sitecore.EmergencyMessage.GetMessages();

    //run the collapse plugin for Bootstrap. Initializes all collapsible elements
    $(".collapse").collapse();

    //Set up input placeholders for browsers that do not support them
    UAlberta.InputPlaceholders.initialize();
});

//Index of functionality for Older IE Versions
if (!Array.prototype.indexOf) {
    Array.prototype.indexOf = function (elt /*, from*/) {
        var len = this.length >>> 0;

        var from = Number(arguments[1]) || 0;
        from = (from < 0)
            ? Math.ceil(from)
            : Math.floor(from);
        if (from < 0)
            from += len;

        for (; from < len; from++) {
            if (from in this &&
                this[from] === elt)
                return from;
        }
        return -1;
    };
}

// make sure the sidebar does not extend past content area on desktop view
$(document).ready(function () {
    var contentContainerLandingPage, contentContainerFacultyHome = null;
    var nudgeOffset = 110;

    if ($('.content-wrapper').hasClass('landing-page')) {
        contentContainerLandingPage = $('.content-wrapper.landing-page');
    }

    if ($('.content-wrapper').hasClass('faculty-home')) {
        contentContainerFacultyHome = $('.content-wrapper.faculty-home');
    }

    function resizeContainer() {
        var newHeight = ($('.sidebar').height() + nudgeOffset) + 'px';

        if ($(window).width() > 979 && contentContainerLandingPage) {
            contentContainerLandingPage.css('min-height', newHeight);
        }

        if ($(window).width() > 689 && contentContainerFacultyHome) {
            contentContainerFacultyHome.css('min-height', newHeight);
        }
    };

    resizeContainer();
    $(window).resize(resizeContainer);
});;
/**
* UAlberta Athletics Game List
* Author: Kyle Schmidt - kyle.schmidt@ualberta.ca
*/

// build namespace
var UAlberta = UAlberta || {};
UAlberta.Sitecore = UAlberta.Sitecore || {};

UAlberta.Sitecore.AthleticsGameList = UAlberta.Sitecore.AthleticsGameList || (function () {
    function getInstance() {
        return (function ($) {
            'use strict';

            var Data = {
                    serviceUrl: "", // the url of the games service
                    displayLimit: 8, // the maximum number of games to show

                    // constants
                    Constants: {
                        // program type
                        ProgramType: {
                            Bears: 1,
                            Pandas: 2,
                            Athletics: 3
                        }
                    }
                },

                Utils = {
                    // get the program type name
                    getProgramType: function (programId) {
                        switch(programId) {
                            case Data.Constants.ProgramType.Bears:
                                return "bears";
                                break;
                            case Data.Constants.ProgramType.Pandas:
                                return "pandas";
                                break;
                            default:
                                return "athletics";
                            break;
                        }
                    }
                },

                AJAX = {
                    // get games
                    getGames: function () {
                        // get data
                        $.ajax({
                            dataType: "json",
                            error: AJAX.Events.error,
                            success: AJAX.Events.success,
                            url: Data.serviceUrl + "&limit=" + Data.displayLimit
                        });
                    },

                    Events: {
                        error: function () {
                            Interface.showError();
                        },

                        success: function (data) {
                            Interface.showGames(data);
                        }
                    }
                },

                Interface = {
                    container: [],

                    // setup the interface
                    setup: function (containerId) {
                        // store the list
                        Interface.container = $("#" + containerId);
                    },

                    // show the games
                    showGames: function(games) {
                        // remove loader
                        Interface.container.find("li:first").remove();

                        // save bottom row
                        var bottomRow = Interface.container.html();

                        // if no games, show message
                        if(games.length == 0) {
                            Interface.container.html("<li>There are no games to display.</li>" + bottomRow);
                            return;
                        }
                        Interface.container.html("");

                        for(var i in games) {
                            var game = games[i];

                            // get game markup strings
                            var completedStr = game.Completed ? "played-game" : "upcoming-game";
                            var isHomeGame = game.HomeTeam.IsUAlberta;
                            var teamStr = Utils.getProgramType(isHomeGame ? game.HomeTeam.Program.ID : game.AwayTeam.Program.ID);
                            var teamString = (isHomeGame ? (game.HomeTeam.Name == null ? "" : (game.HomeTeam.Name + " ")) : (game.AwayTeam.Name == null ? "" : (game.AwayTeam.Name + " ")));
                            var opponentString = game.IsEvent ? game.EventName : (isHomeGame ? "vs " + game.AwayTeam.Name : "@ " + game.HomeTeam.Name);
                            var isHomeWin = game.Completed ? game.HomeScore > game.AwayScore : false;
                            var isTie = game.Completed && game.HomeScore == game.AwayScore;
                            var isUAlbertaWin = isHomeGame && isHomeWin || !isHomeGame && !isHomeWin;
                            var resultsStr = game.Completed && !game.IsEvent ? ("<span class='WL'>" + (isHomeWin ? game.HomeScore : game.AwayScore) + " - " + (isHomeWin ? game.AwayScore : game.HomeScore) + "<span>" + (isTie ? "T" : (isUAlbertaWin ? (game.Overtime ? "OTW" : "W") : (game.Overtime ? "OTL" : "L"))) + "</span></span>") : UAlberta.Sitecore.Utilities.GetDateFromJson(game.Start, UAlberta.Sitecore.Utilities.DateFormat.LongNoYear);

                            // get link strings
                            var gameUrl = game.GameUrl != null ? game.GameUrl : "#";
                            var teamUrl = game.TeamUrl != null ? game.TeamUrl : "#";
                            var recapUrl = game.RecapUrl != null ? " | <a href='" + game.RecapUrl + "'>Recap</a>" : "";

                            var gameHtml =
                                "<li class='schedule-module " + completedStr + " " + teamStr + "'>" +
                                    "<h5 class='schedule-title'>" +
                                        "<a href='" + gameUrl + "'>" + resultsStr + "</a>" +
                                        (game.Completed ? "<span class='schedule-links'>" + recapUrl + " | <a href='" + gameUrl + "'>Boxscore</a></span>" : "") +
                                    "</h5>" +
                                    "<span class='schedule-teams'><a href='" + teamUrl + "'>" + teamString + game.HomeTeam.Sport.Description + "</a> " + opponentString + "</span>" +
                                "</li>";
                            Interface.container.append(gameHtml);
                        }

                        // add back on bottom row
                        Interface.container.append(bottomRow);
                    },

                    // show an error
                    showError: function () {
                        // remove loader
                        Interface.container.find("li:first").remove();

                        // save bottom row
                        var bottomRow = Interface.container.html();

                        // set error
                        Interface.container.html("<li>An error occurred while loading the games. Please refresh the page to try again.</li>" + bottomRow);
                    }
                }
            ;

            // instance initialization
            function init(containerId, serviceUrl, displayLimit) {
                Data.serviceUrl = serviceUrl;
                Data.displayLimit = displayLimit;

                Interface.setup(containerId);
                AJAX.getGames();
            }

            return {
                Initialize: init
            };
        } (jQuery));
    }

    return {
        GetInstance: getInstance
    };
} ());
;
/**
* UAlberta Athletics Game Slider
* Author: Kyle Schmidt - kyle.schmidt@ualberta.ca
*/

// build namespace
var UAlberta = UAlberta || {};
UAlberta.Sitecore = UAlberta.Sitecore || {};

UAlberta.Sitecore.AthleticsGameSlider = UAlberta.Sitecore.AthleticsGameSlider || (function () {
    function getInstance() {
        return (function ($) {
            'use strict';

            var Data = {
                    serviceUrl: "", // the url of the games service
                    games: [], // the list of games that have been loaded
                    currentDisplay: 0, // the current number of games to display on each slide

                    // constants
                    Constants: {
                        // display type
                        DisplaySize: {
                            Small: 2,
                            Medium: 4,
                            Large: 6
                        },

                        // program type
                        ProgramType: {
                            Bears: 1,
                            Pandas: 2,
                            Athletics: 3
                        }
                    }
                },

                Utils = {
                    // get the current display type
                    getDisplayType: function () {
                        var displayType;

                        switch(UAlberta.Sitecore.Utilities.GetWindowType()) {
                            case UAlberta.Sitecore.Utilities.WindowType.Small:
                            case UAlberta.Sitecore.Utilities.WindowType.Mobile:
                                displayType = Data.Constants.DisplaySize.Small;
                                break;
                            case UAlberta.Sitecore.Utilities.WindowType.Tablet:
                                displayType = Data.Constants.DisplaySize.Medium;
                                break;
                            default:
                                displayType = Data.Constants.DisplaySize.Large;
                                break;
                        }

                        return displayType;
                    },

                    // get the program type name
                    getProgramType: function (programId) {
                        switch(programId) {
                            case Data.Constants.ProgramType.Bears:
                                return "bears";
                                break;
                            case Data.Constants.ProgramType.Pandas:
                                return "pandas";
                                break;
                            default:
                                return "athletics";
                            break;
                        }
                    }
                },

                AJAX = {
                    loadingData: false,

                    // get games
                    getGames: function (afterGameId) {
                        if(AJAX.loadingData) {
                            return;
                        }
                        AJAX.loadingData = true;

                        // get extra url params
                        var extra = "";
                        if(afterGameId != undefined) {
                            extra += "&aftergame=" + encodeURIComponent(afterGameId);
                        }

                        // get data
                        $.ajax({
                            dataType: "json",
                            error: AJAX.Events.error,
                            success: function (data) {
                                AJAX.Events.success(data, afterGameId > 0);
                            },
                            url: Data.serviceUrl + "&limit=" + Data.currentDisplay + extra
                        });
                    },

                    Events: {
                        error: function () {
                            Interface.showError();
                            AJAX.loadingData = false;
                        },

                        success: function (data, addToEnd) {
                            Interface.addGames(data, addToEnd, false);
                            AJAX.loadingData = false;
                        }
                    }
                },

                Interface = {
                    slider: [],

                    // setup the interface
                    setup: function (containerId) {
                        // get vars
                        Data.currentDisplay = Utils.getDisplayType();

                        // create slider
                        $("#" + containerId).flexslider({
                            animation: "slide",
                            animationLoop: false,
                            controlNav: false,
                            slideshow: false,
                            start: Interface.Events.sliderStart,
                            after: Interface.Events.sliderAfter
                        });

                        // setup resize logic
                        $(window).resize(function() {
                            UAlberta.Sitecore.Utilities.Delay(Interface.Events.resize, 300, containerId + "-resize");
                        });
                    },

                    // add games
                    addGames: function(games, addToEnd, isRefresh) {
                        // if no games, remove the loading slide
                        if(games.length == 0 && !isRefresh) {
                            // remove slider if there are no games to display at all
                            if(Data.games.length == 0) {
                                Interface.slider.remove();
                            }

                            Interface.slider.removeSlide(addToEnd ? Interface.slider.count - 1 : 0);
                            return;
                        }

                        var gamesHtml = [];
                        var gamesList = [];
                        var slideIndex = addToEnd ? Interface.slider.count - 1 : 1;
                        var gameIndex = addToEnd ? Data.games.length : 0;
                        var slideTo = slideIndex - 1;
                        var firstLoad = Data.games.length == 0;
                        for(var i in games) {
                            var game = games[i];

                            // get game markup strings
                            var completedStr = game.Completed ? "played-game" : "upcoming-game";
                            var isHomeGame = game.HomeTeam.IsUAlberta;
                            var teamStr = Utils.getProgramType(isHomeGame ? game.HomeTeam.Program.Id : game.AwayTeam.Program.Id);
                            var opponentString = game.IsEvent ? game.EventName : (isHomeGame ? "vs " + game.AwayTeam.Name : "@ " + game.HomeTeam.Name);
                            var isHomeWin = game.Completed ? game.HomeScore > game.AwayScore : false;
                            var isTie = game.Completed && game.HomeScore == game.AwayScore;
                            var isUAlbertaWin = isHomeGame && isHomeWin || !isHomeGame && !isHomeWin;
                            var resultsStr = game.Completed && !game.IsEvent ? ((isHomeWin ? game.HomeScore : game.AwayScore) + " - " + (isHomeWin ? game.AwayScore : game.HomeScore) + " " + (isTie ? "T" : (isUAlbertaWin ? (game.Overtime ? "OTW" : "W") : (game.Overtime ? "OTL" : "L")))) : UAlberta.Sitecore.Utilities.GetDateFromJson(game.Start, UAlberta.Sitecore.Utilities.DateFormat.ShortNoYear);
                            var iconStr = game.HomeTeam.Sport.Description.toLowerCase().replace(/\s/g, "-");

                            // get link strings
                            var gameUrl = game.GameUrl != null ? game.GameUrl : "#";
                            var teamUrl = game.TeamUrl != null ? game.TeamUrl : "#";
                            var newsUrl = game.RecapUrl != null && game.Completed ? "<a href='" + game.RecapUrl + "'>Recap</a> | " : (game.PreviewUrl != null ? "<a href='" + game.PreviewUrl + "'>Preview</a> | " : "");

                            var gameHtml =
                                "<div class='extrude score-module " + completedStr + " " + teamStr + "' data-id='" + game.Id + "'>" +
                                    "<h5 class='score-title'>" +
                                        "<a href='" + teamUrl + "'><i class='icon-" + iconStr + "'></i> " + game.HomeTeam.Sport.Description + "</a>" +
                                        "<span class='score-hover-links'>" + newsUrl + "<a href='" + gameUrl + "'>Game Info</a></span>" +
                                    "</h5>" +
                                    "<span class='score-opponent'>" + opponentString + "</span>" +
                                    "<div class='score-results'>" +
                                        "<a href='" + gameUrl + "'><h3>" + resultsStr + "</h3></a>" +
                                    "</div>" +
                                "</div>";
                            gamesHtml.push(gameHtml);
                            gamesList.push(game);

                            if(gamesHtml.length == Data.currentDisplay || i == games.length - 1) {
                                Interface.slider.addSlide("<li>" + gamesHtml.join("") + "</li>", slideIndex);
                                gamesHtml.length = 0;
                                slideIndex++;
                                if(!addToEnd) {
                                    slideTo++;
                                }

                                if(!isRefresh) {
                                    for(var j in gamesList) {
                                        Data.games.splice(gameIndex, 0, gamesList[j]);
                                        gameIndex++;
                                    }
                                    gamesList.length = 0;
                                }
                            }
                        }

                        if(Interface.slider.vars != undefined) {
                            var previousAnimationSpeed = Interface.slider.vars.animationSpeed;
                            Interface.slider.vars.animationSpeed = 0;
                            Interface.slider.flexAnimate(firstLoad ? 1 : Interface.slider.currentSlide > 0 ? slideTo + 1 : slideTo);
                            Interface.slider.vars.animationSpeed = previousAnimationSpeed;
                        } else {
                            Interface.slider.flexAnimate(firstLoad ? 1 : slideTo);
                        }
                    },

                    // show an error
                    showError: function () {
                        Interface.slider.html("An error occurred while loading the games. Please refresh the page to try again.");
                    },

                    Events: {
                        // slider event for when the first slide is shown
                        sliderStart: function (slider) {
                            // save slider
                            Interface.slider = slider;

                            // get initial games
                            AJAX.getGames();
                        },

                        // slider event after a slide has slid
                        sliderAfter: function (slider) {
                            // check for need to load previous games
                            if(slider.animatingTo == 0 && slider.slides.first().hasClass("loading")) {
                                AJAX.getGames(Data.games[0].Id * -1);
                            }

                            // check for need to load next games
                            if(slider.animatingTo == slider.count - 1 && slider.slides.last().hasClass("loading")) {
                                AJAX.getGames(Data.games[Data.games.length - 1].Id);
                            }
                        },

                        // window/viewport was resized
                        resize: function () {
                            // check for new display type
                            var displayType = Utils.getDisplayType();
                            if(displayType != Data.currentDisplay) {
                                Data.currentDisplay = displayType;

                                // store current first game visible
                                var currentGame = $(Interface.slider.slides[Interface.slider.currentSlide]).find(".score-module:first").data("id");

                                // ensure "loading" slides are in place (this prevents a bug)
                                if(!Interface.slider.slides.first().hasClass("loading")) {
                                    Interface.slider.addSlide("<li class='loading'></li>", 0);
                                }
                                if(!Interface.slider.slides.last().hasClass("loading")) {
                                    Interface.slider.addSlide("<li class='loading'></li>");
                                }

                                // remove all game slides, then re-add them
                                for(var i = Interface.slider.count - 1; i >= 0; i--) {
                                    if(!$(Interface.slider.slides[i]).hasClass("loading")) {
                                        Interface.slider.removeSlide(i);
                                    }
                                }
                                Interface.addGames(Data.games, false, true);

                                // move to slide that has the current game
                                Interface.slider.flexAnimate(Interface.slider.slides.find("[data-id=" + currentGame + "]").parent().index());
                            }
                        }
                    }
                }
            ;

            // instance initialization
            function init(containerId, serviceUrl) {
                Data.serviceUrl = serviceUrl;
                Interface.setup(containerId);
            }

            return {
                Initialize: init
            };
        } (jQuery));
    }

    return {
        GetInstance: getInstance
    };
} ());
;
/**
* UAlberta Athletics Roster
* Author: Kyle Schmidt - kyle.schmidt@ualberta.ca
*/

// build namespace
var UAlberta = UAlberta || {};
UAlberta.Sitecore = UAlberta.Sitecore || {};

UAlberta.Sitecore.AthleticsRoster = UAlberta.Sitecore.AthleticsRoster || (function () {
    function getInstance() {
        return (function ($) {
            'use strict';

            var Data = {
                    serviceUrl: ""
                },

                AJAX = {
                    // get person
                    getPerson: function (element, id) {
                        $.ajax({
                            dataType: "json",
                            error: function () {
                                AJAX.Events.error(element);
                            },
                            success: function (data) {
                                AJAX.Events.success(element, data);
                            },
                            url: Data.serviceUrl.replace("{id}", encodeURIComponent(id))
                        });
                    },

                    Events: {
                        error: function (element) {
                            Interface.showError(element);
                        },

                        success: function (element, person) {
                            Interface.showPerson(element, person);
                        }
                    }
                },

                Interface = {
                    historyCount: 0,

                    // setup the interface
                    setup: function (containerId) {
                        // set all name links to open the bio container and get the person
                        $("#" + containerId).find("li[data-id]").not("li[data-id$='-bio']").click(function() {
                            var bioItem = $(this).next();
                            $(".roster li[data-id$='-bio']").not(bioItem).addClass("hidden");
                            if(bioItem.hasClass("loading")) {
                                AJAX.getPerson($(this), $(this).data("id"));
                            }
                            bioItem.toggleClass("hidden");
                            window.location.hash = bioItem.hasClass("hidden") ? "" : $(this).attr("id");
                        });

                        // open preset person
                        setTimeout(function() {
                            Interface.expandPerson(containerId);
                        }, 100);

                        // hash change event
                        $(window).hashchange(function () {
                            Interface.expandPerson(containerId);
                        });
                    },

                    // expand person
                    expandPerson: function (containerId) {
                        // check hash
                        var hash = window.location.hash.replace("#", "");
                        if(hash == "") {
                            // hide all bios
                            $(".roster li[data-id$='-bio']").addClass("hidden");
                        } else {
                            // check if the hash item is hidden
                            if($("#" + containerId).find("#" + hash).next().hasClass("hidden")) {
                                // simulate click on the hash item
                                $("#" + containerId).find("#" + hash).click();
                            }
                        }
                    },

                    // show the person
                    showPerson: function (element, person) {
                        var bioItem = element.next();
                        bioItem.toggleClass("loading");

                        var html = "";

                        // image
                        if(person.HasPhoto) {
                            html += "<img src='" + Data.serviceUrl.replace("{id}", encodeURIComponent(person.Id)) + "/image" + "' alt='" + person.FirstName + " " + person.LastName + "'/>";
                        }

                        // fields
                        html += "<ul class='roster-item'>";
                        html += Interface.addField("Position", person.Position);
                        html += Interface.addField("Height", person.Height);
                        html += Interface.addField("Eligibility", person.Eligibility);
                        html += Interface.addField("Faculty", person.Faculty);
                        html += Interface.addField("Hometown", person.Hometown);
                        html += Interface.addField("Last Team", person.PreviousTeam);
                        html += Interface.addField("Experience", person.Years, " year(s)");
                        html += Interface.addField("Twitter", person.Twitter != undefined && person.Twitter != "" ? "<a href='http://twitter.com/" + person.Twitter + "' target='_blank'>@" + person.Twitter + "</a>" : person.Twitter);
                        html += Interface.addField("EMail", person.Email != undefined && person.Email != "" ? "<a href='mailto:" + person.Email + "'>" + person.Email + "</a>" : person.Email);

                        // add adopt url
                        if(person.AdoptUrl != undefined && person.AdoptUrl != "") {
                            html += "<li><a class='btn btn-micro btn-green' href='" + person.AdoptUrl + "' target='_blank'>Adopt This Athlete</a></li>";
                        }

                        html += "</ul>";

                        // bio
                        html += "<div>" + person.Bio + "</div>";

                        bioItem.html(html);
                    },

                    // add field
                    addField: function (label, value, extra) {
                        if(extra == undefined) {
                            extra = "";
                        }
                        if(value != undefined && value != "") {
                            return "<li><span>" + label + ":</span> " + value + extra + "</li>";
                        }
                        return "";
                    },

                    // show an error
                    showError: function (element) {
                        var bioItem = element.next();
                        bioItem.toggleClass("loading");
                        bioItem.html("An error occurred while obtaining the person. Please refresh the page and try again.");
                    }
                }
            ;

            // instance initialization
            function init(containerId, serviceUrl) {
                Data.serviceUrl = serviceUrl;
                Interface.setup(containerId);
            }

            return {
                Initialize: init
            };
        } (jQuery));
    }

    return {
        GetInstance: getInstance
    };
} ());
;
/**
* UAlberta Athletics Schedule
* Author: Kyle Schmidt - kyle.schmidt@ualberta.ca
*/

// build namespace
var UAlberta = UAlberta || {};
UAlberta.Sitecore = UAlberta.Sitecore || {};

UAlberta.Sitecore.AthleticsSchedule = UAlberta.Sitecore.AthleticsSchedule || (function () {

    function getInstance() {
        return (function ($) {
            'use strict';

            var Data = {
                teams: [], // teams
                teamItems: [], // team items
                currentDate: "", // the current date
                games: [], // games
                teamId: [], // team to show schedule for

                // Constant values
                Constants: {
                    // Calendar types
                    CalendarTypes: {
                        Day: "day",
                        Month: "month"
                    },

                    // Date postfix
                    DatePostfix: "T00:00:00.000-00:00",

                    // Games per page
                    GamesPerPage: 10
                }
            },
                Utils = {
                    // Left pad a string using the specified string up to the desired length
                    padLeft: function (theString, padString, length) {
                        return theString.toString().length < length ? Utils.padLeft(padString + theString, padString, length) : theString;
                    },

                    // Get the value of a multilist widget
                    getMultilistValue: function (obj) {
                        return obj.multiselect("getSelected").val() || [];
                    },

                    // Set the value of a multilist widget
                    setMultilistValue: function (obj, value) {
                        obj.val(value);
                        obj.multiselect("refresh");
                    },

                    // Get the value of a datepicker widget
                    getDatepickerValue: function (obj) {
                        return obj.data("datepicker").getFormattedDate();
                    },

                    // Check if a date is before another date
                    isDateBefore: function (value, checkDate) {
                        var date = Date.parse(value.substr(0, 10)),
                            beforeDate = Date.parse(checkDate.substr(0, 10));

                        if (isNaN(date)) {
                            date = Date.parse($.format.date(value.substr(0, 10) + Data.Constants.DatePostfix, UAlberta.Sitecore.Utilities.DateFormat.Short));
                            beforeDate = Date.parse($.format.date(checkDate.substr(0, 10) + Data.Constants.DatePostfix, UAlberta.Sitecore.Utilities.DateFormat.Short));
                        }

                        if (isNaN(date) || isNaN(beforeDate)) {
                            return false;
                        }

                        return date <= beforeDate;
                    }
                },
                AJAX = {
                    currentRequest: undefined, // the current AJAX xhr item

                    // get games from server or cache if already pulled
                    getGames: function (dateType, date) {
                        // check if a request is already in progress
                        if (AJAX.currentRequest != undefined) {
                            // abort request and reset var
                            AJAX.currentRequest.abort();
                        }

                        // check if params not passed in
                        dateType = dateType !== undefined ? dateType : Utils.getMultilistValue(Interface.calendarTypeControl);
                        date = date !== undefined ? date : (dateType == Data.Constants.CalendarTypes.Month ? (Interface.monthVisible + "-01") : Utils.getDatepickerValue(Interface.calendarControl));

                        // get month and year from date
                        var monthString = date.substr(0, 7);

                        // show date string
                        Interface.showDateText(dateType, date);

                        // clear game list control and paging control
                        Interface.gameListControl.html("");
                        Interface.gamePagingControl.html("");

                        // show loading spinner
                        Interface.showLoading();

                        // check if games are already saved
                        var request = { Month: monthString };
                        if (Data.games[monthString] == undefined) {
                            // get extra service url string
                            var serviceUrlExtra = "";
                            if (Data.teamId.length > 1) {
                                serviceUrlExtra = "Program/" + Data.teamId[0] + "/Sport/" + Data.teamId[1] + "/";
                            }

                            // get games for month from service
                            AJAX.currentRequest = $.ajax({
                                cache: false,
                                contentType: "application/json; charset=utf-8",
                                data: $.toJSON(request),
                                dataType: "json",
                                error: AJAX.Events.error,
                                success: function (data) {
                                    AJAX.Events.success(monthString, data);
                                },
                                type: "POST",
                                url: "/api/athletics/" + serviceUrlExtra + "games.json"
                            });
                        } else {
                            // get games from array
                            Interface.showGames(Data.games[monthString]);
                        }
                    },

                    Events: {
                        error: function () {
                            Interface.gameListControl.html("<li><p>An error occurred while obtaining game/event information. Please refresh the page and try again.</p></li>");
                            AJAX.currentRequest = undefined;
                        },

                        success: function (monthString, data) {
                            Data.games[monthString] = data;
                            Interface.showGames(data);
                            AJAX.currentRequest = undefined;
                        }
                    }
                },
                Interface = {
                    containerId: "",          // id of the container of the schedule
                    calendarControl: [],      // calendar control
                    calendarTypeControl: [],  // calendar type control
                    teamListControl: [],      // team list control
                    dateTextControl: [],      // selected date text control
                    gameListControl: [],     // game list control
                    gamePagingControl: [],   // game paging control
                    monthVisible: "",         // the month visible in the calendar control,
                    gamesVisible: [],        // the games that can be seen (based on filters), used for paging
                    loadingSelector: "",      // the selector for the loading spinner

                    // setup the interface
                    setup: function (containerId) {
                        // get interface components
                        Interface.containerId = containerId;
                        Interface.calendarControl = $("#" + Interface.containerId + " .event-list-calendar-filter");
                        Interface.calendarTypeControl = $("#" + Interface.containerId + " .filter-day select");
                        Interface.teamListControl = $("#" + Interface.containerId + " .calendar-event select");
                        Interface.dateTextControl = $("#" + containerId + " .latest-news .filtered-by");
                        Interface.gameListControl = $("#" + containerId + " .event-list");
                        Interface.gamePagingControl = $("#" + containerId + " .events-pagination");
                        Interface.loadingSelector = "#" + containerId + " .events-loading";

                        // set default values
                        Interface.calendarTypeControl.val(Data.Constants.CalendarTypes.Month);
                        if (window.location.hash != "") {
                            Interface.teamListControl.val(window.location.hash.replace("#", "").split(";"));
                        }

                        // create widgets
                        Interface.calendarControl.datepicker({
                            format: "yyyy-mm-dd",
                            todayHighlight: true
                        }).on("changeMonth", Interface.Events.monthChanged).on("changeDate", Interface.Events.dateSelected);
                        Interface.calendarTypeControl.multiselect({
                            onChange: Interface.Events.calendarTypeChanged
                        });
                        Interface.teamListControl.multiselect({
                            buttonText: UAlberta.Sitecore.Utilities.MultiselectButtonText,
                            onChange: function (element) {
                                window.location.hash = Utils.getMultilistValue(Interface.teamListControl).join(";");
                                Interface.Events.filterListChanged();
                            }
                        });

                        // hash change event
                        $(window).hashchange(function () {
                            Utils.setMultilistValue(Interface.teamListControl, window.location.hash.replace("#", "").split(";"));
                            AJAX.getGames();
                        });

                        // set stored values
                        Interface.monthVisible = Utils.getDatepickerValue(Interface.calendarControl).substr(0, 7);
                    },

                    // show date text
                    showDateText: function (dateType, date) {
                        var html = "| ";

                        switch (dateType) {
                            case Data.Constants.CalendarTypes.Day:
                                html += $.format.date(date + " ", "ddd, MMMM d, yyyy");
                                break;
                            case Data.Constants.CalendarTypes.Month:
                                html += $.format.date(date + " ", "MMMM, yyyy");
                                break;
                        }

                        Interface.dateTextControl.html(html);
                    },

                    // show games on page
                    showGames: function (gameList) {
                        // empty the viewable games list
                        Interface.gamesVisible.length = 0;

                        // process games
                        for (var i in gameList) {
                            var game = gameList[i];
                            // HACK: Ensure we are only processing actual games
                            if (game.Id == undefined) {
                                continue;
                            }

                            // fix game start date
                            game.StartDate = UAlberta.Sitecore.Utilities.GetDateFromJson(game.Start, UAlberta.Sitecore.Utilities.DateFormat.ShortNoYear);
                            game.StartTime = UAlberta.Sitecore.Utilities.GetDateFromJson(game.Start, UAlberta.Sitecore.Utilities.DateFormat.TimeOnly);
                            game.StartUnix = UAlberta.Sitecore.Utilities.GetDateFromJson(game.Start, UAlberta.Sitecore.Utilities.DateFormat.UnixDateOnly);

                            // check filters
                            if (!Interface.checkFilters(game)) {
                                continue;
                            }

                            // add game to viewable list
                            Interface.gamesVisible.push(game);
                        }

                        // display first page of games
                        Interface.showPage(1);
                    },

                    // show paging links
                    showPaging: function (page) {
                        // clear pages
                        Interface.gamePagingControl.html("");

                        // check for empty list
                        if (Interface.gamesVisible.length == 0) {
                            return;
                        }

                        // add pages
                        var activePage = parseInt(page);
                        var maxPage = Math.ceil(Interface.gamesVisible.length / 10);
                        for (var i = 1; i <= maxPage; i++) {
                            // check for active page
                            if (i == activePage) {
                                Interface.gamePagingControl.append('<li class="active">' + i + '</li>');
                            } else {
                                Interface.gamePagingControl.append('<li><a href="javascript:void(null)">' + i + '</a></li>');
                            }
                        }

                        // add click handler
                        Interface.gamePagingControl.find("a").click(Interface.Events.pageClicked);
                    },

                    // show selected page of games
                    showPage: function (page) {
                        // clear games
                        Interface.gameListControl.html("");

                        // check for empty list
                        if (Interface.gamesVisible.length == 0) {
                            // display "no games" message
                            Interface.gameListControl.html('<li><h4>No Games/Events Found</h4></li>');
                            return;
                        }

                        // show games on selected page
                        for (var i = (parseInt(page) - 1) * Data.Constants.GamesPerPage; i < Data.Constants.GamesPerPage * page; i++) {
                            var game = Interface.gamesVisible[i];

                            // ensure game is valid
                            if (game == undefined) {
                                continue;
                            }

                            // create html components
                            var isHomeGame = game.HomeTeam.IsUAlberta;
                            var teamString = (isHomeGame ? (game.HomeTeam.Name == null ? "" : (game.HomeTeam.Name + " ")) : (game.AwayTeam.Name == null ? "" : (game.AwayTeam.Name + " ")));
                            var isHomeWin = game.Completed ? game.HomeScore > game.AwayScore : false;
                            var isTie = game.Completed && game.HomeScore == game.AwayScore;
                            var isUAlbertaWin = isHomeGame && isHomeWin || !isHomeGame && !isHomeWin;
                            var gameTitle = teamString + game.HomeTeam.Sport.Description + (game.IsEvent ? ": " + game.EventName : (isHomeGame ? " vs " + game.AwayTeam.Name : " @ " + game.HomeTeam.Name));
                            var dateHtml = game.StartDate + (game.StartTime == "12:00 AM" ? "" : " " + game.StartTime);
                            var resultsStr = game.Completed && !game.IsEvent ? ((isHomeWin ? game.HomeScore : game.AwayScore) + " - " + (isHomeWin ? game.AwayScore : game.HomeScore) + "<span>" + (isTie ? "T" : (isUAlbertaWin ? (game.Overtime ? "OTW" : "W") : (game.Overtime ? "OTL" : "L"))) + "</span>") : "";

                            // create game html
                            var html = '<li>' +
                                '<a href="' + game.GameUrl + '">' +
                                '<div class="list-item-content">' +
                                '<h4>' + gameTitle + '</h4>' +
                                '<p class="list-item-extra">' + dateHtml + '</p>' +
                                (resultsStr != '' ? '<p class="list-item-extra">' + resultsStr + '</p>' : '') +
                                '</div>' + '</a>' +
                                '</li>';

                            // add game to list
                            Interface.gameListControl.append(html);
                        }

                        // show paging
                        Interface.showPaging(page);
                    },

                    // check to see if an game is part of filters
                    checkFilters: function (game) {
                        // check dates based on calendar type
                        switch (Utils.getMultilistValue(Interface.calendarTypeControl)) {
                            // check if the date selected is on the game date
                            case Data.Constants.CalendarTypes.Day:
                                if (Utils.getDatepickerValue(Interface.calendarControl) != game.StartUnix) {
                                    return false;
                                }
                                break;
                                // month is skipped as we are pulling games based on the month, so show all for month type
                            case Data.Constants.CalendarTypes.Month:
                                break;
                        }

                        // check selected teams (none selected = select all)
                        var selectedTeams = Utils.getMultilistValue(Interface.teamListControl);
                        if (selectedTeams.length > 0 && $.inArray(game.HomeTeam.Program.Id + "-" + game.HomeTeam.Sport.Id, selectedTeams) < 0) {
                            return false;
                        }

                        return true;
                    },

                    // show the loading spinner
                    showLoading: function () {
                        // check if the spinner is already shown
                        if ($(Interface.loadingSelector).length == 0) {
                            Interface.gameListControl.append('<li class="loading"></li>');
                        }
                    },

                    Events: {
                        monthChanged: function (event) {
                            // set calendar type to month
                            Utils.setMultilistValue(Interface.calendarTypeControl, Data.Constants.CalendarTypes.Month);

                            // store visible month
                            Interface.monthVisible = event.date.getUTCFullYear() + "-" + Utils.padLeft(event.date.getUTCMonth() + 1, "0", 2);

                            AJAX.getGames(Data.Constants.CalendarTypes.Month, Interface.monthVisible + "-01");
                        },

                        dateSelected: function (event) {
                            // set calendar type to day
                            Utils.setMultilistValue(Interface.calendarTypeControl, Data.Constants.CalendarTypes.Day);

                            var date = event.date.getUTCFullYear() + "-" + Utils.padLeft(event.date.getUTCMonth() + 1, "0", 2) + "-" + Utils.padLeft(event.date.getUTCDate(), "0", 2);
                            AJAX.getGames(Data.Constants.CalendarTypes.Day, date);
                        },

                        calendarTypeChanged: function (option) {
                            AJAX.getGames();
                        },

                        filterListChanged: function () {
                            AJAX.getGames();
                        },

                        pageClicked: function () {
                            // show clicked page
                            Interface.showPage($(this).html());
                        }
                    }
                };

            // instance initialization

            function init(containerId, teamId) {
                Interface.setup(containerId);
                Data.teamId = teamId.split("-");

                // initialize data objects
                Data.teams = Interface.teamListControl.children().map(function () { return this.value; }).get();
                Interface.teamListControl.children().each(function () { Data.teamItems[this.value] = this.text; });
                Data.currentDate = Utils.getDatepickerValue(Interface.calendarControl);

                // get games
                AJAX.getGames(Utils.getMultilistValue(Interface.calendarTypeControl), Data.currentDate);
            }

            return {
                Initialize: init
            };
        }(jQuery));
    }

    return {
        GetInstance: getInstance
    };
}());;
/**
 * UAlberta Data List
 */

// build namespace
var UAlberta = UAlberta || {};
UAlberta.Sitecore = UAlberta.Sitecore || {};

UAlberta.Sitecore.DataList = function($) {
    
    var _options = 
        {
            ContainerId: '',
            ServiceUrl : '',
            CssClassPrefix : 'data',
            ShowDate: true,
            ShowDescription: true,
            ItemsPerPage: 20
        },
        _cookieValue = '',
        _currentPage = '';

    function init(options) {
        $.extend(_options, options);
        _cookieValue = $.cookie('data-list-current-page');
        _currentPage = (_cookieValue == '' || _cookieValue == null) ? 1 : _cookieValue;
        
        select();
    }
    
    function select() {
        $.ajax({
            type: 'GET',
            dataType: 'json',
            url: _options.ServiceUrl,
            timeout: 30000,
            success: ajaxSuccess,
            error: ajaxError
        });
    }
    
    function ajaxSuccess(data) {
        if (data.length > 0) {
            for (var e = 0; e < data.length; e++) {
                var className = '.' + _options.CssClassPrefix + '-module';
                $(className).toggleClass('loading');

                var item = data[e];

                // First, create the list element
                var listElement = document.createElement('li');
                
                // If the item has a link, wrap the title in it
                var titleHeading = document.createElement('h4');

                // If the title is longer than X characters, truncate it and add an ellipsis
                var maxTitleLength = 30;
                var truncatedTitle;

                var title = item.Title.length > maxTitleLength, str = title ? item.Title.substr(0, maxTitleLength - 1) : item.Title;
                str = title ? str.substr(0, str.lastIndexOf(' ')) : str;
                truncatedTitle = title ? str + '...' : str;

                if (item.Link != '') {
                    var link = document.createElement('a');
                    link.href = item.Link;
                    link.innerHTML = truncatedTitle;

                    titleHeading.appendChild(link);
                }
                else {
                    titleHeading.innerHTML = truncatedTitle;
                }

                listElement.appendChild(titleHeading);

                // If a publication date is available and configured to
                // display, add it now.
                var dateString = item.Date.match(/\d+/);

                if (dateString != '' && _options.ShowDate) {
                    var dateParagraph = document.createElement('p');
                    dateParagraph.className = 'date';

                    var dateInt = parseInt(dateString[0]);
                    var d = new Date(dateInt);

                    dateParagraph.innerHTML = d.toLocaleDateString();
                    listElement.appendChild(dateParagraph);
                }

                // If a description is availalble and configured to 
                // display, add it
                if (item.Description != '' && _options.ShowDescription) {
                    var descDiv = document.createElement('p');
                    descDiv.className = 'description';
                    descDiv.innerHTML = item.Description;

                    listElement.appendChild(descDiv);
                }

                $(_options.ContainerId).append(listElement);
            }

            // If the list is greater than 15 items, paginate it
            if (data.length > _options.ItemsPerPage) {
                $('.data-list-navigation').jPages({ containerID: 'data-list', minHeight: '', startPage: _currentPage, perPage: _options.ItemsPerPage, first: 'first', previous: 'previous', next: 'next', last: 'last', startRange: 1, midRange: 5, endRange: 1, callback: function (pages, items) { $.cookie('data-list-current-page', pages.current, { expires: 1, path: '/' }); } });
            }
        }
    }
    
    function ajaxError() {
    }

    return {
        Initialize: init
    };

}(jQuery);;
/**
 * UAlberta Event
 * Author: Kyle Schmidt - kyle.schmidt@ualberta.ca
 */

// build namespace
var UAlberta = UAlberta || {};
UAlberta.Sitecore = UAlberta.Sitecore || {};

UAlberta.Sitecore.Event = UAlberta.Sitecore.Event || (function() {
    function getInstance() {
        return (function($) {
            'use strict';

            var Data = {
                    event: {}   // the event
                },
                
                Interface = {
                    // Setup the interface
                    setup: function (containerId) {
                        // set page title
                        $("title").html($("title").html().trim().replace(/^Event/, Data.event.Title));
                        $("ul.breadcrumbs > li.bc-here").html(Data.event.Title);
                        $("h1.page-title").html(Data.event.Title);

						// add click event to link
                        $("#" + containerId + " .event-map-link").click(Interface.Events.mapLinkClicked);
                    },

					Events: {
						mapLinkClicked: function() {
							var event = Data.event;
						    
                            // ensure an event was actually added
						    if(event.Title == undefined) {
                                alert("No event was specified to be viewed on Campus Maps.\n\nPlease refresh the page and try again.")
						        return;
						    }
							
							// ensure hidden container exists
							if($("#hiddenFormContainer").length == 0) {
								$("body").append('<div id="hiddenFormContainer"></div>');
							}
							
							// add form to container and submit
							$("#hiddenFormContainer")
								.html("")
								.append($("<form>")
									.attr({
										method: "POST",
										action: "http://www.campusmap.ualberta.ca",
										id: "hidForm",
										target: "_blank"
									})
									.append($("<input>").attr({
										type: "hidden",
										name: "title",
										value: event.Title
									}))
									.append($("<input>").attr({
										type: "hidden",
										name: "desc",
										value: event.Description
									}))
									.append($("<input>").attr({
										type: "hidden",
										name: "location",
										value: event.Location
									}))
									.append($("<input>").attr({
										type: "hidden",
										name: "time",
										value: event.Date
									}))
									.append($("<input>").attr({
										type: "hidden",
										name: "category",
										value: event.Categories
									}))
									.append($("<input>").attr({
										type: "hidden",
										name: "faculty",
										value: event.Calendars
									}))
									.append($("<input>").attr({
										type: "hidden",
										name: "lat",
										value: event.PositionLat
									}))
									.append($("<input>").attr({
										type: "hidden",
										name: "lng",
										value: event.PositionLng
									}))
									.submit()
								);
						}
					}
                }
            ;

            // instance initialization
            function init(containerId, event) {
                // initialize data objects
                Data.event = event;
                
				// setup interface
                Interface.setup(containerId);
            }

            return {
                Initialize: init
            };
        }(jQuery));
    }

    return {
        GetInstance: getInstance
    };
}());
;
/**
* UAlberta Event List
* Author: Kyle Schmidt - kyle.schmidt@ualberta.ca
*/

// build namespace
var UAlberta = UAlberta || {};
UAlberta.Sitecore = UAlberta.Sitecore || {};

UAlberta.Sitecore.EventList = UAlberta.Sitecore.EventList || (function () {

    function getInstance() {
        return (function ($) {
            'use strict';

            var Data = {
                calendars: [],      // calendars
                calendarItems: [],  // calendar items
                categoryItems: [],  // category items
                currentDate: "",    // the current date
                events: [],         // events

                // Constant values
                Constants: {
                    // Calendar types
                    CalendarTypes: {
                        Current: "current",
                        Day: "day",
                        Month: "month"
                    },

                    // Date formats
                    DateFormats: {
                        Long: "MMM d, yyyy h:mm a",
                        Short: "MMM d, yyyy",
                        TimeOnly: "h:mm a"
                    },

                    // Date postfix
                    DatePostfix: "T00:00:00.000-00:00",

                    // Events per page
                    EventsPerPage: 10
                }
            },
                Utils = {
                    // Left pad a string using the specified string up to the desired length
                    padLeft: function (theString, padString, length) {
                        return theString.toString().length < length ? Utils.padLeft(padString + theString, padString, length) : theString;
                    },

                    // Get the value of a multilist widget
                    getMultilistValue: function (obj) {
                        return obj.multiselect("getSelected").val() || [];
                    },

                    // Set the value of a multilist widget
                    setMultilistValue: function (obj, value) {
                        obj.val(value);
                        obj.multiselect("refresh");
                    },

                    // Get the value of a datepicker widget
                    getDatepickerValue: function (obj) {
                        return obj.data("datepicker").getFormattedDate();
                    },

                    // Check if a date is in a date range
                    isDateInRange: function (value, start, end) {
                        var date = Date.parse(value.substr(0, 10)),
                            startDate = Date.parse(start.substr(0, 10)),
                            endDate = Date.parse(end.substr(0, 10));

                        if (isNaN(date)) {
                            date = Date.parse($.format.date(value.substr(0, 10) + Data.Constants.DatePostfix, Data.Constants.DateFormats.Short));
                            startDate = Date.parse($.format.date(start.substr(0, 10) + Data.Constants.DatePostfix, Data.Constants.DateFormats.Short));
                            endDate = Date.parse($.format.date(end.substr(0, 10) + Data.Constants.DatePostfix, Data.Constants.DateFormats.Short));
                        }

                        if (isNaN(date) || isNaN(startDate) || isNaN(endDate)) {
                            return false;
                        }

                        return ((startDate <= date) && (date <= endDate));
                    },

                    // Check if a date is before another date
                    isDateBefore: function (value, checkDate) {
                        var date = Date.parse(value.substr(0, 10)),
                            beforeDate = Date.parse(checkDate.substr(0, 10));

                        if (isNaN(date)) {
                            date = Date.parse($.format.date(value.substr(0, 10) + Data.Constants.DatePostfix, Data.Constants.DateFormats.Short));
                            beforeDate = Date.parse($.format.date(checkDate.substr(0, 10) + Data.Constants.DatePostfix, Data.Constants.DateFormats.Short));
                        }

                        if (isNaN(date) || isNaN(beforeDate)) {
                            return false;
                        }

                        return date <= beforeDate;
                    },

                    // Format date range as a string
                    formatDateRange: function (start, end) {
                        var format = Data.Constants.DateFormats.Long;

                        // check if only date is specified (all day event)
                        if (start.length == 10) {
                            // use short date format
                            format = Data.Constants.DateFormats.Short;

                            // make dates proper timestamps
                            start += Data.Constants.DatePostfix;
                            end += Data.Constants.DatePostfix;

                            // check if only one day (return the date if so)
                            if (start == end) {
                                return $.format.date(start, format);
                            }
                        }

                        // get formatted dates
                        var startFormatted = $.format.date(start, format);
                        var endFormatted = $.format.date(end, start.substr(0, 10) != end.substr(0, 10) ? format : Data.Constants.DateFormats.TimeOnly);

                        return startFormatted + " - " + endFormatted;
                    },

                    // Get array intersection
                    arrayIntersect: function (arr1, arr2) {
                        return $.map(arr1, function (val) { return $.inArray(val, arr2) < 0 ? null : val; });
                    },

                    // Add a click handler to items if one does not already exist
                    addClickHandler: function (items, handler) {
                        if (items.data("events") == undefined || items.data("events").click == undefined) {
                            items.click(handler);
                        }
                    }
                },
                AJAX = {
                    currentRequest: undefined, // the current AJAX xhr item

                    // get events from server or cache if already pulled
                    getEvents: function (dateType, date) {
                        // check if a request is already in progress
                        if (AJAX.currentRequest != undefined) {
                            // abort request and reset var
                            AJAX.currentRequest.abort();
                        }

                        // check if params not passed in
                        dateType = dateType !== undefined ? dateType : Utils.getMultilistValue(Interface.calendarTypeControl);
                        date = date !== undefined ? date : (dateType == Data.Constants.CalendarTypes.Month ? (Interface.monthVisible + "-01") : Utils.getDatepickerValue(Interface.calendarControl));

                        // get month and year from date
                        var monthString = date.substr(0, 7);

                        // show date string
                        Interface.showDateText(dateType, date);

                        // clear event list control and paging control
                        Interface.eventListControl.html("");
                        Interface.eventPagingControl.html("");

                        // show loading spinner
                        Interface.showLoading();

                        // check if events are already saved
                        var request = { Calendars: Data.calendars, Month: monthString };
                        if (Data.events[monthString] == undefined) {
                            // get events for month from service
                            AJAX.currentRequest = $.ajax({
                                cache: false,
                                contentType: "application/json; charset=utf-8",
                                data: $.toJSON(request),
                                dataType: "json",
                                error: AJAX.Events.error,
                                success: function (data) {
                                    AJAX.Events.success(monthString, data);
                                },
                                type: "POST",
                                url: "/api/events/eventlist.json"
                            });
                        } else {
                            // get events from array
                            Interface.showEvents(Data.events[monthString]);
                        }
                    },

                    Events: {
                        error: function () {
                            Interface.eventListControl.html("<li><p>An error occurred while obtaining event information. Please refresh the page and try again.</p></li>");
                            AJAX.currentRequest = undefined;
                        },

                        success: function (monthString, data) {
                            Data.events[monthString] = data;
                            Interface.showEvents(data);
                            AJAX.currentRequest = undefined;
                        }
                    }
                },
                Interface = {
                    containerId: "",          // id of the container of the event list
                    isCondensedView: false,   // condensed view or not
                    hideCategories: false,    // hide categories or not
                    eventsPath: "",           // the path of the events page
                    calendarControl: [],      // calendar control
                    calendarTypeControl: [],  // calendar type control
                    calendarListControl: [],  // calendar list control
                    categoryListControl: [],  // category list control
                    dateTextControl: [],      // selected date text control
                    eventListControl: [],     // event list control
                    eventPagingControl: [],   // event paging control
                    monthVisible: "",         // the month visible in the calendar control,
                    eventsVisible: [],        // the events that can be seen (based on filters), used for paging
                    loadingSelector: "",      // the selector for the loading spinner

                    // setup the interface
                    setup: function (containerId, isCondensedView, hideCategories, eventsPath) {
                        // get interface components
                        Interface.containerId = containerId;
                        Interface.isCondensedView = isCondensedView;
                        Interface.hideCategories = hideCategories;
                        Interface.eventsPath = eventsPath;
                        Interface.calendarControl = $("#" + Interface.containerId + " .event-list-calendar-filter");
                        Interface.calendarTypeControl = $("#" + Interface.containerId + " .filter-day select");
                        Interface.calendarListControl = $("#" + Interface.containerId + " .calendar-event select");
                        Interface.categoryListControl = $("#" + containerId + " .category-event select");
                        Interface.dateTextControl = $("#" + containerId + " .latest-news .filtered-by");
                        Interface.eventListControl = $("#" + containerId + " .event-list");
                        Interface.eventPagingControl = $("#" + containerId + " .events-pagination");
                        Interface.loadingSelector = "#" + containerId + " .events-loading";

                        // check for condensed view
                        if (Interface.isCondensedView) {
                            // change interface to condensed view
                            $("#" + Interface.containerId + " .filter-cont .span6").removeClass("span6");
                            $("#" + Interface.containerId + " .news-heading").hide();
                            Data.Constants.EventsPerPage = 5;
                        }

                        // set default values
                        Interface.calendarTypeControl.val(Data.Constants.CalendarTypes.Current);

                        // create widgets
                        Interface.calendarControl.datepicker({
                            format: "yyyy-mm-dd",
                            todayHighlight: true
                        }).on("changeMonth", Interface.Events.monthChanged).on("changeDate", Interface.Events.dateSelected);
                        Interface.calendarTypeControl.multiselect({
                            onChange: Interface.Events.calendarTypeChanged
                        });
                        Interface.calendarListControl.multiselect({
                            buttonText: UAlberta.Sitecore.Utilities.MultiselectButtonText,
                            onChange: Interface.Events.filterListChanged
                        });
                        Interface.categoryListControl.multiselect({
                            buttonText: UAlberta.Sitecore.Utilities.MultiselectButtonText,
                            onChange: Interface.Events.filterListChanged
                        });

                        // hide calendar list control if only one item in list
                        if (Interface.calendarListControl.children().length == 1) {
                            $("#" + Interface.containerId + " .calendar-event").hide();
                        }

                        // check if we are to hide the categories
                        if (Interface.hideCategories) {
                            $("#" + Interface.containerId + " .category-event").hide();
                        }

                        // set stored values
                        Interface.monthVisible = Utils.getDatepickerValue(Interface.calendarControl).substr(0, 7);
                    },

                    // show date text
                    showDateText: function (dateType, date) {
                        var html = "| ";

                        switch (dateType) {
                            case Data.Constants.CalendarTypes.Current:
                                html += Interface.calendarTypeControl.find(":selected").html();
                                break;
                            case Data.Constants.CalendarTypes.Day:
                                html += $.format.date(date + " ", "ddd, MMMM d, yyyy");
                                break;
                            case Data.Constants.CalendarTypes.Month:
                                html += $.format.date(date + " ", "MMMM, yyyy");
                                break;
                        }

                        Interface.dateTextControl.html(html);
                    },

                    // show events on page
                    showEvents: function (eventList) {
                        // empty the viewable events list
                        Interface.eventsVisible.length = 0;

                        // process events
                        for (var i in eventList) {
                            var event = eventList[i];

                            // check filters
                            if (!Interface.checkFilters(event)) {
                                continue;
                            }

                            // add event to viewable list
                            Interface.eventsVisible.push(event);
                        }

                        // display first page of events
                        Interface.showPage(1);
                    },

                    // show paging links
                    showPaging: function (page) {
                        // clear pages
                        Interface.eventPagingControl.html("");

                        // check for empty list
                        if (Interface.eventsVisible.length == 0) {
                            return;
                        }

                        // add pages
                        var activePage = parseInt(page);
                        var maxPage = Math.ceil(Interface.eventsVisible.length / 10);
                        for (var i = 1; i <= maxPage; i++) {
                            // check for active page
                            if (i == activePage) {
                                Interface.eventPagingControl.append('<li class="active">' + i + '</li>');
                            } else {
                                Interface.eventPagingControl.append('<li><a href="javascript:void(null)">' + i + '</a></li>');
                            }
                        }

                        // add click handler
                        Interface.eventPagingControl.find("a").click(Interface.Events.pageClicked);
                    },

                    // show selected page of events
                    showPage: function (page) {
                        // clear events
                        Interface.eventListControl.html("");

                        // check for empty list
                        if (Interface.eventsVisible.length == 0) {
                            // display "no events" message
                            Interface.eventListControl.html('<li><h4>No Events Found</h4></li>');
                            return;
                        }

                        // show events on selected page
                        for (var i = (parseInt(page) - 1) * Data.Constants.EventsPerPage; i < Data.Constants.EventsPerPage * page; i++) {
                            var event = Interface.eventsVisible[i];

                            // ensure event is valid
                            if (event == undefined) {
                                continue;
                            }

                            // create html components
                            var dateHtml = Utils.formatDateRange(event.StartDate, event.EndDate),
                                eventLinkHtml = event.Calendars == undefined || event.Calendars[0] == undefined || Data.calendarItems[event.Calendars[0]] == undefined ? "#" : Interface.eventsPath + Data.calendarItems[event.Calendars[0]].key + "/" + event.EventId,
                                locationHtml = event.Location == undefined ? "" : event.Location;

                            // create event html
                            var html = '<li>' +
                                '<a href="' + eventLinkHtml + '">' +
                                '<div class="list-item-content">' +
                                '<h4>' + event.Title + '</h4>' +
                                '<p class="list-item-extra">' + dateHtml + '</p>' +
                                (Interface.isCondensedView ? '' : '<p class="list-item-extra">' + locationHtml + '</p>') +
                                '</div>' + '</a>' +
                                '</li>';

                            // add event to list
                            Interface.eventListControl.append(html);
                        }

                        // check for condensed view
                        if (!Interface.isCondensedView) {
                            // show paging
                            Interface.showPaging(page);
                        } else {
                            // add show more events link
                            Interface.eventListControl.append('<li class="bottom-row"><a href="/events">Show More Events</a></li>');
                            // hide paging list
                            Interface.eventPagingControl.hide();
                        }
                    },

                    // check to see if an event is part of filters
                    checkFilters: function (event) {
                        // skip invalid date events
                        if (event.StartDate == undefined || event.EndDate == undefined) {
                            return false;
                        }

                        // check dates based on calendar type
                        switch (Utils.getMultilistValue(Interface.calendarTypeControl)) {
                            // check if the date selected (current date) is on or before the event end date
                            case Data.Constants.CalendarTypes.Current:
                                if (!Utils.isDateBefore(Utils.getDatepickerValue(Interface.calendarControl), event.EndDate)) {
                                    return false;
                                }
                                break;
                                // check if the date selected is between the event dates      
                            case Data.Constants.CalendarTypes.Day:
                                if (!Utils.isDateInRange(Utils.getDatepickerValue(Interface.calendarControl), event.StartDate, event.EndDate)) {
                                    return false;
                                }
                                break;
                                // month is skipped as we are pulling events based on the month, so show all for month type      
                            case Data.Constants.CalendarTypes.Month:
                                break;
                        }

                        // check selected calendars (none selected = select all)
                        var selectedCalendars = Utils.getMultilistValue(Interface.calendarListControl);
                        var eventCalendars = event.Calendars == undefined ? [] : $.map(event.Calendars, function (val) { return val; });
                        if (selectedCalendars.length > 0 && Utils.arrayIntersect(selectedCalendars, eventCalendars).length == 0) {
                            return false;
                        }

                        // check selected categories (none selected = select all)
                        var selectedCategories = Utils.getMultilistValue(Interface.categoryListControl);
                        var eventCategories = event.Categories == undefined ? [] : $.map(event.Categories, function (val) { return val; });
                        if (selectedCategories.length > 0 && Utils.arrayIntersect(selectedCategories, eventCategories).length == 0) {
                            return false;
                        }

                        return true;
                    },

                    // show the loading spinner
                    showLoading: function () {
                        // check if the spinner is already shown
                        if ($(Interface.loadingSelector).length == 0) {
                            Interface.eventListControl.append('<li class="loading"></li>');
                        }
                    },

                    Events: {
                        monthChanged: function (event) {
                            // set calendar type to month
                            Utils.setMultilistValue(Interface.calendarTypeControl, Data.Constants.CalendarTypes.Month);

                            // store visible month
                            Interface.monthVisible = event.date.getUTCFullYear() + "-" + Utils.padLeft(event.date.getUTCMonth() + 1, "0", 2);

                            AJAX.getEvents(Data.Constants.CalendarTypes.Month, Interface.monthVisible + "-01");
                        },

                        dateSelected: function (event) {
                            // set calendar type to day
                            Utils.setMultilistValue(Interface.calendarTypeControl, Data.Constants.CalendarTypes.Day);

                            var date = event.date.getUTCFullYear() + "-" + Utils.padLeft(event.date.getUTCMonth() + 1, "0", 2) + "-" + Utils.padLeft(event.date.getUTCDate(), "0", 2);
                            AJAX.getEvents(Data.Constants.CalendarTypes.Day, date);
                        },

                        calendarTypeChanged: function (option) {
                            // change calendar value if type changed to "current"
                            if (option.val() == Data.Constants.CalendarTypes.Current) {
                                Interface.calendarControl.datepicker("update", Data.currentDate);
                            }

                            AJAX.getEvents();
                        },

                        filterListChanged: function () {
                            AJAX.getEvents();
                        },

                        pageClicked: function () {
                            // show clicked page
                            Interface.showPage($(this).html());
                        }
                    }
                };

            // instance initialization

            function init(containerId, isCondensedView, hideCategories, eventsPath) {
                Interface.setup(containerId, isCondensedView, hideCategories, eventsPath);

                // initialize data objects
                Data.calendars = Interface.calendarListControl.children().map(function () { return this.value; }).get();
                Interface.calendarListControl.children().each(function () { Data.calendarItems[this.value] = { key: $(this).data("key"), name: this.text }; });
                Interface.categoryListControl.children().each(function () { Data.categoryItems[this.value] = this.text; });
                Data.currentDate = Utils.getDatepickerValue(Interface.calendarControl);

                // get events
                AJAX.getEvents(Utils.getMultilistValue(Interface.calendarTypeControl), Data.currentDate);
            }

            return {
                Initialize: init
            };
        }(jQuery));
    }

    return {
        GetInstance: getInstance
    };
}());;
/**
 * UAlberta FMA Carousel
 * Author: Dean Vigoren - vigoren@ualberta.ca
 */

//References To Other Scripts
//@reference jquery.flexslider-min.js

// build namespace
var UAlberta = UAlberta || {};
UAlberta.Sitecore = UAlberta.Sitecore || {};
UAlberta.Sitecore.Feature = UAlberta.Sitecore.Feature || {};


UAlberta.Sitecore.Feature.Carousel = UAlberta.Sitecore.Feature.Carousel || (function () {
    function getInstance() {
        return (function ($) {

            function start(containerId, pauseOnHover, randomize) {
                $('#' + containerId + '.flexslider').flexslider({
                    animation: "slide",
                    selector: ".slides > div.slide",
                    pauseOnHover: pauseOnHover,
                    randomize: randomize,
                    slideshowSpeed: 12000
                });
            }

            return {
                Start: start
            };
        } (jQuery));
    }

    return {
        GetInstance: getInstance
    };
} ());
;
/**
 * UAlberta FMA Tabbed Slider
 * Author: Dean Vigoren - vigoren@ualberta.ca
 */

// build namespace
var UAlberta = UAlberta || {};
UAlberta.Sitecore = UAlberta.Sitecore || {};
UAlberta.Sitecore.Feature = UAlberta.Sitecore.Feature || {};

UAlberta.Sitecore.Feature.Tabbed = function ($) {
    function init() {
        $('.slide').addClass('fma-slide').removeClass('slide');
        // init
        var fmaContainer = $('.fma-container');
        var fmaSlides = fmaContainer.find('.fma-slide');
        var fmaTabs = fmaContainer.parent().find('.fma-tabs li');

        // setActive
        fmaTabs.click(function () {
            setActive($(this).index());
            return false;
        });

        fmaSlides.click(function () {
            setActive($(this).index());
            return fmaSlides.eq(index).hasClass('fma-active');
        });

        fmaTabs.hover(function () {
            toggleHover($(this).index());
        }, function () {
            toggleHover($(this).index());
        });

        fmaSlides.hover(function () {
            toggleHover($(this).index());
        }, function () {
            toggleHover($(this).index());
        });

        var getSlidesWidth = function () {
            var slidesWidth = 0;
            fmaSlides.each(function () {
                slidesWidth += $(this).width();
            });
            return slidesWidth;
        };

        var totalWidth = getSlidesWidth();

        var setActive = function (i) {

            var leftPoint = fmaSlides.eq(i).position().left;
            var containerWidth = $('.fma-slide-wrapper').width();
            var slidePosition = 0;

            fmaSlides.removeClass('fma-active');
            fmaSlides.eq(i).addClass('fma-active');
            fmaTabs.removeClass('fma-button-active');
            fmaTabs.eq(i).addClass('fma-button-active');

            if (i == 0) {
                $('.fma-slide-scroller').css('left', '0px');
            } else if (i == (fmaSlides.length - 1)) {
                slidePosition = containerWidth - getSlidesWidth();
                $('.fma-slide-scroller').css('left', slidePosition + 'px');
            } else {
                slidePosition = ((containerWidth - fmaSlides.eq(i).width()) / 2) - leftPoint;
                $('.fma-slide-scroller').css('left', slidePosition + 'px');
            }

            return false;
        };

        var toggleHover = function (i) {
            fmaSlides.eq(i).toggleClass('fma-hover');
            fmaTabs.eq(i).toggleClass('fma-button-hover');
            return false;
        };

        setActive(0);


    }

    return {
        Initialize: init
    };
} (jQuery);;
/**
* UAlberta Filterable Data List
* Author: Kyle Schmidt - kyle.schmidt@ualberta.ca
* Based on code from Lane Olson - lane.olson@ualberta.ca
*/

(function ($) {
    $.fn.FilterableDataList = function (options) {
        // create settings, extending them with any options that were provided
        var Data = {
            id: "",

            settings: $.extend({
                categoryWrapper: "",
                classPrefix: "filterable-list",
                filterTextboxIconClass: "icon-filter",
                filterTextboxText: "filter items",
                noResultsText: "Sorry, there are no items matching your filter.",
                resultsCategoryText: "Filtered Items"
            }, options)
        },

			Utils = {
			    getNewRandomId: function () {
			        var newId = "filteredDataList_" + Math.floor((Math.random() * 1000) + 1);
			        if ($("#" + newId).length > 0) {
			            return Utils.getNewRandomId();
			        }
			        return newId;
			    }
			},

			Methods = {
			    addMarkup: function (widget) {
			        var wrapper = Data.settings.categoryWrapper,
						prefix = Data.settings.classPrefix,
						icon = Data.settings.filterTextboxIconClass,
						textboxText = Data.settings.filterTextboxText,
						noResults = Data.settings.noResultsText,
						resultsCategory = Data.settings.resultsCategoryText;

			        // add id to widget if needed and store id
			        if (widget.attr("id") == "") {
			            // add id
			            widget.attr("id", Utils.getNewRandomId());
			        }
			        Data.id = widget.attr("id");

			        widget
			        // add filtering
						.append('<li class="' + prefix + '-filter">' +
									'<span class="' + prefix + '-label">' + resultsCategory + '</span>' +
									'<i class="' + icon + '"></i>' +
									'<input type="text" placeholder="' + textboxText + '" class="' + prefix + '-filter-field" />' +
									'<ul class="' + prefix + '-results">' +
										'<li class="' + prefix + '-result-title">' +
											'<' + wrapper + '></' + wrapper + '>' +
										'</li>' +
										'<li class="' + prefix + '-result-none">' +
											'<p>' + noResults + '</p>' +
										'</li>' +
									'</ul>' +
								'</li>')
			        // process categories
						.children("li")
							.addClass(prefix + "-category")
							.each(function () {
							    // process items
							    if (wrapper != "") {
							        $(this).children("a")
										.wrap("<" + wrapper + "/>");
							    }
							    $(this).children("ul")
									.addClass(prefix + "-items")
									.not("." + prefix + "-results")
										.addClass(prefix + "-searchable");
							})
							.first()
								.addClass(prefix + "-active");
			    },

			    addEvents: function (widget) {
			        var wrapper = Data.settings.categoryWrapper,
						prefix = Data.settings.classPrefix;

			        // add active class to link category when clicked
			        widget.find("." + prefix + "-category > " + (wrapper == "" ? "a" : wrapper) + ", ." + prefix + "-category input").click(function () {
			            widget.find("." + prefix + "-category").removeClass(prefix + "-active");
			            $(this).parent().addClass(prefix + "-active");
			            return false;
			        });

			        // populate results with all links by default
			        widget.find("." + prefix + "-result-title > " + (wrapper == "" ? "a" : wrapper)).html("Displaying all " + widget.find("." + prefix + "-searchable a").size() + " items. <small>Begin typing to filter...</small>");
			        widget.find("." + prefix + "-searchable a").each(function () {
			            widget.find("." + prefix + "-results").append('<li class="' + prefix + '-result-item">' + $(this).parent().html() + "</li>");
			        });
			        widget.find("." + prefix + "-result-none").hide();

			        // live search plugin initialization        
			        widget.find("." + prefix + "-filter-field").search("#" + Data.id + " ." + prefix + "-searchable a", function (on) {
			            // this happens on any keydown, keyup, keypress, or blur event
			            on.all(function (results) {
			                var size = results ? results.size() : 0;
			                widget.find("." + prefix + "-result-title > " + (wrapper == "" ? "a" : wrapper)).html("Displaying " + size + " matches for &quot;" + widget.find("." + prefix + "-filter-field").val().replace(/>/g, "&gt;").replace(/</g, "&lt;") + "&quot");
			            });

			            // this happens when the filter field has nothing entered
			            on.reset(function () {
			                widget.find("." + prefix + "-result-title > " + (wrapper == "" ? "a" : wrapper)).html("Displaying all " + widget.find("." + prefix + "-searchable a").size() + " links. <small>Begin typing to filter...</small>");
			                widget.find("." + prefix + "-result-item").remove();
			                widget.find("." + prefix + "-searchable a").each(function () {
			                    widget.find("." + prefix + "-results").append('<li class="' + prefix + '-result-item">' + $(this).parent().html() + "</li>");
			                });
			                widget.find("." + prefix + "-result-none").hide();
			            });

			            // this happens when there are no results base on the query
			            on.empty(function () {
			                widget.find("." + prefix + "-result-none").show();
			                widget.find("." + prefix + "-result-item").remove();
			            });

			            // this happens when there are results
			            on.results(function (results) {
			                widget.find("." + prefix + "-result-none").hide();
			                widget.find("." + prefix + "-result-item").remove();
			                results.each(function () {
			                    widget.find("." + prefix + "-results").append('<li class="' + prefix + '-result-item">' + $(this).parent().html() + "</li>");
			                });
			            });
			        });
			    }
			}
		;

        return this.each(function () {
            Methods.addMarkup($(this));
            Methods.addEvents($(this));
        });
    };
})(jQuery);
;
/**
* UAlberta Media Gallery
* Author: Kyle Schmidt - kyle.schmidt@ualberta.ca
*/

// build namespace
var UAlberta = UAlberta || {};
UAlberta.Sitecore = UAlberta.Sitecore || {};

UAlberta.Sitecore.MediaGallery = UAlberta.Sitecore.MediaGallery || (function () {
    function getInstance() {
        return (function ($) {
            'use strict';

            // description object
            var Description = function () { this.value = "" };
            Description.prototype.addValue = function (field, value) {
                if(Data.fieldsToShow.indexOf(field) != -1 && value.length > 0) {
                    this.value = this.value + (this.value.length > 0 ? "<br />" : "") + value;
                }
            };

            var Data = {
                    items: [], // items
                    itemsPerPage: 9, // items per page
                    presetCategories: [], // categories to always filter on
                    presetType: "", // type to always filter on
                    fieldsToShow: [], // fields to show

                    // Constant values
                    Constants: {
                        // Media types
                        MediaTypes: {
                            Audio: "audio",
                            Image: "image",
                            Video: "video"
                        }
                    }
                },

                Utils = {
                    // Get the value of a multilist widget
                    getMultilistValue: function (obj) {
                        return obj.multiselect("getSelected").val() || [];
                    },

                    // Set the value of a multilist widget
                    setMultilistValue: function (obj, value) {
                        obj.val(value);
                        if(Utils.isMultilistCreated(obj)) {
                            obj.multiselect("refresh");
                        }
                    },

                    // check if a multilist has been created
                    isMultilistCreated: function (obj) {
                        return obj.next().has(".multiselect-container.dropdown-menu").length > 0;
                    },

                    // Get array intersection
                    arrayIntersect: function (arr1, arr2) {
                        return $.map(arr1, function (val) { return $.inArray(val, arr2) < 0 ? null : val; });
                    }
                },

                AJAX = {
                    // get items from server
                    getItems: function (folderId, orderBy) {
                        // show loading spinner
                        Interface.showLoading();

                        // get items from service
                        AJAX.currentRequest = $.ajax({
                            error: AJAX.Events.error,
                            success: AJAX.Events.success,
                            url: "/api/mediagallery/folder/" + encodeURIComponent(folderId) + ".json?orderby=" + encodeURIComponent(orderBy)
                        });
                    },

                    Events: {
                        error: function () {
                            Interface.itemsControl.html("<p>An error occurred while obtaining item information. Please refresh the page and try again.</p>");
                        },

                        success: function (data) {
                            // store the items
                            $(data).each(function(index, item) {
                                // check preset categories and type
                                var categoryCheck = Data.presetCategories.length == 0 || Utils.arrayIntersect($.map(item.Categories, function (val) { return val.Key; }), Data.presetCategories).length > 0;
                                var typeCheck = Data.presetType == "" || item.Type == Data.presetType;

                                if(categoryCheck && typeCheck) {
                                    Data.items[item.Id] = item;
                                }
                            });
                            Interface.showItems();
                        }
                    }
                },

                Interface = {
                    containerId: "", // id of the container of the schedule
                    categoryListControl: [], // category list control
                    typeListControl: [], // type list control
                    customListControl1: [], // custom list control 1
                    customListControl2: [], // custom list control 2
                    customListControl3: [], // custom list control 3
                    customListControl4: [], // custom list control 4
                    itemsControl: [], // items control
                    itemPagingControl: [], // item paging control
                    itemsVisible: [], // the items that can be seen (based on filters), used for paging
                    loadingSelector: "", // the selector for the loading spinner

                    // setup the interface
                    setup: function (containerId) {
                        // get interface components
                        Interface.containerId = containerId;
                        Interface.categoryListControl = $("#" + Interface.containerId + " .media-filter-category select");
                        Interface.typeListControl = $("#" + Interface.containerId + " .media-filter-type select");
                        Interface.customListControl1 = $("#" + Interface.containerId + " .media-filter-custom1 select");
                        Interface.customListControl2 = $("#" + Interface.containerId + " .media-filter-custom2 select");
                        Interface.customListControl3 = $("#" + Interface.containerId + " .media-filter-custom3 select");
                        Interface.customListControl4 = $("#" + Interface.containerId + " .media-filter-custom4 select");
                        Interface.itemsControl = $("#" + Interface.containerId + " .gallery-container");
                        Interface.itemPagingControl = $("#" + Interface.containerId + " .events-pagination");
                        Interface.loadingSelector = "#" + Interface.containerId + " .events-loading";

                        // set default values
                        if(window.location.hash != "") {
                            Interface.setDropdownsUsingHash();
                        }

                        // create widgets
                        Interface.categoryListControl.multiselect({
                            buttonText: UAlberta.Sitecore.Utilities.MultiselectButtonText,
                            onChange: function() {
                                Interface.setHash();
                                Interface.Events.filtersChanged();
                            }
                        });
                        Interface.typeListControl.multiselect({
                            buttonText: UAlberta.Sitecore.Utilities.MultiselectButtonText,
                            onChange: function() {
                                Interface.setHash();
                                Interface.Events.filtersChanged();
                            }
                        });
                        Interface.customListControl1.multiselect({
                            buttonText: UAlberta.Sitecore.Utilities.MultiselectButtonText,
                            onChange: function() {
                                Interface.setHash();
                                Interface.Events.filtersChanged();
                            }
                        });
                        Interface.customListControl2.multiselect({
                            buttonText: UAlberta.Sitecore.Utilities.MultiselectButtonText,
                            onChange: function() {
                                Interface.setHash();
                                Interface.Events.filtersChanged();
                            }
                        });
                        Interface.customListControl3.multiselect({
                            buttonText: UAlberta.Sitecore.Utilities.MultiselectButtonText,
                            onChange: function() {
                                Interface.setHash();
                                Interface.Events.filtersChanged();
                            }
                        });
                        Interface.customListControl4.multiselect({
                            buttonText: UAlberta.Sitecore.Utilities.MultiselectButtonText,
                            onChange: function() {
                                Interface.setHash();
                                Interface.Events.filtersChanged();
                            }
                        });

                        // set up masonry
                        Interface.itemsControl.masonry({
                            // options
                            columnWidth: '.gallery-item',
                            itemSelector: '.gallery-item',
                            gutter: 15,
                            transitionDuration: 0
                        });

                        // hash change event
                        $(window).hashchange(function () {
                            Interface.setDropdownsUsingHash();
                            Interface.showItems();
                        });
                    },

                    // show items on page
                    showItems: function () {
                        // empty the viewable items list
                        Interface.itemsVisible.length = 0;

                        // process games
                        for (var i in Data.items) {
                            var item = Data.items[i];
                            // HACK: Ensure we are only processing actual items
                            if(item.Id == undefined) {
                                continue;
                            }

                            // format item date
                            item.DateFormatted = item.Date == undefined ? "" : item.DateFormatted || UAlberta.Sitecore.Utilities.GetDateFromJson(item.Date, UAlberta.Sitecore.Utilities.DateFormat.Short);

                            // fix empty thumbnail and image url's
                            if(item.ThumbnailImageUrl.length == 0) {
                                item.ThumbnailImageUrl = "/Design/img/" + item.Type + ".png";
                            }

                            // check filters
                            if (!Interface.checkFilters(item)) {
                                continue;
                            }

                            // add item to viewable list
                            Interface.itemsVisible.push(item);
                        }

                        // display first page of games
                        Interface.showPage(1);
                    },

                    // show paging links
                    showPaging: function (page) {
                        // clear pages
                        Interface.itemPagingControl.html("");

                        // check for empty list
                        if (Interface.itemsVisible.length == 0) {
                            return;
                        }

                        // add pages
                        var activePage = parseInt(page);
                        var maxPage = Math.ceil(Interface.itemsVisible.length / Data.itemsPerPage);
                        for (var i = 1; i <= maxPage; i++) {
                            // check for active page
                            if (i == activePage) {
                                Interface.itemPagingControl.append('<li class="active">' + i + '</li>');
                            } else {
                                Interface.itemPagingControl.append('<li><a href="javascript:void(null)">' + i + '</a></li>');
                            }
                        }

                        // add click handler
                        Interface.itemPagingControl.find("a").click(Interface.Events.pageClicked);
                    },

                    // show selected page of items
                    showPage: function (page) {
                        // hide items in order to prevent rendering flash
                        Interface.itemsControl.css("visibility", "hidden");

                        // clear games
                        Interface.itemsControl.html("");

                        // check for empty list
                        if (Interface.itemsVisible.length == 0) {
                            // display "no items" message
                            Interface.itemsControl.html('<h4>No Items Found</h4>');
                            Interface.showPaging(page);
                            return;
                        }

                        // show items on selected page
                        for (var i = (parseInt(page) - 1) * Data.itemsPerPage; i < Data.itemsPerPage * page; i++) {
                            var item = Interface.itemsVisible[i];

                            // ensure item is valid
                            if (item == undefined) {
                                continue;
                            }

                            // create description
                            var description = new Description();
                            description.addValue("caption", item.Caption);
                            description.addValue("duration", item.Duration);
                            description.addValue("attribution", item.Attribution);

                            // create item html
                            var showTitle = Data.fieldsToShow.indexOf("title") != -1 && item.Title.length > 0;
                            var showDate = Data.fieldsToShow.indexOf("date") != -1 && item.DateFormatted.length > 0;
                            var showDescription = description.value.length > 0;
                            var link = item.Link.length > 0 ? item.Link : "#";
                            var addData = item.Link.length == 0;
                            var html = '<a href="' + link + '" class="extrude gallery-item"' + (addData ? ('data-id="' + item.Id + '" data-target="#videoModal" data-toggle="modal"') : '') + '>' +
                                           '<img src="' + item.ThumbnailImageUrl + '"' + ((showTitle || showDescription) ? '' : ' class="standalone"') + '>' +
                                           ((showTitle || showDescription) ? ('<div class="gallery-description">' +
                                               (showTitle ? ('<h3>' + item.Title + '</h3>') : '') +
                                               (showDate ? ('<p class="date">' + item.DateFormatted + '</p>') : '') +
                                               (showDescription ? ('<p class="caption">' + description.value + '</p>') : '') +
                                           '</div>') : '') +
                                       '</a>';

                            // add item to list
                            Interface.itemsControl.append(html);
                        }

                        // initialize Masonry after all images have loaded
                        imagesLoaded(Interface.itemsControl[0], function() { Interface.itemsControl.masonry('reloadItems'); Interface.itemsControl.masonry(); Interface.itemsControl.css("visibility", "visible"); });

                        // add script for items to load content
                        Interface.itemsControl.find("a[data-id]").click(Interface.Events.itemClicked);

                        // show paging
                        Interface.showPaging(page);
                    },

                    // check to see if an item is part of filters
                    checkFilters: function (item) {
                        // check selected categories (none selected = select all)
                        var selectedCategories = Utils.getMultilistValue(Interface.categoryListControl);
                        var itemCategories = $.map(item.Categories, function (val) { return val.Key; });
                        if (selectedCategories.length > 0 && Utils.arrayIntersect(selectedCategories, itemCategories).length == 0) {
                            return false;
                        }

                        // check selected types (none selected = select all)
                        var selectedTypes = Utils.getMultilistValue(Interface.typeListControl);
                        if (selectedTypes.length > 0 && $.inArray(item.Type, selectedTypes) < 0) {
                            return false;
                        }

                        // check selected custom field 1 (none selected = select all)
                        var selectedCustom1 = Utils.getMultilistValue(Interface.customListControl1);
                        if (selectedCustom1.length > 0 && Utils.arrayIntersect(selectedCustom1, item.CustomField1).length == 0) {
                            return false;
                        }

                        // check selected custom field 2 (none selected = select all)
                        var selectedCustom2 = Utils.getMultilistValue(Interface.customListControl2);
                        if (selectedCustom2.length > 0 && Utils.arrayIntersect(selectedCustom2, item.CustomField2).length == 0) {
                            return false;
                        }

                        // check selected custom field 3 (none selected = select all)
                        var selectedCustom3 = Utils.getMultilistValue(Interface.customListControl3);
                        if (selectedCustom3.length > 0 && Utils.arrayIntersect(selectedCustom3, item.CustomField3).length == 0) {
                            return false;
                        }

                        // check selected custom field 4 (none selected = select all)
                        var selectedCustom4 = Utils.getMultilistValue(Interface.customListControl4);
                        if (selectedCustom4.length > 0 && Utils.arrayIntersect(selectedCustom4, item.CustomField4).length == 0) {
                            return false;
                        }

                        return true;
                    },

                    // show the loading spinner
                    showLoading: function () {
                        // check if the spinner is already shown
                        if ($(Interface.loadingSelector).length == 0) {
                            Interface.itemsControl.append('<span class="loading"></span>');
                        }
                    },

                    // set dropdowns using hash value
                    setDropdownsUsingHash: function () {
                        var categories = [];
                        var types = [];
                        var custom1 = [];
                        var custom2 = [];
                        var custom3 = [];
                        var custom4 = [];
                        $(window.location.hash.replace(/^#/, "").split("#")).each(function () {
                            var keys = this.split(";");
                            switch(keys.shift()) {
                                case "category":
                                    categories = keys;
                                    break;
                                case "type":
                                    types = keys;
                                    break;
                                case Interface.customListControl1.siblings("h3").children().text().toLowerCase().replace(/\s/g, ""):  // custom field 1
                                    custom1 = keys;
                                    break;
                                case Interface.customListControl2.siblings("h3").children().text().toLowerCase().replace(/\s/g, ""):  // custom field 2
                                    custom2 = keys;
                                    break;
                                case Interface.customListControl3.siblings("h3").children().text().toLowerCase().replace(/\s/g, ""):  // custom field 3
                                    custom3 = keys;
                                    break;
                                case Interface.customListControl4.siblings("h3").children().text().toLowerCase().replace(/\s/g, ""):  // custom field 4
                                    custom4 = keys;
                                    break;
                            }
                        });
                        Utils.setMultilistValue(Interface.categoryListControl, categories);
                        Utils.setMultilistValue(Interface.typeListControl, types);
                        Utils.setMultilistValue(Interface.customListControl1, custom1);
                        Utils.setMultilistValue(Interface.customListControl2, custom2);
                        Utils.setMultilistValue(Interface.customListControl3, custom3);
                        Utils.setMultilistValue(Interface.customListControl4, custom4);
                    },

                    // set the hash value
                    setHash: function () {
                        var hash = "";

                        // get categories
                        var categories = Utils.getMultilistValue(Interface.categoryListControl).join(";");
                        if(categories.length > 0) {
                            hash += "#category;" + categories;
                        }

                        // get types
                        var types = Utils.getMultilistValue(Interface.typeListControl).join(";");
                        if(types.length > 0) {
                            hash += "#type;" + types;
                        }

                        // custom 1
                        var custom1 = Utils.getMultilistValue(Interface.customListControl1).join(";");
                        if(custom1.length > 0) {
                            var custom1Name = Interface.customListControl1.siblings("h3").children().text().toLowerCase().replace(/\s/g, "");
                            hash += "#" + custom1Name + ";" + custom1;
                        }

                        // custom 2
                        var custom2 = Utils.getMultilistValue(Interface.customListControl2).join(";");
                        if(custom2.length > 0) {
                            var custom2Name = Interface.customListControl2.siblings("h3").children().text().toLowerCase().replace(/\s/g, "");
                            hash += "#" + custom2Name + ";" + custom2;
                        }

                        // custom 3
                        var custom3 = Utils.getMultilistValue(Interface.customListControl3).join(";");
                        if(custom3.length > 0) {
                            var custom3Name = Interface.customListControl3.siblings("h3").children().text().toLowerCase().replace(/\s/g, "");
                            hash += "#" + custom3Name + ";" + custom3;
                        }

                        // custom 4
                        var custom4 = Utils.getMultilistValue(Interface.customListControl4).join(";");
                        if(custom4.length > 0) {
                            var custom4Name = Interface.customListControl4.siblings("h3").children().text().toLowerCase().replace(/\s/g, "");
                            hash += "#" + custom4Name + ";" + custom4;
                        }

                        window.location.hash = hash;
                    },

                    Events: {
                        // filters were changed, filter items
                        filtersChanged: function () {
                            Interface.showItems();
                        },

                        // a page was clicked on, change view to that page
                        pageClicked: function () {
                            // show clicked page
                            Interface.showPage($(this).html());
                        },

                        // an item was clicked on, show details
                        itemClicked: function () {
                            var item = Data.items[$(this).data("id")];

                            // set title
                            $("#videoModal .modal-header h3").text(item.Title);

                            // check item type
                            switch(item.Type) {
                                case Data.Constants.MediaTypes.Audio:
                                    // hide iframe
                                    $("#videoModal .video-mod-container").hide();

                                    // add custom audio markup
                                    var audioHtml = '<audio class="modal-audio" controls>' +
                                                        '<source src="' + item.AudioUrlOgg + '" type="audio/ogg" />' +
                                                        '<source src="' + item.AudioUrlMp3 + '" type="audio/mpeg" />' +
                                                        '<span>Your browser does not support playing of this audio. Please <a href="' + item.AudioUrlMp3 + '">download</a> the audio if you wish to listen to it.</span>' +
                                                    '</audio>';
                                    $("#videoModal .modal-body").append(audioHtml);

                                    break;
                                case Data.Constants.MediaTypes.Image:
                                    // hide iframe
                                    $("#videoModal .video-mod-container").hide();

                                    // add custom image markup
                                    if(item.ImageUrl.length > 0) {
                                        var imageHtml = '<div class="modal-image' + (item.Description.length == 0 ? ' standalone' : '') + '"><img src="' + item.ImageUrl + '" alt="' + item.Title + '" /></div>';
                                        $("#videoModal .modal-body").append(imageHtml);
                                    }

                                    break;
                                case Data.Constants.MediaTypes.Video:
                                    // no modal for mobile
                                    if ($(window).width() < 690) {
                                        window.location = item.VideoUrlMobile;
                                        return;
                                    }

                                    // set video iframe url
                                    $("#videoModal iframe").attr("src", item.VideoUrl + "&autoplay=1");

                                    break;
                            }

                            // add custom description markup
                            if(item.Description.length > 0) {
                                $("#videoModal .modal-body").append("<div class='modal-description'>" + item.Description + "</div>");
                            }
                        }
                    }
                }
            ;

            // instance initialization
            function init(containerId, folderId, itemsPerPage, presetCategories, presetType, fieldsToShow, orderBy) {
                Interface.setup(containerId);

                // set vars
                Data.itemsPerPage = itemsPerPage;
                Data.presetCategories = presetCategories.length > 0 ? presetCategories.split(";") : [];
                Data.presetType = presetType;
                Data.fieldsToShow = fieldsToShow.length > 0 ? fieldsToShow.split(";") : [];

                // get items
                AJAX.getItems(folderId, orderBy);
            }

            return {
                Initialize: init
            };
        } (jQuery));
    }

    return {
        GetInstance: getInstance
    };
} ());
;
/**
* UAlberta News Archive
* Author: Dean Vigoren - vigoren@ualberta.ca
*/

// build namespace
var UAlberta = UAlberta || {};
UAlberta.Sitecore = UAlberta.Sitecore || {};
UAlberta.Sitecore.News = UAlberta.Sitecore.News || {};

UAlberta.Sitecore.News.Archive = function ($) {
    var _options = {
        ServiceUrl: "",
        ItemsPerPage: 10,
        NumberOfPages: 1,
        PageLinksToShow: 10,
        ActivePage: 1,
        SearchTerm: "",
        Categories: "",
        StickySorting: false
    },
        _prevHash = "",
        _intervalPrevHash = "",
        _paging = {
            pageChange: function (pageNumber) {
                if (pageNumber != _options.ActivePage) {
                    _ajax.getArticleData(pageNumber);
                    _paging.updatePageSelection(pageNumber);
                    _options.ActivePage = pageNumber;
                    $(".news-pagination > li").removeClass("active");
                    $("a[data-archive-page = '" + pageNumber + "']").parent().addClass("active");
                    _hashtag.updateHash(pageNumber);
                }
            },

            updatePageSelection: function (pageNumber) {
                if (_options.NumberOfPages > _options.PageLinksToShow) {
                    var showFirstEllipse = (pageNumber >= (_options.PageLinksToShow / 2)),
                        showLastEllipse = (pageNumber <= (_options.NumberOfPages - (_options.PageLinksToShow / 2))),
                        pagesToShow = _options.PageLinksToShow;

                    $(".news-pagination > li").addClass("hidden");

                    if (showFirstEllipse) {
                        $(".news-pagination-break").first().removeClass("hidden");
                        $("a[data-archive-page = '1']").parent().removeClass("hidden");
                        pagesToShow -= 2;
                    }

                    if (showLastEllipse) {
                        $(".news-pagination-break").last().removeClass("hidden");
                        $("a[data-archive-page = '" + _options.NumberOfPages + "']").parent().removeClass("hidden");
                        pagesToShow -= 2;
                    }

                    var beginningNumber = pageNumber - (pagesToShow / 2) + 1,
                        endNumber = beginningNumber + pagesToShow - 1;

                    if (beginningNumber <= 0) {
                        beginningNumber = 1;
                        endNumber = pagesToShow;
                    } else if (beginningNumber >= (_options.NumberOfPages - pagesToShow)) {
                        beginningNumber = _options.NumberOfPages - pagesToShow;
                        endNumber = _options.NumberOfPages;
                    }

                    for (var i = beginningNumber; i <= endNumber; i++) {
                        $("a[data-archive-page = '" + i + "']").parent().removeClass("hidden");
                    }
                }
            }
        },
        _search = {
            preformSearch: function () {
                var url = document.location.search.substr(1).split('&'),
                    value = encodeURI($("#search").val());

                if (url == '') {
                    document.location.search = '?search=' + value;
                } else {
                    var i = url.length;
                    var x;
                    while (i--) {
                        x = url[i].split('=');
                        if (x[0] == 'search') {
                            x[1] = value;
                            url[i] = x.join('=');
                            break;
                        }
                    }
                    if (i < 0) {
                        url[url.length] = ['search', value].join('=');
                    }
                    document.location.search = url.join('&');
                }
            }
        },
        _hashtag = {
            updateHash: function (newHash) {
                _prevHash = window.location.hash;
                window.location.hash = newHash;
            },

            back: function () {
                window.location.hash = window.location.hash == _prevHash ? "" : _prevHash;
            },

            urlInit: function () {
                var h = window.location.hash.replace(/#/g, "");
                if (h != "") {
                    $(".news-pagination-item[data-archive-page = '" + h + "']").click();
                }
            }
        },
        _ajax = {
            getArticleData: function (pageNumber) {
                $.ajax({
                    type: "GET",
                    url: _options.ServiceUrl + "?pagesize=" + _options.ItemsPerPage + "&page=" + pageNumber + "&search=" + _options.SearchTerm + "&categories=" + _options.Categories + "&stickysorting=" + _options.StickySorting,
                    dataType: "json",
                    contentType: "application/json",
                    timeout: 1000,
                    success: _ajax.ajaxSuccess,
                    error: _ajax.ajaxError
                });
            },

            ajaxSuccess: function (data) {
                if (!data) {
                    data = [];
                }

                var newList = '';

                for (var i = 0; i < data.length; i++) {
                    var imgHtml = '';
                    
                    if (data[i].SImage != '') {
                        imgHtml = '<div class="list-item-image frame"><img src="' + data[i].SImage + '" /></div>';
                    }
                    
                    newList += '<li><a href="' + data[i].Link + '">' + imgHtml + '<div class="list-item-content"><h4>' + data[i].Title + '</h4><p class="list-item-extra">' + data[i].Date + '</p><p class="list-item-description">' + data[i].Description + '</p></div></a></li>';
                }

                if (newList == '') {
                    newList = '<li>There was an error retrieving the news articles.</li>';
                }

                $('.news-archive-list').html(newList);
            },

            ajaxError: function () {

            }
        };


    function init(options) {
        _options = $.extend(_options, options);

        $(".news-pagination-item[data-archive-page]").click(function () {
            _paging.pageChange($(this).attr("data-archive-page"));
        });

        $(".news-pagination-item[data-archive-page]").parent().first().addClass('active');

        //Search Stuff
        $("#searchButton").click(function (a) {
            a.preventDefault();
            var value = $("#search").val();
            if (value != "" && value != $("#search").attr("placeholder")) {
                _search.preformSearch();
            }
        });

        $("#search").keydown(function (a) {
            a = a || window.event;
            if (a.keyCode == 13 || a.which == 13) {
                a.preventDefault();
                $("#searchButton").click();
            }

        });

        //Set search value
        $("#search").val(_options.SearchTerm);

        //Hashtags for pages
        _hashtag.urlInit();
    }

    return {
        Initialise: init
    };

}(jQuery);;
// build namespace
var UAlberta = UAlberta || {};
UAlberta.Sitecore = UAlberta.Sitecore || {};
UAlberta.Sitecore.News = UAlberta.Sitecore.News || {};

UAlberta.Sitecore.News.Article = (function ($) {

    function init() {
        // Check the image size, and float it if it's small
        var img = $(".image-caption-container:first img");
        if (img.length) {
            $("<img/>") // Make in memory copy of image to avoid css issues
                .attr("src", $(img).attr("src").split("?")[0])
                .load(function () {
                    if (this.width < 350) {
                        $('.frame').css({
                            'float': 'right',
                            'width': '50%',
                            'margin-left': '1em'
                        });
                    }
                });
        }

        // Grab links from the article for related links
        var storyLinks = $('article .story p a');

        if (storyLinks.length) {
            storyLinks.each(function () {
                $('#related-links').append('<li><a href="' + $(this).attr('href') + '">' + $(this).html() + '</a></li>');
            });
        }

        // Fetch Top Stories
        // --------------------
        var newsEl = $('#top-stories');

        $.getJSON('http://sc3-cdn.ualberta.ca/api/news/headlines.jsonp?callback=?',
            function (data) {
                newsEl.removeClass('loading');
                for (var i = 0; i < data.length; i++) {
                    newsEl.append('<li class="news-row"><a href="' + data[i].Link + '">' + data[i].Title + '</a></li>');
                }
            }
        );

        // Fix Videos (Temporary, needs to be fixed)
        // ------------------
        $('.story iframe').css('width', '100%');
    }

    return {
        Initialise: init
    };

})(jQuery);
;
/**
 * UAlberta Graduate Program Search Functionality
 * Author: Dean Vigoren - vigoren@ualberta.ca
 * Edited: Kyle Schmidt - kyle.schmidt@ualberta.ca (Sept 2014)
 */

// Build namespace
var UAlberta = UAlberta || {};
UAlberta.Sitecore = UAlberta.Sitecore || {};

UAlberta.Sitecore.SearchGraduateProgram = function ($) {

    var _departmentList = new Dictionary(),
        _facultyList = new Dictionary(),
        _intervalPrevHash = "",
        _urlType = null,

        _utils = {
            getFlatTextValue: function (obj) {
                var strings = "";
                for(var i in obj) {
                    if(!obj.hasOwnProperty(i)) {
                        continue;
                    }
                    if(typeof obj[i] == "object") {
                        strings += " " + _utils.getFlatTextValue(obj[i]);
                    } else {
                        // remove ID's
                        if(obj[i][0] == "{" && obj[i][obj[i].length - 1] == "}") {
                            continue;
                        }
                        strings += " " + obj[i].replace(/\n/g, " ").toLowerCase();
                    }
                }
                return strings;
            }
        },

        _ajax = {
            getData: function (callback) {
                $.getJSON("/api/gradprograms", function (data) { _ajax.ajaxSuccess(data); callback(); });
            },

            ajaxSuccess: function (data) {
                if (data && data.length > 0) {
                    for (var i = 0; i < data.length; i++) {
                        var d = data[i],
                            department = d.Department || "",
                            faculties = d.Faculties || [];

                        if (!_departmentList.containsKey(department)) {
                            d._FullText = _utils.getFlatTextValue(d);
                            _departmentList.add(department, d);
                        }

                        for (var x = 0; x < faculties.length; x++) {
                            if (!_facultyList.containsKey(faculties[x].Name)) {
                                _facultyList.add(faculties[x].Name, faculties[x]);
                            }
                        }
                    }
                    _main.populateFacultyDropDown();
                    _departmentList.sortKeys();
                    _facultyList.sortKeys();
                }
            },

            ajaxError: function () { }
        },

        _navigation = {
            urlType: { Main: 1, Details: 2 },

            parseUrl: function () {
                var anchor = window.location.hash;

                //Details page
                if (anchor != "") {
                    return { urlType: _navigation.urlType.Details, value: anchor };
                }

                return { urlType: _navigation.urlType.Main, value: "" };
            },

            urlChange: function () {
                _urlType = _navigation.parseUrl();
                switch (_urlType.urlType) {
                    case _navigation.urlType.Main:
                        $("#gradDetailsWrapper").slideUp(500, function () {
                            $("#gradSearchWrapper,#search-instructions").slideDown(500);
                            _results.displayResults();
                        });
                        break;
                    case _navigation.urlType.Details:
                        $("#gradSearchWrapper,#search-instructions").slideUp(500, function () {
                            $("#gradDetailsWrapper").slideDown(500);
                            _details.displayDetails(_urlType);
                        });
                        break;
                }
            },

            updateHash: function(newHash){
                window.location.hash = newHash;
            }
        },

        _main = {
            populateFacultyDropDown: function () {
                var select = $("#sFacultyList");
                for (var i = 0; i < _facultyList.length(); i++) {
                    var data = _facultyList.lookup(_facultyList.lookupKey(i));
                    select.append("<option value='" + data.ID + "'>" + data.Name + "</option>");
                }

                select.change(function () {
                    _results.displayResults();
                });
            }
        },

        _results = {
            displayResults: function () {
                var results = [],
                    facultyValue = $("#sFacultyList").val(),
                    searchValues = $.grep($("#gradSearchBox").val().trim().toLowerCase().split(' '), function(n) { return(n); });

                resultLoop: for (var i = 0; i < _departmentList.length(); i++) {
                    var key = _departmentList.lookupKey(i),
                        data = _departmentList.lookup(key),
                        degrees = "",
                        faculties = "",
                        x;

                    // filter on search
                    if (searchValues.length > 0) {
                        for (x = 0; x < searchValues.length; x++) {
                            if (data._FullText.indexOf(searchValues[x]) == -1) {
                                continue resultLoop;
                            }
                        }
                    }

                    // filter by faculty
                    for (x = 0; x < data.Faculties.length; x++) {

                        if (facultyValue != "" && facultyValue != data.Faculties[x].ID) {
                            continue;
                        }

                        if (faculties != "") {
                            faculties += "<br/>";
                        }
                        faculties += data.Faculties[x].Name;
                    }

                    if (faculties == "") {
                        continue;
                    }

                    for (x = 0; x < data.Degrees.length; x++) {
                        if (degrees != "") {
                            degrees += ", ";
                        }
                        degrees += data.Degrees[x].Abbreviation;
                    }

                    results.push({
                        Department: data.Department,
                        Degrees: degrees,
                        Faculty: faculties,
                        hash: data.ID.replace(/-|{|}/g, "")
                    });
                }

                var tableBody = $("#gradResultsTable > tbody");
                tableBody.empty();
                for (var i = 0; i < results.length; i++) {
                    tableBody.append("<tr><td><a href='javascript:void(0);' onclick='UAlberta.Sitecore.SearchGraduateProgram.updateHash(\"#" + results[i].hash + "\");'>" + results[i].Department + "</a></td><td>" + results[i].Degrees + "</td><td>" + results[i].Faculty + "</td></tr>");
                }
                if (results.length == 0) {
                    tableBody.append("<tr><td colspan='3'>No results found.</td></tr>");
                }
            }
        },

        _details = {
            displayDetails: function (urlType) {
                var id = urlType.value.replace("#", ""),
                    item = null,
                    faculties = "",
                    degrees = "",
                    i;

                for (i = 0; i < _departmentList.length(); i++) {
                    var key = _departmentList.lookupKey(i),
                        data = _departmentList.lookup(key);

                    if (data.ID.replace(/-|{|}/g, "") == id) {
                        item = data;
                        break;
                    }
                }

                for (i = 0; i < item.Degrees.length; i++) {
                    degrees += "<li>" + item.Degrees[i].Name + "</li>";
                }

                for (i = 0; i < item.Faculties.length; i++) {
                    if (faculties != "") {
                        faculties += "<br/>";
                    }
                    faculties += item.Faculties[i].Name;
                }

                $("#gradDetail_department").html(item.Department);
                $("#gradDetail_faculty").html(faculties);
                $("#gradDetail_website").html(item.ProgramUrl).attr('href', item.ProgramUrl);
                $("#gradDetail_email").html(item.Email).attr('href', 'mailto:' + item.Email);
                $("#gradDetail_research").html(item.ResearchAreas);
                $("#gradDetail_degrees").html(degrees);

                item.GraduateSudentPositionsUrl != "" ? $("#gradDetail_studentPos").html(item.GraduateSudentPositionsUrl).attr('href', item.GraduateSudentPositionsUrl).parent().show() : $("#gradDetail_studentPos").parent().hide();
            }
        };

    function init() {
        $("#gradSearchWrapper,#search-instructions").show();

        jQuery.easing.def = "easeInCubic";

        // check for search via url
        if (window.location.hash.indexOf('search_') != -1) {
            $("#gradSearchBox").val(window.location.hash.replace(/^[#]?search_/g, ''));
            _navigation.updateHash("");
        }

        _ajax.getData(_navigation.urlChange);

        if ("onhashchange" in window && (document.documentMode === undefined || document.documentMode > 7 )) {
            $(window).bind("hashchange", function (e) {
                _navigation.urlChange();
            });
        } else {
            setInterval(function () {
                var newHash = window.location.hash;
                if (_intervalPrevHash !== newHash) {
                    _intervalPrevHash = newHash;
                    _navigation.urlChange();
                }
            },50);
        }

        $("#gradSearchBox").keyup(function (a) {
            a = a || window.event;
            if (a.keyCode == 13 || a.which == 13) {
                a.preventDefault();
                return;
            }
            _results.displayResults();
        });
    }

    return {
        initialize: init,
        updateHash: _navigation.updateHash
    };

} (jQuery);

/*
 * Dictionary Object
 * Created by Dean Vigoren - vigoren@ualberta.ca
 */
function Dictionary() {
    this.keys = new Array();
    this.data = new Array();
}

window['Dictionary'] = Dictionary;

Dictionary.prototype.add = function () {
    for (var c = 0; c < arguments.length; c += 2) {
        this.data[arguments[c]] = arguments[c + 1];
        this.keys[this.keys.length] = arguments[c];
    }
};

Dictionary.prototype.lookup = function (key) {
    return (this.data[key]);
};

Dictionary.prototype.length = function () {
    return this.keys.length;
};

Dictionary.prototype.lookupKey = function (index) {
    return this.keys[index];
};

Dictionary.prototype.containsKey = function(key) {
    return !!(this.keys.indexOf(key) > -1);
};

Dictionary.prototype.sortKeys = function () {
    this.keys.sort();
};;
/**
* UAlberta Teaser Data List
* Author: Kyle Schmidt - kyle.schmidt@ualberta.ca
*/

// build namespace
var UAlberta = UAlberta || {};
UAlberta.Sitecore = UAlberta.Sitecore || {};

UAlberta.Sitecore.TeaserDataList = UAlberta.Sitecore.TeaserDataList || (function () {

    function getInstance() {
        return (function ($) {
            'use strict';

            var Data = {
                // options
                options: {
                    isInSidebar: false,
                    cssClassPrefix: "",
                    showDescriptions: false,
                    showDate: false,
                    showImages: false,
                    showSource: false,
                    displayLimit: 5
                }
            },
                AJAX = {
                    // get items from the feed
                    getItems: function (feedUrl) {
                        $.ajax({
                            cache: false,
                            dataType: "json",
                            error: AJAX.Events.error,
                            success: AJAX.Events.success,
                            url: "/api/news/convertfeed.json?feed=" + encodeURIComponent(feedUrl)
                        });
                    },

                    Events: {
                        error: function () {
                            Interface.itemList.find(".loading").remove();
                            Interface.itemList.prepend("<li><p>An error occurred while obtaining the item information. Please refresh the page and try again.</p></li>");
                        },

                        success: function (data) {
                            Interface.showItems(data.Items);
                        }
                    }
                },
                Interface = {
                    itemList: [],             // the item list

                    // setup the interface
                    setup: function (containerId) {
                        Interface.itemList = $("#" + containerId + " > ul");
                    },

                    // show the items
                    showItems: function (items) {
                        Interface.itemList.find(".loading").remove();

                        var bottomRow = Interface.itemList.find(".bottom-row");
                        var bottomRowHtml = $(bottomRow).clone().wrap('<p>').parent().html();

                        bottomRow.remove();

                        for (var i = 0; i < items.length; i++) {
                            if (i >= Data.options.displayLimit) {
                                break;
                            }
                            Interface.addItem(items[i]);
                        }
                        
                        Interface.itemList.append(bottomRowHtml);
                    },

                    // add item to the list
                    addItem: function (item) {
                        // ensure valid item
                        if (item.Title.Content == '' || item.Links.length == 0) {
                            return;
                        }

                        // css prefix
                        var cssPrefix = Data.options.cssClassPrefix == '' ? 'data' : Data.options.cssClassPrefix;

                        // get date and description html
                        var linkHtml = '<div class="list-item-content">';
                        
                        // set title
                        linkHtml += '<h4>' + item.Title.Content + '</h4>';

                        // get date
                        if (Data.options.showDate) {
                            linkHtml += '<p class="list-item-extra">' + Interface.getDate(item) + '</p>';
                        }

                        // show source
                        if (Data.options.showSource && item.SourceFeed != null && item.SourceFeed.Title != null && item.SourceFeed.Title.Content != null) {
                            var title = item.SourceFeed.Title.Content;

                            if (item.SourceFeed.Links != null && item.SourceFeed.Links.length > 0) {
                                title = '<a href="' + item.SourceFeed.Links[0].Uri + '">' + title + '</a>';
                            }
                            
                            linkHtml += '<p class="list-item-extra">' + title + "</p>";
                        }

                        // show description
                        if (Data.options.showDescriptions && (item.Summary.Content != null || item.Content.Content != null)) {
                            var description = item.Summary.Content != null ? item.Summary.Content : item.Content.Content;
                            linkHtml += '<p class="list-item-description">' + description + '</p>';
                        }

                        linkHtml += '</div>';

                        // set inner html
                        var innerHtml = '';

                        // check if the list is not in the sidebar
                        //if (!Data.options.isInSidebar && (Data.options.showDescriptions || Data.options.showDate || Data.options.showImages)) {
                        //    innerHtml = '<h4>' + innerHtml + '</h4>';
                        //}

                        // set image html
                        var imageHtml = '';
                        if (Data.options.showImages) {
                            for (var i = 0; i < item.Links.length; i++) {
                                var link = item.Links[i];
                                if (link.MediaType != null && link.MediaType.toLowerCase().indexOf("image") !== -1) {
                                    imageHtml = '<div class="list-item-image frame">' + '<img src="' + link.Uri + '" /></div>';
                                }
                            }
                        }

                        // set link
                        innerHtml = '<a href="' + Interface.getLink(item) + '">' + imageHtml + linkHtml + '</a>';

                        // add item
                        Interface.itemList.append('<li' + (Data.options.cssClassPrefix == '' ? '' : ' class="' + cssPrefix + '-row"') + '>' + innerHtml +  '</li>');
                    },

                    // get the item link
                    getLink: function (item) {
                        if (item.Links.length > 0) {
                            for (var i = 0; i < item.Links.length; i++) {
                                var link = item.Links[i];
                                if (link.RelationshipType != null && link.RelationshipType.toLowerCase() == "alternate") {
                                    return link.Uri;
                                }
                            }
                            return item.Links[0].Uri;
                        }
                        return '';
                    },

                    // get the item date
                    getDate: function (item) {
                        if (item.GoogleCalendarWhen != null) {
                            return item.GoogleCalendarWhen;
                        }
                        return UAlberta.Sitecore.Utilities.GetDateFromJson(item.PublishDate, UAlberta.Sitecore.Utilities.DateFormat.Short);
                    }
                };

            // instance initialization

            function init(containerId, feedUrl, options) {
                Data.options = $.extend(Data.options, options);
                Interface.setup(containerId);
                AJAX.getItems(feedUrl);
            }

            return {
                Initialize: init
            };
        }(jQuery));
    }

    return {
        GetInstance: getInstance
    };
}());;
(function ($) {
    $(document).ready(function () {

        //Add Modal markup, ensurers it is only added once.
        if ($("#videoModal").length == 0) {
            $("#mainform").append(
                "<div id='videoModal' class='modal hide fade'>" +
                    "<div class='modal-header'>" +
                        "<button type='button' class='close' data-dismiss='modal' aria-hidden='true'>&times;</button>" +
                        "<h3>Video Modal</h3>" +
                    "</div>" +
                    "<div class='modal-body'>" +
                        "<div class='video-mod-container'>" +
                            "<iframe type='text/html' src='' frameborder='0'></iframe>" +
                        "</div>" +
                    "</div>" +
                "</div>");
        }

        $(document).on("click", ".video-modal-link", function () {
            var videoSrc = $(this).attr('href');
            // no modal for mobile
            if ($(window).width() < 690) {
                window.location = $(this).attr('data-mobileurl');
                return;
            }
            $('#videoModal iframe').attr('src', videoSrc);
            $('#videoModal .modal-header h3').text($(this).data('title'));
        });

        $('#videoModal').bind('hidden', function () {
            // clear iframe
            $("#videoModal iframe").attr('src', '');

            // reset other possible containers
            $("#videoModal .video-mod-container").show();
            $("#videoModal .modal-description").remove();
            $("#videoModal .modal-audio").remove();
            $("#videoModal .modal-image").remove();
        });
    });
})(jQuery);
;
/**
* UAlberta Web Service Content
* Author: Kyle Schmidt - kyle.schmidt@ualberta.ca
*/

// build namespace
var UAlberta = UAlberta || {};
UAlberta.Sitecore = UAlberta.Sitecore || {};

UAlberta.Sitecore.WebServiceContent = UAlberta.Sitecore.WebServiceContent || (function () {
    function getInstance() {
        return (function ($) {
            'use strict';

            var AJAX = {
                    // get content from web service
                    getContent: function (webServiceUrl) {
                        // get content from web service
                        $.ajax({
                            dataType: "jsonp",
                            error: AJAX.Events.error,
                            success: AJAX.Events.success,
                            url: webServiceUrl
                        });
                    },

                    Events: {
                        error: function () {
                            Interface.showContent("<p>An error occurred while loading this content. Please refresh the page and try again.</p>");
                        },

                        success: function (content) {
                            Interface.showContent(content);
                        }
                    }
                },

                Interface = {
                    container: [],        // the container
                    loadingSelector: "",  // the selector for the loading spinner

                    // setup the interface
                    setup: function (containerId) {
                        // get interface components
                        Interface.container = $("#" + containerId);
                    },

                    // show content
                    showContent: function (content) {
                        Interface.container.html(content);
                    }
                }
            ;

            // instance initialization
            function init(containerId, webServiceUrl) {
                Interface.setup(containerId);
                AJAX.getContent(webServiceUrl);
            }

            return {
                Initialize: init
            };
        } (jQuery));
    }

    return {
        GetInstance: getInstance
    };
} ());;
/**
 * UAlberta Person Menu
 * Author: Daniel Sanabria
 */

// build namespace
var UAlberta = UAlberta || {};
UAlberta.Sitecore = UAlberta.Sitecore || {};

UAlberta.Sitecore.PersonLayout = function ($) {
    function init() {
        // init

        $(".people-section-nav .navigation-toggle").on('click', function (e) {
            $(this).toggleClass('collapsed');
            $('.people-nav-cont').toggle();
            $('.people-section-nav .navigation-toggle span').html(($(this).hasClass('collapsed') ? 'Show' : 'Hide') + ' Navigation');
            e.stopPropagation();
            return false;
        });

        var navTabs = $('.people-nav li');

        // setActive
        navTabs.click(function () {
            setActive($(this).index());
            return false;
        });

        var setActive = function (i) {

            navTabs.removeClass('active');
            navTabs.eq(i).addClass('active');

            $('.person-section').hide();
            switch (i) {
                case 1:
                    $('.ph-person-courses').show();
                    break;
                case 2:
                    $('.ph-person-activities').show();
                    break;
                case 3:
                    $('.ph-person-publications').show();
                    break;
                case 4:
                    $('.ph-person-events').show();
                    break;
                default:
                    $('.ph-person-home').show();
                    break;
            }

            return false;
        };

        setActive(0);
    }

    return {
        Initialize: init
    };
}(jQuery);;
/**
* UAlberta Person Profile
* Author: Daniel Sanabria - sanabria@ualberta.ca
*/

// build namespace
var UAlberta = UAlberta || {};
UAlberta.Sitecore = UAlberta.Sitecore || {};

UAlberta.Sitecore.PersonProfile = UAlberta.Sitecore.PersonProfile || (function () {
    function getInstance() {
        return (function ($) {
            'use strict';
            var Data = {
                items: [], // items
                itemsPerPage: 10, // items per page
                // Constant values
                Constants: {
                    // Media types
                    Modules: {
                        Publications: "Publications",
                        Courses: "Courses",
                        Scholarly: "Scholarly"
                    }
                }
            },

            AJAX = {
                // get content from web service
                getContent: function (webServiceUrl) {
                    // get content from web service
                    $.ajax({
                        dataType: "json",
                        url: webServiceUrl,
                        error: AJAX.Events.error,
                        success: function (data) {
                            AJAX.Events.success(data);
                        }
                    });
                },

                Events: {
                    error: function (hr, textStatus, errorThrown) {
                        Interface.showContent("<p>An error occurred while loading this content. Please refresh the page and try again.<br>Error: " + errorThrown.text + "</p>");
                    },

                    success: function (data) {
                        Data.items = data;
                        Interface.showItems();
                    }
                }
            },

            Interface = {
                module:"",
                itemsControl: [], // items control
                itemsPagingControl: [], // item paging control
                itemsVisible: [], // the items that can be seen (based on filters), used for paging

                // setup the interface
                setup: function (containerId, module) {
                    // get interface components
                    Interface.module = module;
                    Interface.itemsControl = $("#" + containerId + " #control-items");
                    Interface.itemsPagingControl = $("#" + containerId + " .events-pagination");
                },

                // show items
                showItems: function () {

                    var page = 1;
                    // remove loader
                    Interface.itemsControl.find("li:first").remove();

                    // if no records, show message
                    if (Data.items.length == 0 || Data.items[0].Items == 0) {
                        $("#nav" + Interface.module).hide();
                        return;
                    }

                    if (Interface.module == Data.Constants.Modules.Publications) {
                        // empty the viewable items list
                        Interface.itemsVisible.length = 0;

                        //Sorting Items by Date
                        Data.items[0].Items.sort(function (a, b) {
                            var d1 = Date.parse(a.Date.length == 6 ? a.Date.insert(4, 0, "-") : a.Date.length == 8 ? a.Date.insert(4, 0, "-").insert(7, 0, "-") : a.Date); // "-" is added for parsing
                            var d2 = Date.parse(b.Date.length == 6 ? b.Date.insert(4, 0, "-") : b.Date.length == 8 ? b.Date.insert(4, 0, "-").insert(7, 0, "-") : b.Date);
                            return ((d1 < d2) ? 1 : ((d1 > d2) ? -1 : 0));
                        });

                        // process items
                        for (var x in Data.items[0].Items) {
                            var item = Data.items[0].Items[x];
                            // HACK: Ensure we are only processing actual items
                            if (item.Id == undefined) {
                                continue;
                            }

                            // add item to viewable list
                            Interface.itemsVisible.push(item);
                        }
                    }

                    Interface.showPage(page);
                },

                renderItems: function(child, accordion) {
                    
                    var html = "";
                    
                    if (accordion) {
                        html += "<li><ul class='people-accordion-content'>";
                    } else {
                        html += "<li><ul>";
                    }

                    var dates = "";
                    var fieldsToExclude = ["Term", "Type", "Category"];
                    var booleanFields = ["Instructor", "Coordinator"];
                    for (var k in child.Fields) {
                        if (child.Fields[k] != "" && fieldsToExclude.indexOf(k) == -1) {
                            if (k.toLowerCase().indexOf("title") > -1) {
                                html += "<li><h5>" + child.Fields[k] + "</h5></li>";
                            } else {
                                if (booleanFields.indexOf(k) > -1) {
                                    html += "<li><strong>" + k + "</strong></li>";
                                } else {
                                    if (k.toLowerCase().indexOf("documents and images") > -1) {
                                        var links = Interface.getKeyLinkList(child.Fields[k]);
                                        if (links != "") {
                                            html += "<li><strong>" + k + ": </strong></li>" + links;
                                        }
                                    } else if (child.Fields[k]) {
                                        // Checking if date is valid
                                        if (child.Fields[k].length < 25 && (Interface.isValidDate(child.Fields[k]) || k.toLowerCase().indexOf("date") != -1)) {
                                            var vdate = child.Fields[k].length == 6 ? child.Fields[k].insert(4, 0, "-") :
                                                        child.Fields[k].length == 8 ? child.Fields[k].insert(4, 0, "-").insert(7,0,"-") : child.Fields[k].substr(0, 10);
                                            if (k.toLowerCase().indexOf("start") != -1 || k.toLowerCase().indexOf("end") != -1) {
                                                if (k.toLowerCase().indexOf("start") != -1) dates = vdate;
                                                else if (k.toLowerCase().indexOf("end") != -1) {
                                                    if (dates == "") dates = "\"" + vdate;
                                                    else dates += " to " + vdate;
                                                    html += "<li>" + dates.toString('MMMM d, yyyy') + "</li>";
                                                }
                                            } else {
                                                html += "<li><strong>" + k + ": </strong>" + vdate + "</li>";
                                            }

                                        } else {
                                            if (k.toLowerCase().indexOf("author") > -1) {
                                                html += "<li><strong>" + k + "(s): </strong>" + child.Fields[k] + "</li>";
                                            } else {
                                                if (k.indexOf("Link") != -1) {
                                                    var link = "<a href='" + child.Fields[k] + "' target='_blank'>" + child.Fields[k] + "</a>";
                                                    html += "<li><strong>" + k + ": </strong>" + link + "</li>";
                                                } else {
                                                    if (k.toLowerCase().indexOf("description") != -1 && Interface.module == Data.Constants.Modules.Publications) {
                                                        html += "<li><div class='publication-description'><strong>" + k + ": </strong>" + child.Fields[k] + "</div></li>";
                                                    } else {
                                                        html += "<li><strong>" + k + ": </strong>" + child.Fields[k] + "</li>";
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }

                    html += "</ul></li>";

                    return html;
                },

                // show selected page of items
                showPage: function (page) {
                    
                    Interface.itemsControl.html("");

                    var accordion;
                    var html = "<ul class='accordion-list'>";

                    for (var i in Data.items) {
                        var parent = Data.items[i];

                        if (parent.Items != 0) {

                            accordion = parent.Name != "Items";
                            
                            if (accordion) {
                                html += "<li>";
                                html += "<a>" + parent.Name + "</a>";
                                html += "<a class='accordion-toggle icon-plus'></a>";
                                html += "<ul class='people-accordion'>";
                            } else {
                                html = "<ul class='people-content'>";
                            }

                            if (Interface.module == Data.Constants.Modules.Publications) {
                                for (var j = (parseInt(page) - 1) * Data.itemsPerPage; j < Data.itemsPerPage * page; j++) {
                                    if (parent.Items[j] == undefined) continue;
                                    html += Interface.renderItems(parent.Items[j], accordion);
                                }
                            } else {
                                for (var k in parent.Items) {
                                    if (parent.Items[k] == undefined) continue;
                                    html += Interface.renderItems(parent.Items[k], accordion);
                                }
                            }

                            if (accordion) {
                                html += "</ul></li>";
                            } else {
                                html += "</ul>";
                            }
                        }
                    }

                    Interface.itemsControl.append(html);
                    Interface.itemsControl.find(".accordion-list li:first-child").toggleClass('expanded');
                    Interface.itemsControl.find(".accordion-toggle").click(function () { $(this).parent().toggleClass('expanded'); return false; });
                    Interface.itemsControl.find(".publication-description").shorten({ showChars: 75, moreText: 'read more', lessText: 'read less' });

                    $('.people-section-nav').show();
                    $('.people-nav-cont').show();

                    // show paging
                    Interface.showPaging(page);
                },

                // show paging links
                showPaging: function (page) {
                    // check for empty list
                    if (Interface.itemsVisible.length == 0) {
                        return;
                    }
                    var html = "";
                    // add pages
                    var activePage = parseInt(page);
                    var maxPage = Math.ceil(Interface.itemsVisible.length / Data.itemsPerPage);
                    for (var i = 1; i <= maxPage; i++) {
                        // check for active page
                        if (i == activePage) {
                            html += '<li class="active">' + i + '</li>';
                        } else {
                            html += '<li><a href="javascript:void(null)">' + i + '</a></li>';
                        }
                    }

                    Interface.itemsPagingControl.html("");
                    Interface.itemsPagingControl.append(html);
                    // add click handler
                    Interface.itemsPagingControl.find("a").click(Interface.pageClicked);
                },

                // a page was clicked on, change view to that page
                pageClicked: function () {
                    // show clicked page
                    Interface.showPage($(this).html());
                },

                insert: String.prototype.insert = function( idx, rem, str ) {
                    return (this.slice(0,idx) + str + this.slice(idx + Math.abs(rem)));
                },

                isValidDate: function(dateStr) {
                    var day, month, year;
                    if (dateStr == null || dateStr.length < 8) return false;

                    // Checks for the following valid date formats: YYYY-MM-DD
                    // Also separates date into month, day, and year variables
                    var datePat = /^(\d{4})([\/-])?(\d{1,2})\2?(\d{1,2})$/;

                    var matchArray = dateStr.substring(0,10).match(datePat); // is the format ok?
                    if (matchArray == null) {
                        //console.log("Date must be in YYYY/MM/DD format (" + dateStr + ")");
                        return false;
                    }
                    year = matchArray[1];   // parse date into variables
                    month = matchArray[3]; 
                    day = matchArray[4];
                    if (month < 1 || month > 12) { // check month range
                        //alert("Month must be between 1 and 12");
                        return false;
                    }
                    if (day < 1 || day > 31) {
                        //alert("Day must be between 1 and 31");
                        return false;
                    }
                    if ((month == 4 || month == 6 || month == 9 || month == 11) && day == 31) {
                        //alert("Month " + month + " doesn't have 31 days!");
                        return false;
                    }
                    if (month == 2) { // check for february 29th
                        var isleap = (year % 4 == 0 && (year % 100 != 0 || year % 400 == 0));
                        if (day > 29 || (day == 29 && !isleap)) {
                            //alert("February " + year + " doesn't have " + day + " days!");
                            return false;
                        }
                    }
                    return true;  // date is valid
                },

                getKeyLinkList: function(arrays) {
                    var links = arrays.split('|');
                    var regex = /^\{\w{8}-\w{4}-\w{4}-\w{4}-\w{12}\}$/;
                    var htmlLinks = "";
                    for (var item in links) {
                        var itemId = links[item].replace(/\W/g, '');
                        if (regex.test(links[item])) {
                            htmlLinks += "<li><a href='/-/media/" + itemId + "' target = '_blank' >Document</a></li>";
                        } else {
                            var linksArray = eval('(' + links[item] + ')');
                            htmlLinks += "<li><a href='" + linksArray.URL + "' target = '_blank' >" + linksArray.Title + "</a></li>";
                        }
                    }
                    return htmlLinks;
                },

                error: function () {
                    console.log(content);
                }
            };

            // instance initialization
            function init(containerId, webServiceUrl, module) {
                Interface.setup(containerId, module);
                AJAX.getContent(webServiceUrl);
            }

            return {
                Initialize: init
            };
        }(jQuery));
    }

    return {
        GetInstance: getInstance
    };
}());;
/*
 * jQuery Shorten plugin 1.1.0
 *
 * Copyright (c) 2014 Viral Patel
 * http://viralpatel.net
 *
 * Licensed under the MIT license:
 *   http://www.opensource.org/licenses/mit-license.php
 */

/*
** updated by Jeff Richardson
** Updated to use strict,
** IE 7 has a "bug" It is returning underfined when trying to reference string characters in this format
** content[i]. IE 7 allows content.charAt(i) This works fine in all modern browsers.
** I've also added brackets where they werent added just for readability (mostly for me).
*/

(function ($) {
	$.fn.shorten = function (settings) {
		"use strict";

		var config = {
			showChars: 100,
			ellipsesText: "...",
			moreText: "more",
			lessText: "less",
			errMsg: null,
			force: false
		};

		if (settings) {
			$.extend(config, settings);
		}

		if ($(this).data('jquery.shorten') && !config.force) {
			return false;
		}
		$(this).data('jquery.shorten', true);

		$(document).off("click", '.morelink');

		$(document).on({
			click: function () {

				var $this = $(this);
				if ($this.hasClass('less')) {
					$this.removeClass('less');
					$this.html(config.moreText);
					$this.parent().prev().prev().show(); // shortcontent
					$this.parent().prev().hide(); // allcontent

				} else {
					$this.addClass('less');
					$this.html(config.lessText);
					$this.parent().prev().prev().hide(); // shortcontent
					$this.parent().prev().show(); // allcontent
				}
				return false;
			}
		}, '.morelink');

		return this.each(function () {
			var $this = $(this);

			var content = $this.html();
			var contentlen = $this.text().length;
			if (contentlen > config.showChars) {
				var c = content.substr(0, config.showChars);
				if (c.indexOf('<') >= 0) // If there's HTML don't want to cut it
				{
					var inTag = false; // I'm in a tag?
					var bag = ''; // Put the characters to be shown here
					var countChars = 0; // Current bag size
					var openTags = []; // Stack for opened tags, so I can close them later
					var tagName = null;

					for (var i = 0, r = 0; r <= config.showChars; i++) {
						if (content[i] == '<' && !inTag) {
							inTag = true;

							// This could be "tag" or "/tag"
							tagName = content.substring(i + 1, content.indexOf('>', i));

							// If its a closing tag
							if (tagName[0] == '/') {


								if (tagName != '/' + openTags[0]) {
									config.errMsg = 'ERROR en HTML: the top of the stack should be the tag that closes';
								} else {
									openTags.shift(); // Pops the last tag from the open tag stack (the tag is closed in the retult HTML!)
								}

							} else {
								// There are some nasty tags that don't have a close tag like <br/>
								if (tagName.toLowerCase() != 'br') {
									openTags.unshift(tagName); // Add to start the name of the tag that opens
								}
							}
						}
						if (inTag && content[i] == '>') {
							inTag = false;
						}

						if (inTag) { bag += content.charAt(i); } // Add tag name chars to the result
						else {
							r++;
							if (countChars <= config.showChars) {
								bag += content.charAt(i); // Fix to ie 7 not allowing you to reference string characters using the []
								countChars++;
							} else // Now I have the characters needed
							{
								if (openTags.length > 0) // I have unclosed tags
								{
									//console.log('They were open tags');
									//console.log(openTags);
									for (j = 0; j < openTags.length; j++) {
										//console.log('Cierro tag ' + openTags[j]);
										bag += '</' + openTags[j] + '>'; // Close all tags that were opened

										// You could shift the tag from the stack to check if you end with an empty stack, that means you have closed all open tags
									}
									break;
								}
							}
						}
					}
					c = $('<div/>').html(bag + '<span class="ellip">' + config.ellipsesText + '</span>').html();
				} else {
					c += config.ellipsesText;
				}

				var html = '<div class="shortcontent">' + c +
                    '</div><div class="allcontent">' + content +
                    '</div><span><a href="javascript://nop/" class="morelink">' + config.moreText + '</a></span>';

				$this.html(html);
				$this.find(".allcontent").hide(); // Hide all text
				$('.shortcontent p:last', $this).css('margin-bottom', 0); //Remove bottom margin on last paragraph as it's likely shortened
			}
		});

	};

})(jQuery);;
