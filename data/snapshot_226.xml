<?xml version="1.0" encoding="utf-8"?>
<HTTPSnapshot xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" id="226">
  <HTTPTask id="6102" hostname="graduate-studies-apply-uat.ualberta.ca" path="https://graduate-studies-apply-uat.ualberta.ca/urd/sits.urd/run/siw_portal.url?29DC62E3DA1B4844wQ2KqzVxfh5Q_ivAwW3s8gReLnlksVBFj8e8Q8oMRQj0CWCSaFT5H1ht7-_R5243MobTdWPWkoiq8szCXAOLikwt6Nte42NT2T6EmFd9k9Y" url="https://graduate-studies-apply-uat.ualberta.ca/urd/sits.urd/run/siw_portal.url?29DC62E3DA1B4844wQ2KqzVxfh5Q_ivAwW3s8gReLnlksVBFj8e8Q8oMRQj0CWCSaFT5H1ht7-_R5243MobTdWPWkoiq8szCXAOLikwt6Nte42NT2T6EmFd9k9Y" ip="129.128.12.49" port="443" connectionId="52" origin="Primary" frame="1" startDateTime="2019-01-02T11:43:29.412-05:00" startTime="1085862046" endTime="1085862062">
    <QueryString>
      <HTTPDataSet>
        <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
          <ActualData>MjlEQzYyRTNEQTFCNDg0NHdRMktxelZ4Zmg1UV9pdkF3VzNzOGdSZUxubGtzVkJGajhlOFE4b01SUWowQ1dDU2FGVDVIMWh0Ny1fUjUyNDNNb2JUZFdQV2tvaXE4c3pDWEFPTGlrd3Q2TnRlNDJOVDJUNkVtRmQ5azlZ</ActualData>
        </HTTPData>
      </HTTPDataSet>
      <IsExternalData>false</IsExternalData>
    </QueryString>
    <HTTPSplittedQueryStrings>
      <HTTPHeaderEntity name="" index="0">
        <HTTPDataSet>
          <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
            <ActualData>MjlEQzYyRTNEQTFCNDg0NHdRMktxelZ4Zmg1UV9pdkF3VzNzOGdSZUxubGtzVkJGajhlOFE4b01SUWowQ1dDU2FGVDVIMWh0Ny1fUjUyNDNNb2JUZFdQV2tvaXE4c3pDWEFPTGlrd3Q2TnRlNDJOVDJUNkVtRmQ5azlZ</ActualData>
          </HTTPData>
        </HTTPDataSet>
        <IsExternalData>false</IsExternalData>
      </HTTPHeaderEntity>
    </HTTPSplittedQueryStrings>
    <HTTPRequest method="GET">
      <HTTPHeaders>
        <HTTPHeaderEntity name="User-Agent" index="0">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>TW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV09XNjQ7IHJ2OjY0LjApIEdlY2tvLzIwMTAwMTAxIEZpcmVmb3gvNjQuMA==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept" index="1">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>dGV4dC9odG1sLGFwcGxpY2F0aW9uL3hodG1sK3htbCxhcHBsaWNhdGlvbi94bWw7cT0wLjksKi8qO3E9MC44</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept-Language" index="2">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>ZW4tR0IsZW47cT0wLjU=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept-Encoding" index="3">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Z3ppcCwgZGVmbGF0ZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Referer" index="4">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>aHR0cHM6Ly9ncmFkdWF0ZS1zdHVkaWVzLWFwcGx5LXVhdC51YWxiZXJ0YS5jYS91cmQvc2l0cy51cmQvcnVuL1NJV19MR04=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="DNT" index="5">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>MQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Cookie" index="6">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>RVZJU0lPTkxPR0lOTEFORz07IEVWSVNJT05MT0dJTkhUVj07IEVWSVNJT05JRD03ODFCRkEyMzJERkE0MDFBQjQ4MUYzQ0Y1QzYxRDZDMDsgSlNFU1NJT05JRD0xRDdCNDYzNTkyMDU1RTU3ODhEQTAwMjcxNzk2OEJGRDsgQklHaXBTZXJ2ZXJTSVRTQVBQLVVBVC1IVFRQLmFwcH5TSVRTQVBQLVVBVC1IVFRQX3Bvb2w9MTA5Mjc1NDA5Mi4zNjg5NS4wMDAwOyBCSUdpcFNlcnZlclNoYXJlZElJUy1VQVQ9NzU3MjA5NzcyLjIwNDgwLjAwMDA=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Upgrade-Insecure-Requests" index="7">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>MQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Host" index="8">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Z3JhZHVhdGUtc3R1ZGllcy1hcHBseS11YXQudWFsYmVydGEuY2E=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPAllHeaders>
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>R0VUIGh0dHBzOi8vZ3JhZHVhdGUtc3R1ZGllcy1hcHBseS11YXQudWFsYmVydGEuY2EvdXJkL3NpdHMudXJkL3J1bi9zaXdfcG9ydGFsLnVybD8yOURDNjJFM0RBMUI0ODQ0d1EyS3F6VnhmaDVRX2l2QXdXM3M4Z1JlTG5sa3NWQkZqOGU4UThvTVJRajBDV0NTYUZUNUgxaHQ3LV9SNTI0M01vYlRkV1BXa29pcThzekNYQU9MaWt3dDZOdGU0Mk5UMlQ2RW1GZDlrOVkgSFRUUC8xLjENClVzZXItQWdlbnQ6IE1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdPVzY0OyBydjo2NC4wKSBHZWNrby8yMDEwMDEwMSBGaXJlZm94LzY0LjANCkFjY2VwdDogdGV4dC9odG1sLGFwcGxpY2F0aW9uL3hodG1sK3htbCxhcHBsaWNhdGlvbi94bWw7cT0wLjksKi8qO3E9MC44DQpBY2NlcHQtTGFuZ3VhZ2U6IGVuLUdCLGVuO3E9MC41DQpBY2NlcHQtRW5jb2Rpbmc6IGd6aXAsIGRlZmxhdGUNClJlZmVyZXI6IGh0dHBzOi8vZ3JhZHVhdGUtc3R1ZGllcy1hcHBseS11YXQudWFsYmVydGEuY2EvdXJkL3NpdHMudXJkL3J1bi9TSVdfTEdODQpETlQ6IDENCkNvb2tpZTogRVZJU0lPTkxPR0lOTEFORz07IEVWSVNJT05MT0dJTkhUVj07IEVWSVNJT05JRD03ODFCRkEyMzJERkE0MDFBQjQ4MUYzQ0Y1QzYxRDZDMDsgSlNFU1NJT05JRD0xRDdCNDYzNTkyMDU1RTU3ODhEQTAwMjcxNzk2OEJGRDsgQklHaXBTZXJ2ZXJTSVRTQVBQLVVBVC1IVFRQLmFwcH5TSVRTQVBQLVVBVC1IVFRQX3Bvb2w9MTA5Mjc1NDA5Mi4zNjg5NS4wMDAwOyBCSUdpcFNlcnZlclNoYXJlZElJUy1VQVQ9NzU3MjA5NzcyLjIwNDgwLjAwMDANClVwZ3JhZGUtSW5zZWN1cmUtUmVxdWVzdHM6IDENCkhvc3Q6IGdyYWR1YXRlLXN0dWRpZXMtYXBwbHktdWF0LnVhbGJlcnRhLmNhDQoNCg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPAllHeaders>
        <HTTPCookies>
          <HTTPHeaderEntity name="EVISIONLOGINLANG" index="0">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData />
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="EVISIONLOGINHTV" index="1">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData />
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="EVISIONID" index="2">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>NzgxQkZBMjMyREZBNDAxQUI0ODFGM0NGNUM2MUQ2QzA=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="JSESSIONID" index="3">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>MUQ3QjQ2MzU5MjA1NUU1Nzg4REEwMDI3MTc5NjhCRkQ=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="BIGipServerSITSAPP-UAT-HTTP.app~SITSAPP-UAT-HTTP_pool" index="4">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>MTA5Mjc1NDA5Mi4zNjg5NS4wMDAw</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="BIGipServerSharedIIS-UAT" index="5">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>NzU3MjA5NzcyLjIwNDgwLjAwMDA=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
        </HTTPCookies>
      </HTTPHeaders>
    </HTTPRequest>
    <HTTPResponse>
      <contentLenght>9598</contentLenght>
      <HTTPHeaders>
        <HTTPHeaderEntity name="Cache-Control" index="0">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>bm8tc3RvcmUsIG5vLWNhY2hlLCBtdXN0LXJldmFsaWRhdGU=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Content-Type" index="1">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>dGV4dC9odG1sO2NoYXJzZXQ9VVRGLTg=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Expires" index="2">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>VGh1LCAwMSBKYW4gMTk3MCAwMDowMDowMCBHTVQ=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="X-Frame-Options" index="3">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>ZGVueQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="X-Content-Type-Options" index="4">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>bm9zbmlmZg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="X-XSS-Protection" index="5">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>MTsgbW9kZT1ibG9jaw==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="X-Powered-By" index="6">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>QVJSLzMuMCxBU1AuTkVU</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Date" index="7">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>V2VkLCAwMiBKYW4gMjAxOSAxNjo0MzowNyBHTVQ=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Content-Length" index="8">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>OTU5OA==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Vary" index="9">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>QWNjZXB0LUVuY29kaW5n</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Content-Encoding" index="10">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Z3ppcA==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Connection" index="11">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>S2VlcC1BbGl2ZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPAllHeaders>
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>SFRUUC8xLjEgMjAwIE9LDQpDYWNoZS1Db250cm9sOiBuby1zdG9yZSwgbm8tY2FjaGUsIG11c3QtcmV2YWxpZGF0ZQ0KQ29udGVudC1UeXBlOiB0ZXh0L2h0bWw7Y2hhcnNldD1VVEYtOA0KRXhwaXJlczogVGh1LCAwMSBKYW4gMTk3MCAwMDowMDowMCBHTVQNClgtRnJhbWUtT3B0aW9uczogZGVueQ0KWC1Db250ZW50LVR5cGUtT3B0aW9uczogbm9zbmlmZg0KWC1YU1MtUHJvdGVjdGlvbjogMTsgbW9kZT1ibG9jaw0KWC1Qb3dlcmVkLUJ5OiBBUlIvMy4wLEFTUC5ORVQNCkRhdGU6IFdlZCwgMDIgSmFuIDIwMTkgMTY6NDM6MDcgR01UDQpDb250ZW50LUxlbmd0aDogOTU5OA0KVmFyeTogQWNjZXB0LUVuY29kaW5nDQpDb250ZW50LUVuY29kaW5nOiBnemlwDQpDb25uZWN0aW9uOiBLZWVwLUFsaXZlDQoNCg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPAllHeaders>
      </HTTPHeaders>
      <HTTPBody>
        <HTTPDataSet>
          <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
            <ActualData>PCEtLSBzdGFydCBvZiBIVE1MIGZyb20gYm9keS1zdGFydC10YWJzLmh0cyAgLS0+DQo8IURPQ1RZUEUgaHRtbD4NCjxodG1sIGxhbmc9ImVuLWdiIj4NCiAgPGhlYWQ+DQoNCiAgICA8bWV0YSBjaGFyc2V0PSJ1dGYtOCI+DQogICAgPG1ldGEgaHR0cC1lcXVpdj0iWC1VQS1Db21wYXRpYmxlIiBjb250ZW50PSJJRT1lZGdlIj4NCiAgICA8bWV0YSBuYW1lPSJ2aWV3cG9ydCIgY29udGVudD0id2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEiPg0KICAgIDxtZXRhIG5hbWU9ImZvcm1hdC1kZXRlY3Rpb24iIGNvbnRlbnQ9InRlbGVwaG9uZT1ubyI+DQoNCgk8bGluayByZWw9InNob3J0Y3V0IGljb24iIGhyZWY9Ii4uL2Nzcy91b2FfZmlsZXMvaWNvL2Zhdmljb24uaWNvIj4NCg0KICAgIDx0aXRsZT5lOlZpc2lvbiBQb3J0YWw8L3RpdGxlPg0KDQogICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi9jc3Mvc2l0cy5jc3MiPg0KICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iLi4vY3NzL3N2LmNzcyI+DQogICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi9wbHVnaW5zL2Nzcy91aS9zaXRzLXVpLmNzcyI+DQogICAgPCEtLSBBZGRpdGlvbmFsIHN0eWxlIGZvciBBZG1pc3Npb25zIGJ1dHRvbnMgLSB0ZW1wb3JhcnkgdW50aWwgZnVsbCByZXNwb25zaXZlIHJldmlldyBwcm9qZWN0IC0tPg0KICAgIDxzdHlsZT4NCiAgICAgICAgLnN2LWJ0bi1hZG0gew0KICAgICAgICAgICAgdGV4dC10cmFuc2Zvcm06IHVwcGVyY2FzZTsNCiAgICAgICAgICAgIGZvbnQtd2VpZ2h0OiA2MDAgIWltcG9ydGFudDsNCiAgICAgICAgfQ0KICAgIDwvc3R5bGU+CQ0KDQogICAgPCEtLSBIVE1MNSBzaGltIGFuZCBSZXNwb25kLmpzIGZvciBJRTggc3VwcG9ydCBvZiBIVE1MNSBlbGVtZW50cyBhbmQgbWVkaWEgcXVlcmllcyAtLT4NCiAgICA8IS0tIFdBUk5JTkc6IFJlc3BvbmQuanMgZG9lc24ndCB3b3JrIGlmIHlvdSB2aWV3IHRoZSBwYWdlIHZpYSBmaWxlOi8vIC0tPg0KICAgIDwhLS1baWYgbHQgSUUgOV0+DQogICAgICA8c2NyaXB0IHNyYz0iLi4vcGx1Z2lucy9qYXZhc2NyaXB0L2h0bWw1c2hpdi5taW4uanMiPjwvc2NyaXB0Pg0KICAgICAgPHNjcmlwdCBzcmM9Ii4uL3BsdWdpbnMvamF2YXNjcmlwdC9yZXNwb25kLm1pbi5qcyI+PC9zY3JpcHQ+DQogICAgPCFbZW5kaWZdLS0+DQoNCg0KICAgIDxzY3JpcHQgc3JjPSIuLi9wbHVnaW5zL2phdmFzY3JpcHQvanF1ZXJ5LmpzP3Y9OTEwLjEiPjwvc2NyaXB0Pg0KICAgIDxzY3JpcHQgc3JjPSIuLi9wbHVnaW5zL2phdmFzY3JpcHQvanF1ZXJ5LXVpLmpzP3Y9OTEwLjEiPjwvc2NyaXB0Pg0KDQogICAgPHNjcmlwdCBzcmM9Ii4uL3BsdWdpbnMvamF2YXNjcmlwdC9zdi5taW4uanM/dj05MTAuMSI+PC9zY3JpcHQ+DQoNCiAgICA8c2NyaXB0IHNyYz0iLi4vamF2YXNjcmlwdC9zZXR0aW5ncy5qcz92PTg4MS4yIj48L3NjcmlwdD4NCgk8c2NyaXB0IHNyYz0iLi4vamF2YXNjcmlwdC9zaXRzX2FqYXguanM/dj04ODEuMiI+PC9zY3JpcHQ+DQogIA0KICAgIDxzY3JpcHQgc3JjPSIuLi9wbHVnaW5zL2phdmFzY3JpcHQvdGFibGVzYXcvdGFibGVzYXcubWluLmpzP3Y9OTMwLjEiPjwvc2NyaXB0Pg0KICAgIDxzY3JpcHQgc3JjPSIuLi9wbHVnaW5zL2phdmFzY3JpcHQvZGF0YXRhYmxlcy9tZWRpYS9qcy9qcXVlcnkuZGF0YVRhYmxlcy5qcyI+PC9zY3JpcHQ+DQogCTxzY3JpcHQgc3JjPSIuLi9wbHVnaW5zL2phdmFzY3JpcHQvZGF0YXRhYmxlcy9tZWRpYS9qcy9kYXRhVGFibGVzLnRyaWJhbC5qcyI+PC9zY3JpcHQ+ICANCiANCg0KCSAgPHNjcmlwdD4NCgkJICBmdW5jdGlvbiB1U3VibWl0KCl7fSAvL2luY2x1ZGUgZHVtbXkgZnVuY3Rpb24gdG8gcHJldmVudCBlcnJvcnMgd2hlbiBzdWJtaXR0aW5nDQoJICA8L3NjcmlwdD4NCg0KDQo8IS0tW2lmIGx0IElFIDddPjxzY3JpcHQ+DQp2YXIgcm9vdCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDsNCnJvb3QuY2xhc3NOYW1lICs9ICIgbHQtaWUxMCI7DQpyb290LmNsYXNzTmFtZSArPSAiIGx0LWllOSI7DQpyb290LmNsYXNzTmFtZSArPSAiIGx0LWllOCI7DQpyb290LmNsYXNzTmFtZSArPSAiIGx0LWllNyI7DQo8L3NjcmlwdD48IVtlbmRpZl0tLT4NCjwhLS1baWYgSUUgN10+PHNjcmlwdD4NCnZhciByb290ID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50Ow0Kcm9vdC5jbGFzc05hbWUgKz0gIiBsdC1pZTEwIjsNCnJvb3QuY2xhc3NOYW1lICs9ICIgbHQtaWU5IjsNCnJvb3QuY2xhc3NOYW1lICs9ICIgbHQtaWU4IjsNCnJvb3QuY2xhc3NOYW1lICs9ICIgaWU3IjsNCjwvc2NyaXB0PjwhW2VuZGlmXS0tPg0KPCEtLVtpZiBJRSA4XT48c2NyaXB0Pg0KdmFyIHJvb3QgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQ7DQpyb290LmNsYXNzTmFtZSArPSAiIGx0LWllMTAiOw0Kcm9vdC5jbGFzc05hbWUgKz0gIiBsdC1pZTkiOw0Kcm9vdC5jbGFzc05hbWUgKz0gIiBpZTgiOw0KPC9zY3JpcHQ+PCFbZW5kaWZdLS0+DQo8IS0tW2lmIElFIDldPjxzY3JpcHQ+DQp2YXIgcm9vdCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDsNCnJvb3QuY2xhc3NOYW1lICs9ICIgbHQtaWUxMCI7DQpyb290LmNsYXNzTmFtZSArPSAiIGllOSI7DQo8L3NjcmlwdD48IVtlbmRpZl0tLT4NCjwhLS1baWYgSUUgMTBdPjxzY3JpcHQ+DQp2YXIgcm9vdCA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDsNCnJvb3QuY2xhc3NOYW1lICs9ICIgaWUxMCI7DQo8L3NjcmlwdD48IVtlbmRpZl0tLT4NCg0KDQoJPCEtLSBUaGUgSGVhZCBTY3JpcHRzOiBNT0RFUk5JWlIgT05MWSEtLT4NCgk8c2NyaXB0IHNyYz0iLi4vY3NzL3VvYV9maWxlcy9pbmRleF9maWxlcy9tb2Rlcm5penIubWluLmpzIj48L3NjcmlwdD4NCgk8c2NyaXB0Pighd2luZG93Lk1vZGVybml6cil8fGRvY3VtZW50LndyaXRlKCc8c2NyaXB0IHNyYz0iLi4vY3NzL3VvYV9maWxlcy9pbmRleF9maWxlcy9tb2Rlcm5penIuanMiPjxcL3NjcmlwdD4nKTs8L3NjcmlwdD4NCg0KDQo8IS0tIFN5c3RlbSBXaWRlIEVycm9yIE1lc3NhZ2luZyAtLT4NCjxsaW5rIG1lZGlhPSJhbGwiIGhyZWY9Ii4uL2Nzcy9zaXdfeW1lcy5jc3MiIHJlbD0ic3R5bGVzaGVldCIgdHlwZT0idGV4dC9jc3MiIC8+DQoNCjwhLS0gQWxiZXJ0YSBGb3VuZGF0aW9uIFN0eWxlU2hlZXQgLS0+DQo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL2Nzcy91b2FfZmlsZXMvY3NzL2ZyYW1ld29yay5jc3MiIG1lZGlhPSJzY3JlZW4iPg0KPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSIuLi9jc3MvdW9hX2ZpbGVzL2Nzcy9mcmFtZXdvcmstaWUuY3NzIiBtZWRpYT0ic2NyZWVuIj4NCg0KPCEtLSBBYmVydGEgU3lzdGVtIE92ZXJyaWRlIFN0eWxlU2hlZXQgLS0+DQo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL2Nzcy91b2Etc2l0cy5jc3MiIG1lZGlhPSJzY3JlZW4iPg0KDQo8IS0tIFRoZSBQcmludCBTaGVldHMgLS0+DQo8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii4uL2Nzcy91b2FfZmlsZXMvY3NzL3ByaW50LmNzcyIgbWVkaWE9InByaW50Ij4NCg0KPCEtLSBhbnkgcmVxdWlyZWQgcGFnZSBoZWFkZXIgaHRtbCBzaG91bGQgZ28gaGVyZSwgaW4gcGxhY2Ugb2YgdGhpcyBkZWZhdWx0IFNJVFMgaGVhZGVyIEhUTUwuDQogICAgIEl0IGlzIGdvb2QgcHJhY3RpY2UgdG8gdXNlICdjbGFzcz0ic2l0c3NjcmVlbm9ubHkiIG9uIGFueSBoZWFkZXIgaW1hZ2VzDQogICAgIHdoaWNoIHdvdWxkIG5vdCBiZSByZXF1aXJlZCBpbiBhIHByaW50ZWQgdmVyc2lvbiBvZiB0aGUgcGFnZS4NCiAtLT4NCjwhLS0gb3ZlcmFsbCBwYWdlIERJViAtLT4NCg0KPGhlYWRlcj4gICAgICAgICAgIA0KCTxkaXYgY2xhc3M9ImJsYWRlLWNvbnRhaW5lciIgc3R5bGU9ImhlaWdodDogNGVtOyI+DQogICAgPGRpdiBjbGFzcz0iYmxhZGUtaW5uZXIiPg0KICAgICAgICA8YSBjbGFzcz0iYnJhbmQiIGhyZWY9Imh0dHA6Ly91b2ZhLnVhbGJlcnRhLmNhLyI+DQogICAgICAgICAgICA8aW1nIHNyYz0iLi4vY3NzL3VvYV9maWxlcy9pbWcvbG9nbzIuc3ZnIiBhbHQ9IlVuaXZlcnNpdHkgb2YgQWxiZXJ0YSI+DQoJCTwvYT4NCiAgICAgICAgPG5hdiBjbGFzcz0iYmxhZGUtbmF2aWdhdGlvbiI+DQogICAgICAgICAgICA8dWwgY2xhc3M9InF1aWNrLWxpbmtzLWNvbnRhaW5lciI+DQogICAgICAgICAgICAgICAgPGxpIGlkPSJxbCIgY2xhc3M9ImRyb3Bkb3duIj4NCiAgICAgICAgICAgICAgICAgICAgPGEgaHJlZj0iaHR0cHM6Ly90cmFpbmluZy5zaXRlY29yZS51YWxiZXJ0YS5jYS9kZXBhcnRtZW50cy9hbm90aGVyLWRlcGFydG1lbnQjIiBpZD0icWwtdG9nZ2xlIiBjbGFzcz0iYnRuIGJ0bi1ncmV5IGJ0bi1zbWFsbCBoaWRkZW4tZGVza3RvcCIgZGF0YS10b2dnbGU9ImRyb3Bkb3duIj4NCiAgICAgICAgICAgICAgICAgICAgICAgIDxzcGFuIGNsYXNzPSJxdWljay1saW5rcy10ZXh0Ij5RdWljayBMaW5rcyA8YiBjbGFzcz0iY2FyZXQiPjwvYj4gICAgICAgICAgICAgICAgICAgICAgICA8L3NwYW4+DQogICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0iaWNvbi1iYXIgcXVpY2stbGlua3MtYnV0dG9uIj48L3NwYW4+DQogICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0iaWNvbi1iYXIgcXVpY2stbGlua3MtYnV0dG9uIj48L3NwYW4+DQogICAgICAgICAgICAgICAgICAgICAgICA8c3BhbiBjbGFzcz0iaWNvbi1iYXIgcXVpY2stbGlua3MtYnV0dG9uIj48L3NwYW4+DQogICAgICAgICAgICAgICAgICAgIDwvYT4NCiAgICAgICAgICAgICAgICAgICAgPHVsIGNsYXNzPSJxdWljay1saW5rcyIgcm9sZT0ibWVudSIgYXJpYS1sYWJlbGxlZGJ5PSJxbC10b2dnbGUiPg0KICAgICAgICAgICAgICAgICAgICAJPGxpIHJvbGU9Im1lbnVpdGVtIj48YSBocmVmPSJodHRwOi8vd2ViYXBwcy5zcnYudWFsYmVydGEuY2Evc2VhcmNoLyIgdGFyZ2V0PSIiPkZpbmQgYSBQZXJzb248L2E+PC9saT4NCiAgICAgICAgICAgICAgICAgICAgICAgPGxpIHJvbGU9Im1lbnVpdGVtIj48YSBocmVmPSJodHRwOi8vb25lY2FyZC51YWxiZXJ0YS5jYS8iIHRhcmdldD0iIj5PTkVjYXJkPC9hPjwvbGk+DQogICAgICAgICAgICAgICAgICAgICAgIDxsaSByb2xlPSJtZW51aXRlbSI+PGEgaHJlZj0iaHR0cHM6Ly93d3cuYmVhcnRyYWNrcy51YWxiZXJ0YS5jYS8iIHRhcmdldD0iIj5CZWFyIFRyYWNrczwvYT48L2xpPg0KICAgICAgICAgICAgICAgICAgICAgICA8bGkgcm9sZT0ibWVudWl0ZW0iPjxhIGhyZWY9Imh0dHA6Ly93d3cuY2FtcHVzbWFwLnVhbGJlcnRhLmNhLyIgdGFyZ2V0PSIiPk1hcHM8L2E+PC9saT4NCiAgICAgICAgICAgICAgICAgICAgICAgPGxpIHJvbGU9Im1lbnVpdGVtIj48YSBocmVmPSJodHRwOi8vYXBwcy51YWxiZXJ0YS5jYS8iIHRhcmdldD0iIj5FbWFpbCAmYW1wOyBBcHBzPC9hPjwvbGk+DQogICAgICAgICAgICAgICAgICAgICAgIDxsaSByb2xlPSJtZW51aXRlbSI+PGEgaHJlZj0iaHR0cHM6Ly9lY2xhc3Muc3J2LnVhbGJlcnRhLmNhL3BvcnRhbC8iIHRhcmdldD0iIj5lQ2xhc3M8L2E+PC9saT4NCiAgICAgICAgICAgICAgICAgICAgICAgPGxpIHJvbGU9Im1lbnVpdGVtIj48YSBocmVmPSJodHRwOi8vd3d3LmxpYnJhcnkudWFsYmVydGEuY2EvIiB0YXJnZXQ9IiI+TGlicmFyaWVzPC9hPjwvbGk+DQogICAgICAgICAgICAgICAgICAgIDwvdWw+DQogICAgICAgICAgICAgICAgICAgPC9saT4gICAgICAgICAgICANCgkJCTwvdWw+ICAgICAgICANCgkJPC9uYXY+ICAgICAgICANCgkJPGRpdiBjbGFzcz0iYmxhZGUtc2VhcmNoIj4NCiAgICAgICAgICAgIDxpIGNsYXNzPSJpY29uLXNlYXJjaCI+PC9pPg0KICAgICAgICAgICAgPGlucHV0IHR5cGU9InNlYXJjaCIgY2xhc3M9InNlYXJjaC1xdWVyeSIgcGxhY2Vob2xkZXI9InNlYXJjaCI+DQogICAgICAgICAgICA8YnV0dG9uIHR5cGU9ImJ1dHRvbiIgY2xhc3M9ImJ0biBidG4tZ3JleSBidG4tc21hbGwgZ2xvYmFsLXNlYXJjaC1idG4iPlNlYXJjaDwvYnV0dG9uPg0KICAgICAgICA8L2Rpdj4NCiAgICA8L2Rpdj4NCgk8L2Rpdj4NCgk8ZGl2IGNsYXNzPSJiYW5uZXItY29udGFpbmVyIj4NCgkJPGRpdiBjbGFzcz0iYmFubmVyLWlubmVyIj4NCgkJCTxhIGhyZWY9Imh0dHA6Ly91b2ZhLnVhbGJlcnRhLmNhLyIgY2xhc3M9InNpdGUtdGl0bGUiPkZhY3VsdHkgb2YgR3JhZHVhdGUgU3R1ZGllcyBhbmQgUmVzZWFyY2g8L2E+DQoJCQk8cCBzdHlsZT0id2lkdGg6IDEwMCU7IGNvbG9yOiByZWQ7IGZvbnQtc2l6ZTogMjRweDsgZm9udC13ZWlnaHQ6IGJvbGQ7IGJhY2tncm91bmQtY29sb3I6IHdoaXRlOyI+VXNlciAvIEFjY2VwdGFuY2UgVGVzdGluZyBlbnZpcm9ubWVudCAtIG5vdCBQcm9kdWN0aW9uPC9wPg0KCQkJPGRpdiBjbGFzcz0iYmFubmVyLWxvZ28iPg0KCQkJCTxzcGFuIGNsYXNzPSJzaXRlLWxvZ28iPjwvc3Bhbj4JCQkJDQoJCQk8L2Rpdj4NCgkJPC9kaXY+DQoJCTxkaXYgY2xhc3M9Im92YWwgb3ZhbDEiPjwvZGl2Pg0KCQk8ZGl2IGNsYXNzPSJvdmFsIG92YWwyIj48L2Rpdj4NCgkJPGRpdiBjbGFzcz0ib3ZhbCBvdmFsMyI+PC9kaXY+DQoJCTxkaXYgY2xhc3M9Im92YWwgb3ZhbDQiPjwvZGl2Pg0KCTwvZGl2Pg0KCTxkaXYgY2xhc3M9Im5hdmlnYXRpb24tY29udGFpbmVyIj4NCgkJPG5hdiBpZD0ibWFpbi1uYXYiIGNsYXNzPSJuYXZpZ2F0aW9uLWlubmVyIj4NCgkJCTx1bD4NCgkJCQk8bGk+DQoJCQkJCTxhIGNsYXNzPSJuYXZpZ2F0aW9uLXRvZ2dsZSBjb2xsYXBzZWQiPjxzcGFuPlNob3cgTmF2aWdhdGlvbjwvc3Bhbj48aSBjbGFzcz0iaWNvbi10b2dnbGUtbmF2Ij48L2k+DQoJCQkJCTwvYT4NCgkJCQkJPHVsIGlkPSJuYXYtbGlzdCIgY2xhc3M9Im1haW4tbmF2aWdhdGlvbiBoaWRkZW4tcGhvbmUgY29sbGFwc2UiIHN0eWxlPSJoZWlnaHQ6IDBweDsiPg0KCQkJCQkJPCEtLSBUaGUgVGFiIGxpc3QgZmllbGQgY29udGFpbnMgZWFjaCBwYWdlIHRhYiBhcyBhIGxpIGl0ZW0sIGNoaWxkIHBhZ2UgdGFicyB3aWxsIGNyZWF0ZSBhIG5ldyB1bCB3aXRoaW4gdGhlIG91dGVyIHVsIC0tPg0KCQkJCQkJPGxpIGNsYXNzPSJuYXYtY3VycmVudCIgPg0KPGEgaHJlZj0ic2l3X3BvcnRhbC51cmw/QkQ2OUJDRjkzOEZFNEJCQ1RZOElkQWJERlVQRXpQVWcwZGwwcXItN3N6Wm9XNjZhbnRhSUxvVzEtZW9VbF9zc0hRQlY3Y1kyT0FHX1l4VzdLWnFoRk1aampGWGNPOFBoNk05eFlidjZZRTE3TkotYm1Wc3dIYmphTFdFIiBpZD0iR1NXRkwwMSIgdGl0bGU9Ik1hbmFnZSBBcHBsaWNhdGlvbnMiPjxzcGFuPkFkbWlzc2lvbnM8L3NwYW4+PC9hPg0KDQo8L2xpPg0KPGxpIGNsYXNzPSJub3JtYWx0YWIiID4NCjxhIGhyZWY9InNpd19wb3J0YWwudXJsPzUzN0VFRUJGNjZCRDRBQTRYcG1lb2xTUDNLQ21oaFQtTmJnNGM5M195ek9lYlczSjRybTBoaDNwTXZrR2xaRjdpS2NFeWZRanhzOGU5bkN1bENaTGI5ZFVEUFVsWTVwNEpxeG9nRk5XcnJCQWwyQTVXTENQbjJ2TjhxayIgaWQ9IkdTQVdEX0FXRF8wMSIgPjxzcGFuPkF3YXJkcyBQb3J0YWw8L3NwYW4+PC9hPg0KDQo8L2xpPg0KPGxpIGNsYXNzPSJub3JtYWx0YWIiID4NCjxhIGhyZWY9InNpd19wb3J0YWwudXJsPzNCQkIwNEUzNDA3NTQ1MTNyYVp3Zmt0NHFRZ2NKcUpQVWlzRVFXNlVIUGQwajQzdVN1YXllWl9tWTJORldXQTZkVWo2VC1icTFRWDhQdkJQOUJlMUM2dEUwTFpXaVdqZkpwU0JtbnlTNFIxeDRuRUpTcVNFUk9wbGVlWSIgaWQ9IkdTQVdEX05PTV8wMSIgPjxzcGFuPkF3YXJkczwvc3Bhbj48L2E+DQoNCjwvbGk+DQo8bGkgY2xhc3M9Im5vcm1hbHRhYiIgPg0KPGEgaHJlZj0ic2l3X3BvcnRhbC51cmw/MzMwMEYwQ0M4RDVGNERFQmJWcEhVWFo2LU9ManNhZmNvUkNjaDYxZlI3dzBqZlgxNTBrcExkeXFQc3RCZHZCNDZMcUJzRVVxbjNhYlVtVWFCenp2YWVNOGh1dTFKYl92U002dF9xX2FnUGFhWmx0cFFBX2E4Qm5XVng4IiBpZD0iR1NNU0cwMSIgPjxzcGFuPkFkbWlzc2lvbnMgTWVzc2FnZXM8L3NwYW4+PC9hPg0KDQo8L2xpPg0KDQoJCQkJCQk8bGkgY2xhc3M9Im5vcm1hbHRhYiI+DQoJCQkJCQkJDQoJCQkJCQk8L2xpPg0KCQkJCQkJPCEtLQ0KCQkJCQkJPGxpIGNsYXNzPSJub3JtYWx0YWIiPg0KCQkJCQkJCTxhIGhyZWY9Ii4uL3J1bi9TSVdfUE9SVEFMX1BDTy5zdGFydF91cmw/MjhFQUY5MTNEMkFGNDdFOU14VGQ2WWZYeVR0Z3hCNXprMUctS01mT2dZU3B4SEdnNk41Tk11MHoxSzEwMUNFTVRRNzVrbHhSY2UzVEc4SGRYOTJhWXpXWXJWVmJjdEdvenlHclBlRnNDYWVSQ0NzMlF3bUg2UThuOUo4IiB0YXJnZXQ9Il9zZWxmIj5Db250ZW50PC9hPiANCgkJCQkJCTwvbGk+DQoJCQkJCQktLT4NCgkJCQkJCTxsaSBjbGFzcz0ibm9ybWFsdGFiIj4NCgkJCQkJCQk8YSBocmVmPSIuLi9ydW4vU0lXX0xHTl9MT0dPVVQuc3RhcnRfdXJsPzkxNDVFRDdFMDZGRjRCQTUxYjBGb1pscVcxb2t0R1o2S2lhMmhKTW9GbHNhMFJZLXZhQnRKWHpPaUpzZkZVZHZlSjgzTzlpTTU4ei02R3RkSTB6V0NmRWtLWE1vQkhCYncyd2FINEJRXzM1Rjk2c1l0Y0x1U0cwVnFwNCIgdGFyZ2V0PSJfc2VsZiI+TG9nb3V0PC9hPg0KCQkJCQkJPC9saT4NCgkJCQkJPC91bD4NCgkJCQk8L2xpPg0KCQkJPC91bD4NCgkJPC9uYXY+DQoJPC9kaXY+DQo8ZGl2IGNsYXNzPSJuYXYtbW9iaWxlIj4NCjxkaXYgY2xhc3M9Im5hdi13cmFwcGVyIj4NCiAgICANCiAgICAgICAgICAgIDx1bCBjbGFzcz0ibGV2ZWwtMCI+DQogICAgICAgICAgICAgICAgPCEtLSBUaGUgVGFiIGxpc3QgZmllbGQgY29udGFpbnMgZWFjaCBwYWdlIHRhYiBhcyBhIGxpIGl0ZW0sIGNoaWxkIHBhZ2UgdGFicyB3aWxsIGNyZWF0ZSBhIG5ldyB1bCB3aXRoaW4gdGhlIG91dGVyIHVsIC0tPg0KCQkJCQkJPGxpIGNsYXNzPSJuYXYtY3VycmVudCIgPg0KPGEgaHJlZj0ic2l3X3BvcnRhbC51cmw/QkQ2OUJDRjkzOEZFNEJCQ1RZOElkQWJERlVQRXpQVWcwZGwwcXItN3N6Wm9XNjZhbnRhSUxvVzEtZW9VbF9zc0hRQlY3Y1kyT0FHX1l4VzdLWnFoRk1aampGWGNPOFBoNk05eFlidjZZRTE3TkotYm1Wc3dIYmphTFdFIiBpZD0iR1NXRkwwMSIgdGl0bGU9Ik1hbmFnZSBBcHBsaWNhdGlvbnMiPjxzcGFuPkFkbWlzc2lvbnM8L3NwYW4+PC9hPg0KDQo8L2xpPg0KPGxpIGNsYXNzPSJub3JtYWx0YWIiID4NCjxhIGhyZWY9InNpd19wb3J0YWwudXJsPzUzN0VFRUJGNjZCRDRBQTRYcG1lb2xTUDNLQ21oaFQtTmJnNGM5M195ek9lYlczSjRybTBoaDNwTXZrR2xaRjdpS2NFeWZRanhzOGU5bkN1bENaTGI5ZFVEUFVsWTVwNEpxeG9nRk5XcnJCQWwyQTVXTENQbjJ2TjhxayIgaWQ9IkdTQVdEX0FXRF8wMSIgPjxzcGFuPkF3YXJkcyBQb3J0YWw8L3NwYW4+PC9hPg0KDQo8L2xpPg0KPGxpIGNsYXNzPSJub3JtYWx0YWIiID4NCjxhIGhyZWY9InNpd19wb3J0YWwudXJsPzNCQkIwNEUzNDA3NTQ1MTNyYVp3Zmt0NHFRZ2NKcUpQVWlzRVFXNlVIUGQwajQzdVN1YXllWl9tWTJORldXQTZkVWo2VC1icTFRWDhQdkJQOUJlMUM2dEUwTFpXaVdqZkpwU0JtbnlTNFIxeDRuRUpTcVNFUk9wbGVlWSIgaWQ9IkdTQVdEX05PTV8wMSIgPjxzcGFuPkF3YXJkczwvc3Bhbj48L2E+DQoNCjwvbGk+DQo8bGkgY2xhc3M9Im5vcm1hbHRhYiIgPg0KPGEgaHJlZj0ic2l3X3BvcnRhbC51cmw/MzMwMEYwQ0M4RDVGNERFQmJWcEhVWFo2LU9ManNhZmNvUkNjaDYxZlI3dzBqZlgxNTBrcExkeXFQc3RCZHZCNDZMcUJzRVVxbjNhYlVtVWFCenp2YWVNOGh1dTFKYl92U002dF9xX2FnUGFhWmx0cFFBX2E4Qm5XVng4IiBpZD0iR1NNU0cwMSIgPjxzcGFuPkFkbWlzc2lvbnMgTWVzc2FnZXM8L3NwYW4+PC9hPg0KDQo8L2xpPg0KDQoJCQkJCQk8bGkgY2xhc3M9Im5vcm1hbHRhYiI+DQoJCQkJCQkJDQoJCQkJCQk8L2xpPg0KCQkJCQkJPCEtLQ0KCQkJCQkJPGxpIGNsYXNzPSJub3JtYWx0YWIiPg0KCQkJCQkJCTxhIGhyZWY9Ii4uL3J1bi9TSVdfUE9SVEFMX1BDTy5zdGFydF91cmw/MjhFQUY5MTNEMkFGNDdFOU14VGQ2WWZYeVR0Z3hCNXprMUctS01mT2dZU3B4SEdnNk41Tk11MHoxSzEwMUNFTVRRNzVrbHhSY2UzVEc4SGRYOTJhWXpXWXJWVmJjdEdvenlHclBlRnNDYWVSQ0NzMlF3bUg2UThuOUo4IiB0YXJnZXQ9Il9zZWxmIj5Db250ZW50PC9hPiANCgkJCQkJCTwvbGk+DQoJCQkJCQktLT4NCgkJCQkJCTxsaSBjbGFzcz0ibm9ybWFsdGFiIj4NCgkJCQkJCQk8YSBocmVmPSIuLi9ydW4vU0lXX0xHTl9MT0dPVVQuc3RhcnRfdXJsPzkxNDVFRDdFMDZGRjRCQTUxYjBGb1pscVcxb2t0R1o2S2lhMmhKTW9GbHNhMFJZLXZhQnRKWHpPaUpzZkZVZHZlSjgzTzlpTTU4ei02R3RkSTB6V0NmRWtLWE1vQkhCYncyd2FINEJRXzM1Rjk2c1l0Y0x1U0cwVnFwNCIgdGFyZ2V0PSJfc2VsZiI+TG9nb3V0PC9hPg0KCQkJCQkJPC9saT4NCiAgICAgICAgICAgDQogICAgICAgICAgICA8L3VsPg0KICAgICAgICANCjwvZGl2Pg0KDQo8L2Rpdj4NCjwvaGVhZGVyPg0KDQogICAgICA8IS0tIERJViBzaXRzcGFnZWNvbnRlbnQgKHNlZSBzaXRzLmNzcykgZW5jbG9zZXMgbWFpbiBwYWdlIGNvbnRlbnQuDQogICAgICAgICAgSXQgaXMgb3BlbmVkIGluIGJvZHktc3RhcnQsIGJvZHktc3RhcnQtdGFicywgYm9keS1zdGFydC1pcHAgYW5kDQogICAgICAgICAgY2xvc2VkIGluIGJvZHktZW5kLCBib2R5LWVuZC1pcHANCiAgICAgICAtLT4NCiAgICAgIDxkaXYgaWQ9InNpdHNwYWdlY29udGVudCIgY2xhc3M9ImNvbnRhaW5lciByb3ctZmx1aWQiPg0KDQo8IS0tIGVuZCBvZiBIVE1MIGZyb20gYm9keS1zdGFydC5odHMgIC0tPg0KPHNjcmlwdCB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiPnNpdHNfd2lkZ2V0X2JwID0geyJkdCI6eyJlbXB0eVRhYmxlIjoiTm8gaW5mb3JtYXRpb24gYXZhaWxhYmxlIiwiaW5mbyI6IlNob3dpbmcgX1NUQVJUXyB0byBfRU5EXyBvZiBfVE9UQUxfIGVudHJpZXMiLCJpbmZvRW1wdHkiOiJObyBlbnRyaWVzIHRvIHNob3ciLCJpbmZvRmlsdGVyZWQiOiIgKGZpbHRlcmVkIGZyb20gX01BWF8gdG90YWwgZW50cmllcykiLCJsZW5ndGhNZW51IjoiU2hvdyBfTUVOVV8gZW50cmllcyIsImxvYWRpbmdSZWNvcmRzIjoiTG9hZGluZy4uLiIsInByb2Nlc3NpbmciOiJQcm9jZXNzaW5nLi4uIiwic2VhcmNoIjoiRmlsdGVyOiIsInplcm9SZWNvcmRzIjoiTm8gbWF0Y2hpbmcgZW50cmllcyBmb3VuZCIsInBhZ2luYXRlIjp7ImZpcnN0IjoiRmlyc3QiLCJsYXN0IjoiTGFzdCIsIm5leHQiOiJOZXh0IiwicHJldmlvdXMiOiJQcmV2aW91cyJ9LCJhcmlhIjp7InNvcnRBc2NlbmRpbmciOiI6IHVzZSB0byBzb3J0IGNvbHVtbiBhc2NlbmRpbmciLCJzb3J0RGVzY2VuZGluZyI6IjogdXNlIHRvIHNvcnQgY29sdW1uIGRlc2NlbmRpbmcifSwidHJpYmFsIjp7ImRldGFpbHNMYWJlbE9wZW4iOiJBY3RpdmF0ZSB0byBzaG93IGFkZGl0aW9uYWwgZGV0YWlscyBmb3IgdGhpcyByb3ciLCJkZXRhaWxzTGFiZWxDbG9zZSI6IkFjdGl2YXRlIHRvIGhpZGUgYWRkaXRpb25hbCBkZXRhaWxzIGZvciB0aGlzIHJvdyIsImRldGFpbHNMYWJlbERhdGFPcGVuIjoiQWN0aXZhdGUgdG8gc2hvdyBhZGRpdGlvbmFsIGRldGFpbHMgZm9yIF9EQVRBXyIsImRldGFpbHNMYWJlbERhdGFDbG9zZSI6IkFjdGl2YXRlIHRvIGhpZGUgYWRkaXRpb25hbCBkZXRhaWxzIGZvciBfREFUQV8ifX0sInRzIjp7Im1vZGVzIjpbIlN0YWNrIiwiU3dpcGUiLCJUb2dnbGUiXSwiY29sdW1ucyI6IkNvbDxzcGFuIGNsYXNzPVwiYTExeS1zbVwiPnVtbjxcL3NwYW4+cyIsImNvbHVtbkJ0blRleHQiOiJDb2x1bW5zIiwiY29sdW1uc0RpYWxvZ0Vycm9yIjoiTm8gZWxpZ2libGUgY29sdW1ucy4iLCJzb3J0IjoiU29ydCIsInByZXZCdG5UZXh0IjoiU2hvdyBwcmV2aW91cyBjb2x1bW4gb24gdGhlIGZvbGxvd2luZyB0YWJsZSIsIm5leHRCdG5UZXh0IjoiU2hvdyBuZXh0IGNvbHVtbiBvbiB0aGUgZm9sbG93aW5nIHRhYmxlIiwicHJldkJ0bkRpc2FibGVkVGV4dCI6IlNob3cgcHJldmlvdXMgY29sdW1uIG9uIHRoZSBmb2xsb3dpbmcgdGFibGUgKG5vdCBjdXJyZW50bHkgYXZhaWxhYmxlKSIsIm5leHRCdG5EaXNhYmxlZFRleHQiOiJTaG93IG5leHQgY29sdW1uIG9uIHRoZSBmb2xsb3dpbmcgdGFibGUgKG5vdCBjdXJyZW50bHkgYXZhaWxhYmxlKSIsInNvcnRBc2NUZXh0IjoiOiB1c2UgdG8gc29ydCBjb2x1bW4gYXNjZW5kaW5nIiwic29ydERlc2NUZXh0IjoiOiB1c2UgdG8gc29ydCBjb2x1bW4gZGVzY2VuZGluZyJ9LCJwZyI6eyJpbmZvVGV4dCI6IlNob3dpbmcgcGFnZSB7MH0gb2YgezF9IiwiaW5mb1dpdGhSZWNzVGV4dCI6IlNob3dpbmcgcGFnZSB7MH0gb2YgezF9IHdpdGggezJ9IHJlY29yZHMgcGVyIHBhZ2UiLCJmaXJzdEJ0blRleHQiOiJGaXJzdCIsInByZXZCdG5UZXh0IjoiUHJldmlvdXMiLCJuZXh0QnRuVGV4dCI6Ik5leHQiLCJsYXN0QnRuVGV4dCI6Ikxhc3QiLCJmaXJzdEJ0bkFyaWFUZXh0IjoiU2hvdyBmaXJzdCBwYWdlIiwicHJldkJ0bkFyaWFUZXh0IjoiU2hvdyBwcmV2aW91cyBwYWdlIiwibmV4dEJ0bkFyaWFUZXh0IjoiU2hvdyBuZXh0IHBhZ2UiLCJsYXN0QnRuQXJpYVRleHQiOiJTaG93IGxhc3QgcGFnZSIsInBhZ2VCdG5BcmlhVGV4dCI6IlNob3cgcGFnZSB7MH0ifSwidHAiOnsiY3VycmVudFRleHQiOiJOb3ciLCJjbG9zZVRleHQiOiJEb25lIiwidGltZU9ubHlUaXRsZSI6IkNob29zZSBUaW1lIiwidGltZVRleHQiOiJUaW1lIiwiaG91clRleHQiOiJIb3VyIiwibWludXRlVGV4dCI6Ik1pbnV0ZSIsInNlY29uZFRleHQiOiJTZWNvbmQiLCJtaWxsaXNlY1RleHQiOiJNaWxsaXNlY29uZCIsIm1pY3Jvc2VjVGV4dCI6Ik1pY3Jvc2Vjb25kIiwidGltZXpvbmVUZXh0IjoiVGltZSBab25lIn0sInVpIjp7ImRpYWxvZ09rIjoiT2siLCJkaWFsb2dDYW5jZWwiOiJDYW5jZWwiLCJ0YWJzQ2xvc2UiOiJDbG9zZSIsImRpYWxvZ0Nsb3NlIjoiQ2xvc2UiLCJtb3JlRGV0YWlscyI6Ik1vcmUgRGV0YWlscyIsImRhdGVQaWNrZXJEYXRlIjoiU2VsZWN0IGEgZGF0ZSIsImRhdGVQaWNrZXJUaW1lIjoiU2VsZWN0IGEgdGltZSIsImRhdGVQaWNrZXJEYXRlVGltZSI6IlNlbGVjdCBhIGRhdGVcL3RpbWUiLCJsb2FkaW5nIjoiTG9hZGluZy4uLiIsInNlbGVjdEFsbFRpdGxlIjoiU2VsZWN0IEFsbCIsInNlbGVjdEFsbCI6IlNlbGVjdCBBbGwiLCJzZWxlY3ROb25lIjoiU2VsZWN0IE5vbmUiLCJpbnZlcnRBbGwiOiJJbnZlcnQgQWxsIiwiZXJyb3JUZXh0IjoiRXJyb3IiLCJkYXRlUGlja2VyTW9udGgiOiJTZWxlY3QgYSBtb250aCIsImRhdGVQaWNrZXJZZWFyIjoiU2VsZWN0IGEgeWVhciIsInRhYnNTY3JvbGxMZWZ0IjoiU2Nyb2xsIGxlZnQiLCJ0YWJzU2Nyb2xsUmlnaHQiOiJTY3JvbGwgcmlnaHQifSwibGQiOnsibG9hZFRpdGxlIjoiTG9hZGluZyIsImxvYWRDb250ZW50IjoiTG9hZGluZywgcGxlYXNlIHdhaXQuLi4iLCJwcm9jZXNzVGl0bGUiOiJQcm9jZXNzaW5nIiwicHJvY2Vzc0NvbnRlbnQiOiJQcm9jZXNzaW5nLCBwbGVhc2Ugd2FpdC4uLiIsInNhdmVUaXRsZSI6IlNhdmluZyIsInNhdmVDb250ZW50IjoiU2F2aW5nLCBwbGVhc2Ugd2FpdC4uLiJ9LCJ0byI6eyJzZXNzaW9uVGl0bGUiOiJTZXNzaW9uIEV4cGlyeSIsInNlc3Npb25Db250ZW50IjoiWW91ciBzZXNzaW9uIGlzIGR1ZSB0byBleHBpcmUgaW4gYXBwcm94aW1hdGVseSB7MH0gbWludXRlKHMpLiBJZiB5b3Ugd291bGQgbGlrZSB0byBjb250aW51ZSB1c2luZyB0aGlzIHNlc3Npb24sIHBsZWFzZSBjbGljayBcIkNvbnRpbnVlXCIuIiwicGFnZVRpdGxlIjoiUGFnZSBFeHBpcnkiLCJwYWdlQ29udGVudCI6IlRoaXMgcGFnZSBpcyBkdWUgdG8gZXhwaXJlIGluIGFwcHJveGltYXRlbHkgezB9IG1pbnV0ZShzKS4gSWYgeW91IHdvdWxkIGxpa2UgdG8gY29udGludWUgdXNpbmcgdGhpcyBwYWdlLCBwbGVhc2UgY2xpY2sgXCJDb250aW51ZVwiLiIsImJ1dHRvbkNvbnRpbnVlIjoiQ29udGludWUifX07PC9zY3JpcHQ+DQo8c2NyaXB0PnNpdHNfdXNlcl90aW1lb3V0ID0gIjlGNUYzNEM2NEEzMDQxRTRkN3ZzUGQybjRoNGpaclNoVUF6VW11cVFtNGhvVWdLLVV4ZEs0NWdVTDJkQTRieW1VbFZ3YV9XNTBGYW1xNXF2OUhYQWphc0w4enlvSDh6dUdZdVdFbm9jcElSR0FXUTkiOzwvc2NyaXB0Pg0KPCEtLSBib2R5LXN0YXJ0Lmh0cyBwYWdlIGhlYWRlciBpbmNsdWRlIGVuZHMgaGVyZSAtLT4NCg0KPCEtLSBhZGRpbmcgaGVhZC5kdW0xIC0tPg0KDQogICAgDQo8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSIlLkRVTTEuTUVOU1lTIiB2YWx1ZT0iUkJGY2VVN3B6RTlRaCtEQklPV0s1WWw1eHk0VWhUUUpwZFh0MXMwRFFMUT07bmV3OzsiIC8+DQo8IS0tIGVuZCBvZiBoZWFkLmR1bTEgLS0+DQoNCjwhLS0gU3RhcnQgT2YgRXh0cmEgSmF2YXNjcmlwdHMgLS0+DQo8c2NyaXB0Pg0KICB2YXIgc2l0c19pbl9wb3J0YWwgPSB0cnVlOyAvL3VzZWQgYnkgc2l0c19hamF4LmpzIHRvIGRldGVybWluZSB3aGV0aGVyIHRoZSBjdXJyZW50IHNjcmVlbiBpcyB0aGUgcG9ydGFsDQogIA0KICBmdW5jdGlvbiBzaXRzX3BvcHVwKG15cGFnZSwgbXluYW1lLCB3LCBoLCBzY3JvbGwsIHJlc2l6ZSwgZGlyZWN0b3JpZXMsbG9jYXRpb24sIG1lbnViYXIsIHN0YXR1cywgdG9vbGJhcikgew0KICAgIHZhciB3aW5sID0gKHNjcmVlbi53aWR0aCAtIHcpIC8gMjsNCiAgICB2YXIgd2ludCA9IChzY3JlZW4uaGVpZ2h0IC0gaCkgLyAyOw0KICAgIHZhciB3aW5wcm9wcyA9ICdoZWlnaHQ9JytoKycsd2lkdGg9Jyt3KycsdG9wPScrd2ludCsnLGxlZnQ9Jyt3aW5sKycsc2Nyb2xsYmFycz0nK3Njcm9sbCsnLHJlc2l6YWJsZT0nK3Jlc2l6ZSsnLGxvY2F0aW9uPScrbG9jYXRpb24rJyxtZW51YmFyPScrbWVudWJhcisnLHN0YXR1cz0nK3N0YXR1cysnLHRvb2xiYXI9Jyt0b29sYmFyKycnOw0KICAgIHdpbiA9IHdpbmRvdy5vcGVuKG15cGFnZSwgbXluYW1lLCB3aW5wcm9wcykNCiAgICBpZiAoIHBhcnNlSW50KG5hdmlnYXRvci5hcHBWZXJzaW9uKSA+PSA0ICkgeyB3aW4ud2luZG93LmZvY3VzKCk7IH0NCiAgfQ0KDQogIGZ1bmN0aW9uIFNJVFNTaG93SGVscChjb2RlKXsNCiAgICB2YXIgaGVscHRpdGxlID0gJCggIiMiICsgY29kZSArICJfVElUTEUiICkuaHRtbCgpOw0KICAgIHZhciBoZWxwdGV4dCAgPSAkKCAiIyIgKyBjb2RlICsgIl9URVhUIiApLmh0bWwoKTs7DQogICAgDQogICAgdmFyIGJ0biA9IHt9Ow0KICAgIGJ0blsnQ2xvc2UnXSA9IGZ1bmN0aW9uKCkgeyAgICAgLy9jYW5jZWwgYnV0dG9uDQogICAgICBzaXRzX2RpYWxvZ19jbG9zZSh0cnVlLCJzaXdfcG9ydGFsX2hlbHBfZGlhbG9nIik7DQogICAgICByZXR1cm4gZmFsc2U7DQogICAgfQ0KICAgIHNpdHNfZGlhbG9nKGhlbHB0aXRsZSxoZWxwdGV4dCxidG4sdHJ1ZSx0cnVlLHRydWUsMCwic2l3X3BvcnRhbF9oZWxwX2RpYWxvZyIsdHJ1ZSwwLjUpOw0KICB9DQogIA0KICBmdW5jdGlvbiBTSVRTVG9nZ2xlSXQoVGhpc1NlY0lEKSB7DQogICAgdmFyIHNlY3Rpb25JZCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFRoaXNTZWNJRCk7DQogICAgaWYgKHNlY3Rpb25JZCA9PSBudWxsKSByZXR1cm47DQogICAgaWYgKHNlY3Rpb25JZC5zdHlsZS5kaXNwbGF5ID09ICcnKSB7DQogICAgICBzZWN0aW9uSWQuc3R5bGUuZGlzcGxheSA9ICdub25lJzsNCiAgICB9DQogICAgZWxzZSB7DQogICAgICBzZWN0aW9uSWQuc3R5bGUuZGlzcGxheSA9ICcnOw0KICAgIH0NCiAgfQ0KICBmdW5jdGlvbiBIaWRlKG9iaikgew0KICAgIHZhciBvRGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQob2JqKTsNCiAgICBpZihvRGl2ICE9IG51bGwpIG9EaXYuc3R5bGUuZGlzcGxheSA9ICJub25lIjsNCiAgfQ0KPC9zY3JpcHQ+DQo8IS0tIEVuZCBPZiBFeHRyYSBTY3JpcHRzIC0tPg0KDQo8IS0tIG1haW4gY29udGVudCBvZiBQb3J0YWwgc3RhcnRzIGhlcmUgLS0+DQoNCg0KPCEtLSBhbGwgcG9ydGFsIGNvbnRhaW5lcnMgaHRtbCBzdGFydHMgaGVyZSAtLT4NCg0KICANCjwhLS0gUG9ydGFsIFBhZ2UgSGVhZGluZyBzZWN0aW9uICAtLT4NCjxkaXYgaWQ9InNpdHNwb3J0YWxwYWdldGl0bGVzZWN0aW9uIiBjbGFzcz0ic2l0c3BvcnRhbHBhZ2V0aXRsZXNlY3Rpb24iPg0KICA8aDEgaWQ9InNpdHNwb3J0YWxwYWdldGl0bGUiIGNsYXNzPSJzaXRzcG9ydGFscGFnZXRpdGxlIj4NCiAgQWRtaXNzaW9ucw0KICA8L2gxPg0KICA8cCBpZD0ic2l0c3BvcnRhbHBhZ2VkZXNjIiBjbGFzcz0ic2l0c3BvcnRhbHBhZ2VkZXNjIj4NCiAgICANCiAgPC9wPg0KPC9kaXY+DQo8IS0tIGVuZCBvZiBwb3J0YWwgcGFnZSBoZWFkaW5nIHNlY3Rpb24gIC0tPg0KIA0KICA8ZGl2IGlkPSJzaXRzcG9ydGFsY29udGFpbmVyc2VjdGlvbiI+ICANCiA8IS0tIDFzdCBDb2x1bW4gLS0+DQo8ZGl2IGlkPSJzaXRzY29sdW1uMW5vdGFicyIgY2xhc3M9InNpdHNjb2x1bW4xbm90YWJzIiBzdHlsZT0id2lkdGg6MTAwJTsiPg0KDQo8IS0tIFN0YXJ0IG9mIENvbnRhaW5lciBHU1dGTDAxXzAxLS0+DQo8ZGl2IGNsYXNzPSJzaXRzY29udGFpbmVybm90YWJzIj4NCiAgIDxkaXYgY2xhc3M9InNpdHNjb25ib3JkZXJub3RhYnMiID4NCiAgICAgIDwhLS0gSGlkZGVuIHNlY3Rpb24gaHRtbCBpcyBoZXJlIC0tPg0KICAgICAgIDxkaXYgaWQ9IkdTV0ZMMDFfMDFfQ09OX1VITFAuQ09OIiBjbGFzcz0ic2l0c2NvbmhlbHAiPiANCiAgICAgICAgPHNjcmlwdCB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiPg0KICAgICAgICAgIEhpZGUoJ0dTV0ZMMDFfMDFfQ09OX1VITFAuQ09OJyk7DQogICAgICAgIDwvc2NyaXB0Pg0KICAgICAgICANCiAgICAgIDwvZGl2Pg0KPCEtLSBzdGFydCBvZiBjb3BzZWN0aW9uIGZvciBHU1dGTDAxXzAxIC0tPg0KPGRpdiBjbGFzcz0ic2l0c2NvcHNlY3Rpb25ub3RhYnMiPg0KPHAgY2xhc3M9InNpdHNjb3AiPjxhIGhyZWY9IlNJV19ZTUhELnN0YXJ0X3VybD85MDAzMkZCRTE0OEU0QTZCeEdHdGdLbTZwZHRWd3Bkb2dWYmYwY055MHJGU25SaDlYS0toMUo1ZDdTWmtNaVRfdmRRSlh2WkVnVzhDcVNRLW9MdUE5ZlUzang1WTRhU3NOdUZaTWdlSTlIUXd1NWpBb1MzSS1lNnJYelctOW1ZZFZ1SkFQUnpDdHJ2RmhCaGk0Wm1MVzVuMXlpRDVoNTJiNGRtYktrMVFwOXNsWmZOTjMzcTIwUTBaOV9JWlB3b1pheUwwaDdnUjUzd3R1TnFlMUpkUE1kd2Rod0c0NzBWZ0VISEVRUSIgdGFyZ2V0PSJfYmxhbmsiICA+QXBwbGljYW50IFNlYXJjaDwvYT48c3BhbiBjbGFzcz0ic2l0c25ld2NvcHRleHQiPiAgICAgIA0KPGltZyBzcmM9Ii4uL2ltYWdlcy9uZXd1cGRhdGVkL25ld2NvcC5naWYiIHN0eWxlPSJib3JkZXI6MHB4IiBhbHQ9IkluZGljYXRlcyBhIG5ldyBvcHRpb24iPg0KPC9zcGFuPjwvcD4NCjxwIGNsYXNzPSJzaXRzY29wIj48YSBocmVmPSJTSVdfQURNX0RTSC5zdGFydF91cmw/NkQ0OUVGMDg5NzkwNDU3QTduV0dQclhJellrMjFFSDRZbnZrZVJKVlJQYW9tQ2FXcTluOVVWYW5semMwdTd1MFA3SUlURTR0MndFMjZEaFl4UlhpQnVnOHBsb2h4YkNEVVZYOWhBd3ppVlFDWlVPSHoweWxjVXpNYmxaYzM0WDJ1UDhMalphT2c0ejlSYlV2b1RjcTRFNmpabmNKZk5BblhZTFJHd1BCNV85YjdUMmJuWV9pV3V3YU45c1QwblhjLWEzbnhoSk5UXy01SVcwRCIgdGFyZ2V0PSJfc2VsZiIgID5BZG1pc3Npb24gRGVzayAyMDE5LTIwMjA8L2E+PHNwYW4gY2xhc3M9InNpdHNuZXdjb3B0ZXh0Ij4gICAgICANCjxpbWcgc3JjPSIuLi9pbWFnZXMvbmV3dXBkYXRlZC9uZXdjb3AuZ2lmIiBzdHlsZT0iYm9yZGVyOjBweCIgYWx0PSJJbmRpY2F0ZXMgYSBuZXcgb3B0aW9uIj4NCjwvc3Bhbj48L3A+DQo8cCBjbGFzcz0ic2l0c2NvcCI+PGEgaHJlZj0iU0lXX0FETV9EU0guc3RhcnRfdXJsPzdCOTBDMDFCRkEwRDRCMTB2ZDFBNzFSM2Q3VUZmRGJ0Tm16YlU5a2xtNmpkRmwwMEpOQU9UalRHdW8yemtPVV96d2pqUC1aX3BQSC0yZmd2eHE5WWxwajJ1amllWGtEa2JLTVFtb0lUQ3NKZS1jczI2YnJQZlBSd1dHbTFaTEZJMzlZM0hXYkgyQjBqVTF3cVhzWXE3T0JIenBaMzhJTjQ0cDJwX002RkVUR0hERGdXMGpSanVGanZER0pBVW1QRGdPT0FSRi1ZV2JCc2tua3giIHRhcmdldD0iX3NlbGYiICA+QWRtaXNzaW9uIERlc2sgMjAxOC0yMDE5PC9hPjxzcGFuIGNsYXNzPSJzaXRzbmV3Y29wdGV4dCI+ICAgICAgDQo8aW1nIHNyYz0iLi4vaW1hZ2VzL25ld3VwZGF0ZWQvbmV3Y29wLmdpZiIgc3R5bGU9ImJvcmRlcjowcHgiIGFsdD0iSW5kaWNhdGVzIGEgbmV3IG9wdGlvbiI+DQo8L3NwYW4+PC9wPg0KPHAgY2xhc3M9InNpdHNjb3AiPjxhIGhyZWY9IlNJV19BRE1fRFNILnN0YXJ0X3VybD81MDI0MDM3Nzc5MzU0NjNGUlFkZXExVmw3SEdVelV0a0xBOGFITG04TTVTVF9XRUpONVlvYmVjRmZtMExkZ0JudGlqZDlBVkVvU2VuWGlFNlJqRzhaNlhBMTI5d1VXS3RnY0lWdkxDVlp0QmJUeHFJdEk5RDZUd0UwNkZRMm9uU2hnRzFhNGczNEcyZUZ2QVB5dk01SWVua2JValh5blIxYTh4M241QXhucXU0SGw1NXpzbHM5UmU4aHQ2S1U3OFNkTWk0Ym5PQ0FIVW1ySEprIiB0YXJnZXQ9Il9zZWxmIiAgPkFkbWlzc2lvbiBEZXNrIDIwMTctMjAxODwvYT48c3BhbiBjbGFzcz0ic2l0c25ld2NvcHRleHQiPiAgICAgIA0KPGltZyBzcmM9Ii4uL2ltYWdlcy9uZXd1cGRhdGVkL25ld2NvcC5naWYiIHN0eWxlPSJib3JkZXI6MHB4IiBhbHQ9IkluZGljYXRlcyBhIG5ldyBvcHRpb24iPg0KPC9zcGFuPjwvcD4NCjxwIGNsYXNzPSJzaXRzY29wIj48YSBocmVmPSJTSVdfQURNX0RTSC5zdGFydF91cmw/N0JERTI1OUE4N0QwNDFFOTJvYlJOWmhwYzVrX3FGVEwxaGFFV0loNk9CZ2FuTTBTR3VPR1AyNnRhSmdjNzVNTHRmV21DN0VXVnpkMlA3TTBoR3RhNFdWaWJ3Vy1kOFcyUTdmSVpBTko0QjNfZGlYNmhmWkhYODhQY09HdUk2UzNRdkE0ZUtvWEFoaUR1TmxMTlIwNG41N0dPRm1mV2h4anZWQjhFVURMTEpLY0hjOE1CTHhaVXU3eW9WMzN0bVZKb21FeXAxeHB0LXk2d2NhOCIgdGFyZ2V0PSJfc2VsZiIgID5BZG1pc3Npb24gRGVzayAyMDE2LTIwMTc8L2E+PHNwYW4gY2xhc3M9InNpdHNuZXdjb3B0ZXh0Ij4gICAgICANCjxpbWcgc3JjPSIuLi9pbWFnZXMvbmV3dXBkYXRlZC9uZXdjb3AuZ2lmIiBzdHlsZT0iYm9yZGVyOjBweCIgYWx0PSJJbmRpY2F0ZXMgYSBuZXcgb3B0aW9uIj4NCjwvc3Bhbj48L3A+DQo8cCBjbGFzcz0ic2l0c2NvcCI+PGEgaHJlZj0iU0lXX1lNSEQuc3RhcnRfdXJsP0UyMURBQ0FGMEFGODQyRDJIVGpYS3NtNHJPNXdmOU9uMktTbXhjS053SFVMTTcyZGNpOW5SREloaTctSDh3WDRXX3U1WHVReGF1WkV1akZIM04xb0U5cTlkQy1vX1lWTGZIYVpfX2c5bl9qZEtJMENDaGI2M3RtZnQ2b1E0OFp2THhtUUo4bUJ1T2x6dlVXQ3pRQU5nOHhzTDJBVkJWRGVkSTlkVWNzQ0p1UlNrVV8za3dORXlhbUVyM01xMU9iMlZxV0NxOE1rRHVad3hYYWlWTk8wNGo5Qklsd2NPQzloTkRvRDd3IiB0YXJnZXQ9Il9ibGFuayIgID5TZW5kIHBvc3QtZGVhZGxpbmUgYXBwbGljYXRpb24gbGluazwvYT48c3BhbiBjbGFzcz0ic2l0c25ld2NvcHRleHQiPjwvc3Bhbj48L3A+DQo8cCBjbGFzcz0ic2l0c2NvcCI+PGEgaHJlZj0iU0lXX1lNSEQuc3RhcnRfdXJsP0VCNTFDMjYxMkRDRDRFRjZKaDR6TzA5S25HZG9oYlJ2ZnlHWHNVLWdmQkVyUzZ1ZUwwUlk3OTc0TzFJM3hwSUU0LXkybFZvZDh0U1FnOUFsWFJNWFpHUHZfVW9CRXUyZmVEQnpOaHhxV2NDWnRpT1Y2UHpRM2dYRXJrZzF6bWJGZVk3TjNXTnZyNFBmTEdHM1lhNUNSTFcwdEszM3dTSTNHZjNrV0RFTm5zVTZLX1RZdTJpOWh6eFR1YkhRSl9TQ1EzVE5Ea3RGREZlSmlhWnpHbHdQYXJXSTdiQ3BtMUNBVzdMQm5RIiB0YXJnZXQ9Il9ibGFuayIgID5WaWV3IHBvc3QtZGVhZGxpbmUgYXBwbGljYXRpb25zPC9hPjxzcGFuIGNsYXNzPSJzaXRzbmV3Y29wdGV4dCI+PC9zcGFuPjwvcD4NCg0KPC9kaXY+DQo8IS0tIGVuZCBvZiBjb3BzZWN0aW9uLS0+DQo8L2Rpdj4NCjwhLS0gZW5kIG9mIGJvcmRlcnNlY3Rpb24tLT4NCjwvZGl2Pg0KPCEtLSBlbmQgb2YgY29udGFpbmVyIEdTV0ZMMDFfMDEgLS0+DQoNCg0KPCEtLSBTdGFydCBvZiBDb250YWluZXIgR1NXRkwwMV8wMy0tPg0KPGRpdiBjbGFzcz0ic2l0c2NvbnRhaW5lcm5vdGFicyI+DQogICA8ZGl2IGNsYXNzPSJzaXRzY29uYm9yZGVybm90YWJzIiA+DQogICAgICA8IS0tIEhpZGRlbiBzZWN0aW9uIGh0bWwgaXMgaGVyZSAtLT4NCiAgICAgICA8ZGl2IGlkPSJHU1dGTDAxXzAzX0NPTl9VSExQLkNPTiIgY2xhc3M9InNpdHNjb25oZWxwIj4gDQogICAgICAgIDxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0Ij4NCiAgICAgICAgICBIaWRlKCdHU1dGTDAxXzAzX0NPTl9VSExQLkNPTicpOw0KICAgICAgICA8L3NjcmlwdD4NCiAgICAgICAgDQogICAgICA8L2Rpdj4NCjwhLS0gc3RhcnQgb2YgY29wc2VjdGlvbiBmb3IgR1NXRkwwMV8wMyAtLT4NCjxkaXYgY2xhc3M9InNpdHNjb3BzZWN0aW9ubm90YWJzIj4NCjxwIGNsYXNzPSJzaXRzY29wIj48YSBocmVmPSJTSVdfQURNX0RTSC5zdGFydF91cmw/QjZENkZBODAwNjI4NDRFOW40ZXBSQlNEZjN3SXFSbjRMazRBbXhneUhGUVZMZS12YlFic09GRmhaNG1TdjRKQVRqMW5EVWhwWUhiMjJObVRYaXoxSElkV2cyQ2FWZUNuQTNRVE1KbFVtYXpzMlU1OWZVbkJjVkhMMVJISjVjNTFLNVV4cXVkSUdhaE1zOWlvOV9YVXJfQTFzSWJZT09NNVZBNU0xdWQwWDdNekZiUVczWEM0Mi1UeFlBSXRrTy1qS2NLRTFDWGFNYVRmR3h0WSIgdGFyZ2V0PSJfc2VsZiIgID5GR1NSIEFkbWlzc2lvbnMgRGVzazwvYT48c3BhbiBjbGFzcz0ic2l0c25ld2NvcHRleHQiPjwvc3Bhbj48L3A+DQo8cCBjbGFzcz0ic2l0c2NvcCI+PGEgaHJlZj0iU0lXX1lNSEQuc3RhcnRfdXJsP0JDNEM3MzJDRDMwMDRDQkVzMmliTldaSkhibzAxTEI5ZFVlSmx5ZGZFQm5KT19UcXFRdDhTdFo4Zk9rTU5iX1ZMZ2Nlb0p6ejZNNTNiY3dCMVNyU0hwbWNGTGR2THhObDVPOUswQ01QMnpZTy1JS01zdU14U2JJNlZad0pZTER1Y0pnQUJvcWR1dHBSNGxLcHQ2WWpkUzlFSFdWUmpWdWt3SXZ3MlJ4RUI5dHVEX3lyNWhoa2dtVnQ5VTllR01CSnN6TklleVQtcjJPLU5zbGNFYkVHcENFdWhaeXVXU1FySUMyN05RIiB0YXJnZXQ9Il9ibGFuayIgID5BcHBsaWNhbnQgU2VhcmNoPC9hPjxzcGFuIGNsYXNzPSJzaXRzbmV3Y29wdGV4dCI+ICAgICAgDQo8aW1nIHNyYz0iLi4vaW1hZ2VzL25ld3VwZGF0ZWQvbmV3Y29wLmdpZiIgc3R5bGU9ImJvcmRlcjowcHgiIGFsdD0iSW5kaWNhdGVzIGEgbmV3IG9wdGlvbiI+DQo8L3NwYW4+PC9wPg0KDQo8L2Rpdj4NCjwhLS0gZW5kIG9mIGNvcHNlY3Rpb24tLT4NCjwvZGl2Pg0KPCEtLSBlbmQgb2YgYm9yZGVyc2VjdGlvbi0tPg0KPC9kaXY+DQo8IS0tIGVuZCBvZiBjb250YWluZXIgR1NXRkwwMV8wMyAtLT4NCg0KPC9kaXY+DQo8IS0tIGVuZCBvZiBsYXN0IGNvbHVtbiAtLT4NCjwvZGl2Pg0KPCEtLSBlbmQgb2YgY29udGFpbmVyIHNlY3Rpb24gLS0+DQogDQo8aW5wdXQgdHlwZT0iaGlkZGVuIiBuYW1lPSIlLlBPUlRBTC5NRU5TWVMuMSIgdmFsdWU9ImZvZ21uZ1ZjMDRBZGhKaURSTmxYQ3RyR09XOVhleFlONm9Vc1AwaS9VNzQ9O25ldzs7IiAvPiANCjwhLS0gYWxsIHBvcnRhbCBjb250YWluZXJzIGh0bWwgZW5kcyBoZXJlIC0tPg0KDQoNCjwhLS0gYm9keS1lbmQuaHRzIHBhZ2UgaGVhZGVyIGluY2x1ZGUgc3RhcnRzIGhlcmUgLS0+DQogIA0KICAgIDwhLS0gc3RhcnQgb2YgSFRNTCBmcm9tIGJvZHktZW5kLmh0cyAgLS0+DQoNCiAgICAgICAgPC9kaXY+DQogICAgICAgIDwhLS0gZW5kIG9mIHNpdHNwYWdlY29udGVudCAtLT4NCjwvZGl2Pg0KPGZvb3Rlcj4NCjxkaXYgY2xhc3M9ImJvdHRvbS1mb290ZXItcm93Ij4NCiAgICA8ZGl2IGNsYXNzPSJmb290ZXItY29udGFpbmVyIGNvbnRhaW5lciI+DQogICAgICAgIDxkaXYgY2xhc3M9ImZvb3Rlci1pbm5lciByb3ctZmx1aWQiPg0KICAgICAgICAgICAgPGRpdiBjbGFzcz0ic3BhbjEyIGZvb3Rlci1jb3B5cmlnaHQiPg0KICAgICAgICAgICAgICAgIDx1bCBjbGFzcz0iZm9vdGVyLXF1aWNrLWxpbmtzIj4NCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxpPjxhIGhyZWY9Imh0dHBzOi8vd3d3LnVhbGJlcnRhLmNhL2Fib3V0L2NvbnRhY3QiIHRhcmdldD0iIj5Db250YWN0IFVzPC9hPjwvbGk+DQogICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGk+PGEgaHJlZj0iaHR0cHM6Ly93d3cuc3VydmV5bW9ua2V5LmNvbS9zL3VhbGJlcnRhLXdlYi1mZWVkYmFjayIgdGFyZ2V0PSIiPkZlZWRiYWNrPC9hPjwvbGk+DQogICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGk+PGEgaHJlZj0iaHR0cDovL3d3dy5yZWdpc3RyYXIudWFsYmVydGEuY2EvY2FsZW5kYXIvIiB0YXJnZXQ9IiI+VW5pdmVyc2l0eSBDYWxlbmRhcjwvYT48L2xpPg0KICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgPGxpPjxhIGhyZWY9Imh0dHA6Ly93d3cuY2FyZWVycy51YWxiZXJ0YS5jYS8iIHRhcmdldD0iIj5DYXJlZXJzPC9hPjwvbGk+DQogICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGk+PGEgaHJlZj0iaHR0cDovL3d3dy5ybXMudWFsYmVydGEuY2EvZW4vRW1lcmdOdW1iZXJzLmFzcHgiIHRhcmdldD0iIj5FbWVyZ2VuY3k8L2E+PC9saT4NCiAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsaT48YSBocmVmPSJodHRwczovL3BvbGljaWVzb25saW5lLnVhbGJlcnRhLmNhLyIgdGFyZ2V0PSJfYmxhbmsiPlBvbGljaWVzPC9hPjwvbGk+DQogICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGk+PGEgaHJlZj0iaHR0cDovL3d3dy53ZWF0aGVyb2ZmaWNlLmdjLmNhL2NpdHkvcGFnZXMvYWItNTBfbWV0cmljX2UuaHRtbCIgdGFyZ2V0PSIiPldlYXRoZXI8L2E+PC9saT4NCiAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsaT48YSBocmVmPSJodHRwOi8vd3d3LmVkbW9udG9uLmNhLyIgdGFyZ2V0PSIiPkVkbW9udG9uPC9hPjwvbGk+DQogICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICA8bGk+PGEgaHJlZj0iaHR0cHM6Ly93d3cudWFsYmVydGEuY2EvcHJpdmFjeSIgdGFyZ2V0PSIiPlByaXZhY3k8L2E+PC9saT4NCiAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIDxsaT48YSBocmVmPSJodHRwczovL3d3dy51YWxiZXJ0YS5jYS9rZWVwaW50b3VjaCIgdGFyZ2V0PSIiPktlZXAgaW4gVG91Y2g8L2E+PC9saT4NCiAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIDxsaT48YSBocmVmPSJodHRwczovL3RyYWluaW5nLnNpdGVjb3JlLnVhbGJlcnRhLmNhL2RlcGFydG1lbnRzL2Fub3RoZXItZGVwYXJ0bWVudCMiPkJhY2sgdG8gVG9wPC9hPjwvbGk+DQogICAgICAgICAgICAgICAgPC91bD4NCiAgICAgICAgICAgICAgICA8cD4NCiAgICAgICAgICAgICAgICAgICAgwqkgMjAxNQ0KICAgICAgICAgICAgICAgICAgICA8c3BhbiBpZD0icGhmb290ZXJfMF91YWxiZXJ0YV9hZGRyZXNzIj5Vbml2ZXJzaXR5IG9mIEFsYmVydGEgMTE2IFN0LiBhbmQgODUgQXZlLiwgPGJyIGNsYXNzPSJ2aXNpYmxlLXBob25lIj5FZG1vbnRvbiwgQUIsIENhbmFkYSBUNkcgMlIzPC9zcGFuPg0KICAgICAgICAgICAgICAgIDwvcD4NCiAgICAgICAgICAgIDwvZGl2Pg0KICAgICAgICA8L2Rpdj4NCiAgICA8L2Rpdj4NCjwvZGl2Pg0KDQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICA8L2Zvb3Rlcj4NCg0KDQo8IS0tIG92ZXJhbGwgYmFja2dyb3VuZCBkaXYgKG9wZW5lZCBpbiBoZWFkZXIgZmlsZXMpIC0tPg0KDQo8c2NyaXB0Pg0KaWYodHlwZW9mKHNpdHNfYWpheF92ZXJzaW9uKT09InN0cmluZyIpIHsNCglzaXRzX2F0dGFjaF9ldmVudCh3aW5kb3csICJsb2FkIiwgZnVuY3Rpb24oKXsJDQoJCXNpdHNfaW5jbHVkZV9maWxlKCIuLi9jc3MvdW9hX2ZpbGVzL2luZGV4X2ZpbGVzL2FsbC5qcyIpOw0KCX0pDQp9DQo8L3NjcmlwdD4NCjwhLS1baWYgSUVdPjxzY3JpcHQgc3JjPSIvL2h0bWw1c2hpdi5nb29nbGVjb2RlLmNvbS9zdm4vdHJ1bmsvaHRtbDUuanMiPjwvc2NyaXB0PjwhW2VuZGlmXS0tPg0KPCEtLSBlbmQgb2YgSFRNTCBmcm9tIGJvZHktZW5kLmh0cyAgLS0+DQogIDwvYm9keT4NCjwvaHRtbD4NCiAgDQo=</ActualData>
          </HTTPData>
        </HTTPDataSet>
        <IsExternalData>false</IsExternalData>
      </HTTPBody>
      <TcpPackets>
        <PacketInfo time="1085862046" offset="0" length="400" />
        <PacketInfo time="1085862062" offset="400" length="9598" />
      </TcpPackets>
    </HTTPResponse>
    <HTTPTask id="6107" hostname="graduate-studies-apply-uat.ualberta.ca" path="https://graduate-studies-apply-uat.ualberta.ca/urd/sits.urd/javascript/settings.js?v=881.2" url="https://graduate-studies-apply-uat.ualberta.ca/urd/sits.urd/javascript/settings.js?v=881.2" ip="129.128.12.49" port="443" connectionId="53" origin="HTML" frame="1" startDateTime="2019-01-02T11:43:29.430-05:00" startTime="1085862296" endTime="1085862312">
      <QueryString>
        <HTTPDataSet>
          <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
            <ActualData>dj04ODEuMg==</ActualData>
          </HTTPData>
        </HTTPDataSet>
        <IsExternalData>false</IsExternalData>
      </QueryString>
      <HTTPSplittedQueryStrings>
        <HTTPHeaderEntity name="v" index="0">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>ODgxLjI=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
      </HTTPSplittedQueryStrings>
      <HTTPRequest method="GET">
        <HTTPHeaders>
          <HTTPHeaderEntity name="User-Agent" index="0">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>TW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV09XNjQ7IHJ2OjY0LjApIEdlY2tvLzIwMTAwMTAxIEZpcmVmb3gvNjQuMA==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Accept" index="1">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>Ki8q</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Accept-Language" index="2">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>ZW4tR0IsZW47cT0wLjU=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Accept-Encoding" index="3">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>Z3ppcCwgZGVmbGF0ZQ==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Referer" index="4">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>aHR0cHM6Ly9ncmFkdWF0ZS1zdHVkaWVzLWFwcGx5LXVhdC51YWxiZXJ0YS5jYS91cmQvc2l0cy51cmQvcnVuL3Npd19wb3J0YWwudXJsPzI5REM2MkUzREExQjQ4NDR3UTJLcXpWeGZoNVFfaXZBd1czczhnUmVMbmxrc1ZCRmo4ZThROG9NUlFqMENXQ1NhRlQ1SDFodDctX1I1MjQzTW9iVGRXUFdrb2lxOHN6Q1hBT0xpa3d0Nk50ZTQyTlQyVDZFbUZkOWs5WQ==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="DNT" index="5">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>MQ==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Cookie" index="6">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>SlNFU1NJT05JRD0xRDdCNDYzNTkyMDU1RTU3ODhEQTAwMjcxNzk2OEJGRDsgQklHaXBTZXJ2ZXJTSVRTQVBQLVVBVC1IVFRQLmFwcH5TSVRTQVBQLVVBVC1IVFRQX3Bvb2w9MTA5Mjc1NDA5Mi4zNjg5NS4wMDAwOyBCSUdpcFNlcnZlclNoYXJlZElJUy1VQVQ9NzU3MjA5NzcyLjIwNDgwLjAwMDA=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Host" index="7">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>Z3JhZHVhdGUtc3R1ZGllcy1hcHBseS11YXQudWFsYmVydGEuY2E=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPAllHeaders>
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>R0VUIGh0dHBzOi8vZ3JhZHVhdGUtc3R1ZGllcy1hcHBseS11YXQudWFsYmVydGEuY2EvdXJkL3NpdHMudXJkL2phdmFzY3JpcHQvc2V0dGluZ3MuanM/dj04ODEuMiBIVFRQLzEuMQ0KVXNlci1BZ2VudDogTW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV09XNjQ7IHJ2OjY0LjApIEdlY2tvLzIwMTAwMTAxIEZpcmVmb3gvNjQuMA0KQWNjZXB0OiAqLyoNCkFjY2VwdC1MYW5ndWFnZTogZW4tR0IsZW47cT0wLjUNCkFjY2VwdC1FbmNvZGluZzogZ3ppcCwgZGVmbGF0ZQ0KUmVmZXJlcjogaHR0cHM6Ly9ncmFkdWF0ZS1zdHVkaWVzLWFwcGx5LXVhdC51YWxiZXJ0YS5jYS91cmQvc2l0cy51cmQvcnVuL3Npd19wb3J0YWwudXJsPzI5REM2MkUzREExQjQ4NDR3UTJLcXpWeGZoNVFfaXZBd1czczhnUmVMbmxrc1ZCRmo4ZThROG9NUlFqMENXQ1NhRlQ1SDFodDctX1I1MjQzTW9iVGRXUFdrb2lxOHN6Q1hBT0xpa3d0Nk50ZTQyTlQyVDZFbUZkOWs5WQ0KRE5UOiAxDQpDb29raWU6IEpTRVNTSU9OSUQ9MUQ3QjQ2MzU5MjA1NUU1Nzg4REEwMDI3MTc5NjhCRkQ7IEJJR2lwU2VydmVyU0lUU0FQUC1VQVQtSFRUUC5hcHB+U0lUU0FQUC1VQVQtSFRUUF9wb29sPTEwOTI3NTQwOTIuMzY4OTUuMDAwMDsgQklHaXBTZXJ2ZXJTaGFyZWRJSVMtVUFUPTc1NzIwOTc3Mi4yMDQ4MC4wMDAwDQpIb3N0OiBncmFkdWF0ZS1zdHVkaWVzLWFwcGx5LXVhdC51YWxiZXJ0YS5jYQ0KDQo=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPAllHeaders>
          <HTTPCookies>
            <HTTPHeaderEntity name="JSESSIONID" index="0">
              <HTTPDataSet>
                <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                  <ActualData>MUQ3QjQ2MzU5MjA1NUU1Nzg4REEwMDI3MTc5NjhCRkQ=</ActualData>
                </HTTPData>
              </HTTPDataSet>
              <IsExternalData>false</IsExternalData>
            </HTTPHeaderEntity>
            <HTTPHeaderEntity name="BIGipServerSITSAPP-UAT-HTTP.app~SITSAPP-UAT-HTTP_pool" index="1">
              <HTTPDataSet>
                <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                  <ActualData>MTA5Mjc1NDA5Mi4zNjg5NS4wMDAw</ActualData>
                </HTTPData>
              </HTTPDataSet>
              <IsExternalData>false</IsExternalData>
            </HTTPHeaderEntity>
            <HTTPHeaderEntity name="BIGipServerSharedIIS-UAT" index="2">
              <HTTPDataSet>
                <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                  <ActualData>NzU3MjA5NzcyLjIwNDgwLjAwMDA=</ActualData>
                </HTTPData>
              </HTTPDataSet>
              <IsExternalData>false</IsExternalData>
            </HTTPHeaderEntity>
          </HTTPCookies>
        </HTTPHeaders>
      </HTTPRequest>
      <HTTPResponse>
        <contentLenght>2560</contentLenght>
        <HTTPHeaders>
          <HTTPHeaderEntity name="Content-Type" index="0">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>YXBwbGljYXRpb24vamF2YXNjcmlwdA==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Last-Modified" index="1">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>VGh1LCAyOCBKdWwgMjAxNiAxNzozODo1NiBHTVQ=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Accept-Ranges" index="2">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>Ynl0ZXM=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="ETag" index="3">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>IjAzODNlZWFmNmU4ZDExOjAi</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Server" index="4">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>TWljcm9zb2Z0LUlJUy84LjU=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="X-Powered-By" index="5">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>QVNQLk5FVA==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Date" index="6">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>V2VkLCAwMiBKYW4gMjAxOSAxNjo0MzowNyBHTVQ=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Content-Length" index="7">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>MjU2MA==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Vary" index="8">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>QWNjZXB0LUVuY29kaW5n</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Content-Encoding" index="9">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>Z3ppcA==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Connection" index="10">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>S2VlcC1BbGl2ZQ==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPAllHeaders>
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2phdmFzY3JpcHQNCkxhc3QtTW9kaWZpZWQ6IFRodSwgMjggSnVsIDIwMTYgMTc6Mzg6NTYgR01UDQpBY2NlcHQtUmFuZ2VzOiBieXRlcw0KRVRhZzogIjAzODNlZWFmNmU4ZDExOjAiDQpTZXJ2ZXI6IE1pY3Jvc29mdC1JSVMvOC41DQpYLVBvd2VyZWQtQnk6IEFTUC5ORVQNCkRhdGU6IFdlZCwgMDIgSmFuIDIwMTkgMTY6NDM6MDcgR01UDQpDb250ZW50LUxlbmd0aDogMjU2MA0KVmFyeTogQWNjZXB0LUVuY29kaW5nDQpDb250ZW50LUVuY29kaW5nOiBnemlwDQpDb25uZWN0aW9uOiBLZWVwLUFsaXZlDQoNCg==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPAllHeaders>
        </HTTPHeaders>
        <HTTPBody>
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Ly8gRGVmaW5lcyB0aGUgc3BlZWQgb2YgYW5pbWF0aW9ucyBpbiBtaWxsaXNlY29uZHMgKG1zKS4NCi8vIFRoZSBzdHJpbmdzICJmYXN0IiAoMjAwbXMpIGFuZCAic2xvdyIgKDYwMG1zKSBjYW4gYWxzbyBiZSB1c2VkLg0KLy8gRGVmYXVsdCB2YWx1ZSBpcyAxMDAuDQp2YXIgc2l0c19hbmltX3NwZWVkID0gMTAwOw0KDQovLyBEZWZpbmVzIHRoZSBwb2ludCBhdCB3aGljaCB0aGUgeWVhciAiMjAiIGlzIHRyZWF0ZWQgYXMgMTkyMCBpbnN0ZWFkIG9mIDIwMjAuDQovLyBUaGlzIHNob3VsZCBiZSB0aGUgc2FtZSBhcyB0aGUgYXNzaWdubWVudCBmaWxlIHNldHRpbmcgJENFTlRVUllfQlJFQUsuDQovLyBEZWZhdWx0IHZhbHVlIGlzIDIwLg0KdmFyIHNpdHNfY2VudHVyeV9icmVhayA9IDIwOw0KDQovLyBEZWZpbmVzIHdoZXRoZXIgb3Igbm90IGEgQ29udGVudCBEZWxpdmVyeSBOZXR3b3JrIChDRE4pIHNob3VsZCBiZSB1c2VkIChhZGRlZCBpbiA4NzAuMSkuDQovLyBVc2luZyBvbmUgY2FuIHNwZWVkIHVwIHRoZSBwZXJmb3JtYW5jZSwgZXNwZWNpYWxseSBmb3IgdXNlcnMgaW4gb3RoZXIgY291bnRyaWVzLg0KLy8gRGVmYXVsdCB2YWx1ZSBpcyAwLg0KLy8gVmFsaWQgdmFsdWVzOg0KLy8gICAwID0gVXNlIGxvY2FsIGZpbGVzIChubyBDRE4pDQovLyAgIDEgPSBqUXVlcnkgQ0ROIC0gcHJvdmlkZWQgYnkgTWF4Q0ROICh0aGUgb2ZmaWNpYWwgalF1ZXJ5IG9uZSkNCi8vICAgMiA9IEdvb2dsZSBBUEkgQ0ROIC0gcHJvdmlkZWQgYnkgR29vZ2xlIChnZW5lcmFsbHkgY29uc2lkZXJlZCB0byBiZSBmYXN0ZXN0IGFuZCBtb3N0IHBvcHVsYXIpDQovLyAgIDMgPSBNaWNyb3NvZnQgQWpheCBDRE4gLSBwcm92aWRlZCBieSBNaWNyb3NvZnQNCi8vICAgNCA9IENsb3VkIEZsYXJlIENETiAtIHByb3ZpZGVkIGJ5IENsb3VkIEZsYXJlDQp2YXIgc2l0c19qcXVlcnlfY2RuID0gMDsNCg0KLy8gRGVmaW5lcyB0aGUgZm9ybWF0IG9mIGRhdGVzIHNlbGVjdGVkIGJ5IGEgZGF0ZSBwaWNrZXIgKGFkZGVkIGluIDg3MC4xKQ0KLy8gVGhpcyBtdXN0IGJlIGNvbXBhdGlibGUgd2l0aCB0aGUgc3lzdGVtIE5hdGlvbmFsIExhbmd1YWdlIFN1cHBvcnQgKE5MUykgc2V0dGluZ3MNCi8vIFNlZSBqUXVlcnkgVUkgd2Vic2l0ZSBmb3Igc3ludGF4IGRldGFpbHMgLSBodHRwOi8vYXBpLmpxdWVyeXVpLmNvbS9kYXRlcGlja2VyLyN1dGlsaXR5LWZvcm1hdERhdGUNCi8vIERlZmF1bHQgdmFsdWUgaXMgImRkL00veXkiLCBpZTogIjAxL0phbi8yMDAxIi4NCnZhciBzaXRzX2RhdGVfZm9ybWF0ID0gImRkL00veXkiDQovLyBHQiAvIFVLID0NCi8vIHZhciBzaXRzX2RhdGVfZm9ybWF0ID0gImQgTSB5eSI7DQovLyBDQSAoQ2FuYWRhKSA9DQovLyB2YXIgc2l0c19kYXRlX2Zvcm1hdCA9ICJ5eS1tbS1kZCI7DQovLyBVUyAoVVNBKSA9DQovLyB2YXIgc2l0c19kYXRlX2Zvcm1hdCA9ICJNIGQsIHl5IjsNCg0KLy8gRGVmaW5lcyB0aGUgZm9ybWF0IG9mIHRpbWVzIHVzaW5nICZEIG5vdGF0aW9uIChhZGRlZCBpbiA4NzEuMSkNCi8vIFRoaXMgbXVzdCBiZSBjb21wYXRpYmxlIHdpdGggdGhlIHN5c3RlbSBOYXRpb25hbCBMYW5ndWFnZSBTdXBwb3J0IChOTFMpIHNldHRpbmdzDQovLyBEZWZhdWx0IHZhbHVlIGlzICJIMjpOMiIsIGllOiAwOTozMA0KdmFyIHNpdHNfdGltZV9mb3JtYXQgPSAiSDI6TjIiOw0KDQovLyBEZWZpbmVzIHRoZSBhbHRlcm5hdGl2ZSB0ZXh0IGZvciBkYXRlIHBpY2tlciBidXR0b25zIChhZGRlZCBpbiA4ODAuMSkNCi8vIERlZmF1bHQgdmFsdWUgaXMgIi4uLiINCnZhciBzaXRzX2J1dHRvbl90ZXh0ID0gIi4uLiI7DQoNCi8vIERlZmluZXMgdGhlIG1heGltdW0gZmlsZSBzaXplIGZvciBhIGZpbGUgYmVpbmcgdXBsb2FkZWQgdXNpbmcgdGhlIHBsdXBsb2FkIHBsdWdpbiAoYWRkZWQgaW4gODgwLjEpDQovLyBEZWZhdWx0IHZhbHVlIGlzICIxMG1iIg0KdmFyIHNpdHNfcGx1cGxvYWRfbWF4X3NpemUgPSAiMTBtYiI7DQoNCi8vIERlZmluZXMgdGhlIGNodW5rIHNpemUgZm9yIGZpbGVzIGJlaW5nIHVwbG9hZGVkIHVzaW5nIHRoZSBwbHVwbG9hZCBwbHVnaW4gKGFkZGVkIGluIDg4MC4xKQ0KLy8gRGVmYXVsdCB2YWx1ZSBpcyAiMm1iIg0KdmFyIHNpdHNfcGx1cGxvYWRfY2h1bmtfc2l6ZSA9ICIybWIiOw0KDQovLyBMb2FkIG1pbmlmaWVkIEphdmFzY3JpcHQgcGx1Z2luIGZpbGVzIHdoZXJlIHBvc3NpYmxlIChhZGRlZCBpbiA4ODAuMSkNCi8vIFVzZWQgZm9yIHBsdWdpbnM6IGRhdGF0YWJsZXMsIG1pZ3JhdGUsIG1lbnUsIGNob3NlbiBhbmQgc2l0c2pxdGltZXRhYmxlDQp2YXIgc2l0c191c2VfbWluaWZpZWQgPSB0cnVlOw0KDQovLyBEZWZpbmVzIHRoZSB5ZWFyIHJhbmdlIGF2YWlsYWJsZSBpbiB0aGUgZGF0ZSBwaWNrZXIgKGFkZGVkIGluIDg4MC4xKQ0KLy8gU2VlIGpRdWVyeSBVSSB3ZWJzaXRlIGZvciBzeW50YXggZGV0YWlscyAtIGh0dHA6Ly9hcGkuanF1ZXJ5dWkuY29tL2RhdGVwaWNrZXIvI29wdGlvbi15ZWFyUmFuZ2UNCi8vIERlZmF1bHQgdmFsdWUgaXMgIi0xMDA6KzUwIiwgaWU6IDEwMCB5ZWFycyBiZWZvcmUgYW5kIDUwIHllYXJzIGFmdGVyIGN1cnJlbnQgeWVhcg0KdmFyIHNpdHNfeWVhcl9yYW5nZSA9ICItMTAwOis1MCI7DQoNCi8vIERlZmluZXMgdGhlIHJlc3BvbnNpdmUgYnJlYWtwb2ludHMgdG8gdXNlIGluIGU6VmlzaW9uIGluIHNpdHVhdGlvbnMgd2hlcmUgdGhvc2UgZGVmaW5lZCBpbiB0aGUgc3R5bGVzaGVldCBjYW5ub3QgYmUgdXNlZCAoYWRkZWQgaW4gOTEwLjEpDQovLyBUaGlzIGluY2x1ZGVzLCBmb3IgZXhhbXBsZSwgdGhvc2UgdXNlZCBieSB0aGUgUmVzcG9uc2l2ZSBleHRlbnNpb24gZm9yIERhdGF0YWJsZXMgKGFzIHVzZWQgdGhyb3VnaG91dCBlOlZpc2lvbiksIGFuZCBzaG91bGQgbm9ybWFsbHkgbWF0Y2ggdGhvc2UgbWF4aW11bXMgZGVmaW5lZCBpbiBzdi5jc3MuDQovLyBJdCB0YWtlcyB0aGUgZm9ybSBvZiBhbiBvYmplY3QgbGlzdGluZyBlYWNoIGJyZWFrcG9pbnQsIGFuZCBzaG91bGQgaW5jbHVkZSBtYXhpbXVtIHZhbHVlcyAoaW4gcGl4ZWxzKSBmb3IgdGhlIHdpZHRoIHRoYXQgc2hvdWxkIGFwcGx5IGZvciBMYXJnZSAobGcpLCBNZWRpdW0gKG1kKSwgU21hbGwgKHNtKSBhbmQgRXh0cmEgU21hbGwgKHhzKSBzY3JlZW5zaXplcw0KdmFyIHNpdHNfYnJlYWtwb2ludHMgPSB7ImxnIjogSW5maW5pdHksICJtZCI6IDExOTksICJzbSI6IDk5MSwgInhzIjogNzY3fTsNCg0KLy8gRGVmaW5lcyB3aGV0aGVyIHRvIGF1dG9tYXRpY2FsbHkgYXBwbHkgZTpWaXNpb24gdGFibGUgd2lkZ2V0cyAoRGF0YXRhYmxlcyBhbmQgVGFibGVzYXcpIHRvIHRhYmxlcyB3aGVuIHRoZSByZWxldmFudCBIVE1MNSBkYXRhIGF0dHJpYnV0ZXMgYXJlIHNwZWNpZmllZA0KLy8gQWRkZWQgaW4gOTEwLjEgLSBhY2NlcHRzIHRydWUgb3IgZmFsc2UgKHRvIGVuYWJsZSBvciBkaXNhYmxlIHJlc3BlY3RpdmVseSkNCnZhciBzaXRzX2F1dG9fdGFibGVfd2lkZ2V0cyA9IHRydWU7DQoNCi8vIERlZmluZXMgd2hldGhlciBEYXRhVGFibGVzIHNob3VsZCB1c2UgdGhlaXIgcmVzcG9uc2l2ZSBtb2RlIChpZiBhdmFpbGFibGUpIGJ5IGRlZmF1bHQuIFRoaXMgYXBwbGllcyB3aGVuIHRoZSByZXNwb25zaXZlIG1vZGUgaXNuJ3QgZXhwbGljaXRseSBzZXQgZm9yIGEgcGFydGljdWxhciB0YWJsZSAoaWYgaXQgd2FzIHRoZW4gaXQgd291bGQgb3ZlcnJpZGUgdGhpcyBzZXR0aW5nKQ0KLy8gQWRkZWQgaW4gOTEwLjEgLSBhY2NlcHRzIHRydWUgb3IgZmFsc2UgKHRvIGVuYWJsZSBvciBkaXNhYmxlIHJlc3BlY3RpdmVseSkNCnZhciBzaXRzX2RhdGF0YWJsZV9yZXNwb25zaXZlID0gdHJ1ZTsNCg0KLy8gRGVmaW5lcyBhbnkgc2NhbGUgZmFjdG9ycyB0byBhcHBseSB0byBkaWFsb2dzIChwcm9kdWNlZCBieSBzaXRzX2RpYWxvZykgZm9yIGVhY2ggYnJlYWtwb2ludC4gRm9yIGV4YW1wbGUsIGlmIGEgZGlhbG9nIGlzIG5vcm1hbGx5IDQwJSBvZiB0aGUgc2NyZWVuIHdpZHRoIGZvciB0aGUgTGFyZ2UgKGxnKQ0KLy8gYnJlYWtwb2ludCB0aGVuIHdlIGNvdWxkIHVzZSBhIHNjYWxlIGZhY3RvciBvZiAyIHRvIG1ha2UgaXQgODAlIGF0IHRoZSBtZWRpdW0gYnJlYWtwb2ludC4gSXQgY29uc2lzdHMgb2YgYW4gb2JqZWN0IGxpc3RpbmcgZmFjdG9ycyBmb3IgZWFjaCBicmVha3BvaW50LCBidXQgbm8gZGlhbG9nIHdpbGwgZXZlciBiZQ0KLy8gbW9yZSB0aGFuIDEwMCUgb2YgdGhlIHNjcmVlbi13aWR0aC4gQWRkZWQgaW4gOTEwLjEuDQp2YXIgc2l0c19kaWFsb2dfc2NhbGluZyA9IHsibGciOiAxLCAibWQiOiAxLjEsICJzbSI6IDEuNSwgInhzIjogM307DQoNCi8vIERlZmluZWQgd2hldGhlciB0aGUgaGVpZ2h0IG9mIGEgZGlhbG9nIHNob3VsZCwgYnkgZGVmYXVsdCwgYnkgbGltaXRlZCB0byBiZSBubyBtb3JlIHRoYW4gYSBjZXJ0YWluIHBlcmNlbnRhZ2Ugb2YgdGhlIHNjcmVlbiBoZWlnaHQgYXQgZWFjaCBicmVha3BvaW50LiBGb3IgZXhhbXBsZSwgdGhlIGRlZmF1bHQgb2YNCi8vIDAuOTUgd291bGQgbWVhbiB0aGF0IHRoZSBkaWFsb2dzIHdpbGwgYmUgaW5pdGlhbGx5IHNob3duIGF0IG5vIG1vcmUgdGhhbiA5NSUgb2YgdGhlIGhlaWdodCBvZiB0aGUgcGFnZSAoaS5lLiB3aWxsIGZpdCBvbiBzY3JlZW4pLCBhbmQgMTAgd291bGQgbWVhbiB0aGF0IHRoZXkgY2FuIGJlIDEwIHRpbWVzIHRoZSBoZWlnaHQgb2YgdGhlIHNjcmVlbi4gWW91IGNhbg0KLy8gdXNlICIiIHRvIGRpc2FibGUgdGhlIGxpbWl0IGZvciBhIHBhcnRpY3VsYXIgYnJlYWtwb2ludC4NCi8vIEl0IGNvbnNpc3RzIG9mIGFuIG9iamVjdCBsaXN0aW5nIG1heGltdW0gcmF0aW9zIGZvciBlYWNoIGJyZWFrcG9pbnQuIEFkZGVkIGluIDkxMC4xDQp2YXIgc2l0c19kaWFsb2dfaGVpZ2h0ID0geyJsZyI6IDAuOTUsICJtZCI6IDAuOTUsICJzbSI6ICIiLCAieHMiOiAiIn07DQoNCi8vIERlZmluZXMgd2hldGhlciBjZXJ0YWluIGFjdGlvbnMgc2hvdWxkIGhhcHBlbiBhdXRvbWF0aWNhbGx5IG9uIHNjcmVlbiByZXNpemUgKGluY2x1ZGluZyBkaWFsb2cgcmUtcG9zaXRpb25pbmcgYW5kIHJlc2NhbGluZykuIEFkZGVkIGluIDkxMC4xIC0gYWNjZXB0cyB0cnVlICh0byBhbHdheXMgcHJvY2VzcyBhcyB0aGUgc2NyZWVuIHJlc2l6ZXMgLSBkZWZhdWx0KSwgYW5kIGZhbHNlICh0byBkaXNhYmxlKQ0KdmFyIHNpdHNfYXV0b19yZXNpemUgPSB0cnVlOw0KDQovLyBEZWZpbmVzIHdoZXRoZXIgdG8gdXNlIHRoZSBzdi1wb3J0YWwuY3NzIHN0eWxlc2hlZXQgd2hlbiBzaG93aW5nIG11bHRpcGxlIGNvbHVtbnMgaW4gdGhlIHBvcnRhbC4gVGhlIHN0eWxlc2hlZXQgb3ZlcnJpZGVzIGNlcnRhaW4gYnJlYWtwb2ludHMgd2hlbiBzaG93aW5nIGNvbnRhaW5lciBvcHRpb25zIGluDQovLyBjb250ZW50IG1vZGUsIHdoaWNoIGNhbiBpbXByb3ZlIHRoZSBsb29rIGFuZCBmZWVsIG9mIHRoZSBjb250ZW50IG9uIHNvbWUgc2NyZWVuIHNpemVzLCBhbmQgd2lsbCBvbmx5IGJlIGxvYWRlZCB3aGVuIG5lZWRlZC4gQWRkZWQgaW4gOTEwLjEgLSBhY2NlcHRzIHRydWUgb3IgZmFsc2UgKHRvIGVuYWJsZSBvciBkaXNhYmxlIHJlc3BlY3RpdmVseSwgd2l0aCB0cnVlIHRoZSBkZWZhdWx0KQ0KdmFyIHNpdHNfdXNlX3BvcnRhbF9jc3MgPSB0cnVlOw0KDQovLyBEZWZpbmVzIHRoZSBtaW5pbXVtIHNpemUgZm9yIHRhYnMgdG8gYmUgcmVzaXplZCB0byBpbiBwaXhlbHMgKGFkZGVkIGluIDkyMC4xKQ0KLy8gRGVmYXVsdCB2YWx1ZSBpcyAxNTAuDQp2YXIgc2l0c19taW5fdGFiX3dpZHRoID0gMTUwOw==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPBody>
        <TcpPackets>
          <PacketInfo time="1085862296" offset="0" length="331" />
          <PacketInfo time="1085862312" offset="331" length="2560" />
        </TcpPackets>
      </HTTPResponse>
    </HTTPTask>
    <HTTPTask id="6112" hostname="graduate-studies-apply-uat.ualberta.ca" path="https://graduate-studies-apply-uat.ualberta.ca/urd/sits.urd/css/uoa-sits.css" url="https://graduate-studies-apply-uat.ualberta.ca/urd/sits.urd/css/uoa-sits.css" ip="129.128.12.49" port="443" connectionId="54" origin="HTML" frame="1" startDateTime="2019-01-02T11:43:29.436-05:00" startTime="1085862328" endTime="1085862328">
      <HTTPRequest method="GET">
        <HTTPHeaders>
          <HTTPHeaderEntity name="User-Agent" index="0">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>TW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV09XNjQ7IHJ2OjY0LjApIEdlY2tvLzIwMTAwMTAxIEZpcmVmb3gvNjQuMA==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Accept" index="1">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>dGV4dC9jc3MsKi8qO3E9MC4x</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Accept-Language" index="2">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>ZW4tR0IsZW47cT0wLjU=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Accept-Encoding" index="3">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>Z3ppcCwgZGVmbGF0ZQ==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Referer" index="4">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>aHR0cHM6Ly9ncmFkdWF0ZS1zdHVkaWVzLWFwcGx5LXVhdC51YWxiZXJ0YS5jYS91cmQvc2l0cy51cmQvcnVuL3Npd19wb3J0YWwudXJsPzI5REM2MkUzREExQjQ4NDR3UTJLcXpWeGZoNVFfaXZBd1czczhnUmVMbmxrc1ZCRmo4ZThROG9NUlFqMENXQ1NhRlQ1SDFodDctX1I1MjQzTW9iVGRXUFdrb2lxOHN6Q1hBT0xpa3d0Nk50ZTQyTlQyVDZFbUZkOWs5WQ==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="DNT" index="5">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>MQ==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Cookie" index="6">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>SlNFU1NJT05JRD0xRDdCNDYzNTkyMDU1RTU3ODhEQTAwMjcxNzk2OEJGRDsgQklHaXBTZXJ2ZXJTSVRTQVBQLVVBVC1IVFRQLmFwcH5TSVRTQVBQLVVBVC1IVFRQX3Bvb2w9MTA5Mjc1NDA5Mi4zNjg5NS4wMDAwOyBCSUdpcFNlcnZlclNoYXJlZElJUy1VQVQ9NzU3MjA5NzcyLjIwNDgwLjAwMDA=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Host" index="7">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>Z3JhZHVhdGUtc3R1ZGllcy1hcHBseS11YXQudWFsYmVydGEuY2E=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPAllHeaders>
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>R0VUIGh0dHBzOi8vZ3JhZHVhdGUtc3R1ZGllcy1hcHBseS11YXQudWFsYmVydGEuY2EvdXJkL3NpdHMudXJkL2Nzcy91b2Etc2l0cy5jc3MgSFRUUC8xLjENClVzZXItQWdlbnQ6IE1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdPVzY0OyBydjo2NC4wKSBHZWNrby8yMDEwMDEwMSBGaXJlZm94LzY0LjANCkFjY2VwdDogdGV4dC9jc3MsKi8qO3E9MC4xDQpBY2NlcHQtTGFuZ3VhZ2U6IGVuLUdCLGVuO3E9MC41DQpBY2NlcHQtRW5jb2Rpbmc6IGd6aXAsIGRlZmxhdGUNClJlZmVyZXI6IGh0dHBzOi8vZ3JhZHVhdGUtc3R1ZGllcy1hcHBseS11YXQudWFsYmVydGEuY2EvdXJkL3NpdHMudXJkL3J1bi9zaXdfcG9ydGFsLnVybD8yOURDNjJFM0RBMUI0ODQ0d1EyS3F6VnhmaDVRX2l2QXdXM3M4Z1JlTG5sa3NWQkZqOGU4UThvTVJRajBDV0NTYUZUNUgxaHQ3LV9SNTI0M01vYlRkV1BXa29pcThzekNYQU9MaWt3dDZOdGU0Mk5UMlQ2RW1GZDlrOVkNCkROVDogMQ0KQ29va2llOiBKU0VTU0lPTklEPTFEN0I0NjM1OTIwNTVFNTc4OERBMDAyNzE3OTY4QkZEOyBCSUdpcFNlcnZlclNJVFNBUFAtVUFULUhUVFAuYXBwflNJVFNBUFAtVUFULUhUVFBfcG9vbD0xMDkyNzU0MDkyLjM2ODk1LjAwMDA7IEJJR2lwU2VydmVyU2hhcmVkSUlTLVVBVD03NTcyMDk3NzIuMjA0ODAuMDAwMA0KSG9zdDogZ3JhZHVhdGUtc3R1ZGllcy1hcHBseS11YXQudWFsYmVydGEuY2ENCg0K</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPAllHeaders>
          <HTTPCookies>
            <HTTPHeaderEntity name="JSESSIONID" index="0">
              <HTTPDataSet>
                <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                  <ActualData>MUQ3QjQ2MzU5MjA1NUU1Nzg4REEwMDI3MTc5NjhCRkQ=</ActualData>
                </HTTPData>
              </HTTPDataSet>
              <IsExternalData>false</IsExternalData>
            </HTTPHeaderEntity>
            <HTTPHeaderEntity name="BIGipServerSITSAPP-UAT-HTTP.app~SITSAPP-UAT-HTTP_pool" index="1">
              <HTTPDataSet>
                <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                  <ActualData>MTA5Mjc1NDA5Mi4zNjg5NS4wMDAw</ActualData>
                </HTTPData>
              </HTTPDataSet>
              <IsExternalData>false</IsExternalData>
            </HTTPHeaderEntity>
            <HTTPHeaderEntity name="BIGipServerSharedIIS-UAT" index="2">
              <HTTPDataSet>
                <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                  <ActualData>NzU3MjA5NzcyLjIwNDgwLjAwMDA=</ActualData>
                </HTTPData>
              </HTTPDataSet>
              <IsExternalData>false</IsExternalData>
            </HTTPHeaderEntity>
          </HTTPCookies>
        </HTTPHeaders>
      </HTTPRequest>
      <HTTPResponse>
        <contentLenght>11603</contentLenght>
        <HTTPHeaders>
          <HTTPHeaderEntity name="Content-Type" index="0">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>dGV4dC9jc3M=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Last-Modified" index="1">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>VGh1LCAyNSBPY3QgMjAxOCAyMjoxNTo0NSBHTVQ=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Accept-Ranges" index="2">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>Ynl0ZXM=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="ETag" index="3">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>IjgwYmU0YjQ2YjA2Y2Q0MTowIg==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Server" index="4">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>TWljcm9zb2Z0LUlJUy84LjU=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="X-Powered-By" index="5">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>QVNQLk5FVA==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Date" index="6">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>V2VkLCAwMiBKYW4gMjAxOSAxNjo0MzowNyBHTVQ=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Content-Length" index="7">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>MTE2MDM=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Vary" index="8">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>QWNjZXB0LUVuY29kaW5n</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Content-Encoding" index="9">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>Z3ppcA==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Connection" index="10">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>S2VlcC1BbGl2ZQ==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPAllHeaders>
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LVR5cGU6IHRleHQvY3NzDQpMYXN0LU1vZGlmaWVkOiBUaHUsIDI1IE9jdCAyMDE4IDIyOjE1OjQ1IEdNVA0KQWNjZXB0LVJhbmdlczogYnl0ZXMNCkVUYWc6ICI4MGJlNGI0NmIwNmNkNDE6MCINClNlcnZlcjogTWljcm9zb2Z0LUlJUy84LjUNClgtUG93ZXJlZC1CeTogQVNQLk5FVA0KRGF0ZTogV2VkLCAwMiBKYW4gMjAxOSAxNjo0MzowNyBHTVQNCkNvbnRlbnQtTGVuZ3RoOiAxMTYwMw0KVmFyeTogQWNjZXB0LUVuY29kaW5nDQpDb250ZW50LUVuY29kaW5nOiBnemlwDQpDb25uZWN0aW9uOiBLZWVwLUFsaXZlDQoNCg==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPAllHeaders>
        </HTTPHeaders>
        <HTTPBody>
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>LyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLw0KLyogICAgIFVuaXZlcnNpdHkgb2YgQWxiZXJ0YSBTSVRTLU92ZXJyaWRlcyAgICAqLw0KLyogICAgIENyZWF0ZWQ6ICAybmQgTWFyY2ggMjAxNSAgICAgICAgICAgICAgICAqLw0KLyogICAgIFVwZGF0ZWQ6ICAyMXN0IE1hcmNoIDIwMTggICAgICAgICAgICAgICAqLw0KLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLw0KDQovKiBSZXNldCBCYWNrZ3JvdW5kIENvbG9yICovDQojc2l0c19wYWdlX2JhY2tncm91bmR7DQoJYmFja2dyb3VuZDoJaW5oZXJpdDsNCgloZWlnaHQ6IGluaXRpYWw7DQp9DQoNCi8qIEZpeCBDb250ZW50IE92ZXJmbG93ICovDQoNCkBtZWRpYSAobWluLXdpZHRoOiA2MS4yNWVtKSB7DQoJI3NpdHNwYWdlY29udGVudHsNCgkJbWFyZ2luOiAxNXB4IDUlOw0KCQl3aWR0aDogaW5pdGlhbDsNCgl9DQoNCgkubWFyZ2luLWxlZnR7DQoJCW1hcmdpbi1sZWZ0OjEwcHg7DQoJfQ0KDQoJLypsYWJlbHsNCgkJdGV4dC1hbGlnbjpsZWZ0Ow0KCX0qLw0KCQ0KCS5ibGFkZS1zZWFyY2ggaW5wdXRbdHlwZT1zZWFyY2hdOmZvY3Vzew0KCSAgICB6LWluZGV4OiAxMDAxICFpbXBvcnRhbnQ7DQoJCXBvc2l0aW9uOiByZWxhdGl2ZSAhaW1wb3J0YW50Ow0KCQl3aWR0aDogMTAwJSAhaW1wb3J0YW50Ow0KCX0NCg0KCQ0KfQ0KDQpAbWVkaWEgKG1pbi13aWR0aDogNzVlbSkgew0KICANCgkjc2l0c3BhZ2Vjb250ZW50ew0KCQltYXJnaW46IDE1cHggOSU7DQoJCXdpZHRoOiBpbml0aWFsOw0KCX0NCgkNCgkubWFyZ2luLWxlZnR7DQoJCW1hcmdpbi1sZWZ0OjBweDsNCgl9DQoNCgkvKmxhYmVsew0KCQl0ZXh0LWFsaWduOmxlZnQ7DQoJfSovDQoJDQoJLmJsYWRlLXNlYXJjaCBpbnB1dFt0eXBlPXNlYXJjaF06Zm9jdXN7DQoJICAgIHotaW5kZXg6IDEwMDEgIWltcG9ydGFudDsNCgkJcG9zaXRpb246IHJlbGF0aXZlICFpbXBvcnRhbnQ7DQoJCXdpZHRoOiAxMDAlICFpbXBvcnRhbnQ7DQoJfQ0KfQ0KDQoNCiNzaXdfaW50cmF5X2NvbnQgPiB0YWJsZSB0ciB0aCwNCiNzaXdfaW50cmF5X2NvbnQgPiB0YWJsZSB0ciB0ZHsNCiAJLypib3JkZXI6MXB4IHNvbGlkOyovDQp9DQoNCiNzaXdfaW50cmF5X2NvbnQgPiB0YWJsZSB0ciB0aCwNCiNzaXdfaW50cmF5X2NvbnQgPiB0YWJsZSB0ciB0aCBhew0KIAlmb250LXdlaWdodDogYm9sZCAhaW1wb3J0YW50Ow0KfQ0KDQojc2l3X2ludHJheV9jb250ID4gdGFibGUgdGhlYWQgdHIgdGggc3BhbiBpbWd7DQoJZmxvYXQ6cmlnaHQ7DQoJcGFkZGluZy10b3A6NXB4DQp9DQoNCiNzaXdfaW50cmF5X2NvbnQgPiB0YWJsZSB0Ym9keSB0ciB0ZCBpbWd7DQoJbWF4LXdpZHRoOmluaXRpYWw7DQp9DQoNCiNzaXdfaW50cmF5X2NvbnQgPiB0YWJsZSB0Ym9keSB0ciB0ZDpsYXN0LWNoaWxkID4gYTpob3Zlcg0Kc3Bhbi5kdW1teWJ1dHRvbiA+IGE6aG92ZXIsDQp0ZC5kdW1teWJ1dHRvbiA+IGE6aG92ZXIgew0KICBiYWNrZ3JvdW5kLWltYWdlOiAtbW96LWxpbmVhci1ncmFkaWVudCh0b3AsICMwMGI5NjEsICMwMDg2NDYpOw0KICBiYWNrZ3JvdW5kLWltYWdlOiAtd2Via2l0LWdyYWRpZW50KGxpbmVhciwgMCAwLCAwIDEwMCUsIGZyb20oIzAwYjk2MSksIHRvKCMwMDg2NDYpKTsNCiAgYmFja2dyb3VuZC1pbWFnZTogLXdlYmtpdC1saW5lYXItZ3JhZGllbnQodG9wLCAjMDBiOTYxLCAjMDA4NjQ2KTsNCiAgYmFja2dyb3VuZC1pbWFnZTogLW8tbGluZWFyLWdyYWRpZW50KHRvcCwgIzAwYjk2MSwgIzAwODY0Nik7DQogIGJhY2tncm91bmQtaW1hZ2U6IGxpbmVhci1ncmFkaWVudCh0byBib3R0b20sICMwMGI5NjEsICMwMDg2NDYpOw0KICBiYWNrZ3JvdW5kLXJlcGVhdDogcmVwZWF0LXg7DQogIGZpbHRlcjogcHJvZ2lkOkRYSW1hZ2VUcmFuc2Zvcm0uTWljcm9zb2Z0LmdyYWRpZW50KHN0YXJ0Q29sb3JzdHI9JyNmZjAwYjk2MScsIGVuZENvbG9yc3RyPScjZmYwMDg2NDYnLCBHcmFkaWVudFR5cGU9MCk7DQogIGNvbG9yOiAjZmZmZmZmOw0KfQ0KDQojc2l3X2ludHJheV9jb250ID4gdGFibGUgdGJvZHkgdHIgdGQ6bGFzdC1jaGlsZCA+IGEsDQpzcGFuLmR1bW15YnV0dG9uID4gYSwNCnRkLmR1bW15YnV0dG9uID4gYXsNCiAgICBib3JkZXI6IDFweCBzb2xpZDsgIA0KICAgIHBhZGRpbmc6IDAuM2VtIDEuNWVtIDAuM2VtIDEuNWVtOw0KICAtd2Via2l0LWJvcmRlci1yYWRpdXM6IDAuNGVtOw0KICAtbW96LWJvcmRlci1yYWRpdXM6IDAuNGVtOw0KICBib3JkZXItcmFkaXVzOiAwLjRlbTsNCiAgZm9udC1mYW1pbHk6ICJESU4gQm9sZCIsIHNhbnMtc2VyaWY7ICANCiAgdGV4dC1kZWNvcmF0aW9uOiBub25lOw0KICBmb250LXdlaWdodDogNTAwOw0KICB0ZXh0LWFsaWduOiBjZW50ZXI7ICBib3JkZXItY29sb3I6ICMwMGFmNWM7DQogIGJvcmRlci1ib3R0b20tY29sb3I6ICMwMDZkMzk7DQogIGJvcmRlci1yaWdodC1jb2xvcjogIzAwN2M0MTsNCiAgYmFja2dyb3VuZC1pbWFnZTogLW1vei1saW5lYXItZ3JhZGllbnQodG9wLCAjMDBhZjVjLCAjMDA3YzQxKTsNCiAgYmFja2dyb3VuZC1pbWFnZTogLXdlYmtpdC1ncmFkaWVudChsaW5lYXIsIDAgMCwgMCAxMDAlLCBmcm9tKCMwMGFmNWMpLCB0bygjMDA3YzQxKSk7DQogIGJhY2tncm91bmQtaW1hZ2U6IC13ZWJraXQtbGluZWFyLWdyYWRpZW50KHRvcCwgIzAwYWY1YywgIzAwN2M0MSk7DQogIGJhY2tncm91bmQtaW1hZ2U6IC1vLWxpbmVhci1ncmFkaWVudCh0b3AsICMwMGFmNWMsICMwMDdjNDEpOw0KICBiYWNrZ3JvdW5kLWltYWdlOiBsaW5lYXItZ3JhZGllbnQodG8gYm90dG9tLCAjMDBhZjVjLCAjMDA3YzQxKTsNCiAgYmFja2dyb3VuZC1yZXBlYXQ6IHJlcGVhdC14Ow0KICBmaWx0ZXI6IHByb2dpZDpEWEltYWdlVHJhbnNmb3JtLk1pY3Jvc29mdC5ncmFkaWVudChzdGFydENvbG9yc3RyPScjZmYwMGFmNWMnLCBlbmRDb2xvcnN0cj0nI2ZmMDA3YzQxJywgR3JhZGllbnRUeXBlPTApOw0KICBjb2xvcjogI2ZmZmZmZjsNCiAgdGV4dC1zaGFkb3c6IDFweCAxcHggMXB4ICMwNTVlMzM7DQogIC13ZWJraXQtYm94LXNoYWRvdzogMHB4IDFweCA0cHggcmdiYSgwLCAwLCAwLCAwLjE1KSwgaW5zZXQgMXB4IDFweCAxcHggIzYzY2I5YSwgaW5zZXQgMHB4IC0xcHggM3B4ICMwMDYyMzQ7DQogIC1tb3otYm94LXNoYWRvdzogMHB4IDFweCA0cHggcmdiYSgwLCAwLCAwLCAwLjE1KSwgaW5zZXQgMXB4IDFweCAxcHggIzYzY2I5YSwgaW5zZXQgMHB4IC0xcHggM3B4ICMwMDYyMzQ7DQogIGJveC1zaGFkb3c6IDBweCAxcHggNHB4IHJnYmEoMCwgMCwgMCwgMC4xNSksIGluc2V0IDFweCAxcHggMXB4ICM2M2NiOWEsIGluc2V0IDBweCAtMXB4IDNweCAjMDA2MjM0OyAgDQogICAgZm9udC1zaXplOiAxZW07DQp9DQoNCg0KLyogRmVpbGRzZXQgV2l0aCBhIEJvcmRlciBhbmQgYSBNaW4gSGVpZ2h0ICovDQpmaWVsZHNldC5vdXRlcnsNCgltaW4taGVpZ2h0OiAyNTBweDsNCglwYWRkaW5nOiAxNXB4Ow0KCW1hcmdpbjogMHB4Ow0KCWJvcmRlcjogMXB4IHNvbGlkICNFM0UzRTM7DQoJLXdlYmtpdC1ib3JkZXItcmFkaXVzOiA0cHg7DQoJLW1vei1ib3JkZXItcmFkaXVzOiA0cHg7DQoJYm9yZGVyLXJhZGl1czogNHB4Ow0KCS13ZWJraXQtYm94LXNoYWRvdzogaW5zZXQgMCAxcHggMXB4IHJnYmEoMCwgMCwgMCwgMC4wNSk7DQoJLW1vei1ib3gtc2hhZG93OiBpbnNldCAwIDFweCAxcHggcmdiYSgwLCAwLCAwLCAwLjA1KTsNCglib3gtc2hhZG93OiBpbnNldCAwIDFweCAxcHggcmdiYSgwLCAwLCAwLCAwLjA1KTsNCglib3gtc2hhZG93OiAwcHggMXB4IDRweCByZ2JhKDAsIDMwLCAxNSwgMC4yKTsNCgliYWNrZ3JvdW5kOiBub25lIHJlcGVhdCBzY3JvbGwgMCUgMCUgI0Y5RjlGOTsNCn0NCg0KLyogRmVpbGRzZXQgV2l0aCBhIEJvcmRlciBTY2FsaW5nICovDQpmaWVsZHNldC5vdXRlci1zY2FsZXsNCglwYWRkaW5nOiAxNXB4Ow0KCW1hcmdpbjogMHB4Ow0KCWJvcmRlcjogMXB4IHNvbGlkICNFM0UzRTM7DQoJLXdlYmtpdC1ib3JkZXItcmFkaXVzOiA0cHg7DQoJLW1vei1ib3JkZXItcmFkaXVzOiA0cHg7DQoJYm9yZGVyLXJhZGl1czogNHB4Ow0KCS13ZWJraXQtYm94LXNoYWRvdzogaW5zZXQgMCAxcHggMXB4IHJnYmEoMCwgMCwgMCwgMC4wNSk7DQoJLW1vei1ib3gtc2hhZG93OiBpbnNldCAwIDFweCAxcHggcmdiYSgwLCAwLCAwLCAwLjA1KTsNCglib3gtc2hhZG93OiBpbnNldCAwIDFweCAxcHggcmdiYSgwLCAwLCAwLCAwLjA1KTsNCglib3gtc2hhZG93OiAwcHggMXB4IDRweCByZ2JhKDAsIDMwLCAxNSwgMC4yKTsNCgliYWNrZ3JvdW5kOiBub25lIHJlcGVhdCBzY3JvbGwgMCUgMCUgI0Y5RjlGOTsNCn0NCg0KLyogQ2VudHJlIEFsaWduIFRleHQgKi8NCi50ZXh0LWNlbnRlcnsNCgl0ZXh0LWFsaWduOiBjZW50ZXI7DQp9DQoNCg0KLyogTGVmdCBBbGlnbiBUZXh0ICovDQoudGV4dC1sZWZ0ew0KCXRleHQtYWxpZ246IGxlZnQ7DQp9DQoNCi8qIFJpZ2h0IEFsaWduIFRleHQgKi8NCi50ZXh0LXJpZ2h0ew0KCXRleHQtYWxpZ246IHJpZ2h0Ow0KfQ0KDQovKiBSZXNldCBGb250IFNpemVzKi8NCiNJUFBXZWxjb21lLA0KI0lQUFBhZ2VUYWJzew0KCWZvbnQtc2l6ZTogaW5oZXJpdDsJDQp9DQoNCi8qSVBSIEFwcGxpY2F0aW9uIFBhbmVscyovDQouaXBycmVjLA0KLmlwcG9jYywNCi5hcHBzZWN7DQoJbWFyZ2luLXRvcDogNXB4Ow0KfQ0KDQovKlJpZ2h0IEFsaWduIFRleHQgZm9yIERlc2t0b3AqLw0KLmRlc2t0b3AtcmlnaHR7DQoJdGV4dC1hbGlnbjogcmlnaHQ7DQp9DQoNCkBtZWRpYSAobWF4LXdpZHRoOiA0My4xMjVlbSkgew0KCQ0KCS5kZXNrdG9wLXJpZ2h0ewkNCgkJdGV4dC1hbGlnbjogaW5oZXJpdDsNCgl9DQoNCn0NCg0KDQovKiBMaW5rIE92ZXJyaWRlcyAqLw0KYSB7DQoJY29sb3I6ICMwMDdjNDE7DQoJdGV4dC1kZWNvcmF0aW9uOiBub25lOw0KfQ0KYTpsaW5rIHsNCgljb2xvcjogIzAwN2M0MTsNCgl0ZXh0LWRlY29yYXRpb246IG5vbmU7DQp9DQphOnZpc2l0ZWQgeyANCgl0ZXh0LWRlY29yYXRpb246IG5vbmU7DQp9DQphOmhvdmVyIHsgDQoJY29sb3I6ICMwMDdjNDE7DQoJdGV4dC1kZWNvcmF0aW9uOiBub25lOw0KfQ0KYTphY3RpdmUgew0KCWNvbG9yOiAjMDA3YzQxOw0KCXRleHQtZGVjb3JhdGlvbjogbm9uZTsNCn0NCg0KYS5idG4tZ3JlZW4sIGEuc2l0ZS10aXRsZSAgew0KCWNvbG9yOiAjZmZmZmZmOw0KCXRleHQtZGVjb3JhdGlvbjogbm9uZTsNCn0NCmEuYnRuLWdyZWVuOmxpbmt7DQoJY29sb3I6ICNmZmZmZmY7DQoJdGV4dC1kZWNvcmF0aW9uOiBub25lOw0KfQ0KYS5idG4tZ3JlZW46dmlzaXRlZCwgYS5zaXRlLXRpdGxlOnZpc2l0ZWQgeyANCgljb2xvcjogI2ZmZmZmZjsNCgl0ZXh0LWRlY29yYXRpb246IG5vbmU7DQp9DQphLmJ0bi1ncmVlbjpob3ZlciB7IA0KCWNvbG9yOiAjZmZmZmZmOw0KCXRleHQtZGVjb3JhdGlvbjogbm9uZTsNCn0NCmEuYnRuLWdyZWVuOmFjdGl2ZSwgYS5zaXRlLXRpdGxlOmFjdGl2ZSB7DQoJY29sb3I6ICNmZmZmZmY7DQoJdGV4dC1kZWNvcmF0aW9uOiBub25lOw0KfQ0KDQphLnNpdGUtdGl0bGU6aG92ZXIgew0KY29sb3I6ICNmZmRiMDU7DQp9DQoNCi8qIEZvbnQgQXdlc29tZSAtIFNwZWNpYWwgU2l6ZSAqLw0KLmZhLTEtMjV7DQoJZm9udC1zaXplOiAxLjI1ZW07DQoJdmVydGljYWwtYWxpZ246IG1pZGRsZTsgDQoJcGFkZGluZy1ib3R0b206IDFweDsgDQoJd2lkdGg6IDIwcHg7DQp9DQoNCi8qIEZvbnQgQXdlc29tZSAtIENvbG91cnMgKi8NCi5mYS5zdWNjZXNzIHsNCgljb2xvcjogIzQ2ODg0NzsNCn0NCg0KLmZhLndhcm5pbmcgew0KCWNvbG9yOiAjYjk0YTQ4Ow0KfQ0KDQoNCi8qTWFuZGF0b3J5IGZpZWxkIEhpZ2hsaWdodGluZyAqLw0KaW5wdXQuc2l0c21hbmRhdG9yeWlucHV0LA0Kc2VsZWN0LnNpdHNtYW5kYXRvcnlpbnB1dCwNCnRleHRhcmVhLnNpdHNtYW5kYXRvcnlpbnB1dHsNCglib3JkZXItY29sb3I6ICNiOTRhNDg7DQoJLXdlYmtpdC1ib3gtc2hhZG93OiBpbnNldCAwIDFweCAxcHggcmdiYSgwLCAwLCAwLCAwLjA3NSk7DQoJLW1vei1ib3gtc2hhZG93OiBpbnNldCAwIDFweCAxcHggcmdiYSgwLCAwLCAwLCAwLjA3NSk7DQoJYm94LXNoYWRvdzogaW5zZXQgMCAxcHggMXB4IHJnYmEoMCwgMCwgMCwgMC4wNzUpOw0KCWNvbG9yOiAjYjk0YTQ4Ow0KCWJhY2tncm91bmQtY29sb3I6I2ZmZmZmZjsNCgl0cmFuc2l0aW9uOiBib3JkZXIgbGluZWFyIDAuMnMsIGJveC1zaGFkb3cgbGluZWFyIDAuMnMNCn0NCg0KaW5wdXQuc2l0c21hbmRhdG9yeWlucHV0OmZvY3VzLA0Kc2VsZWN0LnNpdHNtYW5kYXRvcnlpbnB1dDpmb2N1cywNCnRleHRhcmVhLnNpdHNtYW5kYXRvcnlpbnB1dDpmb2N1c3sNCglib3JkZXItY29sb3I6ICM5NTNiMzk7DQoJLXdlYmtpdC1ib3gtc2hhZG93OiBpbnNldCAwIDFweCAxcHggcmdiYSgwLCAwLCAwLCAwLjA3NSksIDAgMCA2cHggDQoNCiNkNTkzOTI7DQoJLW1vei1ib3gtc2hhZG93OiBpbnNldCAwIDFweCAxcHggcmdiYSgwLCAwLCAwLCAwLjA3NSksIDAgMCA2cHggDQoNCiNkNTkzOTI7DQoJYm94LXNoYWRvdzogaW5zZXQgMCAxcHggMXB4IHJnYmEoMCwgMCwgMCwgMC4wNzUpLCAwIDAgNnB4ICNkNTkzOTI7DQp9DQoNCmxhYmVsLnNpdHNtYW5kYXRvcnlpbnB1dHsNCgljb2xvcjogI2I5NGE0ODsNCn0NCg0KDQoNCmlucHV0LnNpdHNtYW5kYXRvcnlpbnB1dDo6LXdlYmtpdC1pbnB1dC1wbGFjZWhvbGRlciwNCnNlbGVjdC5zaXRzbWFuZGF0b3J5aW5wdXQ6Oi13ZWJraXQtaW5wdXQtcGxhY2Vob2xkZXIsDQp0ZXh0YXJlYS5zaXRzbWFuZGF0b3J5aW5wdXQ6Oi13ZWJraXQtaW5wdXQtcGxhY2Vob2xkZXIgew0KICBjb2xvcjogI2I5NGE0ODsNCn0NCg0KaW5wdXQuc2l0c21hbmRhdG9yeWlucHV0OjotbW96LXBsYWNlaG9sZGVyLA0Kc2VsZWN0LnNpdHNtYW5kYXRvcnlpbnB1dDo6LW1vei1wbGFjZWhvbGRlciwgDQp0ZXh0YXJlYS5zaXRzbWFuZGF0b3J5aW5wdXQ6Oi1tb3otcGxhY2Vob2xkZXIgeyAvKiBGaXJlZm94IDE5KyAqLw0KICBjb2xvcjogI2I5NGE0ODsNCn0NCg0KaW5wdXQuc2l0c21hbmRhdG9yeWlucHV0Oi1tcy1pbnB1dC1wbGFjZWhvbGRlciwNCnNlbGVjdC5zaXRzbWFuZGF0b3J5aW5wdXQ6LW1zLWlucHV0LXBsYWNlaG9sZGVyLA0KdGV4dGFyZWEuc2l0c21hbmRhdG9yeWlucHV0Oi1tcy1pbnB1dC1wbGFjZWhvbGRlciB7DQogIGNvbG9yOiAjYjk0YTQ4Ow0KfQ0KDQppbnB1dC5zaXRzbWFuZGF0b3J5aW5wdXQ6LW1vei1wbGFjZWhvbGRlciwNCnNlbGVjdC5zaXRzbWFuZGF0b3J5aW5wdXQ6LW1vei1wbGFjZWhvbGRlciwNCnRleHRhcmVhLnNpdHNtYW5kYXRvcnlpbnB1dDotbW96LXBsYWNlaG9sZGVyIHsgLyogRmlyZWZveCAxOC0gKi8NCiAgY29sb3I6ICNiOTRhNDg7DQp9DQoNCi51aS13aWRnZXQtaGVhZGVyIHsNCgliYWNrZ3JvdW5kOiAjZmZmZmZmOw0KCWNvbG9yOiMzZDRhNDM7DQoJZm9udC1mYW1pbHk6ICJESU4gQm9sZCIsIHNhbnMtc2VyaWY7CQ0KZm9udC1zaXplOjEuMzVlbTsNCmJvcmRlcjogbm9uZTsNCmJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjYWFhOw0KYm9yZGVyLWJvdHRvbS1yaWdodC1yYWRpdXM6MDsNCmJvcmRlci1ib3R0b20tbGVmdC1yYWRpdXM6MDsNCn0NCg0KLnVpLWRhdGVwaWNrZXIgew0Kd2lkdGg6IDIwZW07DQp9DQoNCi5pbmxpbmUtc2VhcmNoIC5idG4tb3Jnew0KCXRvcDogYXV0bzsNCglyaWdodDogMDsNCgl3aWR0aDogYXV0bzsNCgltYXJnaW46IDA7DQoJLXdlYmtpdC1ib3JkZXItcmFkaXVzOiAwcHggNHB4IDRweCAwcHg7DQoJLW1vei1ib3JkZXItcmFkaXVzOiAwcHggNHB4IDRweCAwcHg7DQoJYm9yZGVyLXJhZGl1czogMHB4IDRweCA0cHggMHB4Ow0KCS13ZWJraXQtYm94LXNoYWRvdzogbm9uZTsNCgktbW96LWJveC1zaGFkb3c6IG5vbmU7DQoJYm94LXNoYWRvdzogbm9uZTsNCgl0ZXh0LWFsaWduOiBjZW50ZXI7DQoJbWFyZ2luLWxlZnQ6IC0wLjM1N2VtOw0KCW1hcmdpbi10b3A6IC0wLjU3ZW07DQoJaGVpZ2h0OiAxLjhlbTsNCglwYWRkaW5nOiAwLjVlbSAwLjhlbSAhaW1wb3J0YW50Ow0KfQ0KDQoudWktZGlhbG9nIC51aS1kaWFsb2ctYnV0dG9ucGFuZSBidXR0b24sDQoucGFnaW5nX2Z1bGxfbnVtYmVycyBhLnBhZ2luYXRlX2J1dHRvbiwNCi5wYWdpbmdfZnVsbF9udW1iZXJzIGEucGFnaW5hdGVfYnV0dG9uLCAucGFnaW5nX2Z1bGxfbnVtYmVycyBhLnBhZ2luYXRlX2FjdGl2ZSB7LyogbWFyZ2luOiAuNWVtIC40ZW0gLjVlbSAwOyAqLy8qIGN1cnNvcjogcG9pbnRlcjsgKi8vKiBib3JkZXItY29sb3I6ICNkZmU5ZTM7ICovLyogZm9udC1zaXplOjEuMmVtOyAqLy8qIGJvcmRlci1ib3R0b20tY29sb3I6ICNiOGNlYzE7ICovYm9yZGVyLXJpZ2h0LWNvbG9yOiAjZDBkZmQ2O2JhY2tncm91bmQtaW1hZ2U6IC1tb3otbGluZWFyLWdyYWRpZW50KHRvcCwgI2Y0ZjRmNCwgI2RmZTllMyk7YmFja2dyb3VuZC1pbWFnZTogLXdlYmtpdC1ncmFkaWVudChsaW5lYXIsIDAgMCwgMCAxMDAlLCBmcm9tKCNmNGY0ZjQpLCB0bygjZGZlOWUzKSk7YmFja2dyb3VuZC1pbWFnZTogLXdlYmtpdC1saW5lYXItZ3JhZGllbnQodG9wLCAjZjRmNGY0LCAjZGZlOWUzKTtiYWNrZ3JvdW5kLWltYWdlOiAtby1saW5lYXItZ3JhZGllbnQodG9wLCAjZjRmNGY0LCAjZGZlOWUzKTtiYWNrZ3JvdW5kLWltYWdlOiBsaW5lYXItZ3JhZGllbnQodG8gYm90dG9tLCAjZjRmNGY0LCAjZGZlOWUzKTtiYWNrZ3JvdW5kLXJlcGVhdDogcmVwZWF0LXg7ZmlsdGVyOiBwcm9naWQ6RFhJbWFnZVRyYW5zZm9ybS5NaWNyb3NvZnQuZ3JhZGllbnQoc3RhcnRDb2xvcnN0cj0nI2ZmZjRmNGY0JywgZW5kQ29sb3JzdHI9JyNmZmRmZTllMycsIEdyYWRpZW50VHlwZT0wKTtjb2xvcjogIzAwN2M0MTt0ZXh0LXNoYWRvdzogMHB4IDFweCAxcHggI2ZmZmZmZjstd2Via2l0LWJveC1zaGFkb3c6IDBweCAxcHggNHB4IHJnYmEoMCwgMCwgMCwgMC4xNSksIGluc2V0IDFweCAxcHggMXB4ICNmZmZmZmYsIGluc2V0IDBweCAtMXB4IDNweCAjZDBkZmQ2Oy1tb3otYm94LXNoYWRvdzogMHB4IDFweCA0cHggcmdiYSgwLCAwLCAwLCAwLjE1KSwgaW5zZXQgMXB4IDFweCAxcHggI2ZmZmZmZiwgaW5zZXQgMHB4IC0xcHggM3B4ICNkMGRmZDY7Ym94LXNoYWRvdzogMHB4IDFweCA0cHggcmdiYSgwLCAwLCAwLCAwLjE1KSwgaW5zZXQgMXB4IDFweCAxcHggI2ZmZmZmZiwgaW5zZXQgMHB4IC0xcHggM3B4ICNkMGRmZDY7dGV4dC1kZWNvcmF0aW9uOiBub25lO3RleHQtYWxpZ246IGNlbnRlcjtmb250LWZhbWlseTogIkRJTiBCb2xkIiwgc2Fucy1zZXJpZjt9DQoNCi5wYWdpbmdfZnVsbF9udW1iZXJzIGEucGFnaW5hdGVfYnV0dG9uLCANCi5wYWdpbmdfZnVsbF9udW1iZXJzIGEucGFnaW5hdGVfYWN0aXZlIHsNCglwYWRkaW5nOjAuNGVtOw0KCWZvbnQtc2l6ZTogMWVtOw0KfQ0KDQoucGFnaW5nX2Z1bGxfbnVtYmVycyBhLnBhZ2luYXRlX2FjdGl2ZSB7DQoJY29sb3I6ICMwMDdjNDEgIWltcG9ydGFudDsNCn0NCg0KLnVpLWRpYWxvZyB7DQoJZm9udC1zaXplOjFlbTsNCn0NCg0KI29yZ19zZWxfZGlhbG9nW3N0eWxlXXsNCgloZWlnaHQ6IGF1dG8gIWltcG9ydGFudDsNCn0NCg0KI3Npd29yZ3NlbGRhdGFyZXN1bHRzX2xlbmd0aHsNCgl3aWR0aDphdXRvOw0KfQ0KDQojc2l3c2Vsb3JnZGF0YXNlY3Rpb257DQoJZm9udC1zaXplOiAwLjllbTsNCn0NCg0KI3Npd29yZ3NlbGRhdGFyZXN1bHRzIHRyew0KCWJhY2tncm91bmQtY29sb3I6ICNmOWY5Zjk7DQogIAliYWNrZ3JvdW5kLWNvbG9yOiByZ2JhKDI0OSwgMjQ5LCAyNDksIDAuNjUpOw0KfQ0KDQojc2l3b3Jnc2VsZGF0YXJlc3VsdHMgdGJvZHkgdHI6aG92ZXIgdGQsICNzaXdvcmdzZWxkYXRhcmVzdWx0cyB0Ym9keSB0cjpob3ZlciB0aCB7DQogIGJhY2tncm91bmQtY29sb3I6ICNmNWY1ZjU7DQogIGJhY2tncm91bmQtY29sb3I6IHJnYmEoMjU1LCAyNDUsIDE4NCwgMC4xNSk7DQogIGJvcmRlci1jb2xvcjogI0UxRDhBNDsNCiAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICNFMUQ4QTQ7DQogIG1hcmdpbi1ib3R0b206IC0xcHg7DQp9DQoNCiNzaXdvcmdzZWxkYXRhcmVzdWx0cyB0Ym9keSB0ciB0ZC5zb3J0aW5nXzF7DQoJYmFja2dyb3VuZC1jb2xvcjogI2Y1ZjVmNTsNCiAgCWJhY2tncm91bmQtY29sb3I6IHJnYmEoMjU1LCAyNDUsIDE4NCwgMC4zNSk7DQp9DQoNCiNzaXdvcmdzZWxkYXRhcmVzdWx0cyB0ci5yb3dfc2VsZWN0ZWQgdGR7DQoJYmFja2dyb3VuZC1jb2xvcjogI2Y1ZjVmNTsNCiAgCWJhY2tncm91bmQtY29sb3I6IHJnYmEoMjU1LCAyNDUsIDE4NCwgMC4zNSk7DQp9DQoNCg0KDQovKkJvb3RzdHJhcCBFcnJvciBNZXNzYWdlcyovDQouYWxlcnQgew0KICBwYWRkaW5nOiA4cHggMzVweCA4cHggMTRweDsNCiAgbWFyZ2luLWJvdHRvbTogMjBweDsNCiAgdGV4dC1zaGFkb3c6IDAgMXB4IDAgcmdiYSgyNTUsIDI1NSwgMjU1LCAwLjUpOw0KICBiYWNrZ3JvdW5kLWNvbG9yOiAjZmNmOGUzOw0KICBib3JkZXI6IDFweCBzb2xpZCAjZmJlZWQ1Ow0KICAtd2Via2l0LWJvcmRlci1yYWRpdXM6IDRweDsNCiAgLW1vei1ib3JkZXItcmFkaXVzOiA0cHg7DQogIGJvcmRlci1yYWRpdXM6IDRweDsNCn0NCg0KLmFsZXJ0LWRhbmdlciwgLmFsZXJ0LWVycm9yIHsNCiAgY29sb3I6ICNiOTRhNDg7DQogIGJhY2tncm91bmQtY29sb3I6ICNmMmRlZGU7DQogIGJvcmRlci1jb2xvcjogI2VlZDNkNzsNCn0NCg0KLmNycy10aXRsZXsNCgkgIG1hcmdpbi10b3A6IDAuNWVtOw0KfQ0KDQouZmlsZVVwbG9hZCB7DQoJcG9zaXRpb246IHJlbGF0aXZlOw0KCW92ZXJmbG93OiBoaWRkZW47DQp9DQoNCi5maWxlVXBsb2FkIGlucHV0LnVwbG9hZCB7DQoJcG9zaXRpb246IGFic29sdXRlOw0KCXRvcDogMDsNCglyaWdodDogMDsNCgltYXJnaW46IDA7DQoJcGFkZGluZzogMDsNCglmb250LXNpemU6IDIwcHg7DQoJY3Vyc29yOiBwb2ludGVyOw0KCW9wYWNpdHk6IDA7DQoJZmlsdGVyOiBhbHBoYShvcGFjaXR5PTApOw0KICAgIAl3aWR0aDoxMDAlOw0KCWhlaWdodDoxMDAlOw0KfQ0KDQovKiBvdmVycmlkZSBmaWVsZHNldHMgYm9yZGVycyovDQoNCmZpZWxkc2V0Lm5vbGluZSwgbGVnZW5kLm5vbGluZXsNCglib3JkZXItYm90dG9tOiBub25lOw0KCSAgbWFyZ2luLWJvdHRvbTogMDsNCn0NCg0KLypFeHRyYSBQYWRkaW5nKi8NCi5wYWQtYm90dG9tew0KCXBhZGRpbmctYm90dG9tOjEwcHgNCn0NCg0KLnBhZC10b3B7DQoJcGFkZGluZy10b3A6MTBweA0KfQ0KDQovKiBMb2dpbiBJbnB1dHMgU2NhbGUgKi8NCg0KaW5wdXQubG9naW4sIHNlbGVjdC5sb2dpbnsNCgl3aWR0aDozMDBweDsNCn0NCg0KDQpAbWVkaWEgKG1heC13aWR0aDogNjkwcHgpIHsNCgkNCglpbnB1dC5sb2dpbiwgc2VsZWN0LmxvZ2luew0KCQl3aWR0aDo5NSU7DQoJfQ0KCQ0KCSNzaXRzcGFnZWNvbnRlbnQgew0KICAJCW1hcmdpbjogaW5pdGlhbDsNCgl9DQoJDQoJLmJsYWRlLXNlYXJjaCBpbnB1dFt0eXBlPXNlYXJjaF06Zm9jdXN7DQoJICAgIHotaW5kZXg6IDEwMDEgIWltcG9ydGFudDsNCgkJcG9zaXRpb246IHJlbGF0aXZlICFpbXBvcnRhbnQ7DQoJCXdpZHRoOiAxMDAlICFpbXBvcnRhbnQ7DQoJfQ0KfQ0KDQovKiBFeHRyYXMgTWFyZ2lucyAqLw0KLm1hcmdpbk92ZXJyaWRlew0KCW1hcmdpbjogMC41ZW0gMCAwLjVlbSAwOw0KfQ0KDQoubWFyZ2luLXRvcHsNCgltYXJnaW4tdG9wOjEwcHg7DQp9DQoNCi5tYXJnaW4tYm90dG9tew0KCW1hcmdpbi1ib3R0b206MTBweDsNCn0NCg0KLm1hcmdpbi1sZWZ0ew0KCW1hcmdpbi1sZWZ0OjEwcHg7DQp9DQoNCi8qbGFiZWx7DQoJdGV4dC1hbGlnbjpyaWdodDsNCn0qLw0KDQoNCkBtZWRpYSAobWF4LXdpZHRoOiA0My4xMjVlbSkgew0KDQoJDQoJLypsYWJlbHsNCgkJdGV4dC1hbGlnbjogaW5oZXJpdDsNCgl9Ki8NCg0KCS50ZXh0LWNlbnRlciB7DQogIAkJdGV4dC1hbGlnbjogaW5oZXJpdDsNCgl9DQoJDQoJLmJsYWRlLXNlYXJjaCBpbnB1dFt0eXBlPXNlYXJjaF06Zm9jdXN7DQoJICAgIHotaW5kZXg6IDEwMDEgIWltcG9ydGFudDsNCgkJcG9zaXRpb246IHJlbGF0aXZlICFpbXBvcnRhbnQ7DQoJCXdpZHRoOiAxMDAlICFpbXBvcnRhbnQ7DQoJfQ0KDQp9DQoNCi5uYXZpZ2F0aW9uLWlubmVyIHVsIGxpIHVsIGxpIGF7DQoJcGFkZGluZy1sZWZ0OjIwcHg7DQoJcGFkZGluZy1yaWdodDoyMHB4Ow0KfQ0KDQovKlRlbXBvcmFyeSBFdmlzaW9uIEZvbnQgRml4Ki8NCi5wYWdldGl0bGUsLnBhZ2Vtc2csLnRhYmxldGl0bGUxLCAudGFibGV0aXRsZWFqYXgsLnRhYmxldGl0bGUyLC50YWJsZW1zZzEsLnRhYmxlbXNnMiwucmVjb3JkY291bnQsLmNvbGhlYWQxLC5jb2xoZWFkMiwucm93aGVhZDEsLnJvd2hlYWQyLC5kYXRhMSwuZGF0YTFvdmVyLC5kYXRhMiwuZGF0YTJvdmVyLC5iZ2Zvcm1pbiwuYmdmb3Jtc3ViLHByZSwuZXJyb3IxLC5sZXR0ZXJfYm9keSwubGV0dGVyX2JvZHlfc3Ryb25nLC5kYXRlLC5wYWdlaGVscHRleHQsLnBvcnRhbGNvbnRpdGxlMSwucGFnZXRhYnMydGl0bGUsI3NpdHNoZWFkZXJjb250cm9sbGlua3MsI3NpdHNsb2dnZWRpbm1lc3NhZ2UsI3NpdHNoZWFkZXJkYXRldGV4dCAsLnNpdHNmb290ZXJ0ZXh0ICwjc2l0c3BhZ2V0YWJzIGEsLnNpdHNwYWdldGFicy12ZXJ0LC5zaXRzcGFnZXRhYnMtdmVydDEgdWwsI3NpdHNwYWdldGFicy12ZXJ0MixoMS5zaXRzcG9ydGFscGFnZXRpdGxlLHAuc2l0c3BvcnRhbHBhZ2VkZXNjICxwLnNpdHNwYWdlZGVzYyxwLnNpdHNwYWdlaGVscCwucG9ydGFsY29udGl0bGUsLnBvcnRhbGxpbmsgLC5wb3J0YWxsaW5rIGE6bGluaywucG9ydGFsbGluayBhOnZpc2l0ZWQgLC5wb3J0YWxsaW5rLC5wb3J0YWxsaW5rIGE6YWN0aXZlLC5zaXRzY29udGl0bGUscC5zaXRzY29udHJvbHMsLnNpdHNjb25oZWxwLC5zaXRzY29waGVscCwuc2l0c2NvbmRlc2NyaXB0aW9uLHAuc2l0c2NvcGljb24sLnNpdHNuZXdjb250ZXh0LC5zaXRzbmV3Y29wdGV4dCx1bC5zaXRzY29wLHAuc2l0c2NvcCxib2R5LGRpdiNjb250YWluZXIsZGl2I3RpdGxlDQp7DQoJZm9udC1zaXplOjEwMCU7CQ0KCWZvbnQtZmFtaWx5OiBzYW5zLXNlcmlmOw0KfQ0KDQojc2l0c3BhZ2Vjb250ZW50ICNzaXRzcGFnZWNvbnRlbnR7DQoJbWFyZ2luOjA7DQp9DQoNCiNzaXRzX3NlYXJjaF9pbnB1dHsNCglwYWRkaW5nOjRweDsNCgltYXJnaW4tYm90dG9tOiAwOw0KfQ0KDQouc2l0c3BhZ2V0aXRsZSwNCmgxLnNpdHNwYWdldGl0bGUsDQpoMi5zaXRzcGFnZXRpdGxlLA0KLnNpdHNwb3J0YWxwYWdldGl0bGUsDQpoMS5zaXRzcG9ydGFscGFnZXRpdGxlLA0KaDIuc2l0c3BvcnRhbHBhZ2V0aXRsZXsNCglmb250LWZhbWlseTogIkRJTiBCb2xkIiwgc2Fucy1zZXJpZjsNCiAgZm9udC1zaXplOiAxLjcxNDNlbTsNCiAgbGluZS1oZWlnaHQ6IDEuMmVtOw0KICBjb2xvcjogIzNkNGE0MzsNCiAgZm9udC13ZWlnaHQ6IGJvbGQ7DQogIGJvcmRlci1ib3R0b206IG5vbmU7DQp9DQoNCi8qVGFibGUgSGFja3MqLw0KDQouc2l0c3RhYmxlZ3JpZCB0aCwgDQouc2l0c3RhYmxlZ3JpZCB0ZCAsDQouc2l0c3RhYmxlb3V0bGluZSB0aCwNCi5zaXRzdGFibGVvdXRsaW5lIHRkIHsNCiAgZm9udC1zaXplOiAxMDAlOw0KICBmb250LWZhbWlseTogc2Fucy1zZXJpZjsNCiAgYm9yZGVyOiBub25lOw0KICBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDsNCiAgY29sb3I6IGluaGVyaXQ7DQogIHRleHQtcmVuZGVyaW5nOiBvcHRpbWl6ZWxlZ2liaWxpdHk7DQogIHZlcnRpY2FsLWFsaWduOiBtaWRkbGU7DQp9DQoNCi5zaXRzdGFibGVncmlkLCAuc2l0c3RhYmxldmVydGljYWwsIC5zaXRzdGFibGVob3Jpem9udGFsLCAuc2l0c3RhYmxlb3V0bGluZSB7DQogIGJhY2tncm91bmQtY29sb3I6IHRyYW5zcGFyZW50Ow0KICBib3JkZXI6bm9uZTsNCn0NCg0KLnNpdHN0YWJsZWdyaWQgY2FwdGlvbiwgLnNpdHN0YWJsZXZlcnRpY2FsIGNhcHRpb24sIC5zaXRzdGFibGVob3Jpem9udGFsIGNhcHRpb24sIC5zaXRzdGFibGVvdXRsaW5lIGNhcHRpb24sIC50YWJsZXRpdGxlMSwgLnRhYmxldGl0bGVhamF4IHsNCiAgZm9udC1mYW1pbHk6ICJESU4gQm9sZCIsIHNhbnMtc2VyaWY7DQogIGZvbnQtc2l6ZTogMTAwJTsNCiAgY29sb3I6ICMzZDRhNDM7DQogIHBhZGRpbmc6IDZweDsNCiAgZm9udC13ZWlnaHQ6IGJvbGQ7DQogIHRleHQtYWxpZ246IGxlZnQ7DQogIGJhY2tncm91bmQtY29sb3I6ICMwODI5NUM7DQogIGJvcmRlci10b3AtbGVmdC1yYWRpdXM6IDhweDsNCiAgYm9yZGVyLXRvcC1yaWdodC1yYWRpdXM6IDhweDsNCiAgYmFja2dyb3VuZDogbm9uZTsNCiAgLW8tYm94LXNoYWRvdzogbm9uZTsNCiAgLXdlYmtpdC1ib3gtc2hhZG93OiBub25lOw0KICAtbW96LWJveC1zaGFkb3c6IG5vbmU7DQogIGJveC1zaGFkb3c6IG5vbmU7DQogIGZvbnQtc2l6ZTogMS4zODU3ZW07DQogIGxpbmUtaGVpZ2h0OiAxLjJlbTsNCiAgYm9yZGVyLWJvdHRvbTogbm9uZTsNCn0NCg0KLnNpdHN0YWJsZWRlc2NyaXB0aW9uY2VsbCB7DQogIGZvbnQtc2l6ZTogMTAwJTsNCiAgZm9udC1mYW1pbHk6IHNhbnMtc2VyaWY7DQogIGJhY2tncm91bmQtaW1hZ2U6IG5vbmU7DQogIGJhY2tncm91bmQtY29sb3I6IHRyYW5zcGFyZW50Ow0KfQ0KDQoNCg0KI3Npd19pbnRyYXlfbWh2MXsNCiAgd2lkdGg6aW5pdGlhbDsNCn0NCg0KI2RzaHRhYmxlID4gY2FwdGlvbiA+IGxhYmVsew0KICBkaXNwbGF5OiBpbml0aWFsOw0KICBmb250LWZhbWlseTogc2Fucy1zZXJpZjsNCiAgZm9udC1zaXplOiAxMDAlOw0KICBjb2xvcjogIzNkNGE0MzsNCn0NCg0KI2RzaHRhYmxlID4gY2FwdGlvbiA+IGxhYmVsID4gYSwNCiNkc2h0YWJsZSA+IGNhcHRpb24gPiBhew0KICBkaXNwbGF5OiBpbml0aWFsOw0KICBmb250LWZhbWlseTogc2Fucy1zZXJpZjsNCiAgZm9udC1zaXplOiAxMDAlOw0KICBjb2xvcjogIzAwN2M0MTsNCn0NCg0KI1RXUC1UQUJTIGRpdi5yb3ctZmx1aWR7CQ0KCWZvbnQtZmFtaWx5OiBzYW5zLXNlcmlmOw0KCWZvbnQtc2l6ZToxcmVtDQp9DQp0YWJsZSBjYXB0aW9uLCAjZHNodGFibGUgdGggew0KICBjb2xvcjogaW5oZXJpdCAhaW1wb3J0YW50Ow0KICBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudCAhaW1wb3J0YW50Ow0KICBwYWRkaW5nOiAzcHg7DQogIGZvbnQtc2l6ZTogMWVtOw0KICBsaW5lLWhlaWdodDogMS4yZW07DQogIGZvbnQtZmFtaWx5OiBzYW5zLXNlcmlmOw0KICBmb250LXdlaWdodDogYm9sZDsNCn0NCg0KaW5wdXQ6bm90KFt0eXBlPWJ1dHRvbl0pOm5vdChbdHlwZT1zdWJtaXRdKTpub3QoLnNlYXJjaC1xdWVyeSksIHRleHRhcmVhLCBzZWxlY3Qgew0KCS8qIG1hcmdpbi1ib3R0b206IDAuNjQyODU3MTRlbTsgKi8NCn0NCg0KLnNlYXJjaC1xdWVyeXsNCglwYWRkaW5nOiAwLjI4NTcxNDI4NTcxNDI4NTdlbSAwLjQyODU3MTQyODU3MTQyODU1ZW0gIWltcG9ydGFudDsNCn0NCg0KLmJnYm9yZGVyLCAuYmdpbnNpZGUsIC5iZ2luc2lkZWFqYXggew0KICBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDsNCn0NCg0KLnNpdHNjb25ib3JkZXJub3RhYnMgew0KICBib3JkZXItbGVmdDogbm9uZTsNCiAgYm9yZGVyLXJpZ2h0OiBub25lOw0KICBib3JkZXItYm90dG9tOiBub25lOw0KICBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDsNCn0NCg0KaW5wdXQ6bm90KFt0eXBlPWJ1dHRvbl0pOm5vdChbdHlwZT1zdWJtaXRdKTpub3QoLnNlYXJjaC1xdWVyeSksIHRleHRhcmVhLCBzZWxlY3Qgew0KICAtd2Via2l0LXRyYW5zaXRpb246IGFsbCAwLjIwcyBlYXNlLWluLW91dDsNCiAgLW1vei10cmFuc2l0aW9uOiBhbGwgMC4yMHMgZWFzZS1pbi1vdXQ7DQogIC1tcy10cmFuc2l0aW9uOiBhbGwgMC4yMHMgZWFzZS1pbi1vdXQ7DQogIC1vLXRyYW5zaXRpb246IGFsbCAwLjIwcyBlYXNlLWluLW91dDsNCiAgZm9udC1mYW1pbHk6IGluaGVyaXQ7DQogIGZvbnQtc2l6ZTogMTAwJTsNCiAgLXdlYmtpdC1ib3JkZXItcmFkaXVzOiAzcHg7DQogIC1tb3otYm9yZGVyLXJhZGl1czogM3B4Ow0KICBib3JkZXItcmFkaXVzOiAzcHg7DQogIGNvbG9yOiAjNjY2NjY2Ow0KICBwYWRkaW5nOiAwLjI4NTcxNDI5ZW0gMC40Mjg1NzE0M2VtOw0KICBib3JkZXI6IDFweCBzb2xpZCAjY2NjY2NjOw0KfQ0KLyoNCnRhYmxlI2FwcHRhYmxlIHRkLCB0YWJsZSNwY2d0YWJsZSwgdGFibGUjbWVzc3RhYmxlIHsNCiAgYm9yZGVyOiAycHggc29saWQgIzAwN2M0MTsNCn0NCiovDQpkaXYjaGVhZGVyIHsNCiAgYm9yZGVyLWJvdHRvbTogMTBweCBzb2xpZCAjMDA3YzQxOw0KfQ0KDQp1bCNtYXN0ZXJuYXYgLnRhYm5hIHsNCiAgYm9yZGVyLXRvcDogbm9uZTsNCiAgYm9yZGVyLWxlZnQ6IG5vbmU7DQp9DQoNCnVsI21hc3Rlcm5hdiBsaSBhIHsNCiAgYmFja2dyb3VuZC1jb2xvcjogIzAwN2M0MSAhaW1wb3J0YW50Ow0KICBib3JkZXItbGVmdDogMXB4IHNvbGlkICMwMDA7DQogIGJvcmRlci10b3A6IDFweCBzb2xpZCAjMDAwOw0KICBiYWNrZ3JvdW5kOiBub25lOw0KfQ0KDQoucmlnaHR0YWIgew0KICBiYWNrZ3JvdW5kLWNvbG9yOiAjMDA3YzQxICFpbXBvcnRhbnQ7DQogIGJvcmRlci1yaWdodDogMXB4IHNvbGlkICMwMDA7DQogIGJvcmRlci10b3A6IDFweCBzb2xpZCAjMDAwOw0KICBiYWNrZ3JvdW5kOiBub25lOw0KfQ0KDQpmb290ZXIgew0KICBjbGVhcjogYm90aDsNCiAgbWFyZ2luLXRvcDogMjBweDsNCn0NCg0KDQouZm9ydW1xdW90ZVtzdHlsZV17DQoJd2lkdGg6IGluaXRpYWwgIWltcG9ydGFudDsNCglmb250LWZhbWlseTogaW5oZXJpdDsNCgljb2xvcjogaW5oZXJpdDsNCgliYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDsNCglib3JkZXI6IG5vbmU7DQp9DQoNCi5vdmVyZmxvdy1maXh7DQoJb3ZlcmZsb3c6IGF1dG87DQp9DQoNCi5zaXRzY29udGl0bGVub3RhYnMgew0KCWZvbnQtc2l6ZTogMTUwJTsNCn0NCg0KcC5zaXRzY29udHJvbHNub3RhYnMgew0KCWRpc3BsYXk6IG5vbmU7DQp9DQoNCi5zb3J0YWJsZSB7DQoJd29yZC1icmVhazoga2VlcC1hbGw7DQp9DQoNCi5ub3JtYWxyb3cgIHsNCgl3b3JkLWJyZWFrOiBrZWVwLWFsbDsNCn0NCg0KI3NjaGxzcGFuIHsNCglkaXNwbGF5OiBpbmxpbmU7DQp9DQoNCiN0b3Rsc3BhbiB7DQoJZmxvYXQ6IHJpZ2h0Ow0KfQ0KDQouZmxvYXRyaWdodCB7DQoJZmxvYXQ6IHJpZ2h0Ow0KfQ0KDQouZmxvYXRsZWZ0IHsNCglmbG9hdDogbGVmdDsNCn0NCg0KLnBhZGRlZGNlbGwgew0KCW1hcmdpbi10b3A6MnB4CQ0KfQ0KDQoNCi51aS10YWJzIC51aS10YWJzLW5hdiBsaSBhIHsNCiAgICBmbG9hdDogbGVmdDsNCiAgICBib3JkZXI6IDFweCBzb2xpZCAjZmZmZmZmOw0KICAgIGJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjZGRkZGRkOw0KICAgIGJvcmRlci1yYWRpdXM6IDRweCA0cHggMCAwOw0KICAgIHBhZGRpbmc6IDhweCAxMnB4Ow0KICAgIGZvbnQtd2VpZ2h0OiBub25lOw0KICAgIHRleHQtZGVjb3JhdGlvbjogbm9uZTsNCiAgICAvKm91dGxpbmU6IG5vbmU7Ki8NCgljb2xvcjogIzIxMjEyMTsNCiAgICAvKmJhY2tncm91bmQ6IG5vbmU7Ki8NCiAgICAvKmJhY2tncm91bmQtY29sb3I6IHJnYmEoMCwgMCwgMCwgMCk7Ki8NCglmb250LXNpemU6IDg3LjUlOw0KCWJvcmRlci10b3A6IDFweCBzb2xpZCAjZDNkM2QzOw0KCWJvcmRlci1sZWZ0OiAxcHggc29saWQgI2QzZDNkMzsNCglib3JkZXItcmlnaHQ6IDFweCBzb2xpZCAjZDNkM2QzOw0KCWZvbnQtZmFtaWx5OiAiRElOIEJvbGQiLCBzYW5zLXNlcmlmOw0KCS8qYmFja2dyb3VuZDogI2U2ZTZlNiB1cmwoIi4uL3NpdHNfaW1hZ2VzL3VpLWJnX2dsYXNzXzc1X2U2ZTZlNl8xeDQwMC5wbmciKSA1MCUgNTAlIHJlcGVhdC14OyovDQoJd2lkdGg6IGF1dG8gIWltcG9ydGFudDsNCglmb250LWZhbWlseTogIkRJTiBCb2xkIiwgc2Fucy1zZXJpZjsNCn0NCg0KLnVpLXRhYnMgLnVpLXRhYnMtbmF2IGxpIHsNCiAgICBsaXN0LXN0eWxlOiBub25lOw0KICAgIGZsb2F0OiBsZWZ0Ow0KICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsNCiAgICB0b3A6IDA7DQogICAgbWFyZ2luOiAxcHggLjJlbSAwIDA7DQogICAgYm9yZGVyLWJvdHRvbS13aWR0aDogMDsNCiAgICBwYWRkaW5nOiAwOw0KICAgIHdoaXRlLXNwYWNlOiBub3dyYXA7DQoJYmFja2dyb3VuZDogI2U2ZTZlNiB1cmwoIi4uL3NpdHNfaW1hZ2VzL3VpLWJnX2dsYXNzXzc1X2U2ZTZlNl8xeDQwMC5wbmciKSA1MCUgNTAlIHJlcGVhdC14Ow0KfQ0KLnVpLXN0YXRlLWRlZmF1bHQsIC51aS13aWRnZXQtY29udGVudCAudWktc3RhdGUtZGVmYXVsdCwgLnVpLXdpZGdldC1oZWFkZXIgLnVpLXN0YXRlLWRlZmF1bHQgew0KICAgIGJvcmRlcjogMXB4IHNvbGlkICNkM2QzZDM7DQogICAgYm9yZGVyLWJvdHRvbS13aWR0aDogMXB4Ow0KICAgIGJhY2tncm91bmQ6ICNlNmU2ZTYgdXJsKCIuLi9zaXRzX2ltYWdlcy91aS1iZ19nbGFzc183NV9lNmU2ZTZfMXg0MDAucG5nIikgNTAlIDUwJSByZXBlYXQteDsgIWltcG9ydGFudDsNCiAgICBmb250LXdlaWdodDogbm9ybWFsOw0KICAgIGNvbG9yOiAjNTU1Ow0KfQ0KDQoudWktY29ybmVyLWFsbCwgLnVpLWNvcm5lci10b3AsIC51aS1jb3JuZXItcmlnaHQsIC51aS1jb3JuZXItdHIgew0KICAgIGJvcmRlci10b3AtcmlnaHQtcmFkaXVzOiA0cHg7DQp9DQoNCi51aS1jb3JuZXItYWxsLCAudWktY29ybmVyLXRvcCwgLnVpLWNvcm5lci1sZWZ0LCAudWktY29ybmVyLXRsIHsNCiAgICBib3JkZXItdG9wLWxlZnQtcmFkaXVzOiA0cHg7DQp9DQoudWktd2lkZ2V0LWhlYWRlciB7DQogICAgY29sb3I6ICMzZDRhNDM7DQogICAgZm9udC1mYW1pbHk6ICJESU4gQm9sZCIsIHNhbnMtc2VyaWY7DQogICAgZm9udC1zaXplOiAxLjM1ZW07DQp9DQoNCi51aS1oZWxwZXItcmVzZXQgew0KICAgIGxpbmUtaGVpZ2h0OiAxLjM7DQogICAgZm9udC1zaXplOiAxMDAlOw0KICAgIGxpc3Qtc3R5bGU6IG5vbmU7DQp9DQoNCi51aS1zdGF0ZS1hY3RpdmUsIC51aS13aWRnZXQtY29udGVudCAudWktc3RhdGUtYWN0aXZlLCAudWktd2lkZ2V0LWhlYWRlciAudWktc3RhdGUtYWN0aXZlIHsNCiAgICBib3JkZXI6IDFweCBzb2xpZCAjYWRhZGFkOw0KICAgIGZvbnQtd2VpZ2h0OiBub3JtYWw7DQogICAgY29sb3I6ICMzMzMzMzM7DQoJYmFja2dyb3VuZDogd2hpdGU7DQp9DQoNCi51aS1kaWFsb2cgLnVpLWRpYWxvZy10aXRsZSB7DQogICAgZmxvYXQ6IGxlZnQ7DQogICAgbWFyZ2luOiAuMWVtIDA7DQogICAgd2hpdGUtc3BhY2U6IG5vd3JhcDsNCiAgICB3aWR0aDogOTAlOw0KICAgIG92ZXJmbG93OiBoaWRkZW47DQogICAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7DQoJYmFja2dyb3VuZC1jb2xvcjogd2hpdGU7DQoJY29sb3I6IGJsYWNrOw0KfQ0KDQoudWktd2lkZ2V0LWhlYWRlciB7DQogICAgY29sb3I6ICMzZDRhNDM7DQogICAgZm9udC1mYW1pbHk6ICJESU4gQm9sZCIsIHNhbnMtc2VyaWY7DQogICAgZm9udC1zaXplOiAxLjM1ZW07DQoJZm9udC13ZWlnaHQ6IGJvbGQ7DQp9DQoNCi51aS10b29sdGlwIHsNCgl6LWluZGV4OiAyOw0KfQ0KDQoNCmlucHV0Om5vdChbdHlwZT0iYnV0dG9uIl0pOm5vdChbdHlwZT0ic3VibWl0Il0pOm5vdCguc2VhcmNoLXF1ZXJ5KSwgdGV4dGFyZWEsIHNlbGVjdCB7DQoJaGVpZ2h0OiBhdXRvOw0KfQ0KDQoucGFnaW5hdGVfYnV0dG9uIHsNCm1hcmdpbjogLjVlbSAuNGVtIC41ZW0gMDsNCmN1cnNvcjogcG9pbnRlcjsNCmJvcmRlci1jb2xvcjogI2RmZTllMzsNCmZvbnQtc2l6ZToxLjJlbTsNCiAgYm9yZGVyLWJvdHRvbS1jb2xvcjogI2I4Y2VjMTsNCiAgYm9yZGVyLXJpZ2h0LWNvbG9yOiAjZDBkZmQ2Ow0KICBiYWNrZ3JvdW5kLWltYWdlOiAtbW96LWxpbmVhci1ncmFkaWVudCh0b3AsICNmNGY0ZjQsICNkZmU5ZTMpOw0KICBiYWNrZ3JvdW5kLWltYWdlOiAtd2Via2l0LWdyYWRpZW50KGxpbmVhciwgMCAwLCAwIDEwMCUsIGZyb20oI2Y0ZjRmNCksIHRvKCNkZmU5ZTMpKTsNCiAgYmFja2dyb3VuZC1pbWFnZTogLXdlYmtpdC1saW5lYXItZ3JhZGllbnQodG9wLCAjZjRmNGY0LCAjZGZlOWUzKTsNCiAgYmFja2dyb3VuZC1pbWFnZTogLW8tbGluZWFyLWdyYWRpZW50KHRvcCwgI2Y0ZjRmNCwgI2RmZTllMyk7DQogIGJhY2tncm91bmQtaW1hZ2U6IGxpbmVhci1ncmFkaWVudCh0byBib3R0b20sICNmNGY0ZjQsICNkZmU5ZTMpOw0KICBiYWNrZ3JvdW5kLXJlcGVhdDogcmVwZWF0LXg7DQogIGZpbHRlcjogcHJvZ2lkOkRYSW1hZ2VUcmFuc2Zvcm0uTWljcm9zb2Z0LmdyYWRpZW50KHN0YXJ0Q29sb3JzdHI9JyNmZmY0ZjRmNCcsIGVuZENvbG9yc3RyPScjZmZkZmU5ZTMnLCBHcmFkaWVudFR5cGU9MCk7DQogIGNvbG9yOiAjMDA3YzQxOw0KICB0ZXh0LXNoYWRvdzogMHB4IDFweCAxcHggI2ZmZmZmZjsNCiAgLXdlYmtpdC1ib3gtc2hhZG93OiAwcHggMXB4IDRweCByZ2JhKDAsIDAsIDAsIDAuMTUpLCBpbnNldCAxcHggMXB4IDFweCAjZmZmZmZmLCBpbnNldCAwcHggLTFweCAzcHggI2QwZGZkNjsNCiAgLW1vei1ib3gtc2hhZG93OiAwcHggMXB4IDRweCByZ2JhKDAsIDAsIDAsIDAuMTUpLCBpbnNldCAxcHggMXB4IDFweCAjZmZmZmZmLCBpbnNldCAwcHggLTFweCAzcHggI2QwZGZkNjsNCiAgYm94LXNoYWRvdzogMHB4IDFweCA0cHggcmdiYSgwLCAwLCAwLCAwLjE1KSwgaW5zZXQgMXB4IDFweCAxcHggI2ZmZmZmZiwgaW5zZXQgMHB4IC0xcHggM3B4ICNkMGRmZDY7DQogIHRleHQtZGVjb3JhdGlvbjogbm9uZTsNCiAgdGV4dC1hbGlnbjogY2VudGVyOw0KICBmb250LWZhbWlseTogIkRJTiBCb2xkIiwgc2Fucy1zZXJpZjsNCn0NCg0KLnN2LXBhZ2luYXRpb24gPiBsaSA+IGEsIC5zdi1wYWdpbmF0aW9uID4gbGkgPiBzcGFuLCAuc3YtcGFnaW5hdGlvbiA+IGxpID4gaW5wdXRbdHlwZT0ic3VibWl0Il0gew0KICAgIHBvc2l0aW9uOiByZWxhdGl2ZTsNCiAgICBmbG9hdDogbGVmdDsNCiAgICBwYWRkaW5nOiA2cHggMTJweDsNCiAgICBsaW5lLWhlaWdodDogMS40Mjg1NzE0MzsNCiAgICB0ZXh0LWRlY29yYXRpb246IG5vbmU7DQogICAgY29sb3I6ICMwMDdjNDE7DQoJYmFja2dyb3VuZC1pbWFnZTogLW1vei1saW5lYXItZ3JhZGllbnQodG9wLCAjZjRmNGY0LCAjZGZlOWUzKTsNCgliYWNrZ3JvdW5kLWltYWdlOiAtd2Via2l0LWdyYWRpZW50KGxpbmVhciwgMCAwLCAwIDEwMCUsIGZyb20oI2Y0ZjRmNCksIHRvKCNkZmU5ZTMpKTsNCgliYWNrZ3JvdW5kLWltYWdlOiAtd2Via2l0LWxpbmVhci1ncmFkaWVudCh0b3AsICNmNGY0ZjQsICNkZmU5ZTMpOw0KCWJhY2tncm91bmQtaW1hZ2U6IC1vLWxpbmVhci1ncmFkaWVudCh0b3AsICNmNGY0ZjQsICNkZmU5ZTMpOw0KCWJhY2tncm91bmQtaW1hZ2U6IGxpbmVhci1ncmFkaWVudCh0byBib3R0b20sICNmNGY0ZjQsICNkZmU5ZTMpOw0KCWJhY2tncm91bmQtcmVwZWF0OiByZXBlYXQteDsNCglmaWx0ZXI6IHByb2dpZDpEWEltYWdlVHJhbnNmb3JtLk1pY3Jvc29mdC5ncmFkaWVudChzdGFydENvbG9yc3RyPScjZmZmNGY0ZjQnLCBlbmRDb2xvcnN0cj0nI2ZmZGZlOWUzJywgR3JhZGllbnRUeXBlPTApOw0KICAgIGJvcmRlcjogMXB4IHNvbGlkICNkZGRkZGQ7DQogICAgICAgIGJvcmRlci10b3AtY29sb3I6IHJnYigyMjEsIDIyMSwgMjIxKTsNCiAgICAgICAgYm9yZGVyLXJpZ2h0LWNvbG9yOiByZ2IoMjIxLCAyMjEsIDIyMSk7DQogICAgICAgIGJvcmRlci1ib3R0b20tY29sb3I6IHJnYigyMjEsIDIyMSwgMjIxKTsNCiAgICAgICAgYm9yZGVyLWxlZnQtY29sb3I6IHJnYigyMjEsIDIyMSwgMjIxKTsNCiAgICBtYXJnaW4tbGVmdDogLTFweDsNCn0NCg0KLnN2LXBhZ2luYXRpb24gPiBsaSA+IGE6aG92ZXIsIC5zdi1wYWdpbmF0aW9uID4gbGkgPiBzcGFuOmhvdmVyLCAuc3YtcGFnaW5hdGlvbiA+IGxpID4gaW5wdXRbdHlwZT0ic3VibWl0Il06aG92ZXIsIC5zdi1wYWdpbmF0aW9uID4gbGkgPiBhOmZvY3VzLCAuc3YtcGFnaW5hdGlvbiA+IGxpID4gc3Bhbjpmb2N1cywgLnN2LXBhZ2luYXRpb24gPiBsaSA+IGlucHV0W3R5cGU9InN1Ym1pdCJdOmZvY3VzIHsNCiAgICBjb2xvcjogIzAwN2M0MTsNCgliYWNrZ3JvdW5kLWltYWdlOiAtbW96LWxpbmVhci1ncmFkaWVudCh0b3AsICNmNGY0ZjQsICNkZmU5ZTMpOw0KCWJhY2tncm91bmQtaW1hZ2U6IC13ZWJraXQtZ3JhZGllbnQobGluZWFyLCAwIDAsIDAgMTAwJSwgZnJvbSgjZjRmNGY0KSwgdG8oI2RmZTllMykpOw0KCWJhY2tncm91bmQtaW1hZ2U6IC13ZWJraXQtbGluZWFyLWdyYWRpZW50KHRvcCwgI2Y0ZjRmNCwgI2RmZTllMyk7DQoJYmFja2dyb3VuZC1pbWFnZTogLW8tbGluZWFyLWdyYWRpZW50KHRvcCwgI2Y0ZjRmNCwgI2RmZTllMyk7DQoJYmFja2dyb3VuZC1pbWFnZTogbGluZWFyLWdyYWRpZW50KHRvIGJvdHRvbSwgI2Y0ZjRmNCwgI2RmZTllMyk7DQoJYmFja2dyb3VuZC1yZXBlYXQ6IHJlcGVhdC14Ow0KCWZpbHRlcjogcHJvZ2lkOkRYSW1hZ2VUcmFuc2Zvcm0uTWljcm9zb2Z0LmdyYWRpZW50KHN0YXJ0Q29sb3JzdHI9JyNmZmY0ZjRmNCcsIGVuZENvbG9yc3RyPScjZmZkZmU5ZTMnLCBHcmFkaWVudFR5cGU9MCk7DQogICAgYm9yZGVyLWNvbG9yOiAjMDA3YzQxOw0KfQ0KDQouc3YtcGFnaW5hdGlvbiA+IC5zdi1hY3RpdmUgPiBhLCAuc3YtcGFnaW5hdGlvbiA+IC5zdi1hY3RpdmUgPiBzcGFuLCAuc3YtcGFnaW5hdGlvbiA+IC5zdi1hY3RpdmUgPiBpbnB1dFt0eXBlPSJzdWJtaXQiXSwgLnN2LXBhZ2luYXRpb24gPiAuc3YtYWN0aXZlID4gYTpob3ZlciwgLnN2LXBhZ2luYXRpb24gPiAuc3YtYWN0aXZlID4gc3Bhbjpob3ZlciwgLnN2LXBhZ2luYXRpb24gPiAuc3YtYWN0aXZlID4gaW5wdXRbdHlwZT0ic3VibWl0Il06aG92ZXIsIC5zdi1wYWdpbmF0aW9uID4gLnN2LWFjdGl2ZSA+IGE6Zm9jdXMsIC5zdi1wYWdpbmF0aW9uID4gLnN2LWFjdGl2ZSA+IHNwYW46Zm9jdXMsIC5zdi1wYWdpbmF0aW9uID4gLnN2LWFjdGl2ZSA+IGlucHV0W3R5cGU9InN1Ym1pdCJdOmZvY3VzIHsNCiAgICB6LWluZGV4OiAyOw0KICAgIGNvbG9yOiAjMDA3YzQxOw0KCWJhY2tncm91bmQtaW1hZ2U6IC1tb3otbGluZWFyLWdyYWRpZW50KHRvcCwgI2Y0ZjRmNCwgI2RmZTllMyk7DQoJYmFja2dyb3VuZC1pbWFnZTogLXdlYmtpdC1ncmFkaWVudChsaW5lYXIsIDAgMCwgMCAxMDAlLCBmcm9tKCNmNGY0ZjQpLCB0bygjZGZlOWUzKSk7DQoJYmFja2dyb3VuZC1pbWFnZTogLXdlYmtpdC1saW5lYXItZ3JhZGllbnQodG9wLCAjZjRmNGY0LCAjZGZlOWUzKTsNCgliYWNrZ3JvdW5kLWltYWdlOiAtby1saW5lYXItZ3JhZGllbnQodG9wLCAjZjRmNGY0LCAjZGZlOWUzKTsNCgliYWNrZ3JvdW5kLWltYWdlOiBsaW5lYXItZ3JhZGllbnQodG8gYm90dG9tLCAjZjRmNGY0LCAjZGZlOWUzKTsNCgliYWNrZ3JvdW5kLXJlcGVhdDogcmVwZWF0LXg7DQoJZmlsdGVyOiBwcm9naWQ6RFhJbWFnZVRyYW5zZm9ybS5NaWNyb3NvZnQuZ3JhZGllbnQoc3RhcnRDb2xvcnN0cj0nI2ZmZjRmNGY0JywgZW5kQ29sb3JzdHI9JyNmZmRmZTllMycsIEdyYWRpZW50VHlwZT0wKTsNCiAgICBib3JkZXItY29sb3I6ICMwMDdjNDE7DQogICAgY3Vyc29yOiBkZWZhdWx0Ow0KfQ0KDQp0YWJsZS5kYXRhVGFibGUgdHIuZXZlbi5yb3dfc2VsZWN0ZWQgdGQsIHRhYmxlLmRhdGFUYWJsZSB0ci5vZGQucm93X3NlbGVjdGVkIHRkIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjOUZBRkQxOw0KICAgIGNvbG9yOiAjMzMzMzMzOw0KfQ0KI0RhdGFUYWJsZXNfVGFibGVfMV93cmFwcGVyLCAjcmV2aWV3VGFibGVfd3JhcHBlciB7DQoJb3ZlcmZsb3c6IGluaGVyaXQ7ICANCn0NCnRib2R5ID4gdHIub2RkIHsNCgliYWNrZ3JvdW5kLWNvbG9yOiAjRTJFNEZGOw0KfQ0KI01FU1NBR0Ugew0KCXBhZGRpbmc6IDAuNzE0Mjg1NzFlbTsNCiAgICBiYWNrZ3JvdW5kOiAjZmZmOw0KICAgIGJvcmRlcjogbm9uZTsNCiAgICAtd2Via2l0LWJvcmRlci1yYWRpdXM6IDRweDsNCiAgICAtbW96LWJvcmRlci1yYWRpdXM6IDRweDsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQp9DQojSU5UUkFZUkVTVUxUUyA+IHRib2R5ID4gdHIub2Rkew0KCWJhY2tncm91bmQtY29sb3I6ICNFMkU0RkY7DQp9DQpbaWRePSJ1aS1pZC0iXSArIGJ1dHRvbiB7DQoJZGlzcGxheTpub25lOw0KfQ0KLnVpLWRpYWxvZyB7DQogICAgYmFja2dyb3VuZC1jb2xvcjogd2hpdGU7DQoJYm9yZGVyOiAxcHggc29saWQgIzAwN2M0MTsNCn0NCltpZF49InVpLWlkLSJdIHsNCg0KCXdpZHRoOiAxMDAlOw0KCWJvcmRlci1ib3R0b206IDFweCBzb2xpZCAjYWFhOw0KCXBhZGRpbmctYm90dG9tOiAxMHB4Ow0KfQ0KLnVpLWRpYWxvZy1idXR0b25zZXQgew0KCSAgICBtYXJnaW4tbGVmdDogODAlOw0KfQ0KLnVpLXdpZGdldC1oZWFkZXIgew0KCSAgICBib3JkZXItYm90dG9tOiBub25lOw0KfQ0KLnVpLWRpYWxvZyAudWktZGlhbG9nLXRpdGxlIHsgDQogICAgd2lkdGg6IDEwMCU7DQp9DQoudWktZGlhbG9nLWJ1dHRvbnBhbmUgew0KCWJvcmRlci10b3A6IDFweCBzb2xpZCAjYWFhOw0KfQ0KLnVpLWRpYWxvZyAudWktd2lkZ2V0IC51aS13aWRnZXQtY29udGVudCB7DQogICAgICAgIA0KICAgIGJvcmRlcjogMnB4IHNvbGlkICMwMDdjNDE7DQoNCn0NCg0KI0NHUEVfU0xZTl9BTEx7DQoJZGlzcGxheTogbm9uZTsNCn0NCiNDR1BFX1RBQkxFIGlucHV0W3R5cGU9dGV4dF0gew0KIA0KICAgIGJveC1zaXppbmc6IGJvcmRlci1ib3g7DQogICAgd2lkdGg6IDEwMCU7DQp9DQoub2Zmc2NyZWVuIHsNCiAgICBwb3NpdGlvbjogZml4ZWQ7DQogICAgbGVmdDogLTEwMDAwMHB4Ow0KICAgIHdpZHRoOiAxcHg7DQogICAgaGVpZ2h0OiAxcHg7DQogICAgb3ZlcmZsb3c6IGhpZGRlbjsNCn0NCg0KDQoNCiNZQ0dQQV9zaXRzcGFnZWRhdGFzZWN0aW9uID4gdGFibGUuc2l0c3RhYmxlZ3JpZCA+IHRib2R5ID4gdHIgPiB0aCB7DQoJcGFkZGluZy1sZWZ0IDogMjBweDsNCn0NCiNZQ0dQQV9DR1BBX0NPTTEsICNZQ0dQQV9DR1BBX0NPTTJ7DQoJb3ZlcmZsb3c6IGF1dG87DQp9DQouY2dwZV9kaXYgew0KCSAgICBib3JkZXI6IDJweCBzb2xpZCAjYWFhOw0KICAgIHBhZGRpbmc6IDVweDsNCn0NCnRhYmxlIGNhcHRpb24sICNkc2h0YWJsZXsgICAgDQogICAgdGV4dC1hbGlnbjogLXdlYmtpdC1jZW50ZXI7DQp9DQojQ0dQRV9UQUJMRSA+IHRib2R5ID4gIHRyLm9kZCB7DQogICAgYmFja2dyb3VuZC1jb2xvcjogI0QwRkNDOTsNCgkNCn0NCg0KDQp0ZXh0YXJlYTpmb2N1cywgaW5wdXRbdHlwZT0idGV4dCJdOmZvY3VzLCBpbnB1dFt0eXBlPSJwYXNzd29yZCJdOmZvY3VzLCBpbnB1dFt0eXBlPSJkYXRldGltZSJdOmZvY3VzLCBpbnB1dFt0eXBlPSJkYXRldGltZS1sb2NhbCJdOmZvY3VzLCBpbnB1dFt0eXBlPSJkYXRlIl06Zm9jdXMsIGlucHV0W3R5cGU9Im1vbnRoIl06Zm9jdXMsIGlucHV0W3R5cGU9InRpbWUiXTpmb2N1cywgaW5wdXRbdHlwZT0id2VlayJdOmZvY3VzLCBpbnB1dFt0eXBlPSJudW1iZXIiXTpmb2N1cywgaW5wdXRbdHlwZT0iZW1haWwiXTpmb2N1cywgaW5wdXRbdHlwZT0idXJsIl06Zm9jdXMsIGlucHV0W3R5cGU9InNlYXJjaCJdOmZvY3VzLCBpbnB1dFt0eXBlPSJ0ZWwiXTpmb2N1cywgaW5wdXRbdHlwZT0iY29sb3IiXTpmb2N1cywgLnVuZWRpdGFibGUtaW5wdXQ6Zm9jdXMgew0KICAgIGJvcmRlci1jb2xvcjogcmdiYSgwLCAxMjQsIDY1LCAwLjgpOw0KICAgIG91dGxpbmU6IDA7DQogICAgb3V0bGluZTogdGhpbiBkb3R0ZWQgXDk7DQogICAgLXdlYmtpdC1ib3gtc2hhZG93OiBpbnNldCAwIDFweCAxcHggcmdiYSgwLCAwLCAwLCAwLjA3NSksIDAgMCA4cHggcmdiYSgwLCAxMjQsIDY1LCAwLjYpOw0KICAgIC1tb3otYm94LXNoYWRvdzogaW5zZXQgMCAxcHggMXB4IHJnYmEoMCwgMCwgMCwgMC4wNzUpLCAwIDAgOHB4IHJnYmEoMCwgMTI0LCA2NSwgMC42KTsNCiAgICBib3gtc2hhZG93OiBpbnNldCAwIDFweCAxcHggcmdiYSgwLCAwLCAwLCAwLjA3NSksIDAgMCA4cHggcmdiYSgwLCAxMjQsIDY1LCAwLjYpOw0KfQ0KDQoucGFnZW1zZyB7DQoJdGV4dC1hbGlnbjogbGVmdDsNCn0NCg0KLnVpLWRpYWxvZy1idXR0b25zZXQgew0KICAgIG1hcmdpbi1sZWZ0OiAwOw0KfQ0KLnVpLWRhdGVwaWNrZXIgeyAgIA0KICAgIGJvcmRlcjogMXB4IHNvbGlkICMwMDg2NDY7DQp9DQouZGF0YVRhYmxlc193cmFwcGVyIC5kYXRhVGFibGVzX3BhZ2luYXRlIC5wYWdpbmF0ZV9idXR0b24gew0KCXBhZGRpbmc6IDAgIWltcG9ydGFudDsNCn0NCg0KLmRhdGFUYWJsZXNfd3JhcHBlciAuZGF0YVRhYmxlc19wYWdpbmF0ZSAucGFnaW5hdGVfYnV0dG9uIHsNCglwYWRkaW5nOiAwICFpbXBvcnRhbnQ7DQp9DQoNCg0KLnVpLWRhdGVwaWNrZXIgLnVpLWRhdGVwaWNrZXItdGl0bGUgc2VsZWN0IHsNCiAgICBmb250LXNpemU6IC43ZW0gIWltcG9ydGFudDsgICAgDQp9DQoNCg0KLyogIEZpeGVzIGZvciBFcnJvciBNZXNzYWdlIFN0eWxpbmcgDQoJVXBvbiB1cGRhdGUgdGhpcyBzZWN0aW9uIHNob3VsZCBiZSBjb3BpZWQgaW50byB1b2EtaXBwLmNzcyBhcyB3ZWxsICAgKi8NCiNzaXRzbWVzc2FnZWJveC5zdi1wYW5lbC5zdi1wYW5lbC1kYW5nZXJ7DQoJY29sb3I6ICNhOTQ0NDI7DQp9DQouc3YtaGlkZGVuLXhzLnN2LXB1bGwtcmlnaHQgew0KCWRpc3BsYXk6IG5vbmU7DQp9DQoNCi8qIFJlcGxhY2VkIDEycHggd2l0aCBpbmhlcml0IGFzIHBlciByZXF1aXJlbWVudHMgaW4gSklSQSBHU01TLTU0NyAqLw0KLnN2LXBhbmVsIHsNCiAgICBmb250LXNpemU6IGluaGVyaXQ7DQp9DQoNCi5zdi1wYW5lbC1oZWFkaW5nIHsNCiAgICBib3JkZXItYm90dG9tOiAwcHggc29saWQgdHJhbnNwYXJlbnQ7DQp9DQoNCi5zdi1wYW5lbC1kYW5nZXIgPiAuc3YtcGFuZWwtaGVhZGluZyAgew0KCWNvbG9yOiAjYTk0NDQyOw0KICAgIGJhY2tncm91bmQtY29sb3I6ICNmMmRlZGU7ICAgIA0KfQ0KLnN2LXBhbmVsLXN1Y2Nlc3M+IC5zdi1wYW5lbC1oZWFkaW5nICB7DQoJY29sb3I6ICMzYzc2M2Q7DQogICAgYmFja2dyb3VuZC1jb2xvcjogI2RmZjBkODsNCn0NCi5zdi1wYW5lbC13YXJuaW5nPiAuc3YtcGFuZWwtaGVhZGluZyAgew0KCWNvbG9yOiAjOGE2ZDNiOw0KICAgIGJhY2tncm91bmQtY29sb3I6ICNmY2Y4ZTM7DQp9DQoNCg0KDQoNCi5zdi1wYW5lbC1kYW5nZXIgPiAuc3YtcGFuZWwtYm9keSB7DQogICAgY29sb3I6ICNhOTQ0NDI7DQogICAgYmFja2dyb3VuZC1jb2xvcjogI2YyZGVkZTsNCglwYWRkaW5nLXRvcDogMHB4Ow0KICAgIA0KfQ0KLnN2LXBhbmVsLWRhbmdlciAgPiAuc2l0c21lc3NhZ2Vjb250ZW50IHsNCgljb2xvcjogI2E5NDQ0MjsNCn0NCi5zdi1wYW5lbC1zdWNjZXNzID4gLnN2LXBhbmVsLWJvZHkgew0KICAgIGNvbG9yOiAjM2M3NjNkOw0KICAgIGJhY2tncm91bmQtY29sb3I6ICNkZmYwZDg7DQoJcGFkZGluZy10b3A6IDE1cHg7DQogICAgDQp9DQouc3YtcGFuZWwtd2FybmluZyA+IC5zdi1wYW5lbC1ib2R5IHsNCiAgICBjb2xvcjogIzhhNmQzYjsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZmNmOGUzOw0KCXBhZGRpbmctdG9wOiAwcHg7DQogICAgDQp9DQoNCg0KLnN2LXBhbmVsLWRhbmdlciA+ICAuc3YtcGFuZWwtYm9keSA+IGE6dmlzaXRlZCB7IA0KCWNvbG9yOiAjYTk0NDQyOw0KCXRleHQtZGVjb3JhdGlvbjogbm9uZTsNCn0NCi5zdi1wYW5lbC1kYW5nZXIgPiAgLnN2LXBhbmVsLWJvZHkgPiBhOmxpbmsgew0KICAgIGNvbG9yOiAjYTk0NDQyOw0KCWZvbnQtd2VpZ2h0OiA3MDA7DQoJDQp9DQoNCmEuYnRuLWdyZWVuOmxpbmsgew0KICAgIGNvbG9yOiAjZmZmZmZmOw0KICAgIHRleHQtZGVjb3JhdGlvbjogbm9uZTsNCn0NCi5zdi1wYW5lbC1zdWNjZXNzID4gIC5zdi1wYW5lbC1ib2R5ID4gYTp2aXNpdGVkIHsgDQoJdGV4dC1kZWNvcmF0aW9uOiBub25lOw0KfQ0KLnN2LXBhbmVsLXN1Y2Nlc3MgPiAgLnN2LXBhbmVsLWJvZHkgPiBhOmxpbmsgew0KCS8vY29sb3I6ICMwMDdjNDE7DQogICAgZm9udC13ZWlnaHQ6IDcwMDsNCgkNCn0NCg0KLnN2LXBhbmVsLnN2LXBhbmVsLWRhbmdlcltyb2xlPWFsZXJ0XSB7DQoJYm9yZGVyLWNvbG9yOiAjZWJjY2QxOw0KCW1hcmdpbjogMjBweDsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgcGFkZGluZzogMjBweDsNCiAgICBmb250LWZhbWlseTogc2Fucy1zZXJpZjsNCiAgICBib3JkZXItd2lkdGg6IDFweDsNCiAgICBib3JkZXItc3R5bGU6IHNvbGlkOw0KCWJhY2tncm91bmQtY29sb3I6ICNmMmRlZGU7DQp9DQouc3YtcGFuZWwuc3YtcGFuZWwtd2FybmluZ1tyb2xlPWFsZXJ0XSB7DQoJYm9yZGVyLWNvbG9yOiAjZmFlYmNjOw0KCW1hcmdpbjogMjBweDsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgcGFkZGluZzogMjBweDsNCiAgICBmb250LWZhbWlseTogc2Fucy1zZXJpZjsNCiAgICBib3JkZXItd2lkdGg6IDFweDsNCiAgICBib3JkZXItc3R5bGU6IHNvbGlkOw0KCWJhY2tncm91bmQtY29sb3I6ICNmY2Y4ZTM7DQp9DQouc3YtcGFuZWwuc3YtcGFuZWwtc3VjY2Vzc1tyb2xlPWFsZXJ0XSB7DQoJYm9yZGVyLWNvbG9yOiAjZDZlOWM2Ow0KCW1hcmdpbjogMjBweDsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgcGFkZGluZzogMjBweDsNCiAgICBmb250LWZhbWlseTogc2Fucy1zZXJpZjsNCiAgICBib3JkZXItd2lkdGg6IDFweDsNCiAgICBib3JkZXItc3R5bGU6IHNvbGlkOw0KCWJhY2tncm91bmQtY29sb3I6ICNkZmYwZDg7DQp9DQouc3YtcGFuZWwuc3YtcGFuZWwtaW5mb1tyb2xlPWFsZXJ0XSB7DQoJYm9yZGVyLWNvbG9yOiAjYmNlOGYxOw0KCW1hcmdpbjogMjBweDsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgcGFkZGluZzogMjBweDsNCiAgICBmb250LWZhbWlseTogc2Fucy1zZXJpZjsNCiAgICBib3JkZXItd2lkdGg6IDFweDsNCiAgICBib3JkZXItc3R5bGU6IHNvbGlkOw0KCWJhY2tncm91bmQtY29sb3I6ICNkZmYwZDg7DQp9DQoNCg0KLmEuYnRuLmJ0bi1ncmVlbi5wdWxsLXJpZ2h0ew0KCWNvbG9yOiAjZmZmZmZmOw0KfQ0KDQojc2l0c21lc3NhZ2Vjb2RlLCAjc2l0c21lc3NhZ2Vjb250ZW50aWNvbnsNCglkaXNwbGF5OiBub25lOw0KfQ0KDQpkaXYjc2l0c21lc3NhZ2Vib3gubXNnaW5mbyB7DQoJDQoNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZGZmMGQ4Ow0KCWJvcmRlci1jb2xvcjogI2Q2ZTljNjsNCgljb2xvcjogIzNjNzYzZDsNCn0NCi5tc2dpbmZvID4gI3NpdHNtZXNzYWdldGl0bGVzZWN0aW9uIHsNCglmb250LXNpemU6IDE2cHg7DQoJcGFkZGluZy10b3A6IDEwcHg7DQogICAgYmFja2dyb3VuZC1jb2xvcjogI2RmZjBkODsNCgljb2xvcjogIzNjNzYzZDsNCglwYWRkaW5nLWxlZnQ6IDE1cHg7DQp9DQoubXNnaW5mbyA+ICNzaXRzbWVzc2FnZWNvbnRlbnRzZWN0aW9uIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZGZmMGQ4Ow0KCWNvbG9yOiAjM2M3NjNkOw0KfQ0KLm1zZ2luZm8gew0KICAgIGJveC1zaGFkb3c6IDBweCAwcHggMHB4IHJnYmEoNTEsIDE3MCwgNTEsIDAuNSk7DQp9DQoNCmRpdiNzaXRzbWVzc2FnZWJveC5tc2dlcnJvciB7DQoJDQoJDQogICAgYmFja2dyb3VuZC1jb2xvcjogI2YyZGVkZTsNCglib3JkZXItY29sb3I6ICNlYmNjZDE7DQoJY29sb3I6ICNhOTQ0NDI7DQp9DQoubXNnZXJyb3IgPiAjc2l0c21lc3NhZ2V0aXRsZXNlY3Rpb24gew0KCWZvbnQtc2l6ZTogMTZweDsNCglwYWRkaW5nLXRvcDogMTBweDsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjJkZWRlICAhaW1wb3J0YW50Ow0KCWNvbG9yOiAjYTk0NDQyOw0KCXBhZGRpbmctbGVmdDogMTVweDsNCn0NCi5tc2dlcnJvciA+ICNzaXRzbWVzc2FnZWNvbnRlbnRzZWN0aW9uIHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjZjJkZWRlOw0KCWNvbG9yOiAjYTk0NDQyOw0KfQ0KLm1zZ2Vycm9yIHsNCiAgICBib3gtc2hhZG93OiAwcHggMHB4IDBweCByZ2JhKDUxLCAxNzAsIDUxLCAwLjUpOw0KfQ0KLnVpLXByb2dyZXNzYmFyLW92ZXJsYXkgew0KCWJhY2tncm91bmQtaW1hZ2U6IGxpbmVhci1ncmFkaWVudCh0byBib3R0b20sICMyNjZkM2YgMCUsICMwZTM4NjUgMTAwJSkhaW1wb3J0YW50Ow0KfQ0KDQovKiA5LjMgVXBkYXRlcyBGb3IgQnV0dG9ucyAqLw0KLyogU3BlY2lmaWMgYnV0dG9ucyB0aGF0IHdlcmUgbGVmdCBvdXQgb2YgdGhlIHVwZ3JhZGUgc3R5bGluZyAqLw0KLnN2LWJ0biwgaW5wdXRbdmFsdWU9IlNBVkUiXSwNCiBpbnB1dFt2YWx1ZT0iU2F2ZSJdLA0KIGlucHV0W3ZhbHVlPSJQcmV2aWV3IE9mZmVyIExldHRlciJdLA0KIGlucHV0W3ZhbHVlPSJJbmRpY2F0ZSBSZXF1aXJlZCBEb2N1bWVudGF0aW9uIl0sDQogaW5wdXRbdmFsdWU9IlNlbmQgT2ZmZXIiXSwNCiBpbnB1dFt2YWx1ZT0iQWRkIl0sDQogaW5wdXRbdmFsdWU9IkFkZCBjb3Vyc2UiXSwNCiBpbnB1dFt2YWx1ZT0iVXBsb2FkIEZpbGVzIl0sDQogaW5wdXRbdmFsdWU9IkRlbGV0ZSBGaWxlcyJdLA0KIGlucHV0W3ZhbHVlPSJTRUxFQ1QgQUxMIl0sDQogaW5wdXRbdmFsdWU9IkNMRUFSIEFMTCJdLA0KIC5mb3Jtc3ViZnJlZXsNCiAgYm9yZGVyOiAxcHggc29saWQ7DQogIC8qIGZvbnQtc2l6ZTogMS4yZW07ICovDQogIC8qIGxpbmUtaGVpZ2h0OiAxZW07ICovDQogIHBhZGRpbmc6IDAuOGVtIDEuNWVtIDAuNmVtIDEuNWVtOw0KICAtd2Via2l0LWJvcmRlci1yYWRpdXM6IDAuNGVtOw0KICAtbW96LWJvcmRlci1yYWRpdXM6IDAuNGVtOw0KICBib3JkZXItcmFkaXVzOiAwLjRlbTsNCiAgZm9udC1mYW1pbHk6ICJESU4gQm9sZCIsIHNhbnMtc2VyaWY7DQogIGZvbnQtd2VpZ2h0OiBub3JtYWw7DQogIHRleHQtZGVjb3JhdGlvbjogbm9uZTsNCiAgZm9udC13ZWlnaHQ6IDUwMDsNCiAgdGV4dC1hbGlnbjogY2VudGVyOw0KfQ0KDQouc3YtYnRuOmhvdmVyLA0KIGlucHV0W3ZhbHVlPSJTQVZFIl06aG92ZXIsDQogaW5wdXRbdmFsdWU9IlNhdmUiXTpob3ZlciwNCiBpbnB1dFt2YWx1ZT0iUHJldmlldyBPZmZlciBMZXR0ZXIiXTpob3ZlciwNCiBpbnB1dFt2YWx1ZT0iSW5kaWNhdGUgUmVxdWlyZWQgRG9jdW1lbnRhdGlvbiJdOmhvdmVyLA0KIGlucHV0W3ZhbHVlPSJTZW5kIE9mZmVyIl06aG92ZXIsDQogaW5wdXRbdmFsdWU9IkFkZCJdOmhvdmVyLA0KIGlucHV0W3ZhbHVlPSJBZGQgY291cnNlIl06aG92ZXIsDQogaW5wdXRbdmFsdWU9IlVwbG9hZCBGaWxlcyJdOmhvdmVyLA0KIGlucHV0W3ZhbHVlPSJEZWxldGUgRmlsZXMiXTpob3ZlciwNCiBpbnB1dFt2YWx1ZT0iU0VMRUNUIEFMTCJdOmhvdmVyLA0KIGlucHV0W3ZhbHVlPSJDTEVBUiBBTEwiXTpob3ZlciwNCiAuZm9ybXN1YmZyZWU6aG92ZXIgew0KICB0ZXh0LWRlY29yYXRpb246IG5vbmU7DQp9DQouc3YtYnRuOmFjdGl2ZSwNCiBpbnB1dFt2YWx1ZT0iU0FWRSJdOmFjdGl2ZSwNCiBpbnB1dFt2YWx1ZT0iU2F2ZSJdOmFjdGl2ZSwNCiBpbnB1dFt2YWx1ZT0iUHJldmlldyBPZmZlciBMZXR0ZXIiXTphY3RpdmUsDQogaW5wdXRbdmFsdWU9IkluZGljYXRlIFJlcXVpcmVkIERvY3VtZW50YXRpb24iXTphY3RpdmUsDQogaW5wdXRbdmFsdWU9IlNlbmQgT2ZmZXIiXTphY3RpdmUsDQogaW5wdXRbdmFsdWU9IkFkZCJdOmFjdGl2ZSwNCiBpbnB1dFt2YWx1ZT0iQWRkIGNvdXJzZSJdOmFjdGl2ZSwNCiBpbnB1dFt2YWx1ZT0iVXBsb2FkIEZpbGVzIl06YWN0aXZlLA0KIGlucHV0W3ZhbHVlPSJEZWxldGUgRmlsZXMiXTphY3RpdmUsDQogaW5wdXRbdmFsdWU9IlNFTEVDVCBBTEwiXTphY3RpdmUsDQogaW5wdXRbdmFsdWU9IkNMRUFSIEFMTCJdOmFjdGl2ZSwNCiAuZm9ybXN1YmZyZWU6YWN0aXZlIHsNCiAgdGV4dC1zaGFkb3c6IG5vbmU7DQogIHRleHQtZGVjb3JhdGlvbjogbm9uZTsNCn0NCg0KLnN2LWJ0bi1wcmltYXJ5LA0KLnVpLWRpYWxvZy1idXR0b25zZXQgLnVpLWJ1dHRvbjpsYXN0LWNoaWxkLCANCi51aS1kaWFsb2ctYnV0dG9uc2V0IC51aS1idXR0b246bGFzdC1jaGlsZCwgDQoudWktZGlhbG9nLWJ1dHRvbnNldCAudWktYnV0dG9uOmxhc3QtY2hpbGQsIA0KLnVpLWRpYWxvZy1idXR0b25zZXQgLnVpLWJ1dHRvbjpsYXN0LWNoaWxkLCANCi51aS1kaWFsb2ctYnV0dG9uc2V0IC51aS1idXR0b246bGFzdC1jaGlsZCwgDQouc3Ytb3BlbiA+IC5zdi1kcm9wZG93bi10b2dnbGUudWktZGlhbG9nLWJ1dHRvbnNldCAudWktYnV0dG9uIHsNCiAgYm9yZGVyLWNvbG9yOiAjMDBhZjVjOw0KICBib3JkZXItYm90dG9tLWNvbG9yOiAjMDA2ZDM5Ow0KICBib3JkZXItcmlnaHQtY29sb3I6ICMwMDdjNDE7DQogICpiYWNrZ3JvdW5kLWNvbG9yOiAjMDA5NjRmOw0KICBiYWNrZ3JvdW5kLWltYWdlOiAtbW96LWxpbmVhci1ncmFkaWVudCh0b3AsICMwMGFmNWMsICMwMDdjNDEpOw0KICBiYWNrZ3JvdW5kLWltYWdlOiAtd2Via2l0LWdyYWRpZW50KGxpbmVhciwgMCAwLCAwIDEwMCUsIGZyb20oIzAwYWY1YyksIHRvKCMwMDdjNDEpKTsNCiAgYmFja2dyb3VuZC1pbWFnZTogLXdlYmtpdC1saW5lYXItZ3JhZGllbnQodG9wLCAjMDBhZjVjLCAjMDA3YzQxKTsNCiAgYmFja2dyb3VuZC1pbWFnZTogLW8tbGluZWFyLWdyYWRpZW50KHRvcCwgIzAwYWY1YywgIzAwN2M0MSk7DQogIGJhY2tncm91bmQtaW1hZ2U6IGxpbmVhci1ncmFkaWVudCh0byBib3R0b20sICMwMGFmNWMsICMwMDdjNDEpOw0KICBiYWNrZ3JvdW5kLXJlcGVhdDogcmVwZWF0LXg7DQogIGZpbHRlcjogcHJvZ2lkOkRYSW1hZ2VUcmFuc2Zvcm0uTWljcm9zb2Z0LmdyYWRpZW50KHN0YXJ0Q29sb3JzdHI9JyNmZjAwYWY1YycsIGVuZENvbG9yc3RyPScjZmYwMDdjNDEnLCBHcmFkaWVudFR5cGU9MCk7DQogIGNvbG9yOiAjZmZmZmZmOw0KICB0ZXh0LXNoYWRvdzogMXB4IDFweCAxcHggIzA1NWUzMzsNCiAgLXdlYmtpdC1ib3gtc2hhZG93OiAwcHggMXB4IDRweCByZ2JhKDAsIDAsIDAsIDAuMTUpLCBpbnNldCAxcHggMXB4IDFweCAjNjNjYjlhLCBpbnNldCAwcHggLTFweCAzcHggIzAwNjIzNDsNCiAgLW1vei1ib3gtc2hhZG93OiAwcHggMXB4IDRweCByZ2JhKDAsIDAsIDAsIDAuMTUpLCBpbnNldCAxcHggMXB4IDFweCAjNjNjYjlhLCBpbnNldCAwcHggLTFweCAzcHggIzAwNjIzNDsNCiAgYm94LXNoYWRvdzogMHB4IDFweCA0cHggcmdiYSgwLCAwLCAwLCAwLjE1KSwgaW5zZXQgMXB4IDFweCAxcHggIzYzY2I5YSwgaW5zZXQgMHB4IC0xcHggM3B4ICMwMDYyMzQ7DQp9DQouc3YtYnRuLXByaW1hcnk6aG92ZXIsDQoudWktZGlhbG9nLWJ1dHRvbnNldCAudWktYnV0dG9uOmxhc3QtY2hpbGQ6aG92ZXIsIA0KLnVpLWRpYWxvZy1idXR0b25zZXQgLnVpLWJ1dHRvbjpsYXN0LWNoaWxkOmZvY3VzLCANCi51aS1kaWFsb2ctYnV0dG9uc2V0IC51aS1idXR0b246bGFzdC1jaGlsZC5zdi1mb2N1cywgDQoudWktZGlhbG9nLWJ1dHRvbnNldCAudWktYnV0dG9uOmxhc3QtY2hpbGQ6YWN0aXZlLCANCi51aS1kaWFsb2ctYnV0dG9uc2V0IC51aS1idXR0b246bGFzdC1jaGlsZC5zdi1hY3RpdmUsIA0KLnN2LW9wZW4gPiAuc3YtZHJvcGRvd24tdG9nZ2xlLnVpLWRpYWxvZy1idXR0b25zZXQgLnVpLWJ1dHRvbjpsYXN0LWNoaWxkIHsNCiAgKmJhY2tncm91bmQtY29sb3I6ICMwMGEwNTQ7DQogIGJhY2tncm91bmQtaW1hZ2U6IC1tb3otbGluZWFyLWdyYWRpZW50KHRvcCwgIzAwYjk2MSwgIzAwODY0Nik7DQogIGJhY2tncm91bmQtaW1hZ2U6IC13ZWJraXQtZ3JhZGllbnQobGluZWFyLCAwIDAsIDAgMTAwJSwgZnJvbSgjMDBiOTYxKSwgdG8oIzAwODY0NikpOw0KICBiYWNrZ3JvdW5kLWltYWdlOiAtd2Via2l0LWxpbmVhci1ncmFkaWVudCh0b3AsICMwMGI5NjEsICMwMDg2NDYpOw0KICBiYWNrZ3JvdW5kLWltYWdlOiAtby1saW5lYXItZ3JhZGllbnQodG9wLCAjMDBiOTYxLCAjMDA4NjQ2KTsNCiAgYmFja2dyb3VuZC1pbWFnZTogbGluZWFyLWdyYWRpZW50KHRvIGJvdHRvbSwgIzAwYjk2MSwgIzAwODY0Nik7DQogIGJhY2tncm91bmQtcmVwZWF0OiByZXBlYXQteDsNCiAgZmlsdGVyOiBwcm9naWQ6RFhJbWFnZVRyYW5zZm9ybS5NaWNyb3NvZnQuZ3JhZGllbnQoc3RhcnRDb2xvcnN0cj0nI2ZmMDBiOTYxJywgZW5kQ29sb3JzdHI9JyNmZjAwODY0NicsIEdyYWRpZW50VHlwZT0wKTsNCiAgYm9yZGVyLWNvbG9yOiAjMDA3YzQxOw0KICBjb2xvcjogI2ZmZmZmZjsNCn0NCi5zdi1idG4tcHJpbWFyeTphY3RpdmUgew0KICAqYmFja2dyb3VuZC1jb2xvcjogIzAwYTI1NTsNCiAgYmFja2dyb3VuZC1pbWFnZTogLW1vei1saW5lYXItZ3JhZGllbnQodG9wLCAjMDA5NjRmLCAjMDBhZjVjKTsNCiAgYmFja2dyb3VuZC1pbWFnZTogLXdlYmtpdC1ncmFkaWVudChsaW5lYXIsIDAgMCwgMCAxMDAlLCBmcm9tKCMwMDk2NGYpLCB0bygjMDBhZjVjKSk7DQogIGJhY2tncm91bmQtaW1hZ2U6IC13ZWJraXQtbGluZWFyLWdyYWRpZW50KHRvcCwgIzAwOTY0ZiwgIzAwYWY1Yyk7DQogIGJhY2tncm91bmQtaW1hZ2U6IC1vLWxpbmVhci1ncmFkaWVudCh0b3AsICMwMDk2NGYsICMwMGFmNWMpOw0KICBiYWNrZ3JvdW5kLWltYWdlOiBsaW5lYXItZ3JhZGllbnQodG8gYm90dG9tLCAjMDA5NjRmLCAjMDBhZjVjKTsNCiAgYmFja2dyb3VuZC1yZXBlYXQ6IHJlcGVhdC14Ow0KICBmaWx0ZXI6IHByb2dpZDpEWEltYWdlVHJhbnNmb3JtLk1pY3Jvc29mdC5ncmFkaWVudChzdGFydENvbG9yc3RyPScjZmYwMDk2NGYnLCBlbmRDb2xvcnN0cj0nI2ZmMDBhZjVjJywgR3JhZGllbnRUeXBlPTApOw0KICAtd2Via2l0LWJveC1zaGFkb3c6IDBweCAtMXB4IDRweCAjZmZmZmZmLCBpbnNldCAwcHggLTFweCA2cHggIzAwN2M0MTsNCiAgLW1vei1ib3gtc2hhZG93OiAwcHggLTFweCA0cHggI2ZmZmZmZiwgaW5zZXQgMHB4IC0xcHggNnB4ICMwMDdjNDE7DQogIGJveC1zaGFkb3c6IDBweCAtMXB4IDRweCAjZmZmZmZmLCBpbnNldCAwcHggLTFweCA2cHggIzAwN2M0MTsNCiAgYm9yZGVyLWNvbG9yOiAjMDA3YzQxOw0KICBjb2xvcjogI2ZmZmZmZjsNCn0NCi5zdi1idG4tZGVmYXVsdCwNCiBpbnB1dFt2YWx1ZT0iU0FWRSJdLA0KIGlucHV0W3ZhbHVlPSJTYXZlIl0sDQogaW5wdXRbdmFsdWU9IlByZXZpZXcgT2ZmZXIgTGV0dGVyIl0sDQogaW5wdXRbdmFsdWU9IkluZGljYXRlIFJlcXVpcmVkIERvY3VtZW50YXRpb24iXSwNCiBpbnB1dFt2YWx1ZT0iQWRkIl0sDQogaW5wdXRbdmFsdWU9IlNlbmQgT2ZmZXIiXSwNCiBpbnB1dFt2YWx1ZT0iQWRkIGNvdXJzZSJdLA0KIGlucHV0W3ZhbHVlPSJVcGxvYWQgRmlsZXMiXSwNCiBpbnB1dFt2YWx1ZT0iRGVsZXRlIEZpbGVzIl0sDQogaW5wdXRbdmFsdWU9IlNFTEVDVCBBTEwiXSwNCiBpbnB1dFt2YWx1ZT0iQ0xFQVIgQUxMIl0sDQogLmZvcm1zdWJmcmVlLA0KLnVpLWRpYWxvZy1idXR0b25zZXQgLnVpLWJ1dHRvbiwgDQoudWktZGlhbG9nLWJ1dHRvbnNldCAudWktYnV0dG9uLCANCi51aS1kaWFsb2ctYnV0dG9uc2V0IC51aS1idXR0b24sIA0KLnVpLWRpYWxvZy1idXR0b25zZXQgLnVpLWJ1dHRvbiwgDQoudWktZGlhbG9nLWJ1dHRvbnNldCAudWktYnV0dG9uLCANCi5zdi1vcGVuID4gLnN2LWRyb3Bkb3duLXRvZ2dsZS51aS1kaWFsb2ctYnV0dG9uc2V0IC51aS1idXR0b257DQogIGJvcmRlci1jb2xvcjogI2RmZTllMzsNCiAgYm9yZGVyLWJvdHRvbS1jb2xvcjogI2I4Y2VjMTsNCiAgYm9yZGVyLXJpZ2h0LWNvbG9yOiAjZDBkZmQ2Ow0KICAqYmFja2dyb3VuZC1jb2xvcjogI2VhZWZlYzsNCiAgYmFja2dyb3VuZC1pbWFnZTogLW1vei1saW5lYXItZ3JhZGllbnQodG9wLCAjZjRmNGY0LCAjZGZlOWUzKTsNCiAgYmFja2dyb3VuZC1pbWFnZTogLXdlYmtpdC1ncmFkaWVudChsaW5lYXIsIDAgMCwgMCAxMDAlLCBmcm9tKCNmNGY0ZjQpLCB0bygjZGZlOWUzKSk7DQogIGJhY2tncm91bmQtaW1hZ2U6IC13ZWJraXQtbGluZWFyLWdyYWRpZW50KHRvcCwgI2Y0ZjRmNCwgI2RmZTllMyk7DQogIGJhY2tncm91bmQtaW1hZ2U6IC1vLWxpbmVhci1ncmFkaWVudCh0b3AsICNmNGY0ZjQsICNkZmU5ZTMpOw0KICBiYWNrZ3JvdW5kLWltYWdlOiBsaW5lYXItZ3JhZGllbnQodG8gYm90dG9tLCAjZjRmNGY0LCAjZGZlOWUzKTsNCiAgYmFja2dyb3VuZC1yZXBlYXQ6IHJlcGVhdC14Ow0KICBmaWx0ZXI6IHByb2dpZDpEWEltYWdlVHJhbnNmb3JtLk1pY3Jvc29mdC5ncmFkaWVudChzdGFydENvbG9yc3RyPScjZmZmNGY0ZjQnLCBlbmRDb2xvcnN0cj0nI2ZmZGZlOWUzJywgR3JhZGllbnRUeXBlPTApOw0KICBjb2xvcjogIzAwN2M0MTsNCiAgbWFyZ2luOiA1cHg7DQogIHRleHQtc2hhZG93OiAwcHggMXB4IDFweCAjZmZmZmZmOw0KICAtd2Via2l0LWJveC1zaGFkb3c6IDBweCAxcHggNHB4IHJnYmEoMCwgMCwgMCwgMC4xNSksIGluc2V0IDFweCAxcHggMXB4ICNmZmZmZmYsIGluc2V0IDBweCAtMXB4IDNweCAjZDBkZmQ2Ow0KICAtbW96LWJveC1zaGFkb3c6IDBweCAxcHggNHB4IHJnYmEoMCwgMCwgMCwgMC4xNSksIGluc2V0IDFweCAxcHggMXB4ICNmZmZmZmYsIGluc2V0IDBweCAtMXB4IDNweCAjZDBkZmQ2Ow0KICBib3gtc2hhZG93OiAwcHggMXB4IDRweCByZ2JhKDAsIDAsIDAsIDAuMTUpLCBpbnNldCAxcHggMXB4IDFweCAjZmZmZmZmLCBpbnNldCAwcHggLTFweCAzcHggI2QwZGZkNjsNCn0NCi5zdi1idG4tZGVmYXVsdDpob3ZlciwNCiBpbnB1dFt2YWx1ZT0iU0FWRSJdOmhvdmVyLA0KIGlucHV0W3ZhbHVlPSJTYXZlIl06aG92ZXIsDQogaW5wdXRbdmFsdWU9IlByZXZpZXcgT2ZmZXIgTGV0dGVyIl06aG92ZXIsDQogaW5wdXRbdmFsdWU9IkluZGljYXRlIFJlcXVpcmVkIERvY3VtZW50YXRpb24iXTpob3ZlciwNCiBpbnB1dFt2YWx1ZT0iU2VuZCBPZmZlciJdOmhvdmVyLA0KIGlucHV0W3ZhbHVlPSJBZGQiXTpob3ZlciwNCiBpbnB1dFt2YWx1ZT0iQWRkIGNvdXJzZSJdOmhvdmVyLA0KIGlucHV0W3ZhbHVlPSJVcGxvYWQgRmlsZXMiXTpob3ZlciwNCiBpbnB1dFt2YWx1ZT0iRGVsZXRlIEZpbGVzIl06aG92ZXIsDQogaW5wdXRbdmFsdWU9IlNFTEVDVCBBTEwiXTpob3ZlciwNCiBpbnB1dFt2YWx1ZT0iQ0xFQVIgQUxMIl06aG92ZXIsDQogLmZvcm1zdWJmcmVlOmhvdmVyLA0KLnVpLWRpYWxvZy1idXR0b25zZXQgLnVpLWJ1dHRvbjpob3ZlciwgDQoudWktZGlhbG9nLWJ1dHRvbnNldCAudWktYnV0dG9uOmZvY3VzLCANCi51aS1kaWFsb2ctYnV0dG9uc2V0IC51aS1idXR0b24uc3YtZm9jdXMsIA0KLnVpLWRpYWxvZy1idXR0b25zZXQgLnVpLWJ1dHRvbjphY3RpdmUsIA0KLnVpLWRpYWxvZy1idXR0b25zZXQgLnVpLWJ1dHRvbi5zdi1hY3RpdmUsIA0KLnN2LW9wZW4gPiAuc3YtZHJvcGRvd24tdG9nZ2xlLnVpLWRpYWxvZy1idXR0b25zZXQgLnVpLWJ1dHRvbiB7DQogICpiYWNrZ3JvdW5kLWNvbG9yOiAjZjhmYWY5Ow0KICBiYWNrZ3JvdW5kLWltYWdlOiAtbW96LWxpbmVhci1ncmFkaWVudCh0b3AsICNmZmZmZmYsICNmMWY1ZjMpOw0KICBiYWNrZ3JvdW5kLWltYWdlOiAtd2Via2l0LWdyYWRpZW50KGxpbmVhciwgMCAwLCAwIDEwMCUsIGZyb20oI2ZmZmZmZiksIHRvKCNmMWY1ZjMpKTsNCiAgYmFja2dyb3VuZC1pbWFnZTogLXdlYmtpdC1saW5lYXItZ3JhZGllbnQodG9wLCAjZmZmZmZmLCAjZjFmNWYzKTsNCiAgYmFja2dyb3VuZC1pbWFnZTogLW8tbGluZWFyLWdyYWRpZW50KHRvcCwgI2ZmZmZmZiwgI2YxZjVmMyk7DQogIGJhY2tncm91bmQtaW1hZ2U6IGxpbmVhci1ncmFkaWVudCh0byBib3R0b20sICNmZmZmZmYsICNmMWY1ZjMpOw0KICBiYWNrZ3JvdW5kLXJlcGVhdDogcmVwZWF0LXg7DQogIGZpbHRlcjogcHJvZ2lkOkRYSW1hZ2VUcmFuc2Zvcm0uTWljcm9zb2Z0LmdyYWRpZW50KHN0YXJ0Q29sb3JzdHI9JyNmZmZmZmZmZicsIGVuZENvbG9yc3RyPScjZmZmMWY1ZjMnLCBHcmFkaWVudFR5cGU9MCk7DQogIGNvbG9yOiAjMDA3YzQxOw0KfQ0KLnN2LWJ0bi1kZWZhdWx0OmFjdGl2ZSwNCiBpbnB1dFt2YWx1ZT0iU0FWRSJdOmFjdGl2ZSwNCiBpbnB1dFt2YWx1ZT0iU2F2ZSJdOmFjdGl2ZSwNCiBpbnB1dFt2YWx1ZT0iUHJldmlldyBPZmZlciBMZXR0ZXIiXTphY3RpdmUsDQogaW5wdXRbdmFsdWU9IkluZGljYXRlIFJlcXVpcmVkIERvY3VtZW50YXRpb24iXTphY3RpdmUsDQogaW5wdXRbdmFsdWU9IkFkZCJdOmFjdGl2ZSwNCiBpbnB1dFt2YWx1ZT0iU2VuZCBPZmZlciJdOmFjdGl2ZSwNCiBpbnB1dFt2YWx1ZT0iQWRkIGNvdXJzZSJdOmFjdGl2ZSwNCiBpbnB1dFt2YWx1ZT0iVXBsb2FkIEZpbGVzIl06YWN0aXZlLA0KIGlucHV0W3ZhbHVlPSJEZWxldGUgRmlsZXMiXTphY3RpdmUsDQogaW5wdXRbdmFsdWU9IlNFTEVDVCBBTEwiXTphY3RpdmUsDQogaW5wdXRbdmFsdWU9IkNMRUFSIEFMTCJdOmFjdGl2ZSwNCiAuZm9ybXN1YmZyZWU6YWN0aXZlew0KICAqYmFja2dyb3VuZC1jb2xvcjogI2UwZTdlMzsNCiAgYmFja2dyb3VuZC1pbWFnZTogLW1vei1saW5lYXItZ3JhZGllbnQodG9wLCAjZDBkZmQ2LCAjZjBmMGYwKTsNCiAgYmFja2dyb3VuZC1pbWFnZTogLXdlYmtpdC1ncmFkaWVudChsaW5lYXIsIDAgMCwgMCAxMDAlLCBmcm9tKCNkMGRmZDYpLCB0bygjZjBmMGYwKSk7DQogIGJhY2tncm91bmQtaW1hZ2U6IC13ZWJraXQtbGluZWFyLWdyYWRpZW50KHRvcCwgI2QwZGZkNiwgI2YwZjBmMCk7DQogIGJhY2tncm91bmQtaW1hZ2U6IC1vLWxpbmVhci1ncmFkaWVudCh0b3AsICNkMGRmZDYsICNmMGYwZjApOw0KICBiYWNrZ3JvdW5kLWltYWdlOiBsaW5lYXItZ3JhZGllbnQodG8gYm90dG9tLCAjZDBkZmQ2LCAjZjBmMGYwKTsNCiAgYmFja2dyb3VuZC1yZXBlYXQ6IHJlcGVhdC14Ow0KICBmaWx0ZXI6IHByb2dpZDpEWEltYWdlVHJhbnNmb3JtLk1pY3Jvc29mdC5ncmFkaWVudChzdGFydENvbG9yc3RyPScjZmZkMGRmZDYnLCBlbmRDb2xvcnN0cj0nI2ZmZjBmMGYwJywgR3JhZGllbnRUeXBlPTApOw0KICAtd2Via2l0LWJveC1zaGFkb3c6IDBweCAtMXB4IDRweCAjZmZmZmZmLCBpbnNldCAwcHggLTFweCA2cHggI2MxZDRjOTsNCiAgLW1vei1ib3gtc2hhZG93OiAwcHggLTFweCA0cHggI2ZmZmZmZiwgaW5zZXQgMHB4IC0xcHggNnB4ICNjMWQ0Yzk7DQogIGJveC1zaGFkb3c6IDBweCAtMXB4IDRweCAjZmZmZmZmLCBpbnNldCAwcHggLTFweCA2cHggI2MxZDRjOTsNCiAgYm9yZGVyOiAxcHggc29saWQgI2I1Y2NiZTsNCiAgdGV4dC1zaGFkb3c6IG5vbmU7DQogIGNvbG9yOiAjMDA3YzQxOw0KfQ0KDQoNCi5zdi1idG4tcHJpbWFyeS5zdi1kaXNhYmxlZCwgLnN2LWJ0bi1wcmltYXJ5W2Rpc2FibGVkXSwgZmllbGRzZXRbZGlzYWJsZWRdIC5zdi1idG4tcHJpbWFyeSwgLnN2LWJ0bi1wcmltYXJ5LnN2LWRpc2FibGVkOmhvdmVyLCAuc3YtYnRuLXByaW1hcnlbZGlzYWJsZWRdOmhvdmVyLCBmaWVsZHNldFtkaXNhYmxlZF0gLnN2LWJ0bi1wcmltYXJ5OmhvdmVyLCAuc3YtYnRuLXByaW1hcnkuc3YtZGlzYWJsZWQ6Zm9jdXMsIC5zdi1idG4tcHJpbWFyeVtkaXNhYmxlZF06Zm9jdXMsIGZpZWxkc2V0W2Rpc2FibGVkXSAuc3YtYnRuLXByaW1hcnk6Zm9jdXMsIC5zdi1idG4tcHJpbWFyeS5zdi1kaXNhYmxlZC5zdi1mb2N1cywgLnN2LWJ0bi1wcmltYXJ5W2Rpc2FibGVkXS5zdi1mb2N1cywgZmllbGRzZXRbZGlzYWJsZWRdIC5zdi1idG4tcHJpbWFyeS5zdi1mb2N1cywgLnN2LWJ0bi1wcmltYXJ5LnN2LWRpc2FibGVkOmFjdGl2ZSwgLnN2LWJ0bi1wcmltYXJ5W2Rpc2FibGVkXTphY3RpdmUsIGZpZWxkc2V0W2Rpc2FibGVkXSAuc3YtYnRuLXByaW1hcnk6YWN0aXZlLCAuc3YtYnRuLXByaW1hcnkuc3YtZGlzYWJsZWQuc3YtYWN0aXZlLCAuc3YtYnRuLXByaW1hcnlbZGlzYWJsZWRdLnN2LWFjdGl2ZSwgZmllbGRzZXRbZGlzYWJsZWRdIC5zdi1idG4tcHJpbWFyeS5zdi1hY3RpdmUgew0KICAgIGJhY2tncm91bmQtY29sb3I6ICMwMGEwNTQ7DQogICAgYm9yZGVyLWNvbG9yOiAjMDA3YzQxOw0KfQ0KDQovKiA5LjMgVXBkYXRlcyBGb3IgUGFuZWxzIChzdXByZXNzIFByaW1hcnkpICovDQouc3YtcGFuZWwtcHJpbWFyeSB7DQogICAgYm9yZGVyLWNvbG9yOiB0cmFuc3BhcmVudDsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDsNCglib3gtc2hhZG93OiBub25lOw0KfQ0KDQouc3YtcGFuZWwtcHJpbWFyeSA+IC5zdi1wYW5lbC1oZWFkaW5nLA0KLnN2LXBhbmVsLXByaW1hcnkuc3YtcGFuZWwtY29sbGFwc2libGUgPiAuc3YtcGFuZWwtaGVhZGluZzpob3ZlciwNCi5zdi1wYW5lbC1wcmltYXJ5LnN2LXBhbmVsLWNvbGxhcHNpYmxlID4gLnN2LXBhbmVsLWhlYWRpbmc6Zm9jdXMsDQouc3YtcGFuZWwtcHJpbWFyeS5zdi1wYW5lbC1jb2xsYXBzaWJsZSA+IC5zdi1wYW5lbC1oZWFkaW5nLnN2LWZvY3VzIHsNCiAgICBjb2xvcjogaW5oZXJpdDsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDsNCiAgICBib3JkZXItY29sb3I6IHRyYW5zcGFyZW50Ow0KfQ0KDQouc3YtcGFuZWwtdGl0bGV7DQoJZm9udC1zaXplOiAxLjcxNDNlbTsNCiAgICBsaW5lLWhlaWdodDogMS4yZW07DQp9DQoNCi8qIDkuMyBVcGRhdGVzIEZvciBQYW5lbHMgKHJlc3RvcmUgU3ViLVBhbmVscykgKi8NCi5zdi1wYW5lbC1wcmltYXJ5IC5zdi1wYW5lbC1wcmltYXJ5IHsNCiAgICBib3JkZXItY29sb3I6ICNkZGRkZGQ7DQogICAgYmFja2dyb3VuZC1jb2xvcjogI2ZmZjsNCn0NCg0KLnN2LXBhbmVsLXByaW1hcnkgLnN2LXBhbmVsLXByaW1hcnkgPiAuc3YtcGFuZWwtaGVhZGluZyB7DQogICAgY29sb3I6ICMzMzMzMzM7DQogICAgYmFja2dyb3VuZC1jb2xvcjogI2Y1ZjVmNTsNCiAgICBib3JkZXItY29sb3I6ICNkZGRkZGQ7DQogICAgYm9yZGVyLWNvbG9yOiAjZGZlOWUzOw0KICAgIGJvcmRlci1ib3R0b20tY29sb3I6ICNiOGNlYzE7DQogICAgYm9yZGVyLXJpZ2h0LWNvbG9yOiAjZDBkZmQ2Ow0KICAgIGJhY2tncm91bmQtaW1hZ2U6IC1tb3otbGluZWFyLWdyYWRpZW50KHRvcCwgI2Y0ZjRmNCwgI2RmZTllMyk7DQogICAgYmFja2dyb3VuZC1pbWFnZTogLXdlYmtpdC1ncmFkaWVudChsaW5lYXIsIDAgMCwgMCAxMDAlLCBmcm9tKCNmNGY0ZjQpLCB0bygjZGZlOWUzKSk7DQogICAgYmFja2dyb3VuZC1pbWFnZTogLXdlYmtpdC1saW5lYXItZ3JhZGllbnQodG9wLCAjZjRmNGY0LCAjZGZlOWUzKTsNCiAgICBiYWNrZ3JvdW5kLWltYWdlOiAtby1saW5lYXItZ3JhZGllbnQodG9wLCAjZjRmNGY0LCAjZGZlOWUzKTsNCiAgICBiYWNrZ3JvdW5kLWltYWdlOiBsaW5lYXItZ3JhZGllbnQodG8gYm90dG9tLCAjZjRmNGY0LCAjZGZlOWUzKTsNCiAgICBiYWNrZ3JvdW5kLXJlcGVhdDogcmVwZWF0LXg7DQp9DQoNCmZpZWxkc2V0ew0KCWJvcmRlci1ib3R0b206IG5vbmU7DQp9DQoNCg0KLmNob3Nlbi1jb250YWluZXIgew0KICAgIGJhY2tncm91bmQtY29sb3I6ICNmZmY7DQp9DQoNCmE6bGluay5zdi1idG4tcHJpbWFyeSB7DQogICAgY29sb3I6ICNmZmY7DQogICAgdGV4dC1kZWNvcmF0aW9uOiBub25lOw0KfQ0KDQppbnB1dDpub3QoW3R5cGU9YnV0dG9uXSk6bm90KFt0eXBlPXN1Ym1pdF0pOm5vdCguc2VhcmNoLXF1ZXJ5KSwgdGV4dGFyZWEsIHNlbGVjdCwgLnN2LWZvcm0tY29udHJvbHsNCgloZWlnaHQ6IDM0cHg7DQp9DQoNCmlucHV0W3R5cGU9c2VhcmNoXS5zdi1pbnB1dC1zbXsNCiAgICBoZWlnaHQ6IDMwcHggIWltcG9ydGFudDsNCiAgICBwYWRkaW5nOiA1cHggMTBweCAhaW1wb3J0YW50Ow0KICAgIGZvbnQtc2l6ZTogMTJweDsNCiAgICBsaW5lLWhlaWdodDogMS41Ow0KICAgIGJvcmRlci1yYWRpdXM6IDNweDsNCn0NCg0KLnN2LWxpc3QtZ3JvdXAtaXRlbSB7DQogICAgcGFkZGluZzogMTBweDsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiB0cmFuc3BhcmVudDsgDQoJYm9yZGVyOm5vbmU7DQp9DQoNCi5zdi1wYW5lbCA+IC5zdi1saXN0LWdyb3VwIC5zdi1saXN0LWdyb3VwLWl0ZW0sIA0KLnN2LXBhbmVsID4gLnN2LXBhbmVsLWNvbGxhcHNlID4gLnN2LWxpc3QtZ3JvdXAgLnN2LWxpc3QtZ3JvdXAtaXRlbSB7DQoJYm9yZGVyLWJvdHRvbTogMXB4IGRvdHRlZCAjZGRkOw0KICAgIHBhZGRpbmc6IC40ZW0gMDsNCn0NCg0KLnN2LXBhbmVsID4gLnN2LWxpc3QtZ3JvdXAgYS5zdi1saXN0LWdyb3VwLWl0ZW06aG92ZXIsIA0KLnN2LXBhbmVsID4gLnN2LXBhbmVsLWNvbGxhcHNlID4gLnN2LWxpc3QtZ3JvdXAgYS5zdi1saXN0LWdyb3VwLWl0ZW06aG92ZXIgew0KCWRpc3BsYXk6IGJsb2NrOw0KICAgIGJhY2tncm91bmQtY29sb3I6ICNmNmY4ZWQ7DQogICAgYmFja2dyb3VuZC1jb2xvcjogcmdiYSgyNTUsMjQ1LDE4NCwuMTUpOw0KICAgIGJvcmRlcjogMXB4IHNvbGlkICNlMWQ4YTQ7DQogICAgbWFyZ2luOiAtMXB4IC0xZW0gMDsNCiAgICBwYWRkaW5nLWxlZnQ6IC45Mjg1NzE0Mjg1NzE0M2VtOw0KICAgIHBhZGRpbmctcmlnaHQ6IDFlbTsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogICAgLW1vei1ib3JkZXItcmFkaXVzOiA0cHg7DQogICAgLXdlYmtpdC1ib3JkZXItcmFkaXVzOiA0cHg7DQp9DQoNCi5zdi1wYW5lbCA+IC5zdi1saXN0LWdyb3VwOmxhc3QtY2hpbGQgLnN2LWxpc3QtZ3JvdXAtaXRlbTpsYXN0LWNoaWxkOmhvdmVyLCAuc3YtcGFuZWwgPiAuc3YtcGFuZWwtY29sbGFwc2UgPiAuc3YtbGlzdC1ncm91cDpsYXN0LWNoaWxkIC5zdi1saXN0LWdyb3VwLWl0ZW06bGFzdC1jaGlsZCB7DQogICAgYm9yZGVyLWJvdHRvbTogMXB4IHNvbGlkICNlMWQ4YTQ7DQp9DQoNCi5zdi1wYW5lbC1kZWZhdWx0ID4gLnN2LXBhbmVsLWhlYWRpbmcgew0KICAgIGNvbG9yOiAjMzMzMzMzOw0KICAgIGJhY2tncm91bmQtY29sb3I6ICNmNWY1ZjU7DQogICAgYm9yZGVyLWNvbG9yOiAjZGRkZGRkOw0KICAgIGJvcmRlci1jb2xvcjogI2RmZTllMzsNCiAgICBib3JkZXItYm90dG9tLWNvbG9yOiAjYjhjZWMxOw0KICAgIGJvcmRlci1yaWdodC1jb2xvcjogI2QwZGZkNjsNCiAgICBiYWNrZ3JvdW5kLWltYWdlOiAtbW96LWxpbmVhci1ncmFkaWVudCh0b3AsICNmNGY0ZjQsICNkZmU5ZTMpOw0KICAgIGJhY2tncm91bmQtaW1hZ2U6IC13ZWJraXQtZ3JhZGllbnQobGluZWFyLCAwIDAsIDAgMTAwJSwgZnJvbSgjZjRmNGY0KSwgdG8oI2RmZTllMykpOw0KICAgIGJhY2tncm91bmQtaW1hZ2U6IC13ZWJraXQtbGluZWFyLWdyYWRpZW50KHRvcCwgI2Y0ZjRmNCwgI2RmZTllMyk7DQogICAgYmFja2dyb3VuZC1pbWFnZTogLW8tbGluZWFyLWdyYWRpZW50KHRvcCwgI2Y0ZjRmNCwgI2RmZTllMyk7DQogICAgYmFja2dyb3VuZC1pbWFnZTogbGluZWFyLWdyYWRpZW50KHRvIGJvdHRvbSwgI2Y0ZjRmNCwgI2RmZTllMyk7DQogICAgYmFja2dyb3VuZC1yZXBlYXQ6IHJlcGVhdC14Ow0KfQ0KDQoudWktZGF0ZXBpY2tlci10cmlnZ2Vyew0KCW1heC13aWR0aDogaW5pdGlhbDsNCn0NCg0KLnN2LWZvcm0tZ3JvdXAsDQouc3YtZm9ybS1hZGRpdGlvbmFsLWluZm8uc3Ytc21hbGwgew0KICAgIGZvbnQtc2l6ZTogaW5oZXJpdDsNCn0NCg0KLnN2LWZvcm0taG9yaXpvbnRhbCAuc3YtY2hlY2tib3gtdGV4dCwNCi5zdi1mb3JtLWhvcml6b250YWwgLnN2LXJhZGlvLXRleHQgew0KCWZvbnQtd2VpZ2h0OiBub3JtYWw7DQp9DQoNCi5jaG9zZW4tY29udGFpbmVyLnN2LW1hbmRhdG9yeSwNCi5zdi1mb3JtLWdyb3VwIC5zdi1tYW5kYXRvcnkgew0KICAgIGJhY2tncm91bmQtY29sb3I6ICNmY2UwZWE7DQp9DQoNCi5zdi1oYXMtZXJyb3IgaW5wdXQ6bm90KFt0eXBlPWJ1dHRvbl0pOm5vdChbdHlwZT1zdWJtaXRdKTpub3QoLnNlYXJjaC1xdWVyeSksIA0KLnN2LWhhcy1lcnJvciBzZWxlY3QsDQouc3YtaGFzLWVycm9yIHRleHRhcmVhLA0KLnN2LWhhcy1lcnJvciAuc3YtbWFuZGF0b3J5IHsNCglib3JkZXItY29sb3I6ICNhOTQ0NDI7DQoJLXdlYmtpdC1ib3gtc2hhZG93OiBpbnNldCAwIDFweCAxcHggcmdiYSgwLCAwLCAwLCAwLjA3NSk7DQoJYm94LXNoYWRvdzogaW5zZXQgMCAxcHggMXB4IHJnYmEoMCwgMCwgMCwgMC4wNzUpOw0KfQ0KDQouc3YtaGFzLWVycm9yIC5jaG9zZW4tY29udGFpbmVyLnN2LW1hbmRhdG9yeSB7DQoJYm9yZGVyOiAxcHggc29saWQgI2E5NDQ0MjsNCiAgICBib3JkZXItcmFkaXVzOiAzcHg7DQp9</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPBody>
        <TcpPackets>
          <PacketInfo time="1085862328" offset="0" length="319" />
          <PacketInfo time="1085862328" offset="319" length="11603" />
        </TcpPackets>
      </HTTPResponse>
    </HTTPTask>
    <HTTPTask id="6117" hostname="graduate-studies-apply-uat.ualberta.ca" path="https://graduate-studies-apply-uat.ualberta.ca/urd/sits.urd/javascript/sits_ajax.js?v=881.2" url="https://graduate-studies-apply-uat.ualberta.ca/urd/sits.urd/javascript/sits_ajax.js?v=881.2" ip="129.128.12.49" port="443" connectionId="55" origin="HTML" frame="1" startDateTime="2019-01-02T11:43:29.444-05:00" startTime="1085862656" endTime="1085862656">
      <QueryString>
        <HTTPDataSet>
          <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
            <ActualData>dj04ODEuMg==</ActualData>
          </HTTPData>
        </HTTPDataSet>
        <IsExternalData>false</IsExternalData>
      </QueryString>
      <HTTPSplittedQueryStrings>
        <HTTPHeaderEntity name="v" index="0">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>ODgxLjI=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
      </HTTPSplittedQueryStrings>
      <HTTPRequest method="GET">
        <HTTPHeaders>
          <HTTPHeaderEntity name="User-Agent" index="0">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>TW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV09XNjQ7IHJ2OjY0LjApIEdlY2tvLzIwMTAwMTAxIEZpcmVmb3gvNjQuMA==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Accept" index="1">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>Ki8q</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Accept-Language" index="2">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>ZW4tR0IsZW47cT0wLjU=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Accept-Encoding" index="3">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>Z3ppcCwgZGVmbGF0ZQ==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Referer" index="4">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>aHR0cHM6Ly9ncmFkdWF0ZS1zdHVkaWVzLWFwcGx5LXVhdC51YWxiZXJ0YS5jYS91cmQvc2l0cy51cmQvcnVuL3Npd19wb3J0YWwudXJsPzI5REM2MkUzREExQjQ4NDR3UTJLcXpWeGZoNVFfaXZBd1czczhnUmVMbmxrc1ZCRmo4ZThROG9NUlFqMENXQ1NhRlQ1SDFodDctX1I1MjQzTW9iVGRXUFdrb2lxOHN6Q1hBT0xpa3d0Nk50ZTQyTlQyVDZFbUZkOWs5WQ==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="DNT" index="5">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>MQ==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Cookie" index="6">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>SlNFU1NJT05JRD0xRDdCNDYzNTkyMDU1RTU3ODhEQTAwMjcxNzk2OEJGRDsgQklHaXBTZXJ2ZXJTSVRTQVBQLVVBVC1IVFRQLmFwcH5TSVRTQVBQLVVBVC1IVFRQX3Bvb2w9MTA5Mjc1NDA5Mi4zNjg5NS4wMDAwOyBCSUdpcFNlcnZlclNoYXJlZElJUy1VQVQ9NzU3MjA5NzcyLjIwNDgwLjAwMDA=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Host" index="7">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>Z3JhZHVhdGUtc3R1ZGllcy1hcHBseS11YXQudWFsYmVydGEuY2E=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPAllHeaders>
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>R0VUIGh0dHBzOi8vZ3JhZHVhdGUtc3R1ZGllcy1hcHBseS11YXQudWFsYmVydGEuY2EvdXJkL3NpdHMudXJkL2phdmFzY3JpcHQvc2l0c19hamF4LmpzP3Y9ODgxLjIgSFRUUC8xLjENClVzZXItQWdlbnQ6IE1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdPVzY0OyBydjo2NC4wKSBHZWNrby8yMDEwMDEwMSBGaXJlZm94LzY0LjANCkFjY2VwdDogKi8qDQpBY2NlcHQtTGFuZ3VhZ2U6IGVuLUdCLGVuO3E9MC41DQpBY2NlcHQtRW5jb2Rpbmc6IGd6aXAsIGRlZmxhdGUNClJlZmVyZXI6IGh0dHBzOi8vZ3JhZHVhdGUtc3R1ZGllcy1hcHBseS11YXQudWFsYmVydGEuY2EvdXJkL3NpdHMudXJkL3J1bi9zaXdfcG9ydGFsLnVybD8yOURDNjJFM0RBMUI0ODQ0d1EyS3F6VnhmaDVRX2l2QXdXM3M4Z1JlTG5sa3NWQkZqOGU4UThvTVJRajBDV0NTYUZUNUgxaHQ3LV9SNTI0M01vYlRkV1BXa29pcThzekNYQU9MaWt3dDZOdGU0Mk5UMlQ2RW1GZDlrOVkNCkROVDogMQ0KQ29va2llOiBKU0VTU0lPTklEPTFEN0I0NjM1OTIwNTVFNTc4OERBMDAyNzE3OTY4QkZEOyBCSUdpcFNlcnZlclNJVFNBUFAtVUFULUhUVFAuYXBwflNJVFNBUFAtVUFULUhUVFBfcG9vbD0xMDkyNzU0MDkyLjM2ODk1LjAwMDA7IEJJR2lwU2VydmVyU2hhcmVkSUlTLVVBVD03NTcyMDk3NzIuMjA0ODAuMDAwMA0KSG9zdDogZ3JhZHVhdGUtc3R1ZGllcy1hcHBseS11YXQudWFsYmVydGEuY2ENCg0K</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPAllHeaders>
          <HTTPCookies>
            <HTTPHeaderEntity name="JSESSIONID" index="0">
              <HTTPDataSet>
                <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                  <ActualData>MUQ3QjQ2MzU5MjA1NUU1Nzg4REEwMDI3MTc5NjhCRkQ=</ActualData>
                </HTTPData>
              </HTTPDataSet>
              <IsExternalData>false</IsExternalData>
            </HTTPHeaderEntity>
            <HTTPHeaderEntity name="BIGipServerSITSAPP-UAT-HTTP.app~SITSAPP-UAT-HTTP_pool" index="1">
              <HTTPDataSet>
                <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                  <ActualData>MTA5Mjc1NDA5Mi4zNjg5NS4wMDAw</ActualData>
                </HTTPData>
              </HTTPDataSet>
              <IsExternalData>false</IsExternalData>
            </HTTPHeaderEntity>
            <HTTPHeaderEntity name="BIGipServerSharedIIS-UAT" index="2">
              <HTTPDataSet>
                <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                  <ActualData>NzU3MjA5NzcyLjIwNDgwLjAwMDA=</ActualData>
                </HTTPData>
              </HTTPDataSet>
              <IsExternalData>false</IsExternalData>
            </HTTPHeaderEntity>
          </HTTPCookies>
        </HTTPHeaders>
      </HTTPRequest>
      <HTTPResponse>
        <contentLenght>91957</contentLenght>
        <HTTPHeaders>
          <HTTPHeaderEntity name="Content-Type" index="0">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>YXBwbGljYXRpb24vamF2YXNjcmlwdA==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Last-Modified" index="1">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>RnJpLCAxNCBKdWwgMjAxNyAyMjoyOToyMSBHTVQ=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Accept-Ranges" index="2">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>Ynl0ZXM=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="ETag" index="3">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>ImQ0MmI3MWEzZjBmY2QyMTowIg==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Server" index="4">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>TWljcm9zb2Z0LUlJUy84LjU=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="X-Powered-By" index="5">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>QVNQLk5FVA==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Date" index="6">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>V2VkLCAwMiBKYW4gMjAxOSAxNjo0MzowNyBHTVQ=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Content-Length" index="7">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>OTE5NTc=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Vary" index="8">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>QWNjZXB0LUVuY29kaW5n</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Content-Encoding" index="9">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>Z3ppcA==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Connection" index="10">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>S2VlcC1BbGl2ZQ==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPAllHeaders>
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2phdmFzY3JpcHQNCkxhc3QtTW9kaWZpZWQ6IEZyaSwgMTQgSnVsIDIwMTcgMjI6Mjk6MjEgR01UDQpBY2NlcHQtUmFuZ2VzOiBieXRlcw0KRVRhZzogImQ0MmI3MWEzZjBmY2QyMTowIg0KU2VydmVyOiBNaWNyb3NvZnQtSUlTLzguNQ0KWC1Qb3dlcmVkLUJ5OiBBU1AuTkVUDQpEYXRlOiBXZWQsIDAyIEphbiAyMDE5IDE2OjQzOjA3IEdNVA0KQ29udGVudC1MZW5ndGg6IDkxOTU3DQpWYXJ5OiBBY2NlcHQtRW5jb2RpbmcNCkNvbnRlbnQtRW5jb2Rpbmc6IGd6aXANCkNvbm5lY3Rpb246IEtlZXAtQWxpdmUNCg0K</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPAllHeaders>
        </HTTPHeaders>
        <HTTPBody>
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Ly9JTlRFUk5BTCB2YXJpYWJsZXMgLSBkb24ndCB0b3VjaCENCi8vRm9yIHZhcmlhYmxlcyB0aGF0IHlvdSBjYW4gY2hhbmdlLCBzZWUgInNldHRpbmdzLmpzIiBmaWxlDQppZih0eXBlb2Yoc2l0c19hamF4X3ZlcnNpb24pPT0idW5kZWZpbmVkIikgew0KICB2YXIgc2l0c19hamF4X3ZlcnNpb24gPSAiOTMwLjEiOyAvL2ZpbGUgdmVyc2lvbiBudW1iZXINCiAgdmFyIHNpdHNfY2FjaGVfcXVlcnkgPSAiIjsgLy9xdWVyeSBzdHJpbmcgdG8gYmUgY2FjaGVkDQogIHZhciBzaXRzX2NhY2hlX2FycmF5ID0gW107IC8vYXJyYXkgd2hpY2ggaG9sZHMgdGhlIGNhY2hlIG9mIHF1ZXJ5cw0KICB2YXIgc2l0c19xdWV1ZV9hcnJheSA9IFtdOyAvL2FycmF5IHdoaWNoIGhvbGRzIHRoZSBxdWV1ZSBvZiBxdWVyeXMgdG8gYmUgcHJvY2Vzc2VkDQogIHZhciBzaXRzX3F1ZXVlX2J1c3kgPSBmYWxzZTsgLy9pbmRpY2F0ZXMgd2hldGhlciB0aGUgcXVldWUgaXMgY3VycmVudGx5IGJlaW5nIHByb2Nlc3NlZA0KICB2YXIgc2l0c19xdWV1ZV9mdW5jID0gIiI7IC8vbmFtZSBvZiBsb2NhbCBmdW5jdGlvbiB0aGF0IHdpbGwgYmUgY2FsbGVkIHRvIHByb2Nlc3MgdGhlIHJlc3VsdHMNCiAgdmFyIHNpdHNfdmFsaWRfYXJyYXkgPSBbXTsgLy9hcnJheSB3aGljaCBob2xkcyB0aGUgY2FjaGUgb2YgdmFsaWRhdGlvbiBxdWVyeXMNCiAgdmFyIHNpdHNfcHJvZ3Jlc3NfaXNzID0gIiI7IC8vSVNTIGNvZGUgZm9yIHRoZSBwcm9ncmVzcyBiYXINCiAgdmFyIHNpdHNfcHJvZ3Jlc3NfaW50ID0gMDsgLy9yZXBlYXQgaW50ZXJ2YWwgZm9yIHRoZSBwcm9ncmVzcyBiYXIgcG9sbGluZw0KICB2YXIgc2l0c19wcm9ncmVzc19jdXIgPSAwOyAvL2NvdW50ZXIgZm9yIHRoZSBwcm9ncmVzcyBiYXIgcG9sbGluZw0KICB2YXIgc2l0c19wcm9ncmVzc19ub3cgPSAwOyAvL3RpbWUgdGhlIHByb2dyZXNzIGJhciB3YXMgY3JlYXRlZA0KICB2YXIgc2l0c19qcXVlcnlfcmVhZHkgPSBmYWxzZTsgLy9pbmRpY2F0ZXMgd2hldGhlciBqUXVlcnkgaGFzIGZpbmlzaGVkIGxvYWRpbmcNCiAgdmFyIHNpdHNfZG9tX3JlYWR5ID0gZmFsc2U7IC8vaW5kaWNhdGVzIHdoZXRoZXIgdGhlIERPTSBoYXMgZmluaXNoZWQgbG9hZGluZw0KICB2YXIgc2l0c19vbmxvYWQgPSBmdW5jdGlvbigpIHt9OyAvL2Z1bmN0aW9uIHRvIHJ1biBvbmNlIGpRdWVyeSBoYXMgbG9hZGVkDQogIHZhciBzaXRzX2ZpbGVzX2FycmF5ID0ge307IC8vYXJyYXkgd2hpY2ggaG9sZHMgYWxsIHRoZSBpbmNsdWRlZCBmaWxlcw0KICB2YXIgc2l0c19ncmlkc19hcnJheSA9IFtdOyAvL2FycmF5IHdoaWNoIGhvbGRzIGluZm9ybWF0aW9uIGFib3V0IGVhY2ggZ3JpZCB3aWRnZXQNCiAgdmFyIHNpdHNfcGFyYW1fYXJyYXkgPSBbXTsgLy9hcnJheSB3aGljaCBob2xkcyB0aGUgcGFyYW1ldGVycyBmb3IgY2FsbGJhY2sgZnVuY3Rpb25zDQogIHZhciBzaXRzX2N1cnJlbnRfbWVudSA9IG51bGw7IC8vaG9sZHMgdGhlIG9iamVjdCByZXByZXNlbnRpbmcgdGhlIGN1cnJlbnQgY29udGV4dCBtZW51DQogIHZhciBzaXRzX3lkYWxfc2VsZWN0ID0gbnVsbDsgLy9ob2xkcyBhbiBIVE1MIGVsZW1lbnQgdG8gYmUgY2xvbmVkIGluIFlEQUwgc2NyZWVuDQogIHZhciBzaXRzX3lkYWxfc2VsZWN0X3NydCA9IG51bGw7IC8vaG9sZHMgYW4gSFRNTCBlbGVtZW50IHRvIGJlIGNsb25lZCBpbiBZREFMIHNjcmVlbg0KICB2YXIgc2l0c19zaG93X2FsZXJ0cyA9IGZhbHNlOyAvL2luZGljYXRlcyB3aGV0aGVyIGFsZXJ0cyBzaG91bGQgYmUgc2hvd24ob25seSBpZiBubyBjb25zb2xlKQ0KICB2YXIgc2l0c19ua2V5X3NlbGVjdG9yID0gImlucHV0W25hbWVePSdOS0VZJ106Zmlyc3QiOyAvL2pRdWVyeSBzZWxlY3RvciBmb3IgTktFWSBmaWVsZA0KICB2YXIgc2l0c19sb2FkZWQgPSBmYWxzZTsgLy9pbmRpY2F0ZXMgd2hldGhlciB0aGUgImxvYWQiIGV2ZW50cyBoYXZlIGZpbmlzaGVkIHJ1bm5pbmcNCiAgdmFyIHNpdHNfYmFyX2J1c3kgPSBmYWxzZTsgLy9pbmRpY2F0ZXMgd2hldGhlciB0aGUgcHJvZ3Jlc3MgYmFyIGlzIGJ1c3kNCiAgdmFyIHNpdHNfZmlsZV9jb3VudGVyID0gMDsgLy91c2VkIHRvIGNyZWF0ZSB1bmlxdWUgaWRzIHdoZW4gaW5jbHVkaW5nIGZpbGVzDQogIHZhciBzaXRzX2pxdWVyeV9sb2MgPSAiLi4vcGx1Z2lucy9qYXZhc2NyaXB0L2pxdWVyeS5qcyI7IC8valF1ZXJ5IGZpbGUgbG9jYXRpb24NCiAgdmFyIHNpdHNfanF1ZXJ5X2xvY19vcmlnID0gc2l0c19qcXVlcnlfbG9jOyAvL2JhY2sgdXAgb3JpZ2luYWwgbG9jYXRpb24NCiAgdmFyIHNpdHNfanF1ZXJ5dWlfbG9jID0gIi4uL3BsdWdpbnMvamF2YXNjcmlwdC9qcXVlcnktdWkuanMiOyAvL2pRdWVyeSBVSSBmaWxlIGxvY2F0aW9uDQogIHZhciBzaXRzX2pxdWVyeXVpX2xvY19vcmlnID0gc2l0c19qcXVlcnl1aV9sb2M7IC8vYmFjayB1cCBvcmlnaW5hbCBsb2NhdGlvbg0KICB2YXIgc2l0c19sb2FkaW5nX2FnYWluID0gZmFsc2U7IC8vaW5kaWNhdGVzIHRoZSBmaWxlIGlzIGxvYWRpbmcgZm9yIGEgc2Vjb25kIHRpbWUNCiAgdmFyIHNpdHNfb25sb2FkX3RyaWVzID0gMTAwOyAvL251bWJlciBvZiB0cmllcyB0byBjYWxsIG9ubG9hZCB3aGlsc3Qgd2FpdGluZyBmb3IgalF1ZXJ5DQogIHZhciBzaXRzX3dpZGdldF9icCA9IHt9OyAvL29iamVjdCBjb250YWluaW5nIGxvY2FsaXNhdGlvbiBmb3Igc29tZSBzdGFuZGFyZCBlOlZpc2lvbiB3aWRnZXRzDQogIHZhciBzaXRzX2N1cnJlbnRfYnJlYWsgPSAiIjsgLy91c2VkIGR1cmluZyBkaWFsb2cgYXV0by1yZXNpemUgdG8gdHJhY2sgdGhlIGN1cnJlbnQgYnJlYWtwb2ludCAocHJpb3IgdG8gYW55IHJlc2l6ZSBvciBjaGFuZ2UgaW4gb3JpZW50YXRpb24pDQogIHZhciBzaXRzX3BhZ2VfZXJyb3JzID0ge307IC8vb2JqZWN0IGhvbGRpbmcgcGFnZSBlcnJvcnMNCiAgdmFyIHNpdHNfZXZlbnRzID0ge307IC8vb2JqZWN0IGhvbGRpbmcgZmxhZ3MgdG8gaW5kaWNhdGUgaWYgZXZlbnRzIGhhdmUgYmVlbiByZWdpc3RlcmVkDQogIHZhciBzaXRzX3BvcnRhbF9vYmplY3QgPSB7fTsgLy9vYmplY3QgaG9sZGluZyBpdGVtcyBmb3IgdXNlIHdpdGggcmVxdWlyZWQgcG9ydGFsIHByb2Nlc3NpbmcoZS5nLiB0aGUgbG9hZGluZyBvZiB0aGUgc3YtcG9ydGFsLmNzcyBzdHlsZXNoZWV0KQ0KICB2YXIgc2l0c19kYXRlc19jYWNoZSA9IHt9OyAvL29iamVjdCB3aGljaCBob2xkcyB0aGUgY2FjaGUgb2YgY29udmVydGVkIGRhdGUgdmFsdWVzKGltcHJvdmUgcGVyZm9ybWFuY2Ugb2YgVGFibGVzYXcgZGF0ZSBzb3J0aW5nKQ0KICB2YXIgc2l0c19nYXBpX2xvYWRlZCA9IGZhbHNlOyAvL2luZGljYXRlcyBpZiBnb29nbGUgYXBpIGhhcyBsb2FkZWQNCiAgdmFyIHNpdHNfZ2FwaV9hdXRoX2xvYWRlZCA9IGZhbHNlOyAvL2luZGljYXRlcyBpZiBnb29nbGUgYXV0aCBhcGkgaGFzIGxvYWRlZA0KICB2YXIgc2l0c19nYXBpX3BpY2tlcl9sb2FkZWQgPSBmYWxzZTsgLy9pbmRpY2F0ZXMgaWYgZ29vZ2xlIHBpY2tlciBhcGkgaGFzIGxvYWRlZA0KICB2YXIgc2l0c19pZV92ZXJzaW9uID0gbnVsbDsgLy9pbmRpY2F0ZXMgdGhlIElFIHZlcnNpb24gYWZ0ZXIgY2FsbGluZyAic2l0c19pZV9zdXBwb3J0ZWQiDQogIHZhciBzaXRzX3VzZXJfdGltZW91dCA9ICIiOyAvL2tleSB1c2VkIHRvIHBlcmZvcm0gdXNlciB0aW1lb3V0IGNoZWNrcw0KfQ0KZWxzZSB7DQogIHNpdHNfbG9hZGluZ19hZ2FpbiA9IHRydWU7IC8vaW5kaWNhdGVzIHRoZSBmaWxlIGlzIGxvYWRpbmcgZm9yIGEgc2Vjb25kIHRpbWUNCn0NCg0KLy9JbmNsdWRlIGEgamF2YXNjcmlwdCBvciBzdHlsZXNoZWV0IGZpbGUNCi8vIHN0cmluZyAgdXJsICAgOiBpbiA7dGhlIHVybCBvZiB0aGUgZmlsZSB0byBpbmNsdWRlDQovLyBmdW5jdGlvbiAgZm5jIDogaW4gO3RoZSBmdW5jdGlvbiB0byBiZSB0cmlnZ2VyZWQgYWZ0ZXIgZmlsZSBoYXMgbG9hZGVkDQovLyBvYmplY3QgIGF0dHIgIDogaW4gO3BsYWluIG9iamVjdCBjb250YWluaW5nIGF0dHJpYnV0ZXMgZm9yIG5ldyBlbGVtZW50DQpmdW5jdGlvbiBzaXRzX2luY2x1ZGVfZmlsZSh1cmwsZm5jLGF0dHIpIHsNCiAgc3dpdGNoKHNpdHNfZmlsZXNfYXJyYXlbdXJsXSkgeyAvL2NoZWNrIGNhY2hlDQogICAgY2FzZSAiWSI6IC8vYWxyZWFkeSBsb2FkZWQNCiAgICAgIGlmKHR5cGVvZihmbmMpPT0iZnVuY3Rpb24iKSB7DQogICAgICAgIGZuYyh0cnVlKTsgLy9ydW4gZnVuY3Rpb24gc3RyYWlnaHQgYXdheQ0KICAgICAgfQ0KICAgICAgcmV0dXJuIHRydWU7DQogICAgY2FzZSAiTiI6IC8vY3VycmVudGx5IGxvYWRpbmcNCiAgICAgIGlmKHR5cGVvZihmbmMpPT0iZnVuY3Rpb24iKSB7DQogICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtzaXRzX2luY2x1ZGVfZmlsZSh1cmwsZm5jKX0sMTAwKTsgLy90cnkgYWdhaW4gc2hvcnRseQ0KICAgICAgfWVsc2V7DQogICAgICAgIHNldFRpbWVvdXQoInNpdHNfaW5jbHVkZV9maWxlKCciK3VybCsiJykiLDEwMCk7IC8vdHJ5IGFnYWluIHNob3J0bHkNCiAgICAgIH0NCiAgICAgIHJldHVybiBmYWxzZTsNCiAgICBkZWZhdWx0Og0KICAgICAgc2l0c19maWxlc19hcnJheVt1cmxdID0gIk4iOyAvL3N0b3JlIGZpbGUgYXMgbG9hZGluZw0KICB9DQogIGlmKHR5cGVvZihmbmMpIT0iZnVuY3Rpb24iKSB7DQogICAgZm5jID0gZnVuY3Rpb24oYm9vKSB7fTsgLy9jcmVhdGUgZW1wdHkgZnVuY3Rpb24NCiAgfQ0KICB2YXIgaHJlZiA9IHVybDsNCiAgaWYoaHJlZi5pbmRleE9mKCIuLi8iKT09MCkgew0KICAgIGhyZWYgKz0gIj92PSIrc2l0c19hamF4X3ZlcnNpb247IC8vYWRkIHZlcnNpb24gdG8gbG9jYWwgZmlsZXMgZm9yIGNhY2hpbmcNCiAgfQ0KICB2YXIgZXh0biA9IHVybC5zdWJzdHIodXJsLmxhc3RJbmRleE9mKCIuIikrMSkudG9VcHBlckNhc2UoKTsgLy9leHRyYWN0IGV4dGVuc2lvbg0KICB2YXIgZWxlbSA9IG51bGw7DQogIHN3aXRjaChleHRuKSB7DQogICAgY2FzZSAiSlMiOg0KICAgICAgZWxlbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoInNjcmlwdCIpOyAvL2luY2x1ZGUgamF2YXNjcmlwdCBmaWxlDQogICAgICBlbGVtLnR5cGUgPSAidGV4dC9qYXZhc2NyaXB0IjsNCiAgICAgIGVsZW0uc3JjID0gaHJlZjsNCiAgICAgIGJyZWFrOw0KICAgIGNhc2UgIkNTUyI6DQogICAgICBlbGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgibGluayIpOyAvL2luY2x1ZGUgc3R5bGVzaGVldCBmaWxlDQogICAgICBlbGVtLnR5cGUgPSAidGV4dC9jc3MiOw0KICAgICAgZWxlbS5yZWwgPSAic3R5bGVzaGVldCI7DQogICAgICBlbGVtLmhyZWYgPSBocmVmOw0KICAgICAgZWxlbS5tZWRpYSA9ICJhbGwiOw0KICAgICAgYnJlYWs7DQogIH0NCiAgaWYoZWxlbSkgew0KICAgIGVsZW0uaWQgPSAic2l0cyIrc2l0c19sZWZ0X3BhZCgrK3NpdHNfZmlsZV9jb3VudGVyLDYsIjAiKTsgLy9jcmVhdGUgdW5pcXVlIElEDQogICAgdmFyIGJvbyA9IGZhbHNlOw0KICAgIGlmKHR5cGVvZihmbmMpPT0iZnVuY3Rpb24iKSB7IC8vcmVnaXN0ZXIgb25sb2FkIGV2ZW50DQogICAgICBpZih0eXBlb2YoZWxlbS5vbnJlYWR5c3RhdGVjaGFuZ2UpIT0idW5kZWZpbmVkIiAmJiB0eXBlb2Yod2luZG93LmV2ZW50KT09Im9iamVjdCIgJiYgIXdpbmRvdy5vcGVyYSkgeyAvL0lFDQogICAgICAgIGVsZW0ub25yZWFkeXN0YXRlY2hhbmdlID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgaWYodGhpcy5yZWFkeVN0YXRlPT0ibG9hZGVkIiB8fCB0aGlzLnJlYWR5U3RhdGU9PSJjb21wbGV0ZSIpIHsNCiAgICAgICAgICAgIGVsZW0ub25yZWFkeXN0YXRlY2hhbmdlID0gbnVsbDsgLy9maXggbWVtb3J5IGxlYWsNCiAgICAgICAgICAgIHNpdHNfZG9faW5jbHVkZV9maWxlKHVybCk7IC8vc3RvcmUgZmlsZSBhcyBsb2FkZWQNCiAgICAgICAgICAgIGZuYyh0cnVlKTsgLy9ydW4gY2FsbGJhY2sgZnVuY3Rpb24gKG5vIHdheSB0byBjYXRjaCBlcnJvciBpbiBJRSkNCiAgICAgICAgICB9DQogICAgICAgIH07DQogICAgICB9DQogICAgICBlbHNlIHsNCiAgICAgICAgZWxlbS5yZW1vdmVBdHRyaWJ1dGUoIm9ucmVhZHlzdGF0ZWNoYW5nZSIpOyAvL3JlbW92ZSB0ZXN0IGF0dHJpYnV0ZQ0KICAgICAgICAgIGVsZW0uc2V0QXR0cmlidXRlKCJvbmxvYWQiLCIiKTsgLy9jaGVjayBmb3Igb25sb2FkIGV2ZW50DQogICAgICAgICAgaWYodHlwZW9mKGVsZW0ub25sb2FkKSE9InVuZGVmaW5lZCIpIHsgLy9Ob24tSUUNCiAgICAgICAgICAgIGVsZW0ucmVtb3ZlQXR0cmlidXRlKCJvbmxvYWQiKTsgLy9yZW1vdmUgdGVzdCBhdHRyaWJ1dGUNCiAgICAgICAgICAgIGVsZW0ub25sb2FkID0gZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgIHNpdHNfZG9faW5jbHVkZV9maWxlKHVybCk7IC8vc3RvcmUgZmlsZSBhcyBsb2FkZWQNCiAgICAgICAgICAgICAgZm5jKHRydWUpOyAvL3J1biBjYWxsYmFjayBmdW5jdGlvbg0KICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIGVsZW0ub25lcnJvciA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICBmbmMoZmFsc2UpOyAvL3J1biBjYWxsYmFjayBmdW5jdGlvbiAoZmlsZSBub3QgbG9hZGVkKQ0KICAgICAgICAgICAgfTsNCiAgICAgICAgICB9DQogICAgICAgICAgZWxzZSB7DQogICAgICAgICAgICBlbGVtLnJlbW92ZUF0dHJpYnV0ZSgib25sb2FkIik7IC8vcmVtb3ZlIHRlc3QgYXR0cmlidXRlDQogICAgICAgICAgICBib28gPSB0cnVlOyAvL2NvdWxkbid0IHJlZ2lzdGVyIGV2ZW50Li4uDQogICAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0NCiAgICB2YXIgaGVhZCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCJoZWFkIilbMF07DQogICAgaGVhZC5hcHBlbmRDaGlsZChlbGVtKTsNCiAgICBpZihib28pIHsgLy8uLi5zbyB0cnkgc2NyaXB0IGJsb2NraW5nDQogICAgICBlbGVtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgic2NyaXB0Iik7DQogICAgICBlbGVtLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKCJzaXRzX2RvX2luY2x1ZGVfZmlsZSgnIit1cmwrIicpOyIpKTsgLy9zdG9yZSBmaWxlIGFzIGxvYWRlZA0KICAgICAgZWxlbS5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShmbmMudG9TdHJpbmcoKSkpOyAvL3J1biBjYWxsYmFjayBmdW5jdGlvbg0KICAgICAgaGVhZC5hcHBlbmRDaGlsZChlbGVtKTsNCiAgICB9DQogICAgaWYgKCB0eXBlb2YoYXR0cikgPT0gIm9iamVjdCIgKXsNCiAgICAgIGZvciAoIHZhciB4IGluIGF0dHIpew0KICAgICAgICBpZiAoYXR0ci5oYXNPd25Qcm9wZXJ0eSh4KSApew0KICAgICAgICAgIGVsZW0uc2V0QXR0cmlidXRlKHgsIGF0dHJbeF0pOw0KICAgICAgICB9DQogICAgICB9DQogICAgfQ0KICAgIHJldHVybiB0cnVlOw0KICB9DQogIHJldHVybiBmYWxzZTsNCn0NCg0KLy9JbnRlcm5hbCBmdW5jdGlvbiB0byBtYXJrIGZpbGUgYXMgaW5jbHVkZWQNCi8vIHN0cmluZyB1cmwgICA6IGluIDt0aGUgdXJsIG9mIHRoZSBmaWxlIHRvIGluY2x1ZGUNCmZ1bmN0aW9uIHNpdHNfZG9faW5jbHVkZV9maWxlKHVybCkgew0KICBzaXRzX2ZpbGVzX2FycmF5W3VybF0gPSAiWSI7DQogIHZhciBhcnIgPSBzaXRzX3BhcmFtX2FycmF5OyAvL3N0b3JlIGFycmF5IGxvY2FsbHkNCiAgdmFyIGwgPSBhcnIubGVuZ3RoOw0KICBmb3IodmFyIGk9MDtpPGw7aSsrKSB7IC8vbG9vcCB0aHJvdWdoIGl0ZW1zIGluIGFycmF5DQogICAgdmFyIHBhciA9IGFycltpXTsNCiAgICBpZihwYXIudXJsPT11cmwpIHsgLy9jaGVjayBmdW5jdGlvbiByZWxhdGVzIHRvIHRoaXMgZmlsZQ0KICAgICAgdmFyIGZuYyA9IHBhci5mbmM7DQogICAgICBpZih0eXBlb2YoZm5jKT09ImZ1bmN0aW9uIikgeyAvL2NhbGwgZnVuY3Rpb24NCiAgICAgICAgZm5jKHBhci5wMDEscGFyLnAwMixwYXIucDAzLHBhci5wMDQscGFyLnAwNSxwYXIucDA2LHBhci5wMDcscGFyLnAwOCxwYXIucDA5KTsNCiAgICAgIH0NCiAgICAgIHNpdHNfcGFyYW1fYXJyYXkuc3BsaWNlKGksMSk7IC8vZGVsZXRlIGZyb20gYXJyYXkNCiAgICAgIGktLTsNCiAgICAgIGwtLTsNCiAgICB9DQogIH0NCiAgLy9pZiB3ZSdyZSBpbmNsdWRpbmcgYSBDU1MgZmlsZSB0aGVuIHdlIG1heSBuZWVkIHRvIHJlcGFyc2UgdGhlIHN0eWxlcyBpbiBJRTgod2hlbiByZXNwb25kLmpzIGlzIGluIHVzZSkNCiAgaWYodHlwZW9mIHJlc3BvbmQ9PT0ib2JqZWN0IiAmJiB0eXBlb2YgcmVzcG9uZC51cGRhdGU9PT0iZnVuY3Rpb24iKSB7DQogICAgdmFyIGV4dG4gPSB1cmwuc3Vic3RyKHVybC5sYXN0SW5kZXhPZigiLiIpKzEpLnRvVXBwZXJDYXNlKCk7IC8vZXh0cmFjdCBleHRlbnNpb24NCiAgICBpZihleHRuPT09IkNTUyIpIHsgLy9yZXBhcnNlIHRoZSBkb2N1bWVudA0KICAgICAgcmVzcG9uZC51cGRhdGUoKTsNCiAgICB9DQogIH0NCiAgcmV0dXJuIHRydWU7DQp9DQoNCi8vSW50ZXJuYWwgZnVuY3Rpb24gdXNlZCBmb3IgRE9NIGNoZWNrKElFIG9ubHkpDQovLyAtIGJhc2VkIG9uIHRyaWNrIGJ5IERpZWdvIFBlcmluaSAtIGh0dHA6Ly9qYXZhc2NyaXB0Lm53Ym94LmNvbS9JRUNvbnRlbnRMb2FkZWQvDQpmdW5jdGlvbiBzaXRzX2llX2RvbV9jaGVjaygpIHsNCiAgaWYoIXNpdHNfZG9tX3JlYWR5KSB7DQogICAgdHJ5IHsNCiAgICAgIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5kb1Njcm9sbCgibGVmdCIpOyAvL3RyeSB0byBzY3JvbGwgdGhlIGRvY3VtZW50Li4uDQogICAgfQ0KICAgIGNhdGNoKGVycikgew0KICAgICAgc2V0VGltZW91dCgic2l0c19pZV9kb21fY2hlY2soKSIsMCk7IC8vLi4ud2hpY2ggZmFpbHMgaWYgdGhlIERPTSBpcyBub3QgcmVhZHkNCiAgICAgIHJldHVybiBmYWxzZTsNCiAgICB9DQogICAgc2l0c19kb21fcmVhZHkgPSB0cnVlOw0KICAgIHNpdHNfZG9fb25sb2FkKCk7IC8vYXR0ZW1wdCB0byBydW4gb25sb2FkIGV2ZW50cw0KICB9DQogIHJldHVybiB0cnVlOw0KfQ0KDQovL0NoZWNrIHdoZW4gRE9NIGlzIHJlYWR5IHRvIGJlIG1hbmlwdWxhdGVkDQppZighc2l0c19sb2FkaW5nX2FnYWluKSB7DQogIGlmKGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIpIHsgLy9Nb3ppbGxhKGFuZCBuZXdlc3QgV2Via2l0KQ0KICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoIkRPTUNvbnRlbnRMb2FkZWQiLGZ1bmN0aW9uKCkgew0KICAgICAgaWYoIXNpdHNfZG9tX3JlYWR5KSB7DQogICAgICAgIHNpdHNfZG9tX3JlYWR5ID0gdHJ1ZTsNCiAgICAgICAgc2l0c19kb19vbmxvYWQoKTsgLy9hdHRlbXB0IHRvIHJ1biBvbmxvYWQgZXZlbnRzDQogICAgICB9DQogICAgfSxmYWxzZSk7DQogIH0NCiAgZWxzZSBpZihkb2N1bWVudC5hdHRhY2hFdmVudCkgeyAvL0lFKGZhaWwgc2FmZSAtIGZpcmVzIGxhdGUpDQogICAgZG9jdW1lbnQuYXR0YWNoRXZlbnQoIm9ucmVhZHlzdGF0ZWNoYW5nZSIsZnVuY3Rpb24oKSB7DQogICAgICBpZihkb2N1bWVudC5yZWFkeVN0YXRlPT0iY29tcGxldGUiKSB7DQogICAgICAgIGRvY3VtZW50Lm9ucmVhZHlzdGF0ZWNoYW5nZSA9IG51bGw7IC8vZml4IG1lbW9yeSBsZWFrDQogICAgICAgIGlmKCFzaXRzX2RvbV9yZWFkeSkgew0KICAgICAgICAgIHNpdHNfZG9tX3JlYWR5ID0gdHJ1ZTsNCiAgICAgICAgICBzaXRzX2RvX29ubG9hZCgpOyAvL2F0dGVtcHQgdG8gcnVuIG9ubG9hZCBldmVudHMNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0pOw0KICAgIGlmKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5kb1Njcm9sbCAmJiB3aW5kb3c9PXdpbmRvdy50b3ApIHsgLy9JRSh0cmljayAtIGZpcmVzIGZpcnN0KQ0KICAgICAgc2l0c19pZV9kb21fY2hlY2soKTsNCiAgICB9DQogIH0NCiAgc2l0c19kb19hdHRhY2hfZXZlbnQod2luZG93LCJsb2FkIixmdW5jdGlvbigpIHsgLy9mYWlsIHNhZmUNCiAgICBpZighc2l0c19kb21fcmVhZHkpIHsNCiAgICAgIHNpdHNfZG9tX3JlYWR5ID0gdHJ1ZTsNCiAgICAgIHNpdHNfZG9fb25sb2FkKCk7IC8vYXR0ZW1wdCB0byBydW4gb25sb2FkIGV2ZW50cw0KICAgIH0NCiAgfSk7DQp9DQoNCi8vSW5jbHVkZSBvdGhlciByZXF1aXJlZCBmaWxlcw0KaWYoIXNpdHNfbG9hZGluZ19hZ2Fpbikgew0KCWlmKHR5cGVvZiBzaXRzX2pxdWVyeV9jZG4hPT0idW5kZWZpbmVkIikgew0KCQlzaXRzX2luY2x1ZGVfc2V0dGluZ3MoKTsgLy9hbHJlYWR5IGxvYWRlZCwgc28gc2tpcCB0aGUgc3RlcA0KCX0NCgllbHNlIHsNCiAgICBzaXRzX2luY2x1ZGVfZmlsZSgiLi4vamF2YXNjcmlwdC9zZXR0aW5ncy5qcyIsc2l0c19pbmNsdWRlX3NldHRpbmdzKTsgLy9sb2FkIHRoZSBzZXR0aW5ncyBmaWxlDQogIH0NCiAgaWYodHlwZW9mKEpTT04pIT0ib2JqZWN0Iikgew0KICAgIHNpdHNfaW5jbHVkZV9maWxlKCIuLi9qYXZhc2NyaXB0L2pzb24yLm1pbi5qcyIpOyAvL2FkZCBqc29uIHBhcnNpbmcoaWYgbm90IHN1cHBvcnRlZCBuYXRpdmVseSkNCiAgfQ0KfQ0KDQovL0NhbGxlZCBhZnRlciBpbmNsdWRpbmcgc2V0dGluZ3MgZmlsZQ0KZnVuY3Rpb24gc2l0c19pbmNsdWRlX3NldHRpbmdzKHNldFN0YXR1cykgew0KICBpZih0eXBlb2Yoc2l0c19hbmltX3NwZWVkKSE9PSJudW1iZXIiIHx8IHNpdHNfYW5pbV9zcGVlZDwxIHx8IHNpdHNfYW5pbV9zcGVlZD4xMDAwKSB7DQogICAgc2l0c19hbmltX3NwZWVkID0gMTAwOyAvL2RlZmF1bHQgMTAwbXMNCiAgfQ0KICBpZih0eXBlb2Yoc2l0c19jZW50dXJ5X2JyZWFrKSE9PSJudW1iZXIiIHx8IHNpdHNfY2VudHVyeV9icmVhazwxIHx8IHNpdHNfY2VudHVyeV9icmVhaz45OSkgew0KICAgIHNpdHNfY2VudHVyeV9icmVhayA9IDIwOyAvL2RlZmF1bHQgMjAxOSBhbmQgMTkyMA0KICB9DQogIGlmKHR5cGVvZihzaXRzX2pxdWVyeV9jZG4pIT09Im51bWJlciIgfHwgc2l0c19qcXVlcnlfY2RuPDAgfHwgc2l0c19qcXVlcnlfY2RuPjUpIHsNCiAgICBzaXRzX2pxdWVyeV9jZG4gPSAwOyAvL2RlZmF1bHQgbG9jYWwgZmlsZXMNCiAgfQ0KICBpZih0eXBlb2Yoc2l0c19uYXRpdmVfd2lkZ2V0cykhPT0ibnVtYmVyIiB8fCBzaXRzX25hdGl2ZV93aWRnZXRzPDAgfHwgc2l0c19uYXRpdmVfd2lkZ2V0cz4yKSB7DQogICAgc2l0c19uYXRpdmVfd2lkZ2V0cyA9IDA7IC8vZGVmYXVsdCBqUXVlcnkgVUkNCiAgfQ0KICBpZih0eXBlb2Yoc2l0c19kYXRlX2Zvcm1hdCkhPT0ic3RyaW5nIiB8fCBzaXRzX2RhdGVfZm9ybWF0PT0iIikgew0KICAgIHNpdHNfZGF0ZV9mb3JtYXQgPSAiZGQvTS95eSI7IC8vZGVmYXVsdCAwMS9KYW4vMjAwMQ0KICB9DQogIGlmKHR5cGVvZihzaXRzX3RpbWVfZm9ybWF0KSE9PSJzdHJpbmciIHx8IHNpdHNfdGltZV9mb3JtYXQ9PSIiKSB7DQogICAgc2l0c190aW1lX2Zvcm1hdCA9ICJIMjpOMiI7IC8vZGVmYXVsdCAwOTozMA0KICB9DQogIGlmKHR5cGVvZihzaXRzX2J1dHRvbl90ZXh0KSE9PSJzdHJpbmciKSB7DQogICAgc2l0c19idXR0b25fdGV4dCA9ICIuLi4iOyAvL2RlZmF1bHQgIi4uLiIgKGNhbiBiZSBibGFuaykNCiAgfQ0KICBpZih0eXBlb2Yoc2l0c195ZWFyX3JhbmdlKSE9PSJzdHJpbmciIHx8IHNpdHNfeWVhcl9yYW5nZT09IiIpIHsNCiAgICBzaXRzX3llYXJfcmFuZ2UgPSAiLTEwMDorNTAiOyAvL2RlZmF1bHQgMTAwIHllYXJzIGJlZm9yZSBhbmQgNTAgeWVhcnMgYWZ0ZXIgY3VycmVudCB5ZWFyDQogIH0NCiAgaWYodHlwZW9mKHNpdHNfYnJlYWtwb2ludHMpIT09Im9iamVjdCIpIHsNCiAgCXNpdHNfYnJlYWtwb2ludHMgPSB7ImxnIjogSW5maW5pdHksICJtZCI6IDExOTksICJzbSI6IDk5MSwgInhzIjogNzY3fTsgLy9kZWZhdWx0cyByZXF1aXJlZCBmb3IgbGFyZ2UsIG1lZGl1bSwgc21hbGwgYW5kIGV4dHJhLXNtYWxsKG1heCB3aWR0aCBmb3IgZWFjaCkNCiAgfQ0KICBpZih0eXBlb2Yoc2l0c19hdXRvX3RhYmxlX3dpZGdldHMpIT09ImJvb2xlYW4iIHx8IHNpdHNfYXV0b190YWJsZV93aWRnZXRzIT09ZmFsc2UpIHsNCiAgCXNpdHNfYXV0b190YWJsZV93aWRnZXRzID0gdHJ1ZTsgLy90YWJsZSB3aWRnZXRzIGluaXRpYWxpc2UgYXV0b21hdGljYWxseSBieSBkZWZhdWx0DQogIH0NCiAgaWYodHlwZW9mKHNpdHNfZGF0YXRhYmxlX3Jlc3BvbnNpdmUpIT09ImJvb2xlYW4iIHx8IHNpdHNfZGF0YXRhYmxlX3Jlc3BvbnNpdmUhPT1mYWxzZSkgew0KICAJc2l0c19kYXRhdGFibGVfcmVzcG9uc2l2ZSA9IHRydWU7IC8vZGF0YXRhYmxlcyBhcmUgcmVzcG9uc2l2ZSBieSBkZWZhdWx0KGlmIHRoZSByZXNwb25zaXZlIHBsdWdpbiBpcyBhdmFpbGFibGUpDQogIH0NCiAgaWYodHlwZW9mKHNpdHNfZGlhbG9nX3NjYWxpbmcpIT09Im9iamVjdCIpIHsNCiAgCXNpdHNfZGlhbG9nX3NjYWxpbmcgPSB7ImxnIjogMSwgIm1kIjogMS4xLCAic20iOiAxLjUsICJ4cyI6IDN9OyAvL2RlZmF1bHQgc2NhbGluZyBmYWN0b3JzIHJlcXVpcmVkIGZvciBsYXJnZSwgbWVkaXVtLCBzbWFsbCBhbmQgZXh0cmEtc21hbGwNCiAgfQ0KICBpZih0eXBlb2Yoc2l0c19kaWFsb2dfaGVpZ2h0KSE9PSJvYmplY3QiKSB7DQogIAlzaXRzX2RpYWxvZ19oZWlnaHQgPSB7ImxnIjogMC45NSwgIm1kIjogMC45NSwgInNtIjogIiIsICJ4cyI6ICIifTsgLy9kZWZhdWx0IG1heGltdW0gaGVpZ2h0IHJhdGlvcygxIHdvdWxkIGJlIDEwMCUgb2YgdGhlIGN1cnJlbnQgd2luZG93KQ0KICB9DQogIGlmKHR5cGVvZihzaXRzX2F1dG9fcmVzaXplKSE9PSJib29sZWFuIikgew0KICAJc2l0c19hdXRvX3Jlc2l6ZSA9IHRydWU7IC8vYXV0byBwcm9jZXNzaW5nIGR1cmluZyByZXNpemluZw0KICB9DQoNCglpZih0eXBlb2Yoc2l0c191c2VfcG9ydGFsX2NzcykhPT0iYm9vbGVhbiIpIHsNCgkJc2l0c191c2VfcG9ydGFsX2NzcyA9IHRydWU7IC8vdXNlIHBvcnRhbCBDU1Mgd2hlbiBuZWVkZWQgYnkgZGVmYXVsdA0KCX0NCiAgaWYodHlwZW9mKHNpdHNfbWluX3RhYl93aWR0aCkhPT0ibnVtYmVyIikgew0KICAgIHNpdHNfbWluX3RhYl93aWR0aCA9IDE1MDsgLy9kZWZhdWx0IDE1MCBwaXhlbHMgZm9yIG1pbmltdW0gdGFiIHdpZHRoDQogIH0NCg0KICBzd2l0Y2goc2l0c19qcXVlcnlfY2RuKSB7DQogICAgY2FzZSAxOiAvL2pRdWVyeSBDRE4NCiAgICAgIHNpdHNfanF1ZXJ5X2xvYyA9ICIvL2NvZGUuanF1ZXJ5LmNvbS9qcXVlcnktMS4xMS4zLm1pbi5qcyI7DQogICAgICBzaXRzX2pxdWVyeXVpX2xvYyA9ICIvL2NvZGUuanF1ZXJ5LmNvbS91aS8xLjExLjQvanF1ZXJ5LXVpLm1pbi5qcyI7DQogICAgICBicmVhazsNCiAgICBjYXNlIDI6IC8vR29vZ2xlIEFQSSBDRE4NCiAgICAgIHNpdHNfanF1ZXJ5X2xvYyA9ICIvL2FqYXguZ29vZ2xlYXBpcy5jb20vYWpheC9saWJzL2pxdWVyeS8xLjExLjMvanF1ZXJ5Lm1pbi5qcyI7DQogICAgICBzaXRzX2pxdWVyeXVpX2xvYyA9ICIvL2FqYXguZ29vZ2xlYXBpcy5jb20vYWpheC9saWJzL2pxdWVyeXVpLzEuMTEuNC9qcXVlcnktdWkubWluLmpzIjsNCiAgICAgIGJyZWFrOw0KICAgIGNhc2UgMzogLy9NaWNyb3NvZnQgQWpheCBDRE4NCiAgICAgIHNpdHNfanF1ZXJ5X2xvYyA9ICIvL2FqYXguYXNwbmV0Y2RuLmNvbS9hamF4L2pRdWVyeS9qcXVlcnktMS4xMS4zLm1pbi5qcyI7DQogICAgICBzaXRzX2pxdWVyeXVpX2xvYyA9ICIvL2FqYXguYXNwbmV0Y2RuLmNvbS9hamF4L2pxdWVyeS51aS8xLjExLjQvanF1ZXJ5LXVpLm1pbi5qcyI7DQogICAgICBicmVhazsNCiAgICBjYXNlIDQ6IC8vQ2xvdWQgRmxhcmUgQ0RODQogICAgICBzaXRzX2pxdWVyeV9sb2MgPSAiLy9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvanF1ZXJ5LzEuMTEuMy9qcXVlcnkubWluLmpzIjsNCiAgICAgIHNpdHNfanF1ZXJ5dWlfbG9jID0gIi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL2pxdWVyeXVpLzEuMTEuNC9qcXVlcnktdWkubWluLmpzIjsNCiAgICAgIGJyZWFrOw0KICAgIGNhc2UgNTogLy9mb3IgdGVzdGluZyBvbmx5DQogICAgICBzaXRzX2pxdWVyeV9sb2MgPSAiLy93d3cubXlzaXRzLmNvbS9zaG91bGQtZmFpbC10aGVuLWZhbGwtYmFjay10by1sb2NhbC9qcXVlcnkuanMiOw0KICAgICAgc2l0c19qcXVlcnl1aV9sb2MgPSAiLy93d3cubXlzaXRzLmNvbS9zaG91bGQtZmFpbC10aGVuLWZhbGwtYmFjay10by1sb2NhbC9qcXVlcnl1aS5qcyI7DQogICAgICBicmVhazsNCiAgfQ0KICBpZih0eXBlb2Yoc2l0c191c2VfbWluaWZpZWQpIT0iYm9vbGVhbiIpIHsNCiAgICBzaXRzX3VzZV9taW5pZmllZCA9IHRydWU7DQogIH0NCiAgaWYodHlwZW9mKCQpPT0iZnVuY3Rpb24iKSB7DQogICAgc2l0c19pbmNsdWRlX2pxdWVyeSgpOyAvL2FscmVhZHkgaW5jbHVkZWQsIHNvIHNraXAgdG8gdGhlIG5leHQgc3RlcA0KICB9DQogIGVsc2Ugew0KICAgIHNpdHNfaW5jbHVkZV9maWxlKHNpdHNfanF1ZXJ5X2xvYyxzaXRzX2luY2x1ZGVfanF1ZXJ5KTsgLy9pbmNsdWRlIGpRdWVyeSBmaWxlcw0KICB9DQp9DQoNCi8vQ2FsbGVkIHRvIGluY2x1ZGUgalF1ZXJ5IGZpbGVzDQpmdW5jdGlvbiBzaXRzX2luY2x1ZGVfanF1ZXJ5KGpxU3RhdHVzKSB7DQogIGlmKHR5cGVvZigkKT09ImZ1bmN0aW9uIikgew0KICAJaWYodHlwZW9mKCQpPT0iZnVuY3Rpb24iICYmIHR5cGVvZigkLnVpKT09Im9iamVjdCIpIHsgLy9hbHJlYWR5IGluY2x1ZGVkLCBzbyBza2lwIHRvIHRoZSBuZXh0IHN0ZXANCiAgCQlzaXRzX2luY2x1ZGVfanF1ZXJ5dWkoKTsNCiAgCX0NCiAgCWVsc2Ugew0KICAgICAgc2l0c19pbmNsdWRlX2ZpbGUoc2l0c19qcXVlcnl1aV9sb2Msc2l0c19pbmNsdWRlX2pxdWVyeXVpKTsNCiAgICAgIHNpdHNfaW5jbHVkZV9maWxlKCIuLi9wbHVnaW5zL2Nzcy91aS9zaXRzLXVpLmNzcyIpOyAvL2luY2x1ZGUgalF1ZXJ5IFVJIHN0eWxlcw0KICAgIH0NCiAgfQ0KICBlbHNlIHsNCiAgICBpZihzaXRzX2pxdWVyeV9sb2MhPXNpdHNfanF1ZXJ5X2xvY19vcmlnKSB7IC8vaWYgdXNpbmcgQ0ROLi4uDQogICAgICBzaXRzX2pxdWVyeV9sb2MgPSBzaXRzX2pxdWVyeV9sb2Nfb3JpZzsgLy8uLi50aGVuIHRyeSBsb2NhbCBmaWxlcw0KICAgICAgc2l0c19qcXVlcnl1aV9sb2MgPSBzaXRzX2pxdWVyeXVpX2xvY19vcmlnOw0KICAgICAgc2l0c19pbmNsdWRlX2ZpbGUoc2l0c19qcXVlcnlfbG9jLHNpdHNfaW5jbHVkZV9qcXVlcnkpOw0KICAgIH0NCiAgICBlbHNlIHsNCiAgICAgIHNpdHNfcHV0bWVzcygiRXJyb3I6IGpRdWVyeSBoYXMgZmFpbGVkIHRvIGxvYWQsIHRoaXMgcGFnZSBtYXkgbm90IGFwcGVhciBjb3JyZWN0bHkuIik7DQogICAgICByZXR1cm4gZmFsc2U7DQogICAgfQ0KICB9DQogIHJldHVybiB0cnVlOw0KfQ0KDQovL0NhbGxlZCB0byBpbmNsdWRlIGpRdWVyeSBmaWxlcw0KZnVuY3Rpb24gc2l0c19pbmNsdWRlX2pxdWVyeXVpKHVpU3RhdHVzKSB7DQogIGlmKHR5cGVvZigkKT09ImZ1bmN0aW9uIiAmJiB0eXBlb2YoJC51aSk9PSJvYmplY3QiKSB7DQogICAgc2l0c19qcXVlcnlfcmVhZHkgPSB0cnVlOw0KICAgIHNpdHNfZG9fb25sb2FkKCk7IC8vYXR0ZW1wdCB0byBydW4gb25sb2FkIGV2ZW50cw0KICB9DQogIGVsc2Ugew0KICAgIGlmKHNpdHNfanF1ZXJ5dWlfbG9jIT1zaXRzX2pxdWVyeXVpX2xvY19vcmlnKSB7IC8vaWYgdXNpbmcgQ0ROLi4uDQogICAgICBzaXRzX2pxdWVyeXVpX2xvYyA9IHNpdHNfanF1ZXJ5dWlfbG9jX29yaWc7IC8vLi4udGhlbiB0cnkgbG9jYWwgZmlsZQ0KICAgICAgc2l0c19pbmNsdWRlX2ZpbGUoc2l0c19qcXVlcnl1aV9sb2Msc2l0c19pbmNsdWRlX2pxdWVyeXVpKTsNCiAgICB9DQogICAgZWxzZSB7DQogICAgICBzaXRzX3B1dG1lc3MoIkVycm9yOiBqUXVlcnkgVUkgaGFzIGZhaWxlZCB0byBsb2FkLCB0aGlzIHBhZ2UgbWF5IG5vdCBhcHBlYXIgY29ycmVjdGx5LiIpOw0KICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0NCiAgfQ0KICByZXR1cm4gdHJ1ZTsNCn0NCg0KLy9DYWxsZWQgdG8gcnVuIGFueSBmdW5jdGlvbiByZWdpc3RlcmVkIGFzIG9ubG9hZCBldmVudA0KZnVuY3Rpb24gc2l0c19kb19vbmxvYWQoKSB7DQogIGlmKCFzaXRzX2pxdWVyeV9yZWFkeSB8fCAhc2l0c19kb21fcmVhZHkpIHsgLy9jaGVjayByZWFkaW5lc3MNCiAgICByZXR1cm4gZmFsc2U7DQogIH0NCiAgaWYodHlwZW9mKCQpIT0iZnVuY3Rpb24iIHx8IHR5cGVvZigkLnVpKSE9Im9iamVjdCIpIHsgLy9qUXVlcnkob3IgVUkpIG5vdCBwYXJzZWQgeWV0DQogICAgaWYoLS1zaXRzX29ubG9hZF90cmllcz4wKSB7DQogICAgICBzZXRUaW1lb3V0KCJzaXRzX2RvX29ubG9hZCgpIiwxNTAtc2l0c19vbmxvYWRfdHJpZXMpOyAvL3JldHJ5IDEwMCB0aW1lcw0KICAgIH0NCiAgICBlbHNlIHsNCiAgICAgIHNpdHNfanF1ZXJ5X3JlYWR5ID0gZmFsc2U7IC8vZmFpbGVkIHRvIHBhcnNlIHRoZSBmaWxlcw0KICAgICAgaWYodHlwZW9mKCQpIT0iZnVuY3Rpb24iKSB7DQogICAgICAgIHNpdHNfcHV0bWVzcygiRXJyb3I6IGpRdWVyeSBoYXMgZmFpbGVkIHRvIHBhcnNlLCB0aGlzIHBhZ2UgbWF5IG5vdCBhcHBlYXIgY29ycmVjdGx5LiIpOw0KICAgICAgfQ0KICAgICAgZWxzZSB7DQogICAgICAgIHNpdHNfcHV0bWVzcygiRXJyb3I6IGpRdWVyeSBVSSBoYXMgZmFpbGVkIHRvIHBhcnNlLCB0aGlzIHBhZ2UgbWF5IG5vdCBhcHBlYXIgY29ycmVjdGx5LiIpOw0KICAgICAgfQ0KICAgIH0NCiAgICByZXR1cm4gZmFsc2U7DQogIH0NCg0KICAvL2lmIGFueSBzY3JpcHRzIGhhdmUgYmVlbiBsb2FkZWQgaW5saW5lIHRoZW4gd2UgbmVlZCB0byBpbmNsdWRlIHRoZW0gaW4gdGhlIGZpbGUgYXJyYXkgc28gc2l0c19pbmNsdWRlX2ZpbGUgZG9lc24ndCB0cnkgYW5kIGluY2x1ZGUgdGhlbSBhZ2Fpbg0KICBzaXRzX2RvX29ubG9hZF9zY3JpcHRzKCk7DQoNCiAgLy9wZXJmb3JtIGFueSBwb3J0YWwgaW5pdGlhbGlzYXRpb24gKHdoZW4gaW4gdGhlIHBvcnRhbCkNCiAgc2l0c19kb19wb3J0YWxfY2hlY2tzKCk7DQoNCiAgLy9wZXJmb3JtIGFueSB0YWJsZSB3aWRnZXQgaW5pdGlsaXNhdGlvbiAoZm9yIGRhdGF0YWJsZXMgYW5kIHRhYmxlc2F3KQ0KICBzaXRzX2RvX29ubG9hZF90YWJsZXMoKTsNCg0KICAvL2NoZWNrIGZvciBmaW5hbmNpYWwgdG90YWxzIHdoaWNoIG5lZWQgdG8gYmUga2VwdCBpbiBsaW5lDQogIHNpdHNfZmluYW5jaWFsX3RvdGFscygpOw0KDQogIC8vY2hlY2sgZm9yIHVzZXIgdGltZW91dCB3YXJuaW5ncw0KICBzaXRzX3VzZXJfdGltZW91dHMoKTsNCg0KICAvL2NoZWNrIGZvciBhbnkgcGFnZSBlcnJvcnMgYW5kIGRpc3BsYXkNCiAgaWYodHlwZW9mKHNpdHNfcGFnZV9lcnJvcnMpPT0ib2JqZWN0Iikgew0KICAgIHNpdHNfcHJvY2Vzc19pbmxpbmVfZXJyb3JzKHNpdHNfcGFnZV9lcnJvcnMpOw0KICB9DQoNCiAgLy9hdHRhY2ggdGhlIHJlc2l6ZSBldmVudCB1c2VkIGJ5IGFueSBhdXRvbWF0aWMgcmVzaXppbmcgKGlmIGVuYWJsZWQpDQogIGlmKHNpdHNfYXV0b19yZXNpemUpIHsNCiAgCSQod2luZG93KS5vbigicmVzaXplIixzaXRzX2RlYm91bmNlX2V2ZW50KHNpdHNfZG9fYXV0b19yZXNpemUxLDI1MCkpOw0KCQlzaXRzX2RvX2F1dG9fcmVzaXplMigpOyAvL21ha2UgaW5pdGlhbCBjYWxsIHRvIHBlcmZvcm0gc2V0dXANCiAgfQ0KDQogIC8vZmluYWxseSwgcnVuIGFueSByZWdpc3RlcmVkIGZ1bmN0aW9uDQogIHZhciBmbmMgPSBzaXRzX29ubG9hZDsNCiAgc2l0c19vbmxvYWQgPSBudWxsOyAvL3RlbGxzICJzaXRzX2F0dGFjaF9ldmVudCIgdGhhdCBvbmxvYWQgaGFzIGZpcmVkDQogIGlmKHR5cGVvZihmbmMpPT0iZnVuY3Rpb24iKSB7DQogICAgZm5jKCk7IC8vcnVuIGZ1bmN0aW9uDQogIH0NCg0KICBzaXRzX2xvYWRlZCA9IHRydWU7IC8vaW5kaWNhdGUgaW5pdGlhbCBsb2FkaW5nIGZpbmlzaGVkDQogIHJldHVybiB0cnVlOw0KfQ0KDQovL1VwZGF0ZSB0aGUgZmlsZSBhcnJheSB3aXRoIGFueSBwcmUtbG9hZGVkIHNjcmlwdHMNCmZ1bmN0aW9uIHNpdHNfZG9fb25sb2FkX3NjcmlwdHMoKSB7DQoJJCgic2NyaXB0W3NyY10iKS5lYWNoKGZ1bmN0aW9uKCkgew0KICAgIHZhciBzcmMgPSAkKHRoaXMpLmF0dHIoInNyYyIpOyAvL2FjY2VzcyB0aGUgbm9uLXRyYW5zbGF0ZWQgc3JjIHZhbHVlDQogICAgaWYoc3JjLmluZGV4T2YoIj8iKT4tMSkgc3JjID0gc3JjLnN1YnN0cmluZygwLHNyYy5sYXN0SW5kZXhPZigiPyIpKTsgLy9zdHJpcCBhbnkgdmVyc2lvbmluZyBmcm9tIHF1ZXJ5IHN0cmluZw0KDQogICAgc2l0c19maWxlc19hcnJheVtzcmNdID0gIlkiOyAvL2luY2x1ZGUgaW4gdGhlIGFycmF5IG9mIGZpbGVzIGxvYWRlZA0KCX0pOw0KfQ0KDQovL2NoZWNrIHRvIHNlZSBpZiB3ZSdyZSBpbiB0aGUgcG9ydGFsIGFuZCB3aGV0aGVyIHRoZSBwb3J0YWwgc3R5bGVzaGVldCBhbmQgcHJvY2Vzc2luZyBtYXkgYmUgbmVjZXNzYXJ5DQpmdW5jdGlvbiBzaXRzX2RvX3BvcnRhbF9jaGVja3MoYnJlYWtwb2ludCkgew0KCS8vbWFrZSBxdWljayBjaGVjayB0byBzZWUgaWYgd2UncmUgaW4gdGhlIHBvcnRhbCh1c2VzIGdsb2JhbCB2YXJpYWJsZSBzZXQgYnkgc2l3X3BvcnRhbCBIVFMpDQoJaWYodHlwZW9mKHNpdHNfcG9ydGFsX29iamVjdC5pblBvcnRhbCk9PT0idW5kZWZpbmVkIikgew0KCQlpZih0eXBlb2Yoc2l0c19pbl9wb3J0YWwpIT09ImJvb2xlYW4ifHwhc2l0c19pbl9wb3J0YWwpIHsNCgkJCXNpdHNfcG9ydGFsX29iamVjdC5pblBvcnRhbCA9IGZhbHNlOw0KCQkJc2l0c19wb3J0YWxfb2JqZWN0Lmhhc0FmZmVjdGVkID0gZmFsc2U7DQoNCgkJCXJldHVybjsgLy93ZSdyZSBub3QgaW4gdGhlIHBvcnRhbCwgc28gZG9uJ3QgbmVlZCB0byBwZXJmb3JtIGFueSBmdXJ0aGVyIGNoZWNrcw0KCQl9DQoJCWVsc2Ugew0KCQkJc2l0c19wb3J0YWxfb2JqZWN0LmluUG9ydGFsID0gdHJ1ZTsNCgkJfQ0KCX0NCglpZihzaXRzX3BvcnRhbF9vYmplY3QuaW5Qb3J0YWwhPT10cnVlKSByZXR1cm47IC8vbm90IGluIHRoZSBwb3J0YWwsIHNvIG5vIGZ1cnRoZXIgY2hlY2tzDQoNCgkvL3NlZSBpZiB0aGUgaW5jbHVzaW9uIG9mIHRoZSBhZGRpdGlvbmFsIHN0eWxlc2hlZXQgaXMgZGlzYWJsZWQoaWYgc28sIG5vIGZ1cnRoZXIgY2hlY2tzKQ0KCWlmKCFzaXRzX3VzZV9wb3J0YWxfY3NzKSByZXR1cm47DQoNCgkvL3NlZSBpZiB0aGVyZSBhcmUgYW55IGNvbnRhaW5lcnMgdGhhdCBtaWdodCBiZW5lZml0IGZyb20gdGhlIGFkZGl0aW9uYWwgcHJvY2Vzc2luZw0KCWlmKHR5cGVvZihzaXRzX3BvcnRhbF9vYmplY3QuaGFzQWZmZWN0ZWQpIT09ImJvb2xlYW4iKSB7DQoJCS8vd2UgbG9vayBmb3Igc3BlY2lmaWMgY2xhc3NlcyB0byBkZW5vdGUgdGhhdCBtdWx0aXBsZSBjb2x1bW5zIGFyZSBzaG93aW5nDQoJCXNpdHNfcG9ydGFsX29iamVjdC5oYXNBZmZlY3RlZCA9KCQoIi5zdi1wb3J0YWwtMi1jb2wiKS5sZW5ndGg+MCk/dHJ1ZTpmYWxzZTsNCgl9DQoJaWYoIXNpdHNfcG9ydGFsX29iamVjdC5oYXNBZmZlY3RlZCkgcmV0dXJuOyAvL25vIGFmZmVjdGVkIGNvbnRhaW5lcnMsIHNvIG5vIGZ1cnRoZXIgY2hlY2tzDQoNCgkvL3NlZSBpZiB0aGUgY3VycmVudCBicmVha3BvaW50IGlzIGFmZmVjdGVkKHNtYWxsZXIgc2NyZWVuc2l6ZXMgZmFsbGJhY2sgdG8gc2luZ2xlIGNvbHVtbiBzbyBkb24ndCBuZWVkIHRoZSBwcm9jZXNzaW5nKQ0KCWJyZWFrcG9pbnQgPSh0eXBlb2YoYnJlYWtwb2ludCkhPT0idW5kZWZpbmVkIiYmYnJlYWtwb2ludCE9PSIiKT8gYnJlYWtwb2ludCA6IHNpdHNfZ2V0X2JyZWFrcG9pbnQoKTsNCg0KCWlmKGJyZWFrcG9pbnQ9PT0ieHMifHxicmVha3BvaW50PT09InNtIikgeyAvL3hzIGFuZCBzbSBmYWxsIGJhY2sgdG8gc2luZ2xlIGNvbHVtbiwgc28gcHJvY2Vzc2luZyBpc24ndCByZXF1aXJlZA0KCQlzaXRzX3BvcnRhbF9vYmplY3QuaXNEaXNhYmxlZCA9IHRydWU7DQoJfQ0KCWVsc2Ugew0KCQlzaXRzX3BvcnRhbF9vYmplY3QuaXNEaXNhYmxlZCA9IGZhbHNlOw0KCX0NCg0KCS8vbG9hZCB0aGUgYWRkaXRpb25hbCBzdHlsZXNoZWV0KGlmIG5lY2Vzc2FyeSkNCglpZighc2l0c19wb3J0YWxfb2JqZWN0LmlzRGlzYWJsZWQpIHsNCgkJaWYoIXNpdHNfcG9ydGFsX29iamVjdC5jc3NMb2FkZWQpIHsNCgkJCXNpdHNfcG9ydGFsX29iamVjdC5jc3NMb2FkZWQgPSB0cnVlOw0KCQkJc2l0c19wb3J0YWxfb2JqZWN0LmNzc0Rpc2FibGVkID0gZmFsc2U7DQoNCgkJCXNpdHNfaW5jbHVkZV9maWxlKCIuLi9jc3Mvc3YtcG9ydGFsLmNzcyIsZnVuY3Rpb24oc3VjY2Vzcyl7DQoJCQkJaWYoIXN1Y2Nlc3MpeyAvL3N0eWxlc2hlZXQgZGlkbid0IGxvYWQsIHNvIG5vIGZ1cnRoZXIgcHJvY2Vzc2luZyBuZWVkZWQNCgkJCQkJcmV0dXJuOw0KCQkJCX0NCg0KCQkJCS8vbm93IHRoYXQgdGhlIHN0eWxlc2hlZXQgaGFzIGxvYWRlZCwgd2UgbWF5IG5lZWQgdG8gcmUtY2hlY2sgYW55IHRhYmxlc2F3IHRhYmxlcyB0byBzZWUgaWYgdGhlaXIgbW9kZSBuZWVkcyB0byBjaGFuZ2UNCgkJCQlpZihzaXRzX3BvcnRhbF9vYmplY3QuaGFzQWZmZWN0ZWQmJiFzaXRzX3BvcnRhbF9vYmplY3QuaXNEaXNhYmxlZCkgew0KCQkJCQlzaXRzX2RvX2F1dG9fcmVzaXplMyhicmVha3BvaW50LHRydWUpOw0KCQkJCQlzaXRzX2ZpbmFuY2lhbF90b3RhbHMoKTsgLy9hbHNvIHJlc2V0IGFueSBmaW5hbmNpYWwgdG90YWxzIChhcyB0aGUgd2UgbWlnaHQgaGF2ZSBjaGFuZ2VkIHRoZSB4cyBicmVha3BvaW50IGZvciB0d28tY29sdW1uIGxheW91dHMpDQoJCQkJfQ0KCQkJfSk7DQoJCX0NCgkJZWxzZSB7DQoJCQkvL3N0eWxlc2hlZXQgbG9hZGVkIHByZXZpb3VzbHksIHNvIGVuYWJsZSBpdCBpZiBpdCdzIGN1cnJlbnRseSBkaXNhYmxlZA0KCQkJaWYoc2l0c19wb3J0YWxfb2JqZWN0LmNzc0Rpc2FibGVkKSB7DQoJCQkJc2l0c19wb3J0YWxfb2JqZWN0LmNzc0Rpc2FibGVkID0gZmFsc2U7DQoJCQkJc2l0c19zdHlsZXNoZWV0X2VuYWJsZSgic3YtcG9ydGFsLmNzcyIsdHJ1ZSk7DQoJCQkJc2l0c19maW5hbmNpYWxfdG90YWxzKCk7IC8vYWxzbyByZXNldCBhbnkgZmluYW5jaWFsIHRvdGFscw0KCQkJfQ0KCQl9DQoJfQ0KCWVsc2Ugew0KCQkvL2lmIHN0eWxlc2hlZXQgaXMgZW5hYmxlZCB0aGVuIHdlIG5lZWQgdG8gZGlzYWJsZSBpdCh0byBkaXNhYmxlIHRoZSBzdHlsZXMpDQoJCWlmKHNpdHNfcG9ydGFsX29iamVjdC5jc3NMb2FkZWQmJiFzaXRzX3BvcnRhbF9vYmplY3QuY3NzRGlzYWJsZWQpIHsNCgkJCXNpdHNfcG9ydGFsX29iamVjdC5jc3NEaXNhYmxlZCA9IHRydWU7DQoJCQlzaXRzX3N0eWxlc2hlZXRfZW5hYmxlKCJzdi1wb3J0YWwuY3NzIixmYWxzZSk7DQoJCQlzaXRzX2ZpbmFuY2lhbF90b3RhbHMoKTsgLy9hbHNvIHJlc2V0IGFueSBmaW5hbmNpYWwgdG90YWxzDQoJCX0NCgl9DQp9DQoNCi8vcGVyZm9ybSBhbnkgdGFibGUgd2lkZ2V0IHByb2Nlc3NpbmcgdXBvbiBwYWdlIGxvYWQoZm9yIERhdGFUYWJsZXMgYW5kIFRhYmxlc2F3KQ0KZnVuY3Rpb24gc2l0c19kb19vbmxvYWRfdGFibGVzKCkgew0KCS8vc2VlIGlmIGVpdGhlciB0YWJsZXNhdyBvciBkYXRhdGFibGVzIGFyZSBhdmFpbGFibGUoaS5lLiBoYXMgdGhlIEpTIGJlZW4gbG9hZGVkKQ0KCXZhciB0YWJsZXNhd19sb2FkZWQgPSh0eXBlb2YgVGFibGVzYXc9PT0ib2JqZWN0Iik/dHJ1ZTpmYWxzZSwgZGF0YXRhYmxlc19sb2FkZWQgPSh0eXBlb2YgJC5mbi5EYXRhVGFibGU9PT0iZnVuY3Rpb24iKT90cnVlOmZhbHNlOw0KCWlmKCF0YWJsZXNhd19sb2FkZWQmJiFkYXRhdGFibGVzX2xvYWRlZCkgcmV0dXJuOw0KDQoJLy9pbml0aWFsaXNlIHRoZSBkZWZhdWx0IFRhYmxlc2F3IGJvaWxlcnBsYXRlcyBwcmlvciB0byBhbnkgaW5pdGlhbGlzaW5nIG9mIHRoZSB3aWRnZXQoc28gd2UgaGF2ZSB0aGVtIGV2ZW4gaWYgYXV0by1pbml0aWFsaXNlIGlzIGRpc2FibGVkKQ0KCWlmKHRhYmxlc2F3X2xvYWRlZCYmdHlwZW9mIHNpdHNfd2lkZ2V0X2JwPT09Im9iamVjdCImJnR5cGVvZiBzaXRzX3dpZGdldF9icC50cz09PSJvYmplY3QiKSB7DQoJCVRhYmxlc2F3LmkxOG4gPSAkLmV4dGVuZCh0cnVlLHt9LHNpdHNfd2lkZ2V0X2JwLnRzKTsNCgl9DQoNCgkvL3NlZSBpZiB3ZSd2ZSBkaXNhYmxlZCB0aGUgYXV0b21hdGljIGluaXRpYWxpc2F0aW9uIG9mIHRhYmxlcw0KCWlmKCFzaXRzX2F1dG9fdGFibGVfd2lkZ2V0cykgcmV0dXJuOw0KDQogIC8vZmluZCBhbGwgdGhlIHRhYmxlcyBvbiB0aGUgcGFnZSBhbmQgZGVjaWRlIHdoYXQgdG8gZG8gZm9yIGVhY2gNCiAgdmFyIHRhYmxlLCBkdF9icmVha3BvaW50cywgYnJlYWtwb2ludCwgdGFibGVzYXdfbW9kZTsNCiAgJCgidGFibGUiKS5lYWNoKGZ1bmN0aW9uKCkgew0KICAJdGFibGUgPSAkKHRoaXMpOw0KDQogICAgLy9pZiB0aGlzIHRhYmxlIGlzIHVzaW5nIHRoZSB0YWJsZXNhdyB3aWRnZXQgaW5pdGlhbGlzZSBpdA0KICAgIHRhYmxlc2F3X21vZGUgPSB0YWJsZS5kYXRhKCJ0YWJsZXNhdy1tb2RlIik7DQogICAgaWYodGFibGVzYXdfbG9hZGVkJiZ0YWJsZXNhd19tb2RlKSB7IC8vaW5pdGlhbGlzZSB0YWJsZXNhdw0KICAgIAlpZih0eXBlb2YgYnJlYWtwb2ludD09PSJ1bmRlZmluZWQiKSBicmVha3BvaW50ID0gc2l0c19nZXRfYnJlYWtwb2ludCgpOw0KDQogICAgCXNpdHNfdGFibGVzYXdfd2lkZ2V0KHRhYmxlLHRhYmxlc2F3X21vZGUsYnJlYWtwb2ludCk7DQogICAgfQ0KICAgIGVsc2Ugew0KICAgIAlpZihkYXRhdGFibGVzX2xvYWRlZCYmdGFibGUuZGF0YSgic3YtZHQiKT09PSJZIikgeyAvL2luaXRpYWxpc2UgZGF0YXRhYmxlcw0KICAgIAkJaWYodHlwZW9mIGR0X2JyZWFrcG9pbnRzPT09InVuZGVmaW5lZCIpIGR0X2JyZWFrcG9pbnRzID0gc2l0c19nZXRfZHRfYnJlYWtwb2ludHMoKTsgLy9nZXQgdGhlIGJyZWFrcG9pbnRzIGZvciByZXNwb25zaXZlIERUDQoNCiAgICAgICAgdGFibGUucGFyZW50KCkucmVtb3ZlQ2xhc3MoInN2LXRhYmxlLXJlc3BvbnNpdmUiKTsNCg0KICAgICAgICAvL2dldCB0aGUgb3B0aW9ucyBmb3IgdGhlIGRhdGF0YWJsZShhdHRyaWJ1dGVzIGNhbiBiZSB1c2VkIHRvIGNvbnRyb2wgdGhpcykNCiAgICAgICAgdmFyIG9wdCA9IHNpdHNfZGF0YXRhYmxlX3BhcmFtcyh0YWJsZSx7fSxkdF9icmVha3BvaW50cyk7DQoNCiAgICAgICAgLy9zZXQgdXAgdGhlIHJlc3BvbnNpdmUgZGF0YXRhYmxlPw0KICAgICAgICB0YWJsZS5EYXRhVGFibGUob3B0KTsNCiAgICAJfQ0KICAgIH0NCiAgfSkNCn0NCg0KLy9JbnRlcm5hbCBmdW5jdGlvbiB0byBjaGVjayBhbmQgc2VlIGlmIHdlIG5lZWQgdG8gdHJpZ2dlciBhbiBhdXRvLXJlc2l6ZQ0KZnVuY3Rpb24gc2l0c19kb19hdXRvX3Jlc2l6ZTEoZXZlbnQpIHsNCgkvL2pRdWVyeSByZXNpemUgZXZlbnRzKGxpa2UgcmVzaXppbmcgdGhlIGRpYWxvZykgYnViYmxlIHNvIG1ha2Ugc3VyZSBpdCdzIHRoZSByZXNpemUgZXZlbnQgd2Ugd2FudCh0aGUgb25lIG9uIHRoZSB3aW5kb3cpDQoJLy9BbiBJRTggaXNzdWUgbWVhbnMgd2UgY2FuJ3QgZWFzaWx5IGRldGVybWluZSB3aGV0aGVyIHRoZSB0YXJnZXQgaXMgdGhlIHdpbmRvdyBvciBub3QsIHNvIHdlIGNoZWNrIG5vZGVUeXBlIHRvIGNvbmZpcm0NCglpZigodHlwZW9mIHdpbmRvdy5ldmVudD09PSJ1bmRlZmluZWQiJiZldmVudC50YXJnZXQhPT13aW5kb3cpfHwodHlwZW9mIHdpbmRvdy5ldmVudCE9PSJ1bmRlZmluZWQiJiZldmVudC50YXJnZXQubm9kZVR5cGUhPT11bmRlZmluZWQmJmV2ZW50LnRhcmdldC5ub2RlVHlwZSE9PTkpKSByZXR1cm47DQoNCgkvL3RyaWdnZXIgdGhlIGF1dG8tcmVzaXplIGNhbGN1bGF0aW9ucw0KCXNpdHNfZG9fYXV0b19yZXNpemUyKCk7DQp9DQoNCi8vSW50ZXJuYWwgZnVuY3Rpb24gdG8gYWN0dWFsbHkgcGVyZm9ybSB0aGUgYXV0b21hdGljIHJlc2l6aW5nIG9mIGRpYWxvZ3MgYW5kIHNvbWUgd2lkZ2V0cw0KZnVuY3Rpb24gc2l0c19kb19hdXRvX3Jlc2l6ZTIoKSB7DQoJdmFyIHdpbnNpeiA9IHNpdHNfd2luZG93X3NpemUoKTsNCg0KCS8vc2VlIGlmIHdlJ3ZlIHByZXZpb3VzbHkgZGV0ZXJtaW5lZCB0aGUgYnJlYWtwb2ludCAtIGlmIHdlIGhhdmVuJ3QgdGhlbiBkbyBzbyBub3cgdGhlbiBzdG9wKGFzIHdlIGNhbid0IGhhdmUgY2FsbGVkIHRoaXMgYmVmb3JlKQ0KCWlmKHR5cGVvZihzaXRzX2N1cnJlbnRfYnJlYWspPT09InVuZGVmaW5lZCJ8fHNpdHNfY3VycmVudF9icmVhaz09PSIiKSB7DQoJCXNpdHNfaXNfcmVzaXplZCgiU2l0c0FyIix3aW5zaXopOyAvL2luaXRpYWxpc2UgIm9sZCIgd2luZG93IHdpZHRoIGFuZCBoZWlnaHQgd2hpbHN0IHdlJ3JlIG9uDQoJCXNpdHNfY3VycmVudF9icmVhayA9IHNpdHNfZ2V0X2JyZWFrcG9pbnQoKTsNCgkJcmV0dXJuOw0KCX0NCg0KCS8vU2FmYXJpIElPUyB0cmlnZ2VycyByZXNpemUgZXZlbnRzIGF0IHVudXN1YWwgdGltZXMoc3VjaCBhcyB3aGVuIHNjcm9sbGluZykgc28gd2UgbmVlZCB0byBjaGVjayB3aGV0aGVyIGEgc2NyZWVuIHJlc2l6ZSBoYXMgYWN0dWFsbHkgaGFwcGVuZWQNCgl2YXIgcmVzaXplbW9kZSA9IHNpdHNfaXNfcmVzaXplZCgiU2l0c0FyIix3aW5zaXopOyAvL3JldHVybnMgbm9uZSwgYm90aCwgaGVpZ2h0LCBvciB3aWR0aA0KCWlmKHJlc2l6ZW1vZGU9PT0ibm9uZSIpIHJldHVybjsgLy9ubyBzY3JlZW4gcmVzaXplIGhhcyBhY3R1YWxseSBoYXBwZW5lZA0KDQoJdmFyIGJyZWFrcG9pbnQgPSBzaXRzX2dldF9icmVha3BvaW50KCk7IC8vZ2V0IHRoZSBjdXJyZW50IGJyZWFrcG9pbnQNCgl2YXIgaXNkaXNhYmxlZCA9IHNpdHNfcG9ydGFsX29iamVjdC5pc0Rpc2FibGVkOyAvL2dldCB0aGUgY3VycmVudCAiZGlzYWJsZWQiIHZhbHVlDQoNCgkvL2lmIHdlJ3JlIHNob3dpbmcgdGhlIHBvcnRhbCB0aGVuIHdlIG5lZWQgdG8gcGVyZm9ybSBzb21lIGFkZGl0aW9uYWwgY2hlY2tzDQoJc2l0c19kb19wb3J0YWxfY2hlY2tzKGJyZWFrcG9pbnQpOw0KDQoJdmFyIHRyaWdnZXJyZXNpemUgPSBmYWxzZTsNCg0KCS8vaWYgd2UncmUgcGVybWl0dGluZyB0YWJsZXNhdyB0byBzd2l0Y2ggdG8vZnJvbSBzdGFjayBhdCB0aGUgbW9iaWxlIGJyZWFrcG9pbnQgdGhlbiBzZWUgaWYgd2UgbmVlZCB0byBkbyBhbnl0aGluZw0KCXZhciB0YWJsZXNhd19jaGVjayA9IGZhbHNlLCB0YWJsZXNhd19wb3J0YWxfY2hlY2sgPSBmYWxzZTsNCglpZihzaXRzX3BvcnRhbF9vYmplY3QuaGFzQWZmZWN0ZWQmJighc2l0c19wb3J0YWxfb2JqZWN0LmlzRGlzYWJsZWR8fChzaXRzX3BvcnRhbF9vYmplY3QuaXNEaXNhYmxlZCYmdHlwZW9mKGlzZGlzYWJsZWQpPT09ImJvb2xlYW4iJiYhaXNkaXNhYmxlZCkpKSB7DQoJCS8vd2UncmUgaW4gdGhlIHBvcnRhbCBhbmQgYWRkaXRpb25hbCBwcm9jZXNzaW5nIGlzIGVuYWJsZWQoaS5lLiB0aGVyZSBhcmUgbXVsdGlwbGUgY29sdW1ucyBpbiB1c2UpIG9yIHdhcyBwcmV2aW91c2x5LCBzbyB3ZSBuZWVkIHRvIGNoZWNrIHRhYmxlIGJ5IHRhYmxlDQoJCXRhYmxlc2F3X2NoZWNrID0gdHJ1ZTsNCgkJdGFibGVzYXdfcG9ydGFsX2NoZWNrID0gdHJ1ZTsNCgl9DQoJZWxzZSB7DQoJCS8vaWYgd2UncmUgbm90IGluIHRoZSBwb3J0YWwgdGhlbiB3ZSBvbmx5IG5lZWQgdG8gcHJvY2VzcyBpZiB3ZSd2ZSBzd2l0Y2hlZCB0byBvciBmcm9tIHRoZSBtb2JpbGUgYnJlYWtwb2ludA0KCQlpZihicmVha3BvaW50IT09c2l0c19jdXJyZW50X2JyZWFrJiYoc2l0c19jdXJyZW50X2JyZWFrPT09InhzInx8YnJlYWtwb2ludD09PSJ4cyIpKSB7DQoJCQl0YWJsZXNhd19jaGVjayA9IHRydWU7DQoJCX0NCgl9DQoNCglpZih0YWJsZXNhd19jaGVjaykgew0KCQkvL3N3aXRjaCBtb2RlIG9uIGFueSB0YWJsZXNhdyB0YWJsZXMgdGhhdCBuZWVkIGl0IChyZXR1cm5zIHRydWUgaWYgYSB0YWJsZSBoYXMgYmVlbiBjaGFuZ2VkKQ0KCQl0cmlnZ2VycmVzaXplID0gc2l0c19kb19hdXRvX3Jlc2l6ZTMoYnJlYWtwb2ludCx0YWJsZXNhd19wb3J0YWxfY2hlY2spOw0KCX0NCg0KCXNpdHNfY3VycmVudF9icmVhayA9IGJyZWFrcG9pbnQ7DQoNCgkvL3dvcmsgdGhyb3VnaCBlYWNoIGRpYWxvZyBjdXJyZW50bHkgdmlzaWJsZSBvbiBzY3JlZW4gYW5kIGFkanVzdCB0byB0YWtlIHRoZSByZWxldmFudCBzY2FsaW5nIGZhY3RvciBpbiB0byBhY2NvdW50DQoJaWYocmVzaXplbW9kZSE9PSJoZWlnaHQiKSB7IC8vc2tpcCBpZiB3ZSd2ZSBvbmx5IGFtZW5kZWQgdGhlIGhlaWdodCBzbyB0aGF0IHNob3dpbmcvaGlkaW5nIHNvZnR3YXJlIGtleWJvYXJkIG9uIHNvbWUgdG91Y2ggc2NyZWVucyBkb2Vzbid0IGNhdXNlIGV4Y2Vzc2l2ZSBtb3ZlbWVudA0KDQogICAgLy9jaGVjayBzZWFyY2ggaW5wdXQgKHNob3VsZCBiZSBoaWRkZW4gdW5sZXNzIGluIHVzZSkNCiAgICB2YXIgc3NpID0gJCgiI3NpdHNfc2VhcmNoX2lucHV0X3NtOnZpc2libGUiKTsNCiAgICBpZihzc2kubGVuZ3RoPjApIHsNCiAgICAgIGlmKHNzaS5pcygiOmZvY3VzIikpIHsNCiAgICAgICAgJCgiI3NpdHNfc2VhcmNoX2J1dHRvbl9zbSIpLmZvY3VzKCk7IC8vc2hpZnQgZm9jdXMgZnJvbSBpbnB1dCB0byBidXR0b24NCiAgICAgIH0NCiAgICAgIHNpdHNfaGlkZShzc2kpOyAvL2hpZGUgaW5wdXQgZmllbGQNCiAgICB9DQoNCgkJdmFyIGRsZywgd2lkOw0KCQkkKCIudWktZGlhbG9nLWNvbnRlbnQiKS5lYWNoKGZ1bmN0aW9uKCkgew0KCQkJZGxnID0gJCh0aGlzKTsNCg0KCQkJLy9pZiB0aGUgZGlhbG9nIGlzIGN1cnJlbnRseSB2aXNpYmxlIHRoZW4gd2UgbmVlZCB0byByZXNpemUgaXQNCgkJCWlmKGRsZy5pcygiOnZpc2libGUiKSkgew0KCQkJCXdpZCA9IGRsZy5kYXRhKCJzdi1kaWFsb2ctd2lkdGgiKTsgLy9nZXQgdGhlIG9yaWdpbmFsIHdpZHRoKCVhZ2UpIGZvciB0aGUgZGlhbG9nDQoNCgkJCQlpZih0eXBlb2Yod2lkKT09PSJudW1iZXIiKSB7DQoJCQkJCXZhciBzaXpvYmogPSBzaXRzX2RvX2RpYWxvZ19zaXplKHdpZCk7DQoJICAgICAgICB2YXIgbmV3d2lkID0gZmFsc2U7DQoNCgkgICAgICAgIGlmKGRsZy5kaWFsb2coIm9wdGlvbiIsIndpZHRoIikhPT1zaXpvYmouY2FsYykgeyAvL2FkanVzdCB3aWR0aCBpZiBpdCBuZWVkcyB0byBjaGFuZ2Uod29ya3MgYXJvdW5kIElFOCBpc3N1ZSkNCgkgICAgICAgICAgZGxnLmRpYWxvZygib3B0aW9uIiwid2lkdGgiLHNpem9iai5jYWxjKTsgLy9hZGp1c3Qgd2lkdGggb2YgZGlhbG9nDQoJICAgICAgICAgIG5ld3dpZCA9IHRydWU7DQoJICAgICAgICB9DQoNCgkgICAgCQkvL3RyeSB0byByZXBvc2l0aW9uIG9yIGNsb3NlIHNvbWUgb2YgdGhlIHN0YW5kYXJkIHdpZGdldHMoZGF0ZXBpY2tlciwgdGltZXBpY2tlciwgZXRjKQ0KIAkgICAJCQlpZigkKCIjdWktZGF0ZXBpY2tlci1kaXYiKS5pcygiOnZpc2libGUiKSkgeyAvL2RhdGVwaWNrZXIgaXMgY3VycmVudGx5IHNob3dpbmcNCiAJICAgICAgICAJaWYoIW5ld3dpZCkgew0KIAkgICAgICAgICAgCXJldHVybjsgLy9kb24ndCByZXNpemUgdGhpcyBkaWFsb2cgaWYgdGhlIHdpZHRoIGlzIHRoZSBzYW1lDQogCSAgICAgICAgIAl9DQogCSAgICAgICAgIAl2YXIgbGFzdElucHV0ID0gJCgkLmRhdGVwaWNrZXIuX2xhc3RJbnB1dCkuZGF0ZXBpY2tlcigiaGlkZSIpOyAvL2hpZGUgbGFzdCBpbnB1dCAtIHVzZXMgKmludGVybmFsKiB2YXJpYWJsZShub3QgaWRlYWwpDQogCSAgICAgICAgIAlzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgew0KIAkgICAgICAgICAgCWxhc3RJbnB1dC5kYXRlcGlja2VyKCJzaG93Iik7IC8vc2hvdyBhZ2FpbiBhZnRlciBkZWxheQ0KIAkgICAgICAgICAJfSwxMDApOw0KIAkgICAJCQl9DQoNCgkJCQkJLy9zZXQgdGhlIGhlaWdodCBvZiB0aGUgZGlhbG9nDQogIAkJCQlzaXRzX2RvX2RpYWxvZ19oZWlnaHQoZGxnLHNpem9iai5tYXhoZ3QpOw0KDQoJCQkJCS8vcmUtY2VudHJlIHRoZSBkaWFsb2cNCgkJCQkJZGxnLmRpYWxvZygib3B0aW9uIiwicG9zaXRpb24iLHsibXkiOiJjZW50ZXIiLCJhdCI6ImNlbnRlciIsIm9mIjp3aW5kb3csImNvbGxpc2lvbiI6ImZpdCJ9KTsNCg0KICAgICAgICAJLy90cnkgcmVwb3NpdGlvbmluZyBkeW5hbWljIGxpc3Rib3ggaWYgaXQgaXMgb3BlbihhcyBhdXRvLXJlc2l6ZSBvZiBkaWFsb2cgZG9lc24ndCB0cmlnZ2VyIG5vcm1hbCByZXNpemUpDQoJCQkJCWlmKHR5cGVvZihkbXVfb25fcmVzaXplKT09PSJmdW5jdGlvbiIpIHsNCgkJCQkJCWRtdV9vbl9yZXNpemUoKTsNCgkJCQkJfQ0KDQogCSAgIAkJCS8vdHJpZ2dlciBhIHJlc2l6ZSBldmVudCB0byBsZXQgdGhlIGRpYWxvZyBrbm93IGl0IG1pZ2h0IG5lZWQgdG8gZG8gc29tZXRoaW5nDQogICAgCQkJZGxnLnRyaWdnZXIoImRpYWxvZ3Jlc2l6ZSIpOw0KCQkJCX0NCgkJCX0NCgkJfSk7DQoJfQ0KDQoJLy90cmlnZ2VyIGEgd2luZG93IHJlc2l6ZSBldmVudCBpZiBzb21ldGhpbmcgaGFzIGNoYW5nZWQgdGhhdCBtaWdodCBhZmZlY3QgdGhlIG92ZXJhbGwgZGlzcGxheSAobGlrZSBzd2l0Y2hpbmcgZnJvbSBvciB0byBzdGFjayBtb2RlKQ0KCWlmKHRyaWdnZXJyZXNpemUpIHsNCgkJJCh3aW5kb3cpLnRyaWdnZXIoInJlc2l6ZSIpOw0KCX0NCn0NCg0KLy9JbnRlcm5hbCBmdW5jdGlvbiB0byBkZWFsIHdpdGggYXV0by1yZXNpemluZyBvZiB0YWJsZXNhdw0KZnVuY3Rpb24gc2l0c19kb19hdXRvX3Jlc2l6ZTMoYnAscG9yKSB7DQoJLy9zZWUgaWYgd2UgaGF2ZSBhbnkgdGFibGVzIHRoYXQgcGVybWl0IG1vZGUgc3dpdGNoaW5nDQoJdmFyIHRhYmxlLCBtb2RlLCBuZXdfbW9kZSwgY2hhbmdlZCA9IGZhbHNlOw0KCSQoInRhYmxlW2RhdGEtdGFibGVzYXctYWxsb3ctc3RhY2tdIikuZWFjaChmdW5jdGlvbigpIHsNCgkJdGFibGUgPSAkKHRoaXMpOw0KDQoJCWlmKHRhYmxlLmF0dHIoImRhdGEtdGFibGVzYXctYWxsb3ctc3RhY2siKT09PSJZIiYmdGFibGUuaGFzQ2xhc3MoInRhYmxlc2F3IikpIHsNCgkJCW1vZGUgPSB0YWJsZS5hdHRyKCJkYXRhLXRhYmxlc2F3LW1vZGUiKTsNCgkJCW5ld19tb2RlID0gIiI7DQoNCgkJCS8vaWYgd2UncmUgaW4gdGhlIHJpZ2h0IHBvcnRhbCBjb250ZW50IG1vZGUgdGhlbiB3ZSBuZWVkIHRvIHBlcmZvcm0gdGFibGUtc3BlY2lmaWMgcHJvY2Vzc2luZyhhcyBlbGVtZW50L2NvbnRhaW5lciBicmVha3BvaW50cyBtaWdodCBiZSBpbiB1c2UpDQoJCQlpZih0eXBlb2YocG9yKT09PSJib29sZWFuIiYmcG9yKSB7DQoJCQkJaWYoc2l0c19kb19nZXRfcG9ydGFsX2JyZWFrcG9pbnQodGFibGUpPT09InhzIikgew0KCQkJCQlpZihtb2RlIT09InN0YWNrIikgew0KCQkJCQkJbmV3X21vZGUgPSAic3RhY2siOyAvL3N3YXAgdG8gc3RhY2sNCgkJCQkJfQ0KCQkJCX0NCgkJCQllbHNlIHsNCgkJCQkJaWYobW9kZT09PSJzdGFjayIpIHsNCgkJCQkJCW5ld19tb2RlID0gdGFibGUuYXR0cigiZGF0YS10YWJsZXNhdy1vcmlnLW1vZGUiKTsgLy9zd2FwIHRvIHRoZSBub24tbW9iaWxlIG1vZGUod2hhdGV2ZXIgdGhhdCBpcykNCgkJCQkJfQ0KCQkJCX0NCgkJCX0NCgkJCWVsc2Ugew0KCQkJCS8vbm90IGluIHBvcnRhbCBjb250ZW50IG1vZGUsIHNvIGp1c3QgdXNlIHRoZSBub3JtYWwgYnJlYWtwb2ludHMNCgkJCQlpZihicD09PSJ4cyImJm1vZGUhPT0ic3RhY2siKSB7DQoJCQkJCW5ld19tb2RlID0gInN0YWNrIjsgLy9zd2FwIHRvIHN0YWNrIGFzIHdlJ3JlIG1vdmluZyBpbiB0byB0aGUgbW9iaWxlIGJyZWFrcG9pbnQNCgkJCQl9DQoJCQkJZWxzZSBpZihzaXRzX2N1cnJlbnRfYnJlYWs9PT0ieHMiJiZtb2RlPT09InN0YWNrIikgew0KCQkJCQluZXdfbW9kZSA9IHRhYmxlLmF0dHIoImRhdGEtdGFibGVzYXctb3JpZy1tb2RlIik7IC8vc3dhcCB0byB0aGUgbm9uLW1vYmlsZSBtb2RlKHdoYXRldmVyIHRoYXQgaXMpDQoJCQkJfQ0KCQkJfQ0KDQoJCQlpZih0eXBlb2YobmV3X21vZGUpIT09InVuZGVmaW5lZCImJm5ld19tb2RlIT09IiIpIHsNCgkJCQkvL3Jlc2V0IHRoZSB0YWJsZQ0KCQkJCXRhYmxlLmRhdGEoInRhYmxlIikuZGVzdHJveSgpOw0KDQoJCQkJLy91cGRhdGUgdGhlIHRhYmxlc2F3IG1vZGUNCgkJCQl0YWJsZS5hdHRyKCJkYXRhLXRhYmxlc2F3LW1vZGUiLG5ld19tb2RlKTsNCg0KCQkJCS8vaW5pdGlhbGlzZSB0aGUgcGx1Z2luIGFnYWluDQoJCQkJdGFibGUudGFibGUoKTsNCg0KCQkJCS8vd2UgaGF2ZSBjaGFuZ2VkIGF0IGxlYXN0IG9uZSB0YWJsZQ0KCQkJCWNoYW5nZWQgPSB0cnVlOw0KCQkJfQ0KCQl9DQoJfSk7DQoNCglyZXR1cm4gY2hhbmdlZDsNCn0NCg0KLy9kZXRlcm1pbmUgd2hldGhlciBhIHNjcmVlbiByZXNpemUgYWZmZWN0cyB3aWR0aCwgaGVpZ2h0LCBib3RoLCBvciBub25lIChub25lIGlzIHVzZWQgaWYgdGhlcmUgaGFzIGJlZW4gbm8gY2hhbmdlIHNpbmNlIHRoZSBmdW5jdGlvbiB3YXMgbGFzdCBjYWxsZWQpDQovLyBzdHJpbmcgaWQgOmluIDt0aGUgaWRlbnRpZmllciB0byB1c2UgaW4gZGV0ZXJtaW5pbmcgd2hldGhlciB0aGUgc2NyZWVuIGhhcyByZXNpemVkIHNpbmNlIHRoZSBsYXN0IGNhbGwgdG8gdGhpcyBmdW5jdGlvbiB3aXRoIHRoYXQgc2FtZSB1bmlxdWUgaWQNCi8vIG9iamVjdCAgd2luc2l6ICA6IGluIDtvYmplY3QgY29udGFpbmluZyB0aGUgd2luZG93IHNpemUgKHggYW5kIHkpIGluIHRoZSBmb3JtYXQgcmV0dXJuZWQgYnkgc2l0c193aW5kb3dfc2l6ZQ0KLy8gc3RyaW5nIG1vZGUgOm91dCA7cmVzaXplZCBpbiB3aWR0aC9oZWlnaHQvYm90aC9ub25lDQpmdW5jdGlvbiBzaXRzX2lzX3Jlc2l6ZWQoaWQsd2luc2l6KSB7DQoJaWYodHlwZW9mKGlkKSE9PSJzdHJpbmcifHxpZD09PSIiKXsNCgkJcmV0dXJuICJub25lIjsgLy91bmFibGUgdG8gcnVuIHdpdGhvdXQgYW4gaWQNCgl9DQoJaWYodHlwZW9mKHdpbnNpeikhPT0ib2JqZWN0Iikgew0KCQl3aW5zaXogPSBzaXRzX3dpbmRvd19zaXplKCk7DQoJfQ0KDQoJdmFyIHJlc2l6ZW1vZGUgPSAibm9uZSI7IC8vYXNzdW1lIG5vIGNoYW5nZSBieSBkZWZhdWx0DQoNCgl2YXIgd2luID0gJCh3aW5kb3cpLCBvbGRoLCBvbGR3ID0gd2luLmRhdGEoIm9sZCIraWQrIldpZHRoIiksIG5ld2gsIG5ld3c7DQoJaWYodHlwZW9mIG9sZHchPT0idW5kZWZpbmVkIikgew0KCQluZXd3ID0gd2luc2l6Lng7DQoJCWlmKG9sZHc9PW5ld3cpIHsNCgkJCS8vaWYgd2lkdGggaXMgdGhlIHNhbWUgdGhlbiB3ZSBjaGVjayB0aGUgaGVpZ2h0DQoJCQlvbGRoID0gd2luLmRhdGEoIm9sZCIraWQrIkhlaWdodCIpOw0KCQkJbmV3aCA9IHdpbnNpei55Ow0KDQoJCQlpZihvbGRoIT1uZXdoKSB7DQoJCQkJcmVzaXplbW9kZSA9ICJoZWlnaHQiOyAvL29ubHkgaGVpZ2h0IGlzIGRpZmZlcmVudA0KCQkJfQ0KCQkJZWxzZSB7DQoJCQkJcmV0dXJuIHJlc2l6ZW1vZGU7IC8vbm8gY2hhbmdlDQoJCQl9DQoJCX0NCgkJZWxzZSB7DQoJCQlvbGRoID0gd2luLmRhdGEoIm9sZCIraWQrIkhlaWdodCIpOw0KCQkJbmV3aCA9IHdpbnNpei55Ow0KCQkJaWYob2xkaCE9bmV3aCkgew0KCQkJCXJlc2l6ZW1vZGUgPSAiYm90aCI7IC8vaGVpZ2h0IGFuZCB3aWR0aCBhcmUgYm90aCBkaWZmZXJlbnQNCgkJCX0NCgkJCWVsc2Ugew0KCQkJCXJlc2l6ZW1vZGUgPSAid2lkdGgiOw0KCQkJfQ0KCQl9DQoJfQ0KCWVsc2Ugew0KCQluZXd3ID0gd2luc2l6Lng7DQoJCW5ld2ggPSB3aW5zaXoueTsgLy93ZSBhc3N1bWUgbm8gY2hhbmdlIGlmIHdlJ3ZlIG1hZGUgaXQgaGVyZShhcyBpdCBtZWFucyB0aGUgZnVuY3Rpb24gaGFzbid0IGJlZW4gcnVuIGJlZm9yZSkNCgl9DQoNCgkvL3VwZGF0ZSB0aGUgcHJldmlvdXMgaGVpZ2h0IGFuZCB3aWR0aCB2YWx1ZXMgcmVhZHkgZm9yIHRoZSBuZXh0IGNoZWNrDQoJd2luLmRhdGEoIm9sZCIraWQrIldpZHRoIixuZXd3KTsNCgl3aW4uZGF0YSgib2xkIitpZCsiSGVpZ2h0IixuZXdoKTsNCg0KCXJldHVybiByZXNpemVtb2RlOw0KfQ0KDQovL0RlYm91bmNlIGV2ZW50cyhzdWNoIGFzIHJlc2l6ZSkNCi8vIGZ1bmN0aW9uIGZ1bmMgOmluIDtmdW5jdGlvbiBub3JtYWxseSBjYWxsZWQgd2hlbiBldmVudCBmaXJlcyB0aGF0IHlvdSB3YW50IHRvIHRocm90dGxlL2RlYm91bmNlDQovLyBudW1lcmljIHdhaXQgOmluIDttaW5pbXVtIHRpbWUgdG8gd2FpdChpbiBtcykgYmVmb3JlIHRyaWdnZXJpbmcgdGhlIGZ1bmN0aW9uIGFnYWluIChpZiB0aGUgZXZlbnQgY29udGludWVzIGZpcmluZykNCi8vIGJvb2xlYW4gaW1tZWRpYXRlIDppbiA7dHJpZ2dlciB0aGUgZnVuY3Rpb24gaW1tZWRpYXRlbHkgKG9uIHRoZSBsZWFkaW5nIHJhdGhlciB0aGFuIHRyYWlsaW5nIGVkZ2UpDQpmdW5jdGlvbiBzaXRzX2RlYm91bmNlX2V2ZW50KGZ1bmMsd2FpdCxpbW1lZGlhdGUpIHsNCiAgdmFyIHRpbWVvdXQ7DQoJcmV0dXJuIGZ1bmN0aW9uKCkgeyAvL2Jhc2VkIG9uIGZ1bmN0aW9uIGZyb20gVW5kZXJzY29yZS5qcyBsaWJyYXJ5DQoJCXZhciBjb250ZXh0ID0gdGhpcywgYXJncyA9IGFyZ3VtZW50czsNCgkJdmFyIGxhdGVyID0gZnVuY3Rpb24oKSB7DQoJCQl0aW1lb3V0ID0gbnVsbDsNCgkJCWlmKCFpbW1lZGlhdGUpIGZ1bmMuYXBwbHkoY29udGV4dCwgYXJncyk7DQoJCX07DQoJCXZhciBjYWxsTm93ID0gaW1tZWRpYXRlICYmICF0aW1lb3V0Ow0KCQljbGVhclRpbWVvdXQodGltZW91dCk7DQoJCXRpbWVvdXQgPSBzZXRUaW1lb3V0KGxhdGVyLCB3YWl0KTsNCgkJaWYoY2FsbE5vdykgZnVuYy5hcHBseShjb250ZXh0LCBhcmdzKTsNCgl9Ow0KfQ0KDQovL0dldCB0aGUgYnJlYWtwb2ludHMgdG8gdXNlIGZvciBhIHJlc3BvbnNpdmUgaW5zdGFuY2Ugb2YgRGF0YVRhYmxlcw0KZnVuY3Rpb24gc2l0c19nZXRfZHRfYnJlYWtwb2ludHMoKSB7DQoJLy93ZSB1c2Ugc2l0c19icmVha3BvaW50cyhmcm9tIHNldHRpbmdzLmpzKSBhcyB0aGUgYmFzaXMsIHNvIGp1c3QgY29udmVydCB0aGVtIGluIHRvIHRoZSBmb3JtYXQgcmVxdWlyZWQgYnkgZGF0YXRhYmxlcw0KCXZhciBicmVha3BvaW50cyA9IFtdOw0KCWJyZWFrcG9pbnRzWzBdID0geyJuYW1lIjoic3YtZHQtbGciLCJ3aWR0aCI6c2l0c19icmVha3BvaW50cy5sZ307DQogIGJyZWFrcG9pbnRzWzFdID0geyJuYW1lIjoic3YtZHQtbWQiLCJ3aWR0aCI6c2l0c19icmVha3BvaW50cy5tZH07DQogIGJyZWFrcG9pbnRzWzJdID0geyJuYW1lIjoic3YtZHQtc20iLCJ3aWR0aCI6c2l0c19icmVha3BvaW50cy5zbX07DQogIGJyZWFrcG9pbnRzWzNdID0geyJuYW1lIjoic3YtZHQteHMiLCJ3aWR0aCI6c2l0c19icmVha3BvaW50cy54c307DQoNCglyZXR1cm4gYnJlYWtwb2ludHM7DQp9DQoNCi8vU2V0IHRoZSBwYWdlIG9wYWNpdHkgZm9yIGFuIG9iamVjdA0KLy8gIGVsZW1lbnQgIG9iaiAgIDogaW4gO3RoZSBvYmplY3QgdG8gc2V0IHRoZSBvcGFjaXR5IGZvcg0KLy8gIG51bWVyaWMgIHZhbCAgIDogaW4gO3RoZSB2YWx1ZSBvZiB0aGUgb3BhY2l0eSBiZXR3ZWVuIDAoY2xlYXIpIGFuZCAxMDAoc29saWQpDQpmdW5jdGlvbiBzaXRzX3NldF9vcGFjaXR5KG9iaix2YWwpIHsNCiAgaWYodHlwZW9mKG9iaik9PSJ1bmRlZmluZWQiIHx8IHZhbDwwIHx8IHZhbD4xMDApIHsgLy9jaGVjayBwYXJhbWV0ZXJzDQogICAgcmV0dXJuIGZhbHNlOw0KICB9DQogIGlmKHZhbD4xKSB7DQogICAgdmFsID0gdmFsLzEwMDsgLy9jb252ZXJ0IHBlcmNlbnRhZ2UgaW4gcmF0aW8NCiAgfQ0KICAkKG9iaikuZmFkZVRvKHNpdHNfYW5pbV9zcGVlZCx2YWwpOyAvL3VzZSBqUXVlcnkgZnVuY3Rpb24NCiAgcmV0dXJuIHRydWU7DQp9DQoNCi8vUG9zaXRpb24gYW4gb2JqZWN0IGluIHRoZSBtaWRkbGUgb2YgdGhlIHNjcmVlbg0KLy8gZWxlbWVudCAgb2JqICA6IGluIDt0aGUgb2JqZWN0IHRvIGNlbnRlcg0KLy8gbnVtZXJpYyAgdmFsICA6IGluIDt0aGUgdmFsdWUgb2YgdGhlIHdpZHRoIGJldHdlZW4gMCBhbmQgMTAwKHBlcmNlbnQpDQpmdW5jdGlvbiBzaXRzX3NjcmVlbl9jZW50ZXIob2JqLHZhbCkgew0KICBpZih0eXBlb2Yob2JqKT09InVuZGVmaW5lZCIpIHsgLy9jaGVjayBwYXJhbWV0ZXJzDQogICAgcmV0dXJuIGZhbHNlOw0KICB9DQogIGlmKHZhbDwxIHx8IHZhbD4xMDApIHsNCiAgICB2YWwgPSBudWxsOyAvL2RlZmF1bHQgdG8gdXNlIG9iamVjdHMgYWN0dWFsIHdpZHRoDQogIH0NCiAgdmFyIG1vbCA9IDA7DQogIHZhciBtb3QgPSAwOw0KICB2YXIgbW93ID0gb2JqLm9mZnNldFdpZHRoOw0KICB2YXIgbW9oID0gb2JqLm9mZnNldEhlaWdodDsNCiAgdmFyIG1zbyA9IHNpdHNfc2Nyb2xsX29mZnNldCgpOw0KICB2YXIgbXdzID0gc2l0c193aW5kb3dfc2l6ZSgpOw0KICBpZihtb3c9PW51bGwgfHwgbW93PT0wIHx8IG1vdz49bXdzLngpIHsgLy9jYWxjdWxhdGUgbGVmdCBwb3NpdGlvbiB1c2luZyB0aGUgc2NyZWVuIHdpZHRoDQogICAgbW9sID0gbXNvLng7DQogICAgbW93ID0gbnVsbDsgLy9kb24ndCBzZXQgdGhlIHdpZHRoIG9mIHRoZSBvYmplY3QgLSBqdXN0IGxlYXZlIGl0IGFzIGl0IGlzDQogIH0NCiAgZWxzZSB7DQogICAgaWYodmFsPT1udWxsKSB7IC8vd2lkdGggbm90IHNwZWNpZmllZCBzbyB1c2UgY2FsY3VsYXRlZCB3aWR0aCBvZiBvYmplY3QNCiAgICAgIG1vbCA9IG1zby54KygobXdzLngqKG1vdy9td3MueCkpLzIpOw0KICAgICAgbW93ID0obXdzLngqKG1vdy9td3MueCkpOw0KICAgIH0NCiAgICBlbHNlIHsNCiAgICAgIG1vbCA9IG1zby54KygodmFsIT0xMDApPygobXdzLngqKCgxMDAtdmFsKS8xMDApKS8yKTowKTsNCiAgICAgIG1vdyA9KCh2YWwhPTEwMCk/KG13cy54Kih2YWwvMTAwKSk6bXdzLngpOw0KICAgIH0NCiAgfQ0KICBpZihtb2g9PW51bGwgfHwgbW9oPT0wIHx8IG1vaD49bXdzLnkpIHsgLy9jYWxjdWxhdGUgdG9wIHBvc2l0aW9uIHVzaW5nIHRoZSBzY3JlZW4gaGVpZ2h0DQogICAgbW90ID0gbXNvLnk7DQogIH0NCiAgZWxzZSB7DQogICAgbW90ID0gbXNvLnkrKChtd3MueS1tb2gpLzIpOw0KICB9DQogIG9iai5zdHlsZS5sZWZ0ID0gbW9sKyJweCI7IC8vc2V0IG9iamVjdCBwb3NpdGlvbg0KICBvYmouc3R5bGUudG9wID0gbW90KyJweCI7DQogIGlmKG1vdyE9bnVsbCkgew0KICAgIG9iai5zdHlsZS53aWR0aCA9IG1vdysicHgiOw0KICB9DQogIHJldHVybiB0cnVlOw0KfQ0KDQovL0dldCBhbiBvYmplY3Qgd2l0aCB4IGFuZCB5IHZhbHVlcyByZWxhdGVkIHRvIHRoZSBvZmZzZXQgb2YgdGhlIGN1cnJlbnQgcGFnZShpLmUuIGhvdyBmYXIgaXQgaGFzIHNjcm9sbGVkKQ0KZnVuY3Rpb24gc2l0c19zY3JvbGxfb2Zmc2V0KCkgew0KICB2YXIgbW9zID0ge307DQogIGlmKHdpbmRvdy5wYWdlWU9mZnNldCB8fCB3aW5kb3cucGFnZVhPZmZzZXQpIHsgLy9Ob24tSUUNCiAgICBtb3MueCA9IHdpbmRvdy5wYWdlWE9mZnNldDsNCiAgICBtb3MueSA9IHdpbmRvdy5wYWdlWU9mZnNldDsNCiAgfQ0KICBlbHNlIGlmKGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCAmJihkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsTGVmdCB8fCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wKSkgeyAvL0lFIDYrIFN0cmljdA0KICAgIG1vcy54ID0gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LnNjcm9sbExlZnQ7DQogICAgbW9zLnkgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wOw0KICB9DQogIGVsc2UgeyAvL0lFIDUgb3IgcXVpcmtzDQogICAgbW9zLnggPSBkb2N1bWVudC5ib2R5LnNjcm9sbExlZnQgfHwgMDsNCiAgICBtb3MueSA9IGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wIHx8IDA7DQogIH0NCiAgcmV0dXJuIG1vczsNCn0NCg0KLy9HZXQgdGhlIGN1cnJlbnQgc3R5bGUgb2YgYW4gb2JqZWN0DQovLyBlbGVtZW50ICBvYmogIDogaW4gO3RoZSBvYmplY3QgdG8gZ2V0IHN0eWxlIG9mDQovLyBzdHJpbmcgIG5hbSAgOiBpbiA7dGhlIHN0eWxlIHByb3BlcnR5IHRvIGdldChoeXBlbmF0ZWQpDQpmdW5jdGlvbiBzaXRzX2dldF9zdHlsZShvYmosbmFtKSB7DQogIGlmKHR5cGVvZihvYmopPT0idW5kZWZpbmVkIiB8fCBuYW09PSIiKSB7IC8vY2hlY2sgcGFyYW1ldGVycw0KICAgIHJldHVybiAiIjsNCiAgfQ0KICB2YXIgdmFsID0gIiI7DQogIGlmKHR5cGVvZigkKSE9ImZ1bmN0aW9uIikgew0KICAgIGlmKGRvY3VtZW50LmRlZmF1bHRWaWV3ICYmIGRvY3VtZW50LmRlZmF1bHRWaWV3LmdldENvbXB1dGVkU3R5bGUpIHsNCiAgICAgIG5hbSA9IG5hbS5yZXBsYWNlKC9bQS1aXS9nLGZ1bmN0aW9uKHN0cikgeyAvL2NvbnZlcnQgbmFtZSBpbnRvIGh5cGVuYXRlZA0KICAgICAgICByZXR1cm4gIi0iK3N0ci50b0xvd2VyQ2FzZSgpOw0KICAgICAgfSk7DQogICAgICB2YWwgPSBkb2N1bWVudC5kZWZhdWx0Vmlldy5nZXRDb21wdXRlZFN0eWxlKG9iaiwiIikuZ2V0UHJvcGVydHlWYWx1ZShuYW0pOyAvL2dldCBjdXJyZW50IHN0eWxlDQogICAgfQ0KICAgIGVsc2UgaWYob2JqLmN1cnJlbnRTdHlsZSkgew0KICAgICAgbmFtID0gbmFtLnJlcGxhY2UoL1wtKFx3KS9nLGZ1bmN0aW9uKHN0cixwMSkgeyAvL2NvbnZlcnQgbmFtZSBpbnRvIGNhbWVsIGNhc2UNCiAgICAgICAgcmV0dXJuIHAxLnRvVXBwZXJDYXNlKCk7DQogICAgICB9KTsNCiAgICAgIHZhbCA9IG9iai5jdXJyZW50U3R5bGVbbmFtXTsgLy9nZXQgY3VycmVudCBzdHlsZQ0KICAgIH0NCiAgfQ0KICBlbHNlIHsNCiAgICB2YWwgPSAkKG9iaikuY3NzKG5hbSk7IC8vdXNlIGpRdWVyeQ0KICB9DQogIHJldHVybiB2YWw7DQp9DQoNCi8vUmVnaXN0ZXIgYW4gZXZlbnQNCi8vIGVsZW1lbnQgIG9iaiAgOiBpbiA7dGhlIG9iamVjdCB0byBhdHRhY2ggdGhlIGV2ZW50IHRvDQovLyBzdHJpbmcgIGV2dCAgOiBpbiA7dGhlIG5hbWUgb2YgdGhlIGV2ZW50IHRvIGF0dGFjaA0KLy8gZnVuY3Rpb24gIGZuYyAgOiBpbiA7dGhlIGZ1bmN0aW9uIHRvIGJlIHRyaWdnZXJlZCBieSB0aGUgZXZlbnQNCmZ1bmN0aW9uIHNpdHNfYXR0YWNoX2V2ZW50KG9iaixldnQsZm5jKSB7DQogIGlmKHR5cGVvZihvYmopPT0idW5kZWZpbmVkIiB8fCBldnQ9PSIiIHx8IHR5cGVvZihmbmMpIT0iZnVuY3Rpb24iKSB7IC8vY2hlY2sgcGFyYW1ldGVycw0KICAgIHJldHVybiBmYWxzZTsNCiAgfQ0KICBpZihldnQ9PSJsb2FkIikgeyAvL2N1c3RvbSBldmVudA0KICAgIGlmKHR5cGVvZihzaXRzX29ubG9hZCkhPSJmdW5jdGlvbiIpIHsgLy9vbmxvYWQgaGFzIGFscmVhZHkgZmlyZWQuLi4NCiAgICAgIHNldFRpbWVvdXQoZm5jLDEwKTsgLy8uLi5zbyBydW4gdGhlIGZ1bmN0aW9uIG5vdw0KICAgIH0NCiAgICBlbHNlIHsNCiAgICAgIHZhciBvbGQgPSBzaXRzX29ubG9hZDsNCiAgICAgIHNpdHNfb25sb2FkID0gZnVuY3Rpb24oKSB7IC8vYWRkIG5ldyBmdW5jdGlvbiB0byBleGlzdGluZyBmdW5jdGlvbg0KICAgICAgICBvbGQoKTsNCiAgICAgICAgZm5jKCk7DQogICAgICB9Ow0KICAgIH0NCiAgICByZXR1cm4gdHJ1ZTsNCiAgfQ0KICBpZihldnQuc3Vic3RyKDAsMik9PSJvbiIpIHsNCiAgICBldnQgPSBldnQuc3Vic3RyKDIpOyAvL3RyaW0gIm9uIiBqdXN0IGluIGNhc2UNCiAgfQ0KICBpZihldnQ9PSJsb2FkIikgew0KICAgIG9iaiA9IHdpbmRvdzsgLy9hdHRhY2ggbG9hZCB0byB3aW5kb3cNCiAgfQ0KICBpZih0eXBlb2YoJCkhPSJmdW5jdGlvbiIpIHsgLy9jaGVjayBpZiBqUXVlcnkgcmVhZHkNCiAgICByZXR1cm4gc2l0c19kb19hdHRhY2hfZXZlbnQob2JqLGV2dCxmbmMpOw0KICB9DQogIGVsc2Ugew0KICAgICQob2JqKS5iaW5kKGV2dCxmbmMpOyAvL3VzZSBqUXVlcnkgdG8gcmVnaXN0ZXIgZXZlbnQNCiAgfQ0KICByZXR1cm4gdHJ1ZTsNCn0NCg0KLy9JbnRlcm5hbCBmdW5jdGlvbiB0byByZWdpc3RlciBhbiBldmVudCBwcmUtalF1ZXJ5DQovLyBlbGVtZW50ICBvYmogOiBpbiA7dGhlIG9iamVjdCB0byBhdHRhY2ggdGhlIGV2ZW50IHRvDQovLyBzdHJpbmcgZXZ0IDogaW4gO3RoZSBuYW1lIG9mIHRoZSBldmVudCB0byBhdHRhY2gNCi8vIGZ1bmN0aW9uIGZuYyA6IGluIDt0aGUgZnVuY3Rpb24gdG8gYmUgdHJpZ2dlcmVkIGJ5IHRoZSBldmVudA0KZnVuY3Rpb24gc2l0c19kb19hdHRhY2hfZXZlbnQob2JqLGV2dCxmbmMpIHsNCiAgaWYob2JqLmFkZEV2ZW50TGlzdGVuZXIpIHsgLy9Nb3ppbGxhDQogICAgb2JqLmFkZEV2ZW50TGlzdGVuZXIoZXZ0LGZuYyxmYWxzZSk7DQogICAgcmV0dXJuIHRydWU7DQogIH0NCiAgZWxzZSB7DQogICAgaWYob2JqLmF0dGFjaEV2ZW50KSB7IC8vSUUNCiAgICAgIG9iai5hdHRhY2hFdmVudCgib24iK2V2dCxmbmMpOw0KICAgICAgcmV0dXJuIHRydWU7DQogICAgfQ0KICB9DQogIHJldHVybiBmYWxzZTsgLy9jb3VsZCBub3QgYmUgcmVnaXN0ZXJlZA0KfQ0KDQovL1VucmVnaXN0ZXIgYW4gZXZlbnQNCi8vIGVsZW1lbnQgIG9iaiAgOiBpbiA7dGhlIG9iamVjdCB0byBkZXRhY2ggdGhlIGV2ZW50IGZyb20NCi8vIHN0cmluZyAgZXZ0ICA6IGluIDt0aGUgbmFtZSBvZiB0aGUgZXZlbnQgdG8gZGV0YWNoDQovLyBmdW5jdGlvbiAgZm5jICA6IGluIDt0aGUgZnVuY3Rpb24gdGhhdCB3YXMgdHJpZ2dlcmVkIGJ5IHRoZSBldmVudA0KZnVuY3Rpb24gc2l0c19kZXRhY2hfZXZlbnQob2JqLGV2dCxmbmMpIHsNCiAgaWYodHlwZW9mKG9iaik9PSJ1bmRlZmluZWQiIHx8IGV2dD09IiIgfHwgdHlwZW9mKGZuYykhPSJmdW5jdGlvbiIpIHsgLy9jaGVjayBwYXJhbWV0ZXJzDQogICAgcmV0dXJuIGZhbHNlOw0KICB9DQogIGlmKGV2dC5zdWJzdHIoMCwyKT09Im9uIikgew0KICAgIGV2dCA9IGV2dC5zdWJzdHIoMik7IC8vdHJpbSAib24iDQogIH0NCiAgaWYoZXZ0IT0ibG9hZCIpIHsgLy9jYW4ndCB1bnJlZ2lzdGVyICJvbmxvYWQiIGV2ZW50cw0KICAgICQob2JqKS51bmJpbmQoZXZ0LGZuYyk7IC8vdXNlIGpRdWVyeSB0byB1bnJlZ2lzdGVyIGV2ZW50DQogIH0NCiAgcmV0dXJuIHRydWU7DQp9DQoNCi8vR2V0IHRoZSBjdXJyZW50IG1vdXNlIHBvc2l0aW9uDQovLyBldmVudCAgZSAgOiBpbiA7dGhlIGV2ZW50IHdoaWNoIGhhcyBqdXN0IGZpcmVkDQpmdW5jdGlvbiBzaXRzX21vdXNlX29mZnNldChlKSB7DQogIGUgPSBlIHx8IHdpbmRvdy5ldmVudDsNCiAgdmFyIG0gPSBzaXRzX3Njcm9sbF9vZmZzZXQoKTsgLy9nZXQgY3VycmVudCBzY3JvbGwgcG9zaXRpb24NCiAgbS54ICs9IGUuY2xpZW50WDsgLy9hZGQgY29vcmRpbmF0ZXMNCiAgbS55ICs9IGUuY2xpZW50WTsNCiAgcmV0dXJuIG07IC8vcmV0dXJuIGNvb3JkaW5hdGVzIHt4LHl9DQp9DQoNCi8vR2V0IHRoZSBwb3NpdGlvbiBvZiB0aGUgc3BlY2lmaWVkIG9iamVjdA0KLy8gZWxlbWVudCAgbyAgOiBpbiA7dGhlIG9iamVjdCB0byBnZXQgdGhlIHBvc2l0aW9uIG9mDQovLyBib29sZWFuICBiICA6IGluIDtpbmRpY2F0ZXMgd2hldGhlciB0aGlzIGlzIHJlbGF0aXZlIHRvIHRoZSB3aG9sZSBwYWdlIG9yIG5vdA0KZnVuY3Rpb24gc2l0c19vYmplY3Rfb2Zmc2V0KG8sYikgew0KICBpZih0eXBlb2YoYik9PSJ1bmRlZmluZWQiKSB7DQogICAgYiA9IGZhbHNlOyAvL2RlZmF1bHQgaXMgcmVsYXRpdmUgdG8gc2NyZWVuKG5vdCBwYWdlKQ0KICB9DQogIHZhciBjdXJsZWZ0ID0oby5vZmZzZXRMZWZ0LW8uc2Nyb2xsTGVmdCk7IC8vZ2V0IGNvb3JkaW5hdGVzDQogIHZhciBjdXJ0b3AgPShvLm9mZnNldFRvcC1vLnNjcm9sbFRvcCk7DQogIHdoaWxlKG89by5vZmZzZXRQYXJlbnQpIHsgLy9sb29wIHRocm91Z2ggcGFyZW50cyBhZGRpbmcgdGhlaXIgY29vcmRpbmF0ZXMNCiAgICBpZihvLnRhZ05hbWU9PSJCT0RZIiB8fCBvLnRhZ05hbWU9PSJIVE1MIikgeyAvL3NvbWUgYnJvd3NlcnMgYXBwbHkgc2Nyb2xsIHRvIGJvZHkvaHRtbCBvdGhlcnMgdG8gZG9jdW1lbnQuLi4NCiAgICAgIGlmKGIpIHsgLy8ocmVsYXRpdmUgdG8gcGFnZSkNCiAgICAgICAgdmFyIHMgPSBzaXRzX3Njcm9sbF9vZmZzZXQoKTsgLy8uLi5zbyBmaW5kIHRoZSBzY3JvbGwgdmFsdWVzIHRoZSBoYXJkIHdheS4uLg0KICAgICAgICBjdXJsZWZ0ICs9KG8ub2Zmc2V0TGVmdC1zLngpOw0KICAgICAgICBjdXJ0b3AgKz0oby5vZmZzZXRUb3Atcy55KTsNCiAgICAgIH0NCiAgICAgIGVsc2UgeyAvLyhyZWxhdGl2ZSB0byBzY3JlZW4pDQogICAgICAgIGN1cmxlZnQgKz0gby5vZmZzZXRMZWZ0Ow0KICAgICAgICBjdXJ0b3AgKz0gby5vZmZzZXRUb3A7DQogICAgICB9DQogICAgfQ0KICAgIGVsc2Ugew0KICAgICAgY3VybGVmdCArPShvLm9mZnNldExlZnQtby5zY3JvbGxMZWZ0KTsgLy8uLi5vdGhlcndpc2UgdXNlIHRoZSBlYXN5IHdheQ0KICAgICAgY3VydG9wICs9KG8ub2Zmc2V0VG9wLW8uc2Nyb2xsVG9wKTsNCiAgICB9DQogIH0NCiAgcmV0dXJuIHt4OmN1cmxlZnQseTpjdXJ0b3B9OyAvL3JldHVybiBjb29yZGluYXRlcyB7eCx5fQ0KfQ0KDQovL0dldCB0aGUgZGltZW5zaW9ucyBvZiB0aGUgc3BlY2lmaWVkIG9iamVjdA0KLy8gZWxlbWVudCAgbyAgOiBpbiA7dGhlIG9iamVjdCB0byBnZXQgdGhlIGRpbWVuc2lvbnMgb2YNCmZ1bmN0aW9uIHNpdHNfb2JqZWN0X3NpemUobykgew0KICByZXR1cm4ge3g6by5vZmZzZXRXaWR0aCx5Om8ub2Zmc2V0SGVpZ2h0fTsgLy9yZXR1cm4gZGltZW5pb25zIHt4LHl9DQp9DQoNCi8vR2V0IHRoZSBkaW1lbnNpb25zIG9mIHRoZSB3aW5kb3cNCmZ1bmN0aW9uIHNpdHNfd2luZG93X3NpemUoKSB7DQogIHZhciBtc3cgPSAwOw0KICB2YXIgbXNoID0gMDsNCiAgaWYodHlwZW9mKCQpIT0iZnVuY3Rpb24iKSB7DQogICAgbXN3ID0gZG9jdW1lbnQuY29tcGF0TW9kZT09IkNTUzFDb21wYXQiICYmIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aCB8fCBkb2N1bWVudC5ib2R5LmNsaWVudFdpZHRoOw0KICAgIG1zaCA9IGRvY3VtZW50LmNvbXBhdE1vZGU9PSJDU1MxQ29tcGF0IiAmJiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0IHx8IGRvY3VtZW50LmJvZHkuY2xpZW50SGVpZ2h0Ow0KICB9DQogIGVsc2Ugew0KICAgIG1zdyA9ICQod2luZG93KS53aWR0aCgpOyAvL3VzZSBqUXVlcnkNCiAgICBtc2ggPSAkKHdpbmRvdykuaGVpZ2h0KCk7DQogIH0NCiAgcmV0dXJuIHt4Om1zdyx5Om1zaH07IC8vcmV0dXJuIGRpbWVuaW9ucyB7eCx5fQ0KfQ0KDQovL1NldCB0aGUgZm9jdXMgdG8gdGhlIHNwZWNpZmllZCBvYmplY3QgaWQNCi8vIHN0cmluZyAgaWQgIDogaW4gO3RoZSBpZCBvZiB0aGUgb2JqZWN0IHRvIHNldCBmb2N1cyB0bw0KZnVuY3Rpb24gc2l0c19zZXRfZm9jdXMoaWQpIHsNCiAgdmFyIG9iaiA9IHNpdHNfZ2V0X29iamVjdChpZCk7DQogIGlmKCFvYmopIHsNCiAgICByZXR1cm4gZmFsc2U7IC8vb2JqZWN0IG5vdCBmb3VuZA0KICB9DQogIG9iai5mb2N1cygpOyAvL3NldCBmb2N1cw0KICByZXR1cm4gdHJ1ZTsNCn0NCg0KLy9HZXQgdGhlIHZhbHVlIG9mIHRoZSBzcGVjaWZpZWQgb2JqZWN0IGlkDQovLyBzdHJpbmcgIGlkICA6IGluIDt0aGUgaWQgb2YgdGhlIG9iamVjdCB0byBnZXQgdGhlIHZhbHVlIG9mDQpmdW5jdGlvbiBzaXRzX2dldF92YWx1ZShpZCkgew0KICB2YXIgb2JqID0gbnVsbDsNCiAgaWYodHlwZW9mKGlkKT09InN0cmluZyIpIHsNCiAgICBvYmogPSBzaXRzX2dldF9vYmplY3QoaWQpOyAvL2dldCBvYmplY3QgZnJvbSBpZA0KICB9DQogIGVsc2Ugew0KICAgIG9iaiA9IGlkOyAvL29iamVjdCB3YXMgcGFzc2VkIGluDQogIH0NCiAgaWYoIW9iaikgew0KICAgIHJldHVybiAiIjsgLy9vYmplY3Qgbm90IGZvdW5kDQogIH0NCiAgc3dpdGNoKG9iai50YWdOYW1lKSB7DQogICAgY2FzZSAiSU5QVVQiOg0KICAgICAgdmFyIHR5cCA9IG9iai5nZXRBdHRyaWJ1dGUoInR5cGUiKS50b1VwcGVyQ2FzZSgpOw0KICAgICAgaWYodHlwPT0iUkFESU8iKSB7IC8vcmFkaW9ncm91cA0KICAgICAgICB2YXIgcmFkID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeU5hbWUob2JqLm5hbWUpOw0KICAgICAgICBmb3IodmFyIGk9MDtpPHJhZC5sZW5ndGg7aSsrKSB7DQogICAgICAgICAgaWYocmFkW2ldLmNoZWNrZWQpIHsNCiAgICAgICAgICAgIHJldHVybiByYWRbaV0udmFsdWU7IC8vcmV0dXJuIGNoZWNrZWQgdmFsdWUNCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuICIiOw0KICAgICAgfQ0KICAgICAgaWYodHlwPT0iQ0hFQ0tCT1giKSB7IC8vY2hlY2tib3gNCiAgICAgICAgaWYob2JqLmNoZWNrZWQpIHsNCiAgICAgICAgICByZXR1cm4gIlkiOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiAiTiI7DQogICAgICB9DQogICAgICBpZih0eXA9PSJEQVRFIikgeyAvL2RhdGUNCiAgICAgICAgcmV0dXJuIHNpdHNfYXRvbV90b19kYXRlKG9iai52YWx1ZSk7DQogICAgICB9DQogICAgICBpZih0eXBlb2YoJCk9PSJmdW5jdGlvbiIpIHsgLy9keW5hbWljIGxpc3Rib3gNCiAgICAgICAgdmFyIGZsZF9qcSA9ICQob2JqKTsNCiAgICAgICAgaWYoZmxkX2pxLmhhc0NsYXNzKCJkbXVfZW5hYmxlZCIpKSB7DQogICAgICAgICAgdmFyIHZhbHUgPSBmbGRfanEuZGF0YSgiZG11LWN1cnIiKTsNCiAgICAgICAgICBpZih0eXBlb2YodmFsdSk9PSJzdHJpbmciICYmIHZhbHUhPSIiKSB7DQogICAgICAgICAgICByZXR1cm4gdmFsdTsNCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgIH0NCiAgICAgIHJldHVybiBvYmoudmFsdWU7IC8vdGV4dGJveA0KICAgIGNhc2UgIlNFTEVDVCI6DQogICAgICBpZihvYmouc2VsZWN0ZWRJbmRleD4tMSkgew0KICAgICAgICBpZihvYmoubXVsdGlwbGU9PXRydWUpIHsgLy8gYWRkZWQgYnkgUFBMMDI1ODkzIHRvIGhhbmRsZSBtdWx0aSBzZWxlY3Qgd2lkZ2V0cw0KICAgICAgICAgIHZhciB2VmFsdWVzID0gIiI7DQogICAgICAgICAgZm9yKHZhciBpPTA7aTxvYmoub3B0aW9ucy5sZW5ndGg7aSsrKSB7DQogICAgICAgICAgICBpZihvYmoub3B0aW9uc1tpXS5zZWxlY3RlZCkgew0KICAgICAgICAgICAgICBpZih2VmFsdWVzPT0iIikgew0KICAgICAgICAgICAgICAgIHZWYWx1ZXMgPSBvYmoub3B0aW9uc1tpXS52YWx1ZTsNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICB2VmFsdWVzID0gdlZhbHVlcysiLCIrb2JqLm9wdGlvbnNbaV0udmFsdWU7IC8vICIsIiB3aWxsIGJlIHRoZSBzZXBhcmF0b3IgYmV0d2VlbiB2YWx1ZXMNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH0NCiAgICAgICAgICByZXR1cm4gdlZhbHVlczsgLy8gcmV0dXJuIGFsbCB0aGUgbXVsdGkgc2VsZWN0ZWQgdmFsdWVzIGluIHRoZSBsaXN0DQogICAgICAgIH0NCiAgICAgICAgZWxzZSB7DQogICAgICAgICAgcmV0dXJuIG9iai5vcHRpb25zW29iai5zZWxlY3RlZEluZGV4XS52YWx1ZTsgLy9kcm9wZG93bg0KICAgICAgICB9DQogICAgICB9DQogICAgICByZXR1cm4gIiI7DQogICAgY2FzZSAiVEVYVEFSRUEiOg0KICAgICAgcmV0dXJuIG9iai52YWx1ZTsgLy90ZXh0YXJlYQ0KICB9DQogIHJldHVybiAiIjsgLy92YWx1ZSBub3QgZm91bmQNCn0NCg0KLy9TZXQgdGhlIHZhbHVlIG9mIHRoZSBzcGVjaWZpZWQgb2JqZWN0IGlkDQovLyBzdHJpbmcgIGlkICA6IGluIDt0aGUgaWQgb2YgdGhlIG9iamVjdCB0byBzZXQgdGhlIHZhbHVlIG9mDQovLyBzdHJpbmcgIHZhbCAgOiBpbiA7dGhlIHZhbHVlIHRvIGJlIHNldA0KLy8gYm9vbGVhbiBjbHIgOiBpbiA7cmVzZXQgdHJhbnNsYXRpb24vZXJyb3INCmZ1bmN0aW9uIHNpdHNfc2V0X3ZhbHVlKGlkLHZhbCxjbHIpIHsNCiAgdmFyIG9iaiA9IG51bGw7DQogIGlmKHR5cGVvZihpZCk9PSJzdHJpbmciKSB7DQogICAgb2JqID0gc2l0c19nZXRfb2JqZWN0KGlkKTsgLy9nZXQgb2JqZWN0IGZyb20gaWQNCiAgfQ0KICBlbHNlIHsNCiAgICBvYmogPSBpZDsgLy9vYmplY3Qgd2FzIHBhc3NlZCBpbg0KICB9DQogIGlmKCFvYmopIHsNCiAgICByZXR1cm4gZmFsc2U7IC8vb2JqZWN0IG5vdCBmb3VuZA0KICB9DQogIGlmKCFjbHIpIHsNCiAgCWNsciA9IHRydWU7IC8vcmVzZXQgdGhlIHRyYW5zbGF0aW9uL2Vycm9yIGJ5IGRlZmF1bHQNCiAgfQ0KDQogIHZhciBjLGksbCxmb3VuZCA9IGZhbHNlLGNoYW5nZWQgPSBmYWxzZTsNCiAgc3dpdGNoKG9iai50YWdOYW1lKSB7DQogICAgY2FzZSAiSU5QVVQiOg0KICAgICAgdmFyIHR5cCA9IG9iai5nZXRBdHRyaWJ1dGUoInR5cGUiKS50b1VwcGVyQ2FzZSgpOw0KICAgICAgaWYodHlwPT0iUkFESU8iKSB7IC8vcmFkaW9ncm91cA0KICAgICAgICBjID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeU5hbWUob2JqLm5hbWUpOw0KICAgICAgICBsID0gYy5sZW5ndGg7DQogICAgICAgIGZvcihpPTA7aTxsO2krKykgeyAvL2xvb3AgdGhyb3VnaCBvcHRpb25zDQogICAgICAgICAgaWYoY1tpXS52YWx1ZT09dmFsKSB7IC8vdW50aWwgdmFsdWUgZm91bmQNCiAgICAgICAgICAJaWYoIWNbaV0uY2hlY2tlZCkgew0KICAgICAgICAgIAkJY2hhbmdlZCA9IHRydWU7DQogICAgICAgICAgCX0NCiAgICAgICAgICAgIGNbaV0uY2hlY2tlZCA9IHRydWU7IC8vc2VsZWN0IHZhbHVlDQogICAgICAgICAgICBmb3VuZCA9IHRydWU7DQogICAgICAgICAgfQ0KICAgICAgICAgIGVsc2Ugew0KICAgICAgICAgICAgY1tpXS5jaGVja2VkID0gZmFsc2U7IC8vdW5zZWxlY3Qgb3RoZXIgdmFsdWVzDQogICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICB9DQogICAgICBlbHNlIHsNCgkgICAgICBpZih0eXA9PSJDSEVDS0JPWCIpIHsgLy9jaGVja2JveA0KICAJICAgICAgaWYodmFsPT0iWSIpIHsNCiAgCSAgICAgIAlpZighb2JqLmNoZWNrZWQpIHsNCiAgCSAgICAgIAkJY2hhbmdlZCA9IHRydWU7DQogIAkgICAgICAJfQ0KICAgIAkgICAgICBvYmouY2hlY2tlZCA9IHRydWU7DQogICAgICAJICB9DQogICAgICAgIAllbHNlIHsNCiAgICAgICAgCQlpZihvYmouY2hlY2tlZCkgew0KICAgICAgICAJCQljaGFuZ2VkID0gdHJ1ZTsNCiAgICAgICAgCQl9DQogICAgICAgICAgCW9iai5jaGVja2VkID0gZmFsc2U7DQogICAgICAgIAl9DQoJCQkJCWZvdW5kID0gdHJ1ZTsNCiAgICAgIAl9DQogICAgICAJZWxzZSB7DQogICAgICAJCWlmKHR5cD09IkRBVEUiKSB7IC8vZGF0ZQ0KICAgICAgCQkJdmFyIG5ld3ZhbCA9IHNpdHNfZGF0ZV90b19hdG9tKHZhbCk7DQogICAgICAJCQlpZihvYmoudmFsdWUhPW5ld3ZhbCkgew0KICAgICAgCQkJCWNoYW5nZWQgPSB0cnVlOw0KICAgICAgCQkJfQ0KICAgICAgICAJCW9iai52YWx1ZSA9IG5ld3ZhbDsNCgkJCQkJCWZvdW5kID0gdHJ1ZTsNCiAgICAgIAkJfQ0KICAgICAgCQllbHNlIHsNCiAgICAgIAkJCWlmKHR5cGVvZigkKT09ImZ1bmN0aW9uIikgew0KICAgICAgICAJCQl2YXIgZmxkX2pxID0gJChvYmopOw0KICAgICAgICAJCQlpZihmbGRfanEuaGFzQ2xhc3MoImRtdV9lbmFibGVkIikpIHsgLy9keW5hbWljIGxpc3Rib3gNCiAgICAgICAgCQkJCXZhciBjdXJ2YWwgPSBmbGRfanEuZGF0YSgiZG11LWN1cnIiKTsNCiAgICAgICAgCQkJCWlmKHR5cGVvZihjdXJ2YWwpPT0idW5kZWZpbmVkIikgew0KICAgICAgICAJCQkJCWN1cnZhbCA9IG9iai52YWx1ZTsgLy9maWVsZCBwcm9iYWJseSBub3QgeWV0IGZvY3Vzc2VkIG9uLCBzbyB0YWtlIHZhbHVlIGRpcmVjdGx5IGZyb20gaW5wdXQgaW5zdGVhZA0KICAgICAgICAJCQkJfQ0KICAgICAgICAJCQkJaWYoY3VydmFsIT12YWwpIHsNCiAgICAgICAgCQkJCQlzaXRzX2RvX3NldF92YWx1ZShmbGRfanEsY2xyKTsNCiAgICAgICAgCQkJCX0NCgkgICAgICAgICAgCQlyZXR1cm4gZG11X3NldF92YWx1ZShvYmosdmFsKTsNCiAgCSAgICAgIAkJfQ0KICAgIAkgIAkJfQ0KDQogICAJICAJCQlpZihvYmoudmFsdWUhPXZhbCkgew0KICAgCSAgCQkJCWNoYW5nZWQgPSB0cnVlOw0KICAgCSAgCQkJfQ0KICAgICAJCQkJb2JqLnZhbHVlID0gdmFsOyAvL3RleHRib3gNCiAgICAgCQkJCWZvdW5kID0gdHJ1ZTsNCiAgICAgIAkJfQ0KICAgICAgCX0NCiAgICAgIH0NCiAgICAgIGJyZWFrOw0KICAgIGNhc2UgIlNFTEVDVCI6DQogICAgICBjID0gb2JqLm9wdGlvbnM7IC8vZHJvcGRvd24NCiAgICAgIGwgPSBjLmxlbmd0aDsNCiAgICAgIGZvcihpPTA7IWZvdW5kJiZpPGw7aSsrKSB7IC8vbG9vcCB0aHJvdWdoIG9wdGlvbnMNCiAgICAgICAgaWYoY1tpXS52YWx1ZT09dmFsKSB7IC8vdW50aWwgdmFsdWUgZm91bmQNCiAgICAgICAgCWlmKCFjW2ldLnNlbGVjdGVkKSB7DQogICAgICAgIAkJY2hhbmdlZCA9IHRydWU7DQogICAgICAgIAl9DQogICAgICAgICAgY1tpXS5zZWxlY3RlZCA9IHRydWU7IC8vc2VsZWN0IHZhbHVlDQogICAgICAgICAgZm91bmQgPSB0cnVlOw0KICAgICAgICB9DQogICAgICAgIGVsc2Ugew0KICAgICAgICAgIGNbaV0uc2VsZWN0ZWQgPSBmYWxzZTsgLy91bi1zZWxlY3QgdmFsdWUNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgICAgYnJlYWs7DQogICAgY2FzZSAiVEVYVEFSRUEiOg0KICAgIAlpZihvYmoudmFsdWUhPXZhbCkgew0KICAgIAkJY2hhbmdlZCA9IHRydWU7DQogICAgCX0NCiAgICAgIG9iai52YWx1ZSA9IHZhbDsgLy90ZXh0YXJlYQ0KICAgICAgZm91bmQgPSB0cnVlOw0KICAgICAgYnJlYWs7DQogIH0NCg0KICAvL3BlcmZvcm0gY2xlYW51cCB0YXNrcyAobGlrZSBibGFuayBvdXQgdGhlIHRyYW5zbGF0aW9uL2Vycm9yIGZpZWxkcyB3aGVuIGFwcHJvcHJpYXRlKQ0KICBpZihmb3VuZCAmJiBjaGFuZ2VkKSB7DQogIAlzaXRzX2RvX3NldF92YWx1ZShvYmosY2xyKTsNCiAgfQ0KICByZXR1cm4gZm91bmQ7IC8vcmV0dXJuIHdoZXRoZXIgZmllbGQgZm91bmQNCn0NCg0KLy9JbnRlcm5hbCBmdW5jdGlvbiB0byBwZXJmb3JtIGNsZWFudXAgdGFza3MgZHVyaW5nIHNpdHNfc2V0X3ZhbHVlDQovLyBlbGVtZW50IG9iaiA6aW4gO3RoZSBlbGVtZW50IHdlJ3JlIHNldHRpbmcgdGhlIHZhbHVlIGluDQovLyBib29sZWFuIGNsciA6IGluIDtyZXNldCB0cmFuc2xhdGlvbi9lcnJvcg0KZnVuY3Rpb24gc2l0c19kb19zZXRfdmFsdWUob2JqLGNscikgew0KCWlmKCFjbHIpIHsNCgkJcmV0dXJuOyAvL2NsZWFyaW5nIGlzIGN1cnJlbnRseSB0aGUgb25seSBmdW5jdGlvbiwgc28gaWYgaXQncyBkaXNhYmxlZCB0aGVuIHdlIGRvbid0IGNvbnRpbnVlDQoJfQ0KCWlmKHR5cGVvZigkKSE9ImZ1bmN0aW9uIikgew0KCQlyZXR1cm47IC8vbm8galF1ZXJ5LCBzbyB3ZSBkb24ndCBjb250aW51ZQ0KCX0NCg0KCW9iaiA9ICQob2JqKTsNCg0KCS8vaWYgd2UncmUgdXNpbmcgZHluYW1pYyBsaXN0Ym94IG9yIHRyYW5zbGF0aW9uLCB0aGVuIHdlIG5lZWQgdG8gY2xlYXIgdGhlIHRyYW5zbGF0aW9uL2Vycm9yIGZpZWxkcyAoaWYgcHJlc2VudCkNCgl2YXIgcnNwID0gb2JqLmhhc0NsYXNzKCJzdi1mb3JtLWNvbnRyb2wiKTsNCglpZihyc3ApIHsgLy9yZXNwb25zaXZlIGxheW91dA0KCQlpZihvYmouaGFzQ2xhc3MoImRtdV9lbmFibGVkIil8fG9iai5oYXNDbGFzcygiaGFzVHJhbnNsYXRpb24iKSkgew0KCQkJLy9pZiB3ZSdyZSBpbiBhIHRhYmxlIHRoZW4gd2Ugc2hvdWxkbid0IGhhdmUgYSB0cmFuc2xhdGlvbiB0byB3b3JyeSBhYm91dCwgc28gd2UncmUgb25seSBpbnRlcmVzdGVkIHdoZW4gd2UncmUgaW4gYSBmb3JtIGdyb3VwDQoJCQl2YXIgZWxlID0gb2JqLmNsb3Nlc3QoIi5zdi1mb3JtLWdyb3VwLHRkIik7DQoJCQlpZihlbGUuaXMoIi5zdi1mb3JtLWdyb3VwIikpIHsgLy93ZSdyZSBub3QgaW4gYSB0YWJsZQ0KCQkJCS8vZW1wdHkgdGhlIHRyYW5zbGF0aW9uIGJsb2NrIChhc3N1bWluZyBzdGFuZGFyZCBzdHJ1Y3R1cmUpDQoJCQkJZWxlLmNoaWxkcmVuKCIuc3YtaGVscC1ibG9jayIpLmZpbmQoIi5zdi10cmFucy1ibG9jayIpLmh0bWwoIiIpOw0KDQoJCQkJLy9yZXNldCB0aGUgZXJyb3IgYmxvY2sgYW5kIHN0eWxpbmcNCgkJCQlzaXRzX2lubGluZV92YWxpZGF0aW9uX21lc3NhZ2UoMCwiIixvYmopOw0KCQkJfQ0KCQl9DQoJfQ0KCWVsc2V7IC8vbm90IHJlc3BvbnNpdmUNCgkJdmFyIGZsZElkID0gb2JqLmF0dHIoImlkIik7DQoNCgkJaWYodHlwZW9mKGZsZElkKSE9InVuZGVmaW5lZCImJmZsZElkIT0iIikgew0KCQkJaWYob2JqLmhhc0NsYXNzKCJkbXVfZW5hYmxlZCIpKSB7IC8vZHluYW1pYyBsaXN0Ym94DQoJCQkJaWYodHlwZW9mKGRtdV90cmFucykhPSJ1bmRlZmluZWQiICYmIHR5cGVvZihkbXVfdHJhbnNbZmxkSWRdKSE9InVuZGVmaW5lZCIpIHsNCgkJCQkJJCgiIyIrc2l0c19kb19nZXRfb2JqZWN0KGRtdV90cmFuc1tmbGRJZF0pKS5odG1sKCIiKTsgLy9lbXB0eSB0cmFuc2xhdGlvbg0KCQkJCX0NCgkJCX0NCgkJCWlmKG9iai5oYXNDbGFzcygiaGFzVHJhbnNsYXRpb24iKSkgeyAvL0FKQVggdHJhbnNsYXRlDQoJCQkJdmFyIHRyYW5zRmxkID0gJCgiIyIrc2l0c19kb19nZXRfb2JqZWN0KGZsZElkKyJ0cmFucyIpKTsNCgkJCQlpZih0cmFuc0ZsZC5sZW5ndGg+MCkgew0KCQkJCQl0cmFuc0ZsZC5odG1sKCIiKTsgLy9lbXB0eSB0cmFuc2xhdGlvbg0KDQoJCQkJCS8vcmVtb3ZlIGFueSBlcnJvciBzdHlsaW5nIGZyb20gZmllbGQgYW5kIHRyYW5zbGF0aW9uIHBhcmVudHMNCgkJCQkJdmFyIGVsZSA9IG9iai5wYXJlbnQoKTsNCgkJCQkJaWYoZWxlLmhhc0NsYXNzKCJkbXVfd3JhcHBlciIpKSB7DQoJCQkJCQllbGUgPSBlbGUucGFyZW50KCk7IC8vd2hlbiB1c2luZyBsaXN0Ym94IHRoZXJlIG1heSBiZSBhIHdyYXBwZXIgZGl2IGluIHBsYWNlIHRoYXQgd2UgaWdub3JlDQoJCQkJCX0NCgkJCQkJZWxlLnJlbW92ZUNsYXNzKCJ3eXNfZXJyb3IiKTsNCg0KCQkJCQl0cmFuc0ZsZC5wYXJlbnQoKS5yZW1vdmVDbGFzcygid3lzX2Vycm9yIik7DQoJCQkJfQ0KCQkJfQ0KCQl9DQoJfQ0KDQoJLy9pZiB0aGUgZmllbGQgY291bGQgYmUgcGFydCBvZiBhbiBBSkFYIFRyYW5zbGF0aW9uIHRoZW4gcmVzZXQgdGhlIGFzc29jaWF0ZWQgY2FjaGUNCglpZih0eXBlb2YoYVRWYWxzKSE9InVuZGVmaW5lZCImJm9iai5oYXNDbGFzcygiaGFzVHJhbnNsYXRpb24iKSkgew0KCQl2YXIgbmFtID0gb2JqLmF0dHIoIm5hbWUiKTsNCgkJaWYodHlwZW9mKG5hbSkhPSJ1bmRlZmluZWQiJiZuYW0hPSIiKSB7DQoJCQlkZWxldGUgYVRWYWxzW25hbV07IC8vcmVtb3ZlIHRoZSAicHJldmlvdXMgdmFsdWUiIHVzZWQgZm9yIGNvbXBhcmlzb24gdG8gc2VlIGlmIHRoZSB2YWx1ZSBjaGFuZ2VkDQoJCX0NCgl9DQp9DQoNCi8vR2V0IGFuIGludGVnZXIgdmFsdWUgZnJvbSBhIHNpemUgcHJvcGVydHkNCi8vIHN0cmluZyAgdmFsICA6IGluIDt0aGUgdmFsdWUgb2YgdGhlIHNpemUgcHJvcGVydHkNCmZ1bmN0aW9uIHNpdHNfZ2V0X2ludGVnZXIodmFsKSB7DQogIHN3aXRjaChzaXRzX3R5cGVfb2YodmFsKSkgew0KICAgIGNhc2UgIm51bWJlciI6DQogICAgICByZXR1cm4gcGFyc2VJbnQodmFsLDEwKTsgLy9yZXR1cm4gZGVjaW1hbCBpbnRlZ2VyDQogICAgY2FzZSAidW5kZWZpbmVkIjoNCiAgICBjYXNlICJudWxsIjoNCiAgICAgIHJldHVybiAwOw0KICAgIGRlZmF1bHQ6DQogICAgICB2YXIgc3RyID0gdmFsLnRvU3RyaW5nKCk7IC8vY29udmVydCB0byBhIHN0cmluZw0KICAgICAgc3RyID0gc3RyLnJlcGxhY2UoL3B4L2dpLCIiKTsgLy9yZW1vdmUgInB4Ig0KICAgICAgc3RyID0gc3RyLnJlcGxhY2UoL2VtL2dpLCIiKTsgLy9yZW1vdmUgImVtIg0KICAgICAgcmV0dXJuIHBhcnNlSW50KHN0ciwxMCk7IC8vcmV0dXJuIGRlY2ltYWwgaW50ZWdlcg0KICB9DQp9DQoNCi8vTG9nIGRlYnVnIG1lc3NhZ2VzIHRvIHRoZSBjb25zb2xlDQovLyBzdHJpbmcgIHN0ciAgOiBpbiA7dGhlIGRlYnVnIG1lc3NhZ2UgdG8gbG9nDQpmdW5jdGlvbiBzaXRzX3B1dG1lc3Moc3RyKSB7DQogIGlmKHN0cj09IiIpIHsgLy9jaGVjayBwYXJhbWV0ZXJzDQogICAgcmV0dXJuIGZhbHNlOw0KICB9DQogIGlmKHR5cGVvZih3aW5kb3cudW5pZmFjZVRyaWdnZXJzKT09ImZ1bmN0aW9uIikgeyAgLy9VbmlmYWNlDQogICAgd2luZG93LnVuaWZhY2VUcmlnZ2VycygiaHRtbDVfcHV0bWVzcyIsIlVOSUZBQ0U6ICIrc3RyKTsNCiAgfQ0KICBlbHNlIGlmKHdpbmRvdy5jb25zb2xlKSB7IC8vU2FmYXJpIGFuZCBGaXJlZm94IHdpdGggRmlyZWJ1Zw0KICAgIHdpbmRvdy5jb25zb2xlLmxvZyhzdHIpOw0KICB9DQogIGVsc2Ugew0KICAgIGlmKHdpbmRvdy5vcGVyYSkgeyAvL09wZXJhDQogICAgICB3aW5kb3cub3BlcmEucG9zdEVycm9yKHN0cik7DQogICAgfQ0KICAgIGVsc2UgeyAvL290aGVyIGJyb3dzZXJzDQogICAgICBpZihzaXRzX3Nob3dfYWxlcnRzKSB7DQogICAgICAgIHN0ciArPSAiXG5cbihDbGljayAnQ2FuY2VsJyB0byBzdXBwcmVzcyBkZWJ1ZyBhbGVydHMgb24gdGhpcyBwYWdlKSI7DQogICAgICAgIHNpdHNfc2hvd19hbGVydHMgPSBjb25maXJtKHN0cik7DQogICAgICB9DQogICAgfQ0KICB9DQogIHJldHVybiB0cnVlOw0KfQ0KDQovL1NlbmQgYSBxdWVyeSB0byB0aGUgc2VydmVyDQovLyBzdHJpbmcgIG1ldCAgOiBpbiA7dGhlIG1ldGhvZCgiUE9TVCIgb3IgIkdFVCIpDQovLyBzdHJpbmcgIG9wZSAgOiBpbiA7dGhlIGZvcm0gbmFtZSBhbmQgb3BlcmF0aW9uKGVnLiAic2l3X2RtdS5nZXQiKQ0KLy8gc3RyaW5nICBwYXIgIDogaW4gO3RoZSBwYXJhbWV0ZXJzIHRvIGJlIHNlbnQoZWcuICJmbGQxPXZhbDEmZmxkMj12YWwyIikNCi8vIGJvb2xlYW4gIGNhYyAgOiBpbiA7aW5kaWNhdGVzIHdoZXRoZXIgdGhlIHJlc3BvbnNlIHNob3VsZCBiZSBjYWNoZWQgb3Igbm90DQovLyBzdHJpbmcgICBmbmMgIDogaW4gO3RoZSBuYW1lIG9mIHRoZSBsb2NhbCByZXN1bHRzIGZ1bmN0aW9uKGRlZmF1bHQgaXMgImxvY2FsX3Byb2Nlc3NfcmVzdWx0cyIpDQpmdW5jdGlvbiBzaXRzX3NlbmRfcXVlcnkobWV0LG9wZSxwYXIsY2FjLGZuYykgew0KICBpZigobWV0IT0iR0VUIiAmJiBtZXQhPSJQT1NUIikgfHwgb3BlPT0iIiB8fCBwYXI9PSIiKSB7IC8vY2hlY2sgcGFyYW1ldGVycw0KICAgIHJldHVybiBmYWxzZTsNCiAgfQ0KICB2YXIgYXJyID0gbmV3IEFycmF5KDQpOyAvL3NldHVwIHF1ZXVlIGl0ZW0NCiAgYXJyWzBdID0gbWV0Ow0KICBhcnJbMV0gPSBvcGU7DQogIGFyclsyXSA9IHBhcjsNCiAgaWYoY2FjKSB7IC8vY2hlY2tlZCBjYWNoaW5nIG1vZGUNCiAgICBhcnJbM10gPSAiWSI7DQogIH0NCiAgZWxzZSB7DQogICAgYXJyWzNdID0gIk4iOw0KICB9DQogIGlmKHR5cGVvZihmbmMpPT0ic3RyaW5nIiAmJiBmbmMubGVuZ3RoPjApIHsgLy9jaGVjayBpZiBsb2NhbCBmdW5jdGlvbiBvdmVycmlkZGVuDQogICAgYXJyWzRdID0gZm5jOw0KICB9DQogIGVsc2Ugew0KICAgIGFycls0XSA9ICJsb2NhbF9wcm9jZXNzX3Jlc3VsdHMiOw0KICB9DQogIHNpdHNfcXVldWVfYXJyYXkucHVzaChhcnIpOyAvL2FkZCBpdGVtIHRvIHRoZSBxdWV1ZQ0KICBpZighc2l0c19xdWV1ZV9idXN5KSB7DQogICAgc2V0VGltZW91dCgic2l0c19kb19wcm9jZXNzX3F1ZXVlKCk7IiwxMCk7IC8vcHJvY2VzcyBxdWV1ZSBpZiBub3QgYWxyZWFkeSBwcm9jZXNzaW5nDQogICAgc2l0c19xdWV1ZV9idXN5ID0gdHJ1ZTsgLy9pbmRpY2F0ZSB0aGF0IHF1ZXVlIGlzIHByb2Nlc3NpbmcNCiAgfQ0KICByZXR1cm4gdHJ1ZTsNCn0NCg0KLy9JbnRlcm5hbCBmdW5jdGlvbiB0byBwcm9jZXNzIHRoZSBxdWV1ZQ0KZnVuY3Rpb24gc2l0c19kb19wcm9jZXNzX3F1ZXVlKCkgew0KICBzaXRzX3F1ZXVlX2Z1bmMgPSAiIjsgLy9jbGVhciB0aGUgbG9jYWwgZnVuY3Rpb24NCiAgc2l0c19jYWNoZV9xdWVyeSA9ICIiOyAvL2NsZWFyIHRoZSBjYWNoZSBxdWVyeQ0KICBpZihzaXRzX3F1ZXVlX2FycmF5Lmxlbmd0aD09MCkgeyAvL2NoZWNrIGlmIHRoZSBxdWV1ZSBpcyBlbXB0eQ0KICAgIHNpdHNfcXVldWVfYnVzeSA9IGZhbHNlOw0KICAgIHJldHVybjsNCiAgfQ0KICB2YXIgYXJyID0gc2l0c19xdWV1ZV9hcnJheVswXTsgLy9nZXQgdGhlIG5leHQgcXVlcnkgaXRlbQ0KICBzaXRzX3F1ZXVlX2FycmF5ID0gc2l0c19xdWV1ZV9hcnJheS5zbGljZSgxKTsgLy9yZW1vdmUgZnJvbSB0aGUgcXVldWUNCiAgdmFyIHN0ciA9IGFyci5zbGljZSgwLDMpLmpvaW4oIn4iKTsgLy9hZGQgbWV0aG9kLCBvcGVyYXRpb24gYW5kIHBhcmFtZXRlcnMgdG9nZXRoZXINCiAgaWYoYXJyWzNdPT0iWSIpIHsgLy9pZiB1c2luZyBjYWNoZS4uLg0KICAgIGlmKHNpdHNfY2FjaGVfYXJyYXlbc3RyXSkgeyAvL2NoZWNrIGZvciBjYWNoZWQgdmFsdWUNCiAgICAgIHZhciB0eHQgPSBzaXRzX2NhY2hlX2FycmF5W3N0cl07DQogICAgICBzaXRzX2V4ZWN1dGVfZnVuY3Rpb24oYXJyWzRdLHdpbmRvdyx0eHQpOyAvL3Byb2Nlc3MgdGhlIHJldHVybmVkIHJlc3VsdHMNCiAgICAgIHNldFRpbWVvdXQoInNpdHNfZG9fcHJvY2Vzc19xdWV1ZSgpOyIsMTApOyAvL2NvbnRpbnVlIHByb2Nlc3NpbmcgcXVldWUNCiAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCiAgICBzaXRzX2NhY2hlX3F1ZXJ5ID0gc3RyOyAvL3NldCB0aGUgY2FjaGUgcXVlcnkNCiAgfQ0KICBlbHNlIHsgLy8uLi5lbHNlIG5vdCB1c2luZyBjYWNoZQ0KICAgIGlmKHNpdHNfY2FjaGVfYXJyYXlbc3RyXSkgeyAvL2NoZWNrIGZvciBjYWNoZWQgdmFsdWUNCiAgICAgIGRlbGV0ZSBzaXRzX2NhY2hlX2FycmF5W3N0cl07IC8vZGVsZXRlIGNhY2hlZCB2YWx1ZSBpZiBpdCBleGlzdHMNCiAgICB9DQogIH0NCiAgc2l0c19xdWV1ZV9mdW5jID0gYXJyWzRdOyAvL3NldCB0aGUgbG9jYWwgZnVuY3Rpb24NCiAgdmFyIG9wdCA9IHt0eXBlOmFyclswXSx1cmw6YXJyWzFdLGRhdGE6YXJyWzJdLGRhdGFUeXBlOiJodG1sIixjb21wbGV0ZTpzaXRzX2RvX3Byb2Nlc3NfcmVzdWx0c307IC8vY3JlYXRlIGFqYXggb3B0aW9ucyBvYmplY3QNCiAgJC5hamF4KG9wdCk7IC8vc2VuZCBhamF4IHF1ZXJ5DQp9DQoNCi8vRnVuY3Rpb24gdG8gZXhlY3V0ZSBmdW5jdGlvbiBieSBuYW1lDQovLyBzdHJpbmcgIG5hbSAgOiBpbiA7bmFtZSBvZiB0aGUgZnVuY3Rpb24NCi8vIG9iamVjdCAgY29uICA6IGluIDtvcmlnaW5hbCBjb250ZXh0KGRlZmF1bHQgaXMgd2luZG93KQ0KLy8oYW55dGhpbmcgZWxzZSBwYXNzZWQgaW4gd2lsbCBiZSB1c2VkIGFzIHRoZSBhcmd1bWVudHMgZm9yIHRoZSBmdW5jdGlvbiBjYWxsZWQpDQpmdW5jdGlvbiBzaXRzX2V4ZWN1dGVfZnVuY3Rpb24obmFtLGNvbi8qLGFyZyovKSB7DQogIGlmKHR5cGVvZihuYW0pPT0ic3RyaW5nIikgeyAvL2NoZWNrIGZpcnN0IHBhcmFtZXRlcg0KICAgIGNvbiA9IGNvbiB8fCB3aW5kb3c7IC8vZGVmYXVsdCBjb250ZXh0IGlzIHdpbmRvdw0KICAgIHZhciBhcmcgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMik7IC8vZ2V0IGFyZ3VtZW50cw0KICAgIHZhciBuc3AgPSBuYW0uc3BsaXQoIi4iKTsgLy9zcGxpdCBuYW1lc3BhY2VzIGZyb20gZnVuY3Rpb24gbmFtZQ0KICAgIHZhciBmbmMgPSBuc3AucG9wKCk7IC8vZ2V0IHRoZSBmdW5jdGlvbiBuYW1lDQogICAgdmFyIGxlbiA9IG5zcC5sZW5ndGg7DQogICAgZm9yKHZhciBpPTA7aTxsZW47aSsrKSB7IC8vbG9vcCB0aHJvdWdoIG5hbWVzcGFjZXMNCiAgICAgIGNvbiA9IGNvbltuc3BbaV1dOyAvL3RyYXZlcnNlIG5hbWVzcGFjZQ0KICAgIH0NCiAgICByZXR1cm4gY29uW2ZuY10uYXBwbHkoY29uLGFyZyk7IC8vY2FsbCBmdW5jdGlvbiB3aXRoIGFyZ3VtZW50cyBhbmQgcmV0dXJuDQogIH0NCiAgcmV0dXJuIGZhbHNlOw0KfQ0KDQovL0ludGVybmFsIGZ1bmN0aW9uIHRvIHByb2Nlc3MgdGhlIHJlc3VsdHMgZnJvbSB0aGUgYWpheCBjYWxsDQovLyBvYmplY3QgIHhtbCAgOiBpbiA7dGhlIFhtbEh0dHBSZXF1ZXN0IG9iamVjdCBmcm9tIHRoZSBhamF4IGNhbGwNCi8vIHN0cmluZyAgc3RzICA6IGluIDt0aGUgc3RhdHVzIG9mIHRoZSByZXF1ZXN0DQpmdW5jdGlvbiBzaXRzX2RvX3Byb2Nlc3NfcmVzdWx0cyh4bWwsc3RzKSB7DQogIHZhciB0eHQgPSB4bWwucmVzcG9uc2VUZXh0OyAvL2dldCByZXNwb25zZSB0ZXh0DQogIGlmKHNpdHNfY2FjaGVfcXVlcnkhPSIiICYmIHR4dC5zdWJzdHIoMCw0KT09IjxPSz4iKSB7IC8vY2hlY2sgdmFsdWUgY2FuIGFuZCBzaG91bGQgYmUgY2FjaGVkDQogICAgc2l0c19jYWNoZV9hcnJheVtzaXRzX2NhY2hlX3F1ZXJ5XSA9IHR4dDsgLy9hZGQgdG8gY2FjaGUNCiAgfQ0KICBzaXRzX2V4ZWN1dGVfZnVuY3Rpb24oc2l0c19xdWV1ZV9mdW5jLHdpbmRvdyx0eHQpOyAvL3Byb2Nlc3MgdGhlIHJldHVybmVkIHJlc3VsdHMNCiAgc2V0VGltZW91dCgic2l0c19kb19wcm9jZXNzX3F1ZXVlKCk7IiwxMCk7IC8vY29udGludWUgcHJvY2Vzc2luZyBxdWV1ZQ0KfQ0KDQovL0dldCBhbiBvYmplY3Qgd2l0aCB0aGUgc3BlY2lmaWVkIElEDQovLyBzdHJpbmcgIGlkICA6IGluIDt0aGUgSUQgb2YgdGhlIG9iamVjdCB5b3Ugd2FudA0KLy8gc3RyaW5nIGF0dHIgOiBpbiA7dGhlIGF0dHJpYnV0ZSB0byB1c2UoZGVmYXVsdCBpcyAiaWQiKQ0KZnVuY3Rpb24gc2l0c19nZXRfb2JqZWN0KGlkLGF0dHIpIHsNCiAgaWYoaWQ9PSIiKSB7IC8vY2hlY2sgcGFyYW1ldGVycw0KICAgIHJldHVybiBudWxsOw0KICB9DQogIGlmKHR5cGVvZihhdHRyKT09InN0cmluZyIgJiYgYXR0ciE9IiIpIHsNCiAgICBhdHRyID0gYXR0ci50b0xvd2VyQ2FzZSgpOw0KICB9DQogIGVsc2Ugew0KICAgIGF0dHIgPSAiaWQiOyAvL2RlZmF1bHQgdG8gaWQNCiAgfQ0KICB2YXIgYXJyID0gbnVsbDsNCiAgc3dpdGNoKGF0dHIpIHsgLy9yZXR1cm4gb2JqZWN0IGJ5IGF0dHJpYnV0ZQ0KICAgIGNhc2UgImlkIjoNCiAgICAgIGlmKHR5cGVvZigkKSE9ImZ1bmN0aW9uIikgew0KICAgICAgICByZXR1cm4gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpOyAvL2pRdWVyeSBub3QgcXVpdGUgcmVhZHkNCiAgICAgIH0NCiAgICAgIGFyciA9ICQoIiMiK3NpdHNfZG9fZ2V0X29iamVjdChpZCkpOyAvL2VzY2FwZSBqUXVlcnkgc2VsZWN0b3INCiAgICAgIGlmKGFyci5sZW5ndGg9PTEpIHsNCiAgICAgICAgcmV0dXJuIGFyclswXTsgLy9yZXR1cm4gb2JqZWN0DQogICAgICB9DQogICAgICBicmVhazsNCiAgICBjYXNlICJuYW1lIjoNCiAgICAgIGlmKHR5cGVvZigkKSE9ImZ1bmN0aW9uIikgew0KICAgICAgICBhcnIgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5TmFtZShpZCk7IC8valF1ZXJ5IG5vdCBxdWl0ZSByZWFkeQ0KICAgICAgICBpZihhcnIubGVuZ3RoPT0xKSB7DQogICAgICAgICAgcmV0dXJuIGFyclswXTsgLy9yZXR1cm4gb2JqZWN0DQogICAgICAgIH0NCiAgICAgIH0NCiAgICAgIGFyciA9ICQoImlucHV0W25hbWU9IitzaXRzX2RvX2dldF9vYmplY3QoaWQpKyJdIik7IC8vZXNjYXBlIGpRdWVyeSBzZWxlY3Rvcg0KICAgICAgaWYoYXJyLmxlbmd0aD09MSkgew0KICAgICAgICByZXR1cm4gYXJyWzBdOyAvL3JldHVybiBvYmplY3QNCiAgICAgIH0NCiAgICAgIGJyZWFrOw0KICB9DQogIHJldHVybiBudWxsOw0KfQ0KDQovL0ludGVybmFsIGZ1bmN0aW9uIHRvIGVzY2FwZSBqUXVlcnkgc2VsZWN0b3IgY2hhcmFjdGVycw0KLy8gc3RyaW5nIGlkICA6IGluIDt0aGUgc2VsZWN0b3IgdG8gZXNjYXBlDQpmdW5jdGlvbiBzaXRzX2RvX2dldF9vYmplY3QoaWQpIHsNCiAgaWYodHlwZW9mKGlkKSE9InN0cmluZyIgfHwgaWQubGVuZ3RoPDEpIHsgLy9jaGVjayBzZWxlY3Rvcg0KICAgIHJldHVybiAiIjsNCiAgfQ0KICByZXR1cm4gaWQucmVwbGFjZSgvKFwjfFw7fFwmfFwsfFwufFwrfFx+fFwnfFw6fFwifFwhfFxefFwkfFxbfFxdfFwofFwpfFw9fFw+fFx8fFwvfFwgKS9nLCJcXCQxIik7IC8vcmV0dXJuIHNlbGVjdG9yDQp9DQoNCi8vRnVuY3Rpb24gdG8gZXNjYXBlIGpRdWVyeSBzZWxlY3RvciBjaGFyYWN0ZXJzDQovLyBzdHJpbmcgc2VsICA6IGluIDt0aGUgc2VsZWN0b3IgdG8gZXNjYXBlDQpmdW5jdGlvbiBzaXRzX2VzY2FwZV9zZWxlY3RvcihzZWwpIHsNCiAgcmV0dXJuIHNpdHNfZG9fZ2V0X29iamVjdChzZWwpOw0KfQ0KDQovL1JlcGxhY2UgYWxsIGluc3RhbmNlcyBvZiBhIHN0cmluZyB3aXRoaW4gYW5vdGhlcg0KLy8gc3RyaW5nICBvcmlnICA6IGluIDt0aGUgb3JpZ2luYWwgc3RyaW5nDQovLyBzdHJpbmcgIHN0ckEgIDogaW4gO3RoZSBzZWFyY2ggc3RyaW5nDQovLyBzdHJpbmcgIHN0ckIgIDogaW4gO3RoZSByZXBsYWNlIHN0cmluZw0KZnVuY3Rpb24gc2l0c19yZXBsYWNlX2FsbChvcmlnLHN0ckEsc3RyQikgew0KICBpZih0eXBlb2Yob3JpZykhPSJzdHJpbmciIHx8IG9yaWcubGVuZ3RoPDEpIHsgLy9jaGVjayBvcmlnaW5hbCBzdHJpbmcNCiAgICByZXR1cm4gIiI7DQogIH0NCiAgdmFyIGkgPSAwOyAvL2JyZWFrIGluZmluaXRlIGxvb3ANCiAgdmFyIHN0ciA9IG9yaWc7DQogIHdoaWxlKHN0ci5pbmRleE9mKHN0ckEpPj0wICYmIGk8MTAwMDApIHsgLy9zZWFyY2ggZm9yIHN0cmluZyBBLi4uDQogICAgc3RyID0gc3RyLnJlcGxhY2Uoc3RyQSxzdHJCKTsgLy8uLi5hbmQgcmVwbGFjZSB3aXRoIHN0cmluZyBCDQogICAgaSsrOw0KICB9DQogIGlmKGk9PTEwMDAwKSB7IC8vaWYgaW5maW5pdGUgbG9vcC4uLg0KICAgIHN0ciA9IG9yaWc7IC8vLi4ucmV0dXJuIG9yaWdpbmFsIHN0cmluZw0KICB9DQogIHJldHVybiBzdHI7IC8vcmV0dXJuIHN0cmluZw0KfQ0KDQovL09wZW4gYSBuZXcgZGlhbG9nIG1lc3NhZ2UNCi8vIHN0cmluZyAgdHRsICA6IGluIDt0aGUgZGlhbG9nIHRpdGxlDQovLyBzdHJpbmcgIGNvbiAgOiBpbiA7dGhlIGh0bWwgY29udGVudHMgb2YgdGhlIGRpYWxvZw0KLy8gb2JqZWN0ICBidG4gIDogaW4gO29iamVjdCBjb250YWluaW5nIGJ1dHRvbnMoZWcuIHsiT2siOmZ1bmN0aW9uKCkgeyQodGhpcykuZGlhbG9nKCJjbG9zZSIpO319KTsNCi8vIGJvb2xlYW4gIGRyZyAgOiBpbiA7aXMgdGhlIGRpYWxvZyBkcmFnZ2FibGU/KGRlZmF1bHQgaXMgdHJ1ZSkNCi8vIGJvb2xlYW4gIG1kbCAgOiBpbiA7aXMgdGhlIGRpYWxvZyBtb2RhbD8oZGVmYXVsdCBpcyBmYWxzZSkNCi8vIGJvb2xlYW4gIHJzeiAgOiBpbiA7aXMgdGhlIGRpYWxvZyByZXNpemFibGU/KGRlZmF1bHQgaXMgdHJ1ZSkNCi8vIG51bWVyaWMgIHpuZCAgOiBpbiA7dGhlIHotaW5kZXggb2YgdGhlIGRpYWxvZyAtIElHTk9SRUQhDQovLyBzdHJpbmcgIHRpZCAgOiBpbiA7dGhlIGluZGV4IG9mIHRoZSBkaXYoZGVmYXVsdCBpcyAic2l0c19kaWFsb2ciKQ0KLy8gYm9vbGVhbiAgb3BuIDogaW4gO3Nob3VsZCB0aGUgZGlhbG9nIG9wZW4gaW1tZWRpYXRlbHk/KGRlZmF1bHQgaXMgdHJ1ZSkNCi8vIG51bWVyaWMgIHdpZCA6IGluIDt0aGUgd2lkdGggb2YgZGlhbG9nIGFzIGEgcGVyY2VudGFnZSBvZiB0aGUgc2NyZWVuKGRlZmF1bHQgaXMgNjApDQovLyBudW1lcmljICBoZ3QgOiBpbiA7dGhlIG1pbmltdW0gaGVpZ2h0IG9mIHRoZSBkaWFsb2csIGluIHBpeGVscyhubyBkZWZhdWx0KQ0KZnVuY3Rpb24gc2l0c19kaWFsb2codHRsLGNvbixidG4sZHJnLG1kbCxyc3osem5kLHRpZCxvcG4sd2lkLGhndCkgew0KICBpZih0eXBlb2YodGlkKSE9InN0cmluZyIgfHwgdGlkLmxlbmd0aDwxKSB7DQogICAgdGlkID0gInNpdHNfZGlhbG9nIjsNCiAgfQ0KICB2YXIgZGl2ID0gc2l0c19nZXRfb2JqZWN0KHRpZCk7IC8vY2hlY2sgZm9yIGV4aXN0aW5nIGRpdg0KICBpZighZGl2KSB7DQogICAgZGl2ID0gJCgiPGRpdj4iKS5hcHBlbmRUbygiYm9keSIpLmF0dHIoImlkIix0aWQpWzBdOyAvL2NyZWF0ZSBuZXcgZGl2DQogIH0NCiAgJChkaXYpLmF0dHIoInRpdGxlIix0dGwpLmh0bWwoY29uKTsgLy9zZXQgdGl0bGUgYW5kIGNvbnRlbnRzDQogIHZhciBzaXpvYmogPSBzaXRzX2RvX2RpYWxvZ19zaXplKHdpZCk7IC8vY2FsY3VsYXRlIHdpZHRoDQogIHZhciBvcHQgPSB7fTsNCiAgb3B0LmF1dG9PcGVuID0gZmFsc2U7DQogIG9wdC5jbG9zZU9uRXNjYXBlID0gZmFsc2U7DQogIG9wdC53aWR0aCA9IHNpem9iai5jYWxjOyAvL2NhbGN1bGF0ZSB3aWR0aA0KICBpZihidG4pIHsNCiAgICBvcHQuYnV0dG9ucyA9IGJ0bjsgLy9hZGQgYnV0dG9ucyB0byBkaWFsb2cgKGRlZmF1bHQgaXMgbm9uZSkNCiAgfQ0KICBpZih0eXBlb2YoZHJnKT09ImJvb2xlYW4iKSB7DQogICAgb3B0LmRyYWdnYWJsZSA9IGRyZzsgLy9zZXQgZHJhZ2dhYmxlIChkZWZhdWx0IGlzIHRydWUpDQogIH0NCiAgaWYodHlwZW9mKG1kbCk9PSJib29sZWFuIikgew0KICAgIG9wdC5tb2RhbCA9IG1kbDsgLy9zZXQgbW9kYWxpdHkgKGRlZmF1bHQgaXMgZmFsc2UpDQogIH0NCiAgaWYodHlwZW9mKHJzeik9PSJib29sZWFuIikgew0KICAgIG9wdC5yZXNpemFibGUgPSByc3o7IC8vc2V0IHJlc2l6YWJsZSAoZGVmYXVsdCBpcyB0cnVlKQ0KICB9DQogIGlmKHR5cGVvZihoZ3QpPT0ibnVtYmVyIiAmJiBoZ3Q+MCkgew0KICAgIGlmKGhndD5zaXpvYmoubWF4aGd0KSB7DQogICAgICBoZ3QgPSBzaXpvYmoubWF4aGd0OyAvL21pbmltdW0gaGVpZ2h0IGNhbid0IGJlIGJpZ2dlciB0aGFuIG1heGltdW0gaGVpZ2h0DQogICAgfQ0KICAgIG9wdC5taW5IZWlnaHQgPSBoZ3Q7IC8vc2V0IG1pbmltdW0gaGVpZ2h0DQogIH0NCiAgdmFyIGRsZyA9ICQoIiMiK3RpZCk7DQogIGRsZy5kaWFsb2cob3B0KTsgLy9jcmVhdGUgZGlhbG9nIGJ1dCBkb24ndCBvcGVuIHlldA0KICBzaXRzX2hpZGUoIi51aS1kaWFsb2ctdGl0bGViYXItY2xvc2UiKTsgLy9oaWRlIGNsb3NlIGljb24NCiAgaWYodHlwZW9mKHJzeikhPSJib29sZWFuIiB8fCByc3opIHsNCiAgICBkbGcub24oImRpYWxvZ3Jlc2l6ZSIsZnVuY3Rpb24oZXZ0LHVpKSB7IC8vd2hlbiByZXNpemluZyBkaWFsb2cuLi4gKGRlZmF1bHQgaXMgdHJ1ZSkNCiAgICAgIHNpdHNfZGVib3VuY2VfZXZlbnQoc2l0c190YWJzX3Jlc2l6ZSwyNTApOyAvLy4uLnJlc2l6ZSB0YWJzIGluIGRpYWxvZw0KICAgIH0pOw0KICB9DQogIGlmKHR5cGVvZihvcG4pIT0iYm9vbGVhbiIgfHwgb3BuKSB7DQogICAgZGxnLmRpYWxvZygib3BlbiIpOyAvL29wZW4gdGhlIGRpYWxvZyBub3cgKGRlZmF1bHQgaXMgdHJ1ZSkNCiAgfQ0KICBzaXRzX2RvX2RpYWxvZ19oZWlnaHQoZGxnLHNpem9iai5tYXhoZ3QpOyAvL3NldCB0aGUgaGVpZ2h0IG9mIHRoZSBkaWFsb2cNCiAgZGxnLmRpYWxvZygib3B0aW9uIiwicG9zaXRpb24iLHsibXkiOiJjZW50ZXIiLCJhdCI6ImNlbnRlciIsIm9mIjp3aW5kb3csImNvbGxpc2lvbiI6ImZpdCJ9KTsgLy9yZS1jZW50cmUgdGhlIGRpYWxvZw0KICBkbGcuZGF0YSgic3YtZGlhbG9nLXdpZHRoIixzaXpvYmoub3JpZyk7IC8vdHJhY2sgdGhlIG9yaWdpbmFsIGRpYWxvZyB3aWR0aCBmb3IgdXNlIGluIGF1dG8gcmUtc2l6aW5nDQogIHJldHVybiB0cnVlOw0KfQ0KDQovL1VwZGF0ZXMgdGhlIGNvbnRlbnRzIG9mIHRoZSBkaWFsb2cgbWVzc2FnZQ0KLy8gc3RyaW5nICBjb24gIDogaW4gO3RoZSBodG1sIGNvbnRlbnRzIG9mIHRoZSBkaWFsb2coZmFsc2UgdG8gbGVhdmUgYXMgaXMpDQovLyBvYmplY3QgIGJ0biAgOiBpbiA7b2JqZWN0IGNvbnRhaW5pbmcgYnV0dG9ucyhlZy4geyJPayI6ZnVuY3Rpb24oKSB7JCh0aGlzKS5kaWFsb2coImNsb3NlIik7fX0pKGZhbHNlIHRvIGxlYXZlIGFzIGlzKTsNCi8vIHN0cmluZyAgdGlkICA6IGluIDt0aGUgaW5kZXggb2YgdGhlIGRpdihkZWZhdWx0IGlzICJzaXRzX2RpYWxvZyIpDQpmdW5jdGlvbiBzaXRzX2RpYWxvZ191cGRhdGUoY29uLGJ0bix0aWQpIHsNCiAgaWYodHlwZW9mKHRpZCkhPSJzdHJpbmciIHx8IHRpZC5sZW5ndGg8MSkgew0KICAgIHRpZCA9ICJzaXRzX2RpYWxvZyI7DQogIH0NCiAgdmFyIGRsZyA9ICQoIiMiK3RpZCk7IC8vZ2V0IGRpYWxvZyBvYmplY3QNCiAgaWYoZGxnLmhhc0NsYXNzKCJ1aS1kaWFsb2ctY29udGVudCIpKSB7DQogICAgaWYodHlwZW9mKGNvbikhPSJib29sZWFuIikgew0KICAgICAgZGxnLmh0bWwoY29uKTsgLy9zZXQgdGhlIGNvbnRlbnRzDQogICAgfQ0KICAgIGlmKHR5cGVvZihidG4pPT0ib2JqZWN0Iikgew0KICAgICAgZGxnLmRpYWxvZygib3B0aW9uIiwiYnV0dG9ucyIsYnRuKTsgLy9hZGQgYnV0dG9ucyB0byBkaWFsb2coZGVmYXVsdCBpcyBub25lKQ0KICAgIH0NCiAgICBpZighZGxnLmRpYWxvZygiaXNPcGVuIikpIHsgLy9vcGVuIHRoZSBkaWFsb2cgaWYgaXQgaXNuJ3QgYWxyZWFkeQ0KICAgIAlkbGcuZGlhbG9nKCJvcGVuIik7DQogICAgICAkKCJ1bC51aS10YWJzLW5hdiIpLmNoaWxkcmVuKCJsaSIpLmNzcygibGlzdC1zdHlsZSIsIm5vbmUiKTsgLy9maXggSUUgYnVnDQogICAgfQ0KICAgIHZhciBzaXpvYmogPSBzaXRzX2RvX2RpYWxvZ19zaXplKCIiKTsgLy9jYWxjdWxhdGUgd2lkdGgNCiAgCXNpdHNfZG9fZGlhbG9nX2hlaWdodChkbGcsc2l6b2JqLm1heGhndCk7IC8vc2V0IHRoZSBoZWlnaHQgb2YgdGhlIGRpYWxvZw0KICAgIHJldHVybiB0cnVlOw0KICB9DQogIHJldHVybiBmYWxzZTsNCn0NCg0KLy9DbG9zZXMgdGhlIGRpYWxvZyBtZXNzYWdlIGFuZCBvcHRpb25hbGx5IGRlc3Ryb3lzIGl0DQovLyBib29sZWFuICBkc3QgIDogaW4gO2Rlc3Ryb3kgdGhlIGRpYWxvZz8oZGVmYXVsdCBpcyB0cnVlKQ0KLy8gc3RyaW5nICB0aWQgIDogaW4gO3RoZSBpbmRleCBvZiB0aGUgZGl2KGRlZmF1bHQgaXMgInNpdHNfZGlhbG9nIikNCmZ1bmN0aW9uIHNpdHNfZGlhbG9nX2Nsb3NlKGRzdCx0aWQpIHsNCiAgaWYodHlwZW9mKHRpZCkhPSJzdHJpbmciIHx8IHRpZC5sZW5ndGg8MSkgew0KICAgIHRpZCA9ICJzaXRzX2RpYWxvZyI7DQogIH0NCiAgdmFyIGRsZyA9ICQoIiMiK3RpZCk7IC8vZ2V0IGRpYWxvZyBvYmplY3QNCiAgaWYoZGxnLmhhc0NsYXNzKCJ1aS1kaWFsb2ctY29udGVudCIpKSB7DQogICAgZGxnLmRpYWxvZygiY2xvc2UiKTsgLy9jbG9zZSB0aGUgZGlhbG9nDQogICAgaWYoZHN0IHx8IHR5cGVvZihkc3QpPT0idW5kZWZpbmVkIikgew0KICAgICAgZGxnLmRpYWxvZygiZGVzdHJveSIpLmVtcHR5KCk7IC8vZGVzdHJveSB0aGUgZGlhbG9nDQogICAgfQ0KICAgIHJldHVybiB0cnVlOw0KICB9DQogIHJldHVybiBmYWxzZTsNCn0NCg0KLy9SZXNpemVzIHRoZSBkaWFsb2cgbWVzc2FnZSBhbmQgYWxzbyByZS1wb3NpdGlvbnMgaXQNCi8vIG51bWVyaWMgIHdpZCA6IGluIDt0aGUgd2lkdGggb2YgZGlhbG9nIGFzIGEgcGVyY2VudGFnZSBvZiB0aGUgc2NyZWVuKGRlZmF1bHQgaXMgNjApDQovLyBzdHJpbmcgIHRpZCAgOiBpbiA7dGhlIGluZGV4IG9mIHRoZSBkaXYoZGVmYXVsdCBpcyAic2l0c19kaWFsb2ciKQ0KZnVuY3Rpb24gc2l0c19kaWFsb2dfcmVzaXplKHdpZCx0aWQpIHsNCiAgaWYodHlwZW9mKHRpZCkhPSJzdHJpbmciIHx8IHRpZC5sZW5ndGg8MSkgew0KICAgIHRpZCA9ICJzaXRzX2RpYWxvZyI7DQogIH0NCiAgdmFyIGRsZyA9ICQoIiMiK3RpZCk7IC8vZ2V0IGRpYWxvZyBvYmplY3QNCiAgaWYoZGxnLmhhc0NsYXNzKCJ1aS1kaWFsb2ctY29udGVudCIpKSB7DQogIAl2YXIgc2l6b2JqID0gc2l0c19kb19kaWFsb2dfc2l6ZSh3aWQpOw0KCQlpZih3aWQhPT0iIikgeyAvLyIiIG1lYW5zIHdlIGp1c3QgY2VudHJlIHVzaW5nIHRoZSBjdXJyZW50IHNpemUNCiAgICAJZGxnLmRpYWxvZygib3B0aW9uIiwid2lkdGgiLHNpem9iai5jYWxjKTsgLy9hZGp1c3Qgd2lkdGggb2YgZGlhbG9nDQogICAgCWRsZy5kYXRhKCJzdi1kaWFsb2ctd2lkdGgiLHNpem9iai5vcmlnKTsgLy90cmFjayB0aGUgb3JpZ2luYWwgZGlhbG9nIHdpZHRoIGZvciB1c2UgaW4gYXV0byByZS1zaXppbmcNCiAgIAl9DQogIAlzaXRzX2RvX2RpYWxvZ19oZWlnaHQoZGxnLHNpem9iai5tYXhoZ3QpOyAvL3NldCB0aGUgaGVpZ2h0IG9mIHRoZSBkaWFsb2cNCiAgICBkbGcuZGlhbG9nKCJvcHRpb24iLCJwb3NpdGlvbiIseyJteSI6ImNlbnRlciIsImF0IjoiY2VudGVyIiwib2YiOndpbmRvdywiY29sbGlzaW9uIjoiZml0In0pOyAvL3JlLWNlbnRyZSB0aGUgZGlhbG9nDQogICAgcmV0dXJuIHRydWU7DQogIH0NCiAgcmV0dXJuIGZhbHNlOw0KfQ0KDQovL0ludGVybmFsIGZ1bmN0aW9uIHVzZWQgYnkgc2l0c19kaWFsb2cgYW5kIHNpdHNfZGlhbG9nX3Jlc2l6ZSB0byBkZXRlcm1pbmUgdGhlIHNjcmVlbiB3aWR0aCBhbmQgbWF4aGVpZ2h0IHRvIHVzZSh2YXJpZXMgZnJvbSBicmVha3BvaW50IHRvIGJyZWFrcG9pbnQpDQovLyBudW1lcmljIHdpZCA6aW47dGhlIHdpZHRoIG9mIGRpYWxvZyBhcyBhIHBlcmNlbnRhZ2Ugb2YgdGhlIHNjcmVlbihkZWZhdWx0IGlzIDYwKQ0KLy8gb2JqZWN0IG9iaiA6b3V0O29iamVjdCBjb250YWluaW5nICJvcmlnIiBpdGVtKHRoZSBvcmlnaW5hbCB3aWR0aCBhcyBhIHJhdGlvIG9mIHNjcmVlbnNpemUpLCAiY2FsYyIodGhlIGNhbGN1bGF0ZWQgcGl4ZWwgd2lkdGgpIGFuZCAibWF4aGd0Iih0aGUgY2FsY3VsYXRlZCBtYXggaGVpZ2h0KQ0KZnVuY3Rpb24gc2l0c19kb19kaWFsb2dfc2l6ZSh3aWQpIHsNCgl2YXIgc2l6ID0gc2l0c193aW5kb3dfc2l6ZSgpOyAvL3ggYW5kIHkgc2l6ZXMgZm9yIHdpZHRoIGFuZCBoZWlnaHQNCgl2YXIgeHNpeiA9IHNpei54OyAvL2N1cnJlbnQgc2NyZWVuIHdpZHRoDQoJdmFyIHlzaXogPSBzaXoueTsgLy9jdXJyZW50IHNjcmVlbiBoZWlnaHQNCg0KICBpZih0eXBlb2Yod2lkKSE9PSJudW1iZXIiIHx8IHdpZDw9MCkgeyAvL2NoZWNrIHdpZHRoIHBlcmNlbnRhZ2UNCiAgICB3aWQgPSAwLjY7IC8vNjAlDQogIH0NCiAgZWxzZSBpZih3aWQ+MSYmd2lkPD0xMDApIHsNCiAgICB3aWQgPSB3aWQvMTAwOyAvL2NvbnZlcnQgcGVyY2VudGFnZSBpbnRvIGRlY2ltYWwNCiAgfQ0KICBlbHNlIGlmKHdpZD4xMDApIHsNCiAgCXdpZCA9IHdpZC94c2l6OyAvL2NvbnZlcnQgZml4ZWQgd2lkdGggaW4gdG8gcGVyY2VudGFnZSBvZiBzY3JlZW4gd2lkdGgNCiAgfQ0KCWlmKHdpZD4xKSB7DQoJCXdpZCA9IDE7IC8vd2lkdGggc2hvdWxkbid0IGJlIGdyZWF0ZXIgdGhhbiB0aGUgYXZhaWxhYmxlIHNjcmVlbiB3aWR0aA0KCX0NCg0KCXZhciBuZXd3aWQgPSB3aWQsIGZhY3Q7DQoNCgkvL2RldGVybWluZSB3aGljaCBicmVha3BvaW50IHdlJ3JlIGN1cnJlbnRseSBpbg0KCXZhciBicCA9IHNpdHNfZ2V0X2JyZWFrcG9pbnQoKTsNCg0KICAvL2lmIHNjYWxpbmcgZmFjdG9ycyBhdmFpbGFibGUgdGhlbiB1c2UgdGhlbQ0KICBpZih0eXBlb2Yoc2l0c19kaWFsb2dfc2NhbGluZyk9PT0ib2JqZWN0Iikgew0KCQlpZih0eXBlb2YoYnApPT09InN0cmluZyIpIHsNCgkJCS8vbG9vayB1cCB0aGUgc2NhbGluZyBmYWN0b3IgZm9yIHRoaXMgYnJlYWtwb2ludCBhbmQgdXNlIGl0IHRvIHVwZGF0ZSB0aGUgd2lkdGgNCgkJCWZhY3QgPSBzaXRzX2RpYWxvZ19zY2FsaW5nW2JwXTsNCgkJCWlmKHR5cGVvZihmYWN0KT09PSJudW1iZXIiKSB7DQoJCQkJbmV3d2lkID0gbmV3d2lkICogZmFjdDsNCgkJCX0NCgkJfQ0KCX0NCg0KCWlmKG5ld3dpZD4xKSB7DQoJCW5ld3dpZCA9IDE7IC8vZmFjdG9yIHB1c2hlZCB1cyBvdmVyIHRoZSBhdmFpbGFibGUgc2NyZWVuIHdpZHRoLCBzbyByZXNldCBpdA0KCX0NCgluZXd3aWQgPSBzaXRzX2dldF9pbnRlZ2VyKG5ld3dpZCp4c2l6KTsNCg0KCXZhciBtYXhoZ3QgPSAwLjk1OyAvL2Fzc3VtZSBhIG1heCBoZWlnaHQgb2YgOTUlIG9mIHNjcmVlbiBoZWlnaHQNCg0KCS8vaWYgbWF4aW11bSBoZWlnaHQgcmF0aW9zIGF2YWlsYWJsZSB0aGVuIHVzZSB0aGVtDQoJaWYodHlwZW9mKHNpdHNfZGlhbG9nX2hlaWdodCk9PT0ib2JqZWN0Iikgew0KCQlpZih0eXBlb2YoYnApPT09InN0cmluZyIpIHsNCgkJCXZhciByYXRpbyA9IHNpdHNfZGlhbG9nX2hlaWdodFticF07DQoJCQlpZih0eXBlb2YocmF0aW8pPT09Im51bWJlciJ8fHJhdGlvPT09IiIpIHsgLy8iIiBtZWFucyBubyBtYXggaGVpZ2h0IHJhdGlvDQoJCQkJbWF4aGd0ID0gcmF0aW87DQoJCQl9DQoJCX0NCgl9DQoNCgkvL2NvbnZlcnQgcmF0aW8gaW4gdG8gYWN0dWFsIGhlaWdodA0KCWlmKG1heGhndCE9PSIiKSB7DQoJCW1heGhndCA9IHNpdHNfZ2V0X2ludGVnZXIobWF4aGd0KnlzaXopOw0KCX0NCg0KCXZhciBvYmogPSB7fTsNCglvYmoub3JpZyA9IHdpZDsgLy9vcmlnaW5hbCB3aWR0aCBhcyByYXRpbyBvZiBzY3JlZW5zaXplDQoJb2JqLmZhY3QgPSBmYWN0OyAvL2ZhY3RvciBmb3IgdGhlIGN1cnJlbnQgYnJlYWtwb2ludA0KCW9iai5jYWxjID0gbmV3d2lkOyAvL3RoZSBjYWxjdWxhdGVkIHBpeGVsIHdpZHRoDQoJb2JqLm1heGhndCA9IG1heGhndDsgLy90aGUgbWF4aW11bSBoZWlnaHQNCglyZXR1cm4gb2JqOw0KfQ0KDQovL0ludGVybmFsIGZ1bmN0aW9uIHRvIGNhbGN1bGF0ZSBhbmQgc2V0IHRoZSBoZWlnaHQgb2YgYSBkaWFsb2cgYXMgYSBwZXJjZW50YWdlIG9mIHNjcmVlbiBoZWlnaHQNCi8vIG9iamVjdCBkbGcgOmluO2pRdWVyeSBkaWFsb2cgb2JqZWN0DQovLyBudW1lcmljIG1heGhndCA6aW47bWF4aW11bSBoZWlnaHQgb2YgdGhlIGRpYWxvZyh3aWxsIGJlIHNldCBvbmx5IGlmIHRoZSBjb250ZW50IGlzIGxhcmdlciB0aGFuIHRoaXMgY3VycmVudGx5KQ0KZnVuY3Rpb24gc2l0c19kb19kaWFsb2dfaGVpZ2h0KGRsZyxtYXhoZ3QpIHsNCglpZih0eXBlb2YoZGxnKSE9PSJvYmplY3QifHx0eXBlb2YobWF4aGd0KSE9Im51bWJlciIpIHsgLy9pZiBubyBkaWFsb2cgb3IgaGVpZ2h0IHBhc3NlZCBpbiB0aGVuIHdlIHVzZSBhdXRvbWF0aWMgY2FsY3VsYXRpb24NCgkJZGxnLmhlaWdodCgiIik7DQoJCXJldHVybjsNCgl9DQogIHZhciBvdXQgPSBkbGcuY2xvc2VzdCgiLnVpLWRpYWxvZyIpLmhlaWdodCgpOyAvL2NhbGN1bGF0ZSBvdXRlciBoZWlnaHQgb2YgdGhlIGRpYWxvZw0KICBpZihvdXQ+bWF4aGd0KSB7DQogICAgdmFyIGlubiA9IG1heGhndCtkbGcuaGVpZ2h0KCktb3V0Ow0KICAgIGRsZy5oZWlnaHQoaW5uKTsgLy9yZXNpemUgZGlhbG9nIHRvIGZpdCBvbiB0aGUgc2NyZWVuDQogIH0NCn0NCg0KLy9EZXRlcm1pbmVzIHdoaWNoIGJyZWFrcG9pbnQgdGhlIGN1cnJlbnQgc2NyZWVuLXNpemUgZmFsbHMgd2l0aGluKHJldHVybnMgbGcsIG1kLCBzbSBvciB4cykNCi8vIHN0cmluZyBicmVha3BvaW50IDpvdXQ7dGhlIGJyZWFrcG9pbnQgZm9yIHRoZSBjdXJyZW50IHNjcmVlbg0KZnVuY3Rpb24gc2l0c19nZXRfYnJlYWtwb2ludCgpIHsNCglyZXR1cm4gc2l0c19kb19nZXRfYnJlYWtwb2ludCgic2l0c19icF9lbGVtZW50IiwiIik7DQp9DQoNCi8vSW50ZXJuYWwgZnVuY3Rpb24gdG8gZGV0ZXJtaW5lIHRoZSBjdXJyZW50IGJyZWFrcG9pbnQgLSB1c2VzIGtub3duIGR1bW15IGVsZW1lbnRzIHRvIHdvcmsgb3V0IHdoaWNoIG9uZXMgYXJlIGhpZGRlbg0KZnVuY3Rpb24gc2l0c19kb19nZXRfYnJlYWtwb2ludChjb24sY2xhKSB7DQoJdmFyIGJwID0gWyJ4cyIsInNtIiwibWQiXTsgLy9saXN0IG9mIHBvc3NpYmxlIGJyZWFrcG9pbnRzKGFwYXJ0IGZyb20gdGhlIGxhcmdlc3Qgd2hpY2ggaXMgYXNzdW1lZCBpZiBubyBvdGhlcnMgYXJlIGhpZGRlbikNCg0KCS8vZ2V0IHRoZSBjb250YWluZXIgZWxlbWVudCBhcyB3ZSBuZWVkIHRvIHVuaGlkZSB0aGF0IGZpcnN0DQoJdmFyIGNvbmVsZSA9ICQoIiMiK2Nvbik7DQoJaWYoY29uZWxlLmxlbmd0aD09PTApIHsNCgkJLy9hZGQgdGhlIGNvbnRhaW5lciBlbGVtZW50IGZvciBsYXRlcg0KCQljb25lbGUgPSAkKCI8c3BhbiBpZD1cIiIrY29uKyJcIiBjbGFzcz1cIiIrY2xhKyJcIj48L3NwYW4+Iik7DQoNCgkJLy9pbmNsdWRlIGl0IGluIHRoZSBkb2N1bWVudA0KCQkkKCJib2R5IikuYXBwZW5kKGNvbmVsZSk7DQoJfQ0KCWVsc2Ugew0KICAgIHNpdHNfc2hvdyhjb25lbGUpOw0KCX0NCg0KCXZhciBlbGUsIGNvbmVsZTsNCglmb3IodmFyIGk9MDtpPGJwLmxlbmd0aDtpKyspIHsNCgkJLy9maW5kIHRoZSBlbGVtZW50DQoJCWVsZSA9ICQoIiMiK2NvbisiXyIrYnBbaV0pOw0KDQoJCWlmKGVsZS5sZW5ndGg9PT0wKSB7IC8vaWYgdGhlIGVsZW1lbnQgaXMgbWlzc2luZyB0aGVuIHdlIG5lZWQgdG8gYWRkIGl0DQoJCQkvL2NyZWF0ZSB0aGUgZWxlbWVudCB3ZSBjaGVjayh3ZSBuZWVkIGNvbnRlbnQgaW4gaXQgb3Igc29tZSBicm93c2VycyBjb25zaWRlciBpdCB0byBiZSBoaWRkZW4gc3RpbGwpDQoJCQllbGUgPSAkKCI8c3BhbiBpZD1cIiIrY29uKyJfIiticFtpXSsiXCIgY2xhc3M9XCJzdi1oaWRkZW4tIiticFtpXSsiXCI+JiMxNjA7PC9zcGFuPiIpOw0KDQoJCQkvL2FkZCBpdCB0byB0aGUgY29udGFpbmVyDQoJCQljb25lbGUuYXBwZW5kKGVsZSk7DQoJCX0NCg0KCQkvL2lzIHRoZSBlbGVtZW50IGhpZGRlbiAtIGlmIHNvIHRoZW4gd2UgYXNzdW1lIHdlJ3JlIGluIHRoYXQgYnJlYWtwb2ludChhcyB0aGUgY2xhc3NlcyBhc3NvY2lhdGVkIHdpdGggZWFjaCBhcmUgb25seSBoaWRkZW4gaW4gdGhhdCBicmVha3BvaW50KQ0KCQlpZihlbGUuaXMoIjpoaWRkZW4iKSkgew0KICAgICAgc2l0c19oaWRlKGNvbmVsZSk7IC8vaGlkZSBjb250YWluZXIgc28gaXQgZG9lc24ndCBhZmZlY3QgZGlzcGxheQ0KCQkJcmV0dXJuIGJwW2ldOw0KCQl9DQoJfQ0KICBzaXRzX2hpZGUoY29uZWxlKTsgLy9oaWRlIGNvbnRhaW5lciBzbyBpdCBkb2Vzbid0IGFmZmVjdCB0aGUgZGlzcGxheQ0KDQoJLy9pZiB3ZSBtYWRlIGl0IHRoaXMgZmFyIHRoZW4gd2UgYXNzdW1lIGl0J3MgdGhlIGxhcmdlc3QgYnJlYWtwb2ludA0KCXJldHVybiAibGciOw0KfQ0KDQovL0ludGVybmFsIGZ1bmN0aW9uIHRvIGRldGVybWluZSBhIHBvcnRhbCBicmVha3BvaW50IG11bHRpcGxpZXIgYW5kIHJldHVybiB0aGUgYXNzb2NpYXRlZCBicmVha3BvaW50KGZvciB1c2Ugd2hlbiB5b3UgaGF2ZSBhbiBlbGVtZW50IHdpdGhpbiBhIHNjcmVlbiBpbiBwb3J0YWwgY29udGVudCBtb2RlKS4gUmV0dXJucyBsZywgbWQsIHNtIG9yIHhzDQovLyBzdHJpbmcgZWxlIDppbjt0aGUgZWxlbWVudCB0byB1c2UgYXMgdGhlIGJhc2lzIGZvciB0aGUgY2hlY2sNCi8vIHN0cmluZyBicmVha3BvaW50IDpvdXQ7IHRoZSBicmVha3BvaW50IGZvciB0aGUgZWxlbWVudCBhbmQgY29udGFpbmVyDQpmdW5jdGlvbiBzaXRzX2RvX2dldF9wb3J0YWxfYnJlYWtwb2ludChzZWwpIHsNCgkvL3RoZSBwb3J0YWwgbXVsdGlwbGllciBpcyBhc3NvY2lhdGVkIHdpdGggdGhlIGNvbnRhaW5lciwgc28gbG9vayBmb3IgdGhlIHJlbGV2YW50IHBhcmVudCBlbGVtZW50KGlmIG9uZSBleGlzdHMgLSBpZiBub3QgdGhlbiB0aGVyZSBpcyBubyBtdWx0aXBsaWVyKQ0KCXZhciBtdWx0aXBsaWVyID0gJChzZWwpLnBhcmVudHMoIltkYXRhLXN2LXBvcnRhbC1tdWx0aXBsaWVyXSIpLmF0dHIoImRhdGEtc3YtcG9ydGFsLW11bHRpcGxpZXIiKTsNCgltdWx0aXBsaWVyID0oaXNOYU4obXVsdGlwbGllcikpPyAxIDogcGFyc2VJbnQobXVsdGlwbGllciwxMCk7DQoNCgkvL2lmIHdlJ3ZlIGZvdW5kIGEgbXVsdGlwbGllciB0aGVuIHVzZSBpdA0KCWlmKHR5cGVvZihtdWx0aXBsaWVyKT09PSJudW1iZXIiJiZtdWx0aXBsaWVyPjEpIHsNCgkJcmV0dXJuIHNpdHNfZG9fZ2V0X2JyZWFrcG9pbnQoInNpdHNfYnBfZWxlbWVudCIrbXVsdGlwbGllciwic3YtcG9ydGFsLSIrbXVsdGlwbGllcisiLWNvbCIpOw0KCX0NCg0KCS8vaWYgbm8gbXVsdGlwbGllciB0aGVuIHJldHVybiB0aGUgc3RhbmRhcmQgYnJlYWtwb2ludA0KCXJldHVybiBzaXRzX2RvX2dldF9icmVha3BvaW50KCJzaXRzX2JwX2VsZW1lbnQiLCIiKTsNCn0NCg0KLy9HZXQgdGhlIHRhcmdldCBvYmplY3Qgb2Ygc3BlY2lmaWVkIHRoZSBldmVudA0KLy8gZXZlbnQgIGUgIDogaW4gO3RoZSBldmVudCBvYmplY3QNCmZ1bmN0aW9uIHNpdHNfZ2V0X3RhcmdldChlKSB7DQogIGUgPSBlIHx8IHdpbmRvdy5ldmVudDsNCiAgdmFyIHQgPSBlLnRhcmdldCB8fCBlLnNyY0VsZW1lbnQ7IC8vZ2V0IHRhcmdldCBkZXBlbmRpbmcgb24gYnJvd3Nlcg0KICBpZih0Lm5vZGVUeXBlPT0zKSB7DQogICAgdCA9IHQucGFyZW50Tm9kZTsgLy9maXggZm9yIFNhZmFyaSB3aGljaCByZXR1cm5zIHRleHQgbm9kZQ0KICB9DQogIHJldHVybiB0OyAvL3JldHVybiB0YXJnZXQgb2JqZWN0DQp9DQoNCi8vQ2hlY2sgaWYgdGhlIG1vdXNlIGlzIHdpdGhpbiB0aGUgYm91bmRzIG9mIGFuIGVsZW1lbnQNCi8vIG9iamVjdCAgbSAgOiBpbiA7dGhlIGNvb3JkaW5hdGVzIG9mIHRoZSBtb3VzZSB7eCx5fQ0KLy8gZWxlbWVudCAgZCAgOiBpbiA7dGhlIGVsZW1lbnQgdG8gY2hlY2sNCmZ1bmN0aW9uIHNpdHNfbW91c2VfaXNpbihtLGQpIHsNCiAgdmFyIG4gPSBzaXRzX29iamVjdF9vZmZzZXQoZCk7IC8vZ2V0IG5vcnRoLXdlc3QgY29ybmVyIG9mIG9iamVjdA0KICBpZihtLng+PW4ueCAmJiBtLnk+PW4ueSkgew0KICAgIHZhciBvID0gc2l0c19vYmplY3Rfc2l6ZShkKTsgLy9nZXQgb2JqZWN0IGRpbWVuc2lvbnMNCiAgICBuLnggPSBvLngrbi54OyAvL2NhbGN1bGF0ZSBzb3V0aC1lYXN0IGNvcm5lciBvZiBvYmplY3QNCiAgICBuLnkgPSBvLnkrbi55Ow0KICAgIGlmKG0ueDxuLnggJiYgbS55PG4ueSkgeyAvL2NoZWNrIGlmIG1vdXNlIGlzIGJldHdlZW4gTlcgYW5kIFNFIGNvcm5lcnMNCiAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCiAgfQ0KICByZXR1cm4gZmFsc2U7DQp9DQoNCi8vR2V0IGEgc3BlY2lmaWMgYm9pbGVycGxhdGUgdGV4dA0KLy8gYXJyYXkgIGFyciAgOiBpbiA7dGhlIGFycmF5IG9mIGJvaWxlcnBsYXRlKGJ1aWx0IHVzaW5nIElOQ19BSkFYOmdldF9icF9hcnJheSkNCi8vIG51bWVyaWMgIG51bSAgOiBpbiA7dGhlIG51bWJlciBvZiB0aGUgYm9pbGVycGxhdGUgZmllbGQNCmZ1bmN0aW9uIHNpdHNfZ2V0X2JwdGV4dChhcnIsbnVtKSB7DQogIHZhciBzdHIgPSAiIjsNCiAgaWYobnVtPjAgJiYgbnVtPD1hcnIubGVuZ3RoKSB7DQogICAgc3RyID0gYXJyW251bS0xXTsgLy9nZXQgc3RyaW5nIGZyb20gYXJyYXkoemVybyBpbmRleGVkKQ0KICB9DQogIGVsc2UgeyAvL2RlZmF1bHQgc3RyaW5nIGlmIG5vdCBpbiBhcnJheQ0KICAgIHN0ciA9ICJ7QlAiK3NpdHNfbGVmdF9wYWQobnVtLDMsIjAiKSsifSI7DQogIH0NCiAgcmV0dXJuIHN0cjsgLy9yZXR1cm4gc3RyaW5nDQp9DQoNCi8vUmVtb3ZlcyBhbGwgaW5zdGFuY2VzIG9mIHRoZSBzZWNvbmQgc3RyaW5nIGZyb20gdGhlIGZpcnN0IHdoaWNoIGFwcGVhciBhdCB0aGUgYmVnaW5uaW5nDQovLyBzdHJpbmcgIHN0ciAgOiBpbiA7dGhlIG9yaWdpbmFsIHN0cmluZw0KLy8gc3RyaW5nICBwYXQgIDogaW4gO3RoZSBzdWJzdHIgdG8gYmUgZm91bmQgYW5kIHJlbW92ZWQNCmZ1bmN0aW9uIHNpdHNfbGVmdF90cmltKHN0cixwYXQpIHsNCiAgc3RyID0gIiIrc3RyOyAvL2Nhc3QgYXMgc3RyaW5nDQogIHdoaWxlKHN0ci5zdWJzdHIoMCxwYXQubGVuZ3RoKT09cGF0KSB7IC8vY2hlY2sgZm9yIG9jY3VycmVuY2UgYXQgdGhlIGJlZ2lubmluZw0KICAgIHN0ciA9IHN0ci5zdWJzdHIocGF0Lmxlbmd0aCk7IC8vcmVtb3ZlIHRoZSBvY2N1cnJlbmNlDQogIH0NCiAgcmV0dXJuIHN0cjsgLy9yZXR1cm4gc3RyaW5nDQp9DQoNCi8vUmVtb3ZlcyBhbGwgaW5zdGFuY2VzIG9mIHRoZSBzZWNvbmQgc3RyaW5nIGZyb20gdGhlIGZpcnN0IHdoaWNoIGFwcGVhciBhdCB0aGUgZW5kDQovLyBzdHJpbmcgIHN0ciAgOiBpbiA7dGhlIG9yaWdpbmFsIHN0cmluZw0KLy8gc3RyaW5nICBwYXQgIDogaW4gO3RoZSBzdWJzdHIgdG8gYmUgZm91bmQgYW5kIHJlbW92ZWQNCmZ1bmN0aW9uIHNpdHNfcmlnaHRfdHJpbShzdHIscGF0KSB7DQogIHN0ciA9ICIiK3N0cjsgLy9jYXN0IGFzIHN0cmluZw0KICB3aGlsZShzdHIuc3Vic3RyKHN0ci5sZW5ndGgtcGF0Lmxlbmd0aCk9PXBhdCkgeyAvL2NoZWNrIGZvciBvY2N1cnJlbmNlIGF0IHRoZSBlbmQNCiAgICBzdHIgPSBzdHIuc3Vic3RyKDAsc3RyLmxlbmd0aC1wYXQubGVuZ3RoKTsgLy9yZW1vdmUgdGhlIG9jY3VycmVuY2UNCiAgfQ0KICByZXR1cm4gc3RyOyAvL3JldHVybiBzdHJpbmcNCn0NCg0KLy9SZW1vdmUgYWxsIHdoaXRlc3BhY2UgZnJvbSB0aGUgYmVnaW5uaW5nIGFuZCBlbmQgb2YgdGhlIHN0cmluZw0KLy8gc3RyaW5nICBzdHIgIDogaW4gO3RoZSBvcmlnaW5hbCBzdHJpbmcNCmZ1bmN0aW9uIHNpdHNfd2hpdGVfdHJpbShzdHIpIHsNCiAgcmV0dXJuICQudHJpbSgiIitzdHIpOyAvL3JldHVybiBzdHJpbmcNCn0NCg0KLy9HZXQgdGhlIGN1cnJlbnQgZGF0ZSBhcyBhIHN0cmluZw0KLy8gc3RyaW5nICBmbXQgIDogaW4gO3RoZSBkYXRlIGZvcm1hdA0KZnVuY3Rpb24gc2l0c19jdXJyZW50X2RhdGUoZm10KSB7DQogIHZhciBub3cgPSBuZXcgRGF0ZSgpOyAvL2dldCBjdXJyZW50IGRhdGUvdGltZQ0KICByZXR1cm4gc2l0c19kYXRlX3RvX3N0cmluZyhub3csKGZtdCB8fCBzaXRzX2RhdGVfZm9ybWF0KSk7IC8vcmV0dXJuIHN0cmluZw0KfQ0KDQovL0dldCB0aGUgY3VycmVudCB0aW1lIGFzIGEgc3RyaW5nDQovLyBzdHJpbmcgIGZtdCA6aW47dGhlIHRpbWUgZm9ybWF0IHN0cmluZw0KZnVuY3Rpb24gc2l0c19jdXJyZW50X3RpbWUoZm10KSB7DQogIHZhciBub3cgPSBuZXcgRGF0ZSgpOyAvL2dldCBjdXJyZW50IGRhdGUvdGltZQ0KICByZXR1cm4gc2l0c190aW1lX3RvX3N0cmluZyhub3csKGZtdCB8fCBzaXRzX3RpbWVfZm9ybWF0KSk7IC8vcmV0dXJuIHN0cmluZw0KfQ0KDQovL0dldCB0aGUgY3VycmVudCBkYXRldGltZSBhcyBhIHN0cmluZw0KLy8gc3RyaW5nICBmbXQgOmluO3RoZSBkYXRldGltZSBmb3JtYXQgc3RyaW5nDQpmdW5jdGlvbiBzaXRzX2N1cnJlbnRfZGF0ZXRpbWUoZm10KSB7DQogIHZhciBub3cgPSBuZXcgRGF0ZSgpOyAvL2dldCBjdXJyZW50IGRhdGUvdGltZQ0KICByZXR1cm4gc2l0c19kYXRldGltZV90b19zdHJpbmcobm93LChmbXQgfHwgc2l0c19kYXRlX2Zvcm1hdCsiICIrc2l0c190aW1lX2Zvcm1hdCkpOyAvL3JldHVybiBzdHJpbmcNCn0NCg0KLy9HZXQgYXJyYXkgY29udGFpbmluZyBzdGFydCBhbmQgZW5kIHllYXIgdXNpbmcgeWVhciByYW5nZQ0KLy8gc3RyaW5nICBybmcgOiBpbiA7dGhlIHllYXIgcmFuZ2UgLSBodHRwczovL2FwaS5qcXVlcnl1aS5jb20vZGF0ZXBpY2tlci8jb3B0aW9uLXllYXJSYW5nZQ0KLy8gbnVtZXJpYyBjdXIgOiBpbiA7dGhlIGN1cnJlbnQgeWVhciAtIG9ubHkgbmVlZGVkIGlmIHVzaW5nIHRoZSAiYyIgc3R5bGUgeWVhciByYW5nZQ0KZnVuY3Rpb24gc2l0c195ZWFyX3JhbmdlX3ZhbHVlcyhybmcsY3VyKSB7DQogIHJuZyA9IHJuZyB8fCBzaXRzX3llYXJfcmFuZ2U7IC8vdXNlIGRlZmF1bHQgdmFsdWUNCiAgdmFyIG5vdyA9IG5ldyBEYXRlKCkuZ2V0RnVsbFllYXIoKTsNCiAgdmFyIGZuYyA9IGZ1bmN0aW9uKHZhbCkgeyAvL2Z1bmN0aW9uIHRvIGNvbnZlcnQgcmVsYXRpdmUgdmFsdWUgaW50byBhY3R1YWwgdmFsdWUNCiAgICB2YXIgeWVhciA9KHZhbC5tYXRjaCgvY1srXC1dLiovKSA/KGN1ciB8fCBub3cpK3BhcnNlSW50KHZhbC5zdWJzdHJpbmcoMSksMTApIDoodmFsLm1hdGNoKC9bK1wtXS4qLykgPyBub3crcGFyc2VJbnQodmFsLDEwKSA6IHBhcnNlSW50KHZhbCwxMCkpKTsNCiAgICByZXR1cm4oaXNOYU4oeWVhcikgPyBub3cgOiB5ZWFyKTsNCiAgfTsNCiAgdmFyIGFyciA9IHJuZy5zcGxpdCgiOiIpOyAvL3NwbGl0IHJhbmdlDQogIHZhciBiZWcgPSBmbmMoYXJyWzBdKTsNCiAgdmFyIGVuZCA9IE1hdGgubWF4KGJlZyxmbmMoYXJyWzFdIHx8ICIiKSk7DQogIHJldHVybiBbYmVnLGVuZF07IC8vcmV0dXJuIHZhbHVlcw0KfQ0KDQovL1ZhbGlkYXRlIGEgZGF0ZSB3aXRoaW4gYSByYW5nZQ0KLy8gc3RyaW5nICBkYXQgIDogaW4gO3RoZSBkYXRlIHN0cmluZw0KLy8gc3RyaW5nICBybW4gIDogaW4gO3RoZSBtaW5pbXVtIHZhbHVlDQovLyBzdHJpbmcgIHJteCAgOiBpbiA7dGhlIG1heGltdW0gdmFsdWUNCi8vIGJvb2xlYW4gZnJtICA6IGluIDtyZXR1cm4gZm9ybWF0dGVkIHZhbHVlPw0KLy8gc3RyaW5nIGZybWkgIDogaW4gO2Zvcm1hdCBvZiBkYXRlIHZhbHVlcyAoc2VlIGh0dHA6Ly9hcGkuanF1ZXJ5dWkuY29tL2RhdGVwaWNrZXIvI3V0aWxpdHktZm9ybWF0RGF0ZSkNCmZ1bmN0aW9uIHNpdHNfdmFsaWRhdGVfZGF0ZShkYXQscm1uLHJteCxmcm0sZnJtaSkgew0KICBpZih0eXBlb2Yocm1uKT09InVuZGVmaW5lZCIpIHsNCiAgICBybW4gPSAiIjsNCiAgfQ0KICBpZih0eXBlb2Yocm14KT09InVuZGVmaW5lZCIpIHsNCiAgICBybXggPSAiIjsNCiAgfQ0KICBpZih0eXBlb2YoZnJtKT09ImJvb2xlYW4iICYmIGZybSkgew0KICAgIGZybSA9ICJZIjsNCiAgfQ0KICBlbHNlIHsNCiAgICBmcm0gPSAiTiI7DQogIH0NCiAgaWYodHlwZW9mKGZybWkpPT0idW5kZWZpbmVkIikgew0KICAgIGZybWkgPSAiIjsNCiAgfQ0KICB2YXIgcmVzID0gIiI7DQogIHZhciBwYXIgPSAidHlwZT1EJnZhbHU9IitkYXQrIiZybWluPSIrcm1uKyImcm1heD0iK3JteCsiJmZybXQ9Iitmcm0rIiZmcm1pPSIrZnJtaTsgLy9idWlsZCBwYXJhbWV0ZXIgbGlzdA0KICBpZihzaXRzX3ZhbGlkX2FycmF5W3Bhcl0pIHsNCiAgICByZXMgPSBzaXRzX3ZhbGlkX2FycmF5W3Bhcl07IC8vY2hlY2sgY2FjaGUNCiAgfQ0KICBlbHNlIHsNCiAgICByZXMgPSAiPE9LPkZBTFNFIjsNCiAgICBpZih0eXBlb2YoZGF0KT09InN0cmluZyIgJiYgZGF0IT0iIiAmJiBkYXQubGVuZ3RoPjUpIHsNCiAgICAgIHZhciBhdG9tID0gKGZybWkgPyBzaXRzX2RhdGVfY29udmVydChmcm1pLCJ5eS1tbS1kZCIsZGF0KSA6IHNpdHNfZGF0ZV90b19hdG9tKGRhdCkpOw0KICAgICAgdmFyIHRkYXQgPSBzaXRzX3RvX2RhdGUoYXRvbSwieXktbW0tZGQiKTsNCiAgICAgIGlmKHR5cGVvZih0ZGF0KSE9InVuZGVmaW5lZCIpIHsNCiAgICAgICAgcmVzID0gIjxPSz5UUlVFIjsgLy9kYXRlIHZhbHVlIGlzIHZhbGlkDQogICAgICAgIGlmKHJtbiE9IiIpIHsNCiAgICAgICAgICB2YXIgYXJtbiA9IChmcm1pID8gc2l0c19kYXRlX2NvbnZlcnQoZnJtaSwieXktbW0tZGQiLHJtbikgOiBzaXRzX2RhdGVfdG9fYXRvbShybW4pKTsNCiAgICAgICAgICB2YXIgdHJtbiA9IHNpdHNfdG9fZGF0ZShhcm1uLCJ5eS1tbS1kZCIpOw0KICAgICAgICAgIGlmKHR5cGVvZih0cm1uKSE9InVuZGVmaW5lZCIpIHsNCiAgICAgICAgICAgIGlmKGF0b208YXJtbikgew0KICAgICAgICAgICAgICByZXMgPSAiPE9LPkZBTFNFIjsgLy9kYXRlIGlzIGJlbG93IG1pbmltdW0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgaWYocmVzPT0iPE9LPlRSVUUiICYmIHJteCE9IiIpIHsNCiAgICAgICAgICB2YXIgYXJteCA9IChmcm1pID8gc2l0c19kYXRlX2NvbnZlcnQoZnJtaSwieXktbW0tZGQiLHJteCkgOiBzaXRzX2RhdGVfdG9fYXRvbShybXgpKTsNCiAgICAgICAgICB2YXIgdHJteCA9IHNpdHNfdG9fZGF0ZShhcm14LCJ5eS1tbS1kZCIpOw0KICAgICAgICAgIGlmKHR5cGVvZih0cm14KSE9InVuZGVmaW5lZCIpIHsNCiAgICAgICAgICAgIGlmKGF0b20+YXJteCkgew0KICAgICAgICAgICAgICByZXMgPSAiPE9LPkZBTFNFIjsgLy9kYXRlIGlzIGFib3ZlIG1heGltdW0NCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgaWYocmVzPT0iPE9LPlRSVUUiICYmIGZybT09IlkiKSB7DQogICAgICAgICAgcmVzICs9ICI9IitzaXRzX2F0b21fdG9fZGF0ZShhdG9tKTsgLy9yZXR1cm4gZm9ybWF0dGVkIHZhbHVlDQogICAgICAgIH0NCiAgICAgIH0NCiAgICB9DQogICAgc2l0c192YWxpZF9hcnJheVtwYXJdID0gcmVzOyAvL2FkZCB0byBjYWNoZQ0KICB9DQogIGlmKHJlcz09IjxPSz5UUlVFIikgew0KICAgIHJldHVybiB0cnVlOw0KICB9DQogIGlmKGZybT09IlkiICYmIHJlcy5zdWJzdHIoMCw5KT09IjxPSz5UUlVFPSIpIHsgLy9yZXR1cm4gZm9ybWF0dGVkIHZhbHVlDQogICAgcmV0dXJuIHJlcy5zdWJzdHIoOSk7DQogIH0NCiAgcmV0dXJuIGZhbHNlOw0KfQ0KDQovL1ZhbGlkYXRlIGEgdGltZSB3aXRoaW4gYSByYW5nZQ0KLy8gc3RyaW5nICB0aW0gIDogaW4gO3RoZSB0aW1lIHN0cmluZw0KLy8gc3RyaW5nICBybW4gIDogaW4gO3RoZSBtaW5pbXVtIHZhbHVlDQovLyBzdHJpbmcgIHJteCAgOiBpbiA7dGhlIG1heGltdW0gdmFsdWUNCi8vIGJvb2xlYW4gZnJtICA6IGluIDtyZXR1cm4gZm9ybWF0dGVkIHZhbHVlPw0KLy8gc3RyaW5nIGZybWkgIDogaW4gO2Zvcm1hdCBvZiB0aW1lIHZhbHVlcyAodXNlICZEIG5vdGF0aW9uIEgyOk4yOlMyLlQyIHApDQpmdW5jdGlvbiBzaXRzX3ZhbGlkYXRlX3RpbWUodGltLHJtbixybXgsZnJtLGZybWkpIHsNCiAgaWYodHlwZW9mKHJtbik9PSJ1bmRlZmluZWQiKSB7DQogICAgcm1uID0gIiI7DQogIH0NCiAgaWYodHlwZW9mKHJteCk9PSJ1bmRlZmluZWQiKSB7DQogICAgcm14ID0gIiI7DQogIH0NCiAgaWYodHlwZW9mKGZybSk9PSJib29sZWFuIiAmJiBmcm0pIHsNCiAgICBmcm0gPSAiWSI7DQogIH0NCiAgZWxzZSB7DQogICAgZnJtID0gIk4iOw0KICB9DQogIGlmKHR5cGVvZihmcm1pKT09InVuZGVmaW5lZCIpIHsNCiAgICBmcm1pID0gIiI7DQogIH0NCiAgdmFyIHJlcyA9ICIiOw0KICB2YXIgcGFyID0gInR5cGU9VCZ2YWx1PSIrdGltKyImcm1pbj0iK3JtbisiJnJtYXg9IitybXgrIiZmcm10PSIrZnJtKyImZnJtaT0iK2ZybWk7IC8vYnVpbGQgcGFyYW1ldGVyIGxpc3QNCiAgaWYoc2l0c192YWxpZF9hcnJheVtwYXJdKSB7DQogICAgcmVzID0gc2l0c192YWxpZF9hcnJheVtwYXJdOyAvL2NoZWNrIGNhY2hlDQogIH0NCiAgZWxzZSB7DQogICAgcmVzID0gIjxPSz5GQUxTRSI7DQogICAgdmFyIHRpbWUgPSBzaXRzX3RvX3RpbWUodGltLGZybWkpOw0KICAgIGlmKHR5cGVvZih0aW1lKSE9InVuZGVmaW5lZCIpIHsNCiAgICAgIHJlcyA9ICI8T0s+VFJVRSI7IC8vdGltZSBpcyB2YWxpZCB2YWx1ZQ0KICAgICAgaWYocm1uIT0iIikgew0KICAgICAgICB2YXIgdHJtbiA9IHNpdHNfdG9fdGltZShybW4sZnJtaSk7DQogICAgICAgIGlmKHR5cGVvZih0cm1uKSE9InVuZGVmaW5lZCIgJiYgdGltZTx0cm1uKSB7DQogICAgICAgICAgcmVzID0gIjxPSz5GQUxTRSI7IC8vdGltZSBpcyBsZXNzIHRoYW4gbWluaW11bQ0KICAgICAgICB9DQogICAgICB9DQogICAgICBpZihyZXM9PSI8T0s+VFJVRSIgJiYgcm14IT0iIikgew0KICAgICAgICB2YXIgdHJteCA9IHNpdHNfdG9fdGltZShybXgsZnJtaSk7DQogICAgICAgIGlmKHR5cGVvZih0cm14KSE9InVuZGVmaW5lZCIgJiYgdGltZT50cm14KSB7DQogICAgICAgICAgcmVzID0gIjxPSz5GQUxTRSI7IC8vdGltZSBpcyBtb3JlIHRoYW4gbWF4aW11bQ0KICAgICAgICB9DQogICAgICB9DQogICAgICBpZihyZXM9PSI8T0s+VFJVRSIgJiYgZnJtPT0iWSIpIHsNCiAgICAgICAgcmVzICs9ICI9IitzaXRzX3RpbWVfdG9fc3RyaW5nKHRpbWUpOyAvL3JldHVybiBmb3JtYXR0ZWQgdmFsdWUNCiAgICAgIH0NCiAgICB9DQogICAgc2l0c192YWxpZF9hcnJheVtwYXJdID0gcmVzOyAvL2FkZCB0byBjYWNoZQ0KICB9DQogIGlmKHJlcz09IjxPSz5UUlVFIikgew0KICAgIHJldHVybiB0cnVlOw0KICB9DQogIGlmKGZybT09IlkiICYmIHJlcy5zdWJzdHIoMCw5KT09IjxPSz5UUlVFPSIpIHsgLy9yZXR1cm4gZm9ybWF0dGVkIHZhbHVlDQogICAgcmV0dXJuIHJlcy5zdWJzdHIoOSk7DQogIH0NCiAgcmV0dXJuIGZhbHNlOw0KfQ0KDQovL1ZhbGlkYXRlIGEgbnVtYmVyIGlzIHdpdGhpbiBhbiBpbmNsdXNpdmUgcmFuZ2UNCi8vIHN0cmluZyAgbnVtICA6IGluIDt0aGUgbnVtYmVyIHN0cmluZw0KLy8gYm9vbGVhbiAgYm9vICA6IGluIDtpbnRlZ2VyIHZhbHVlPw0KLy8gbnVtZXJpYyAgcm1uICA6IGluIDt0aGUgbWluaW11bSB2YWx1ZQ0KLy8gbnVtZXJpYyAgcm14ICA6IGluIDt0aGUgbWF4aW11bSB2YWx1ZQ0KZnVuY3Rpb24gc2l0c192YWxpZGF0ZV9udW1iZXIobnVtLGJvbyxybW4scm14KSB7DQogIGlmKG51bSkgew0KICAgIGlmKGlzTmFOKG51bSkpIHsgLy9jaGVjayBpcyBhbiBudW1iZXINCiAgICAgIHJldHVybiBmYWxzZTsNCiAgICB9DQogICAgdmFyIHZhbCA9IDA7DQogICAgaWYoYm9vKSB7DQogICAgICB2YWwgPSBwYXJzZUludChudW0sMTApOw0KICAgIH0NCiAgICBlbHNlIHsNCiAgICAgIHZhbCA9IHBhcnNlRmxvYXQobnVtKTsNCiAgICB9DQogICAgaWYoYm9vICYmIG51bSE9dmFsKSB7IC8vY2hlY2sgaXMgYW4gaW50ZWdlcg0KICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0NCiAgICBpZih0eXBlb2Yocm1uKT09Im51bWJlciIgJiYgdmFsPHJtbikgeyAvL2NoZWNrIG1pbiB2YWx1ZQ0KICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0NCiAgICBpZih0eXBlb2Yocm14KT09Im51bWJlciIgJiYgdmFsPnJteCkgeyAvL2NoZWNrIG1heCB2YWx1ZQ0KICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0NCiAgfQ0KICByZXR1cm4gdHJ1ZTsNCn0NCg0KLy9WYWxpZGF0ZSBhIHN0cmluZyB0byBzZWUgaWYgaXMgYW4gZW1haWwgYWRkcmVzcw0KLy8gc3RyaW5nICBzdHIgIDogaW4gO3RoZSBlbWFpbCBzdHJpbmcNCmZ1bmN0aW9uIHNpdHNfdmFsaWRhdGVfZW1haWwoc3RyKSB7DQogIGlmKHN0cikgew0KICAgIHZhciBwMSA9IHN0ci5pbmRleE9mKCI8Iik7IC8vY2hlY2sgZm9yICJuYW1lIDxlbWFpbD4iIGZvcm1hdA0KICAgIGlmKHAxPi0xKSB7DQogICAgICB2YXIgdGVtcCA9IHN0ci5zdWJzdHIocDErMSk7DQogICAgICB2YXIgcDIgPSB0ZW1wLmluZGV4T2YoIj4iKTsNCiAgICAgIGlmKHAyPi0xKSB7DQogICAgICAgIHN0ciA9IHRlbXAuc3Vic3RyKDAscDIpOyAvL2V4dHJhY3QgZW1haWwgYWRkcmVzcw0KICAgICAgfQ0KICAgIH0NCiAgICBpZighKC9eXHcoW1wuXC1cX1wnXCtdP1x3KSpAXHcoW1wuXC1dP1x3KSpcLlx3KFtcLl0/XHcpKyQvLnRlc3Qoc3RyKSkpIHsgLy90ZXN0IHJlZ3VsYXIgZXhwcmVzc2lvbg0KICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0NCiAgfQ0KICByZXR1cm4gdHJ1ZTsNCn0NCg0KLy9Db252ZXJ0IGNlcnRhaW4gY2hhcmFjdGVycyB0aGF0IGNhbm5vdCBiZSB1c2VkIGluIFVSTCdzKGUuZy4gPCwgJiwgZXRjKQ0KLy8gc3RyaW5nICBzdHIgIDogaW4gO3RoZSB1cmwgc3RyaW5nDQpmdW5jdGlvbiBzaXRzX2VzY2FwZV91cmwoc3RyKSB7DQogIGlmKGVuY29kZVVSSUNvbXBvbmVudCkgew0KICAgIHJldHVybiBlbmNvZGVVUklDb21wb25lbnQoc3RyKTsNCiAgfQ0KICBlbHNlIGlmKGVzY2FwZSkgew0KICAgIHJldHVybiBlc2NhcGUoc3RyKTsNCiAgfQ0KICByZXR1cm4gc3RyOyAvL3JldHVybiBlc2NhcGVkIHN0cmluZw0KfQ0KDQovL0FkZCBjaGFyYWN0ZXJzIHRvIHRoZSBiZWdpbm5pbmcgb2YgYSBzdHJpbmcgdG8gZm9yY2UgbGVuZ3RoDQovLyBzdHJpbmcgIHN0ciAgOiBpbiA7dGhlIHN0cmluZyB0byBhZGQgbGVhZGluZyBjaGFyYWN0ZXJzIHRvDQovLyBudW1lcmljICBsZW4gIDogaW4gO3RoZSBsZW5ndGggdGhlIHN0cmluZyBzaG91bGQgYmUNCi8vIHN0cmluZyAgIHBhZCAgOiBpbiA7dGhlIGNoYXJhY3RlciB0byBwYWQgd2l0aA0KZnVuY3Rpb24gc2l0c19sZWZ0X3BhZChzdHIsbGVuLHBhZCkgew0KICBzdHIgPSAiIitzdHI7IC8vY2FzdCBhcyBzdHJpbmcNCiAgd2hpbGUoc3RyLmxlbmd0aDxsZW4pIHsNCiAgICBzdHIgPSBwYWQrc3RyOyAvL3ByZXBlbmQgcGFkIGNoYXJhY3Rlcg0KICB9DQogIHJldHVybiBzdHI7IC8vcmV0dXJuIGZpeGVkIHN0cmluZw0KfQ0KDQovL0FkZCBjaGFyYWN0ZXJzIHRvIHRoZSBlbmQgb2YgYSBzdHJpbmcgdG8gZm9yY2UgbGVuZ3RoDQovLyBzdHJpbmcgIHN0ciAgOiBpbiA7dGhlIHN0cmluZyB0byBhZGQgbGVhZGluZyBjaGFyYWN0ZXJzIHRvDQovLyBudW1lcmljICBsZW4gIDogaW4gO3RoZSBsZW5ndGggdGhlIHN0cmluZyBzaG91bGQgYmUNCi8vIHN0cmluZyAgIHBhZCAgOiBpbiA7dGhlIGNoYXJhY3RlciB0byBwYWQgd2l0aA0KZnVuY3Rpb24gc2l0c19yaWdodF9wYWQoc3RyLGxlbixwYWQpIHsNCiAgc3RyID0gIiIrc3RyOyAvL2Nhc3QgYXMgc3RyaW5nDQogIHdoaWxlKHN0ci5sZW5ndGg8bGVuKSB7DQogICAgc3RyICs9IHBhZDsgLy9hcHBlbmQgcGFkIGNoYXJhY3Rlcg0KICB9DQogIHJldHVybiBzdHI7IC8vcmV0dXJuIGZpeGVkIHN0cmluZw0KfQ0KDQovL1JlcGxhY2UgZWFjaCBpbnN0YW5jZSBvZiBhIHN0cmluZyB3aXRoaW4gYW5vdGhlcih3aWxsIG5vdCBsb29wKQ0KLy8gc3RyaW5nICBvcmlnICA6IGluIDt0aGUgb3JpZ2luYWwgc3RyaW5nDQovLyBzdHJpbmcgIHN0ckEgIDogaW4gO3RoZSBzZWFyY2ggc3RyaW5nDQovLyBzdHJpbmcgIHN0ckIgIDogaW4gO3RoZSByZXBsYWNlIHN0cmluZw0KLy8gbnVtZXJpYyAgIG1heHIgIDogaW4gO3RoZSBtYXhpbXVtIG51bWJlciBvZiByZXBsYWNlbWVudHMgdG8gbWFrZQ0KZnVuY3Rpb24gc2l0c19yZXBsYWNlKG9yaWcsc3RyQSxzdHJCLG1heHIpIHsNCiAgaWYodHlwZW9mKG9yaWcpIT0ic3RyaW5nIiB8fCBvcmlnLmxlbmd0aDwxKSB7IC8vY2hlY2sgb3JpZ2luYWwgc3RyaW5nDQogICAgcmV0dXJuICIiOw0KICB9DQogIGlmKHR5cGVvZihtYXhyKSE9Im51bWJlciIgfHwgbWF4cjwwKSB7IC8vY2hlY2sgbGltaXQNCiAgICBtYXhyID0gMTAwMDA7DQogIH0NCiAgdmFyIHN0ciA9IG9yaWc7IC8vY29weSBzdHJpbmcNCiAgdmFyIHJldCA9ICIiOw0KICB2YXIgbGVuID0gc3RyQS5sZW5ndGg7DQogIHZhciBwb3MgPSBzdHIuaW5kZXhPZihzdHJBKTsgLy9zZWFyY2ggZm9yIHN0cmluZyBBLi4uDQogIHZhciBjdXIgPSAwOw0KICB3aGlsZShwb3M+PTAgJiYgY3VyPG1heHIpIHsNCiAgICBjdXIrKzsNCiAgICByZXQgKz0gc3RyLnN1YnN0cigwLHBvcykrc3RyQjsgLy8uLi5hbmQgcmVwbGFjZSB3aXRoIHN0cmluZyBCDQogICAgc3RyID0gc3RyLnN1YnN0cihwb3MrbGVuKTsNCiAgICBwb3MgPSBzdHIuaW5kZXhPZihzdHJBKTsgLy9zZWFyY2ggaW4gcmVtaW5kZXIgb2Ygc3RyaW5nDQogIH0NCiAgcmV0dXJuIHJldCtzdHI7IC8vcmV0dXJuIHN0cmluZw0KfQ0KDQovL0NvbnZlcnQgY2VydGFpbiBjaGFyYWN0ZXJzIHRoYXQgY2Fubm90IGJlIHVzZWQgaW4gamF2YXNjcmlwdCBzdHJpbmcncyhlLmcuICcsICIsIGV0YykNCi8vIHN0cmluZyAgc3RyICA6IGluIDt0aGUgamF2YXNjcmlwdCBzdHJpbmcNCmZ1bmN0aW9uIHNpdHNfZXNjYXBlX3N0cmluZyhzdHIpIHsNCiAgdmFyIHJldCA9IHNpdHNfcmVwbGFjZShzdHIsIlxcIiwiXFxcXCIpOw0KICByZXQgPSBzaXRzX3JlcGxhY2UocmV0LCJcLyIsIlxcXC8iKTsNCiAgcmV0ID0gc2l0c19yZXBsYWNlKHJldCwiXCIiLCJcXFwiIik7DQogIHJldCA9IHNpdHNfcmVwbGFjZShyZXQsIlwnIiwiXFxcJyIpOw0KICByZXQgPSBzaXRzX3JlcGxhY2UocmV0LCJcJiIsIlxcXCYiKTsNCiAgcmV0dXJuIHJldDsgLy9yZXR1cm4gZXNjYXBlZCBzdHJpbmcNCn0NCg0KLy9UcnVuY2F0ZSBhIHN0cmluZyBhdCBhIGNlcnRhaW4gbGVuZ3RoIGFuZCBhZGQgYW4gZWxsaXBzaXMgaWYgbmVjZXNzYXJ5DQovLyBzdHJpbmcgIHN0ciAgOiBpbiA7dGhlIHN0cmluZyB0byBiZSB0cnVuY2F0ZWQNCi8vIG51bWVyaWMgIG51bSAgOiBpbiA7dGhlIG1heGltdW0gbGVuZ3RoIG9mIHRoZSBzdHJpbmcNCmZ1bmN0aW9uIHNpdHNfY3JlYXRlX2VsbGlwc2lzKHN0cixudW0pIHsNCiAgaWYoc3RyLmxlbmd0aD5udW0pIHsNCiAgICBzdHIgPSBzdHIuc3Vic3RyKDAsbnVtLTMpKyIuLi4iOyAvL3RydW5jYXRlIGFuZCBhZGQgZWxsaXBzaXMNCiAgfQ0KICByZXR1cm4gc3RyOw0KfQ0KDQovL0NyZWF0ZXMgcmlnaHQgY2xpY2sgY29udGV4dCBtZW51DQovLyBzdHJpbmcgICBzZWwgIDogaW4gO2pRdWVyeSBzZWxlY3RvciB0byBhcHBseSB0aGUgY29udGV4dCBtZW51IHRvDQovLyBvYmplY3QgICBvYmogIDogaW4gO29iamVjdCBjb250YWluaW5nIHRoZSB0ZXh0IGFuZCB0aGUgY2FsbGJhY2sgZnVuY3Rpb25zIGZvciBlYWNoIG9wdGlvbiBpbiB0aGUgbWVudQ0KLy8gb2JqZWN0ICAgb3B0ICA6IGluIDtvYmplY3QgY29udGFpbmluZyBhbnkgb3B0aW9ucyB0byBleHRlbmQgb3Igb3ZlcnJpZGUgdGhlIGRlZmF1bHRzKG9wdGlvbmFsKQ0KZnVuY3Rpb24gc2l0c19jb250ZXh0X21lbnUoc2VsLG9iaixvcHQpIHsNCiAgdmFyIGxvYyA9IHNpdHNfbWluaWZpZWRfcGF0aCgiLi4vcGx1Z2lucy9qYXZhc2NyaXB0L21lbnUvIiwianF1ZXJ5LnVpLWNvbnRleHRtZW51LmpzIiwianF1ZXJ5LnVpLWNvbnRleHRtZW51Lm1pbi5qcyIpOw0KICBpZihzaXRzX2ZpbGVzX2FycmF5W2xvY109PSJZIikgeyAvL2FscmVhZHkgbG9hZGVkLi4uDQogICAgc2l0c19kb19jb250ZXh0X21lbnUoc2VsLG9iaixvcHQpOyAvLy4uLnNvIGNhbGwgc3RyYWlnaHQgYXdheQ0KICB9DQogIGVsc2UgeyAvL25vdCBsb2FkZWQgeWV0DQogICAgdmFyIHBhciA9IHt9OyAvL2NyZWF0ZSBhbiBvYmplY3Qgb2YgcGFyYW1ldGVycw0KICAgIHBhci51cmwgPSBsb2M7DQogICAgcGFyLmZuYyA9IHNpdHNfZG9fY29udGV4dF9tZW51Ow0KICAgIHBhci5wMDEgPSBzZWw7DQogICAgcGFyLnAwMiA9IG9iajsNCiAgICBwYXIucDAzID0gb3B0Ow0KICAgIHZhciBsZW4gPSBzaXRzX3BhcmFtX2FycmF5LnB1c2gocGFyKTsgLy9zYXZlIGZvciBsYXRlcg0KICAgIHNpdHNfaW5jbHVkZV9maWxlKHNpdHNfbWluaWZpZWRfcGF0aCgiLi4vcGx1Z2lucy9qYXZhc2NyaXB0L3RhcGhvbGQvIiwidGFwaG9sZC5qcyIsInRhcGhvbGQubWluLmpzIiksZnVuY3Rpb24oYm9vKSB7DQogICAgICBzaXRzX2luY2x1ZGVfZmlsZShzaXRzX21pbmlmaWVkX3BhdGgoIi4uL3BsdWdpbnMvamF2YXNjcmlwdC9tZW51LyIsImpxdWVyeS51aS1jb250ZXh0bWVudS5qcyIsImpxdWVyeS51aS1jb250ZXh0bWVudS5taW4uanMiKSk7DQogICAgfSk7DQogIH0NCiAgcmV0dXJuIHRydWU7DQp9DQoNCi8vSW50ZXJuYWwgZnVuY3Rpb24gdG8gaW5zdGFsbCBjb250ZXh0IG1lbnUNCi8vIHN0cmluZyAgIHNlbCA6IGluIDtqUXVlcnkgc2VsZWN0b3IgdG8gYXBwbHkgdGhlIGNvbnRleHQgbWVudSB0bw0KLy8gb2JqZWN0ICAgb2JqIDogaW4gO29iamVjdCBjb250YWluaW5nIHRoZSB0ZXh0IGFuZCB0aGUgY2FsbGJhY2sgZnVuY3Rpb25zIGZvciBlYWNoIG9wdGlvbiBpbiB0aGUgbWVudQ0KLy8gb2JqZWN0ICAgb3B0IDogaW4gO29iamVjdCBjb250YWluaW5nIGFueSBvcHRpb25zIHRvIGV4dGVuZCBvciBvdmVycmlkZSB0aGUgZGVmYXVsdHMob3B0aW9uYWwpDQpmdW5jdGlvbiBzaXRzX2RvX2NvbnRleHRfbWVudShzZWwsb2JqLG9wdCkgew0KICBpZigodHlwZW9mKHNlbCk9PSJzdHJpbmciICYmIHNlbC5sZW5ndGg+MCkgfHwgdHlwZW9mKHNlbCk9PSJvYmplY3QiKSB7IC8vY2hlY2sgZmlyc3QgcGFyYW1ldGVyDQogICAgaWYoKHR5cGVvZihvYmopPT0ic3RyaW5nIiAmJiBvYmoubGVuZ3RoPjApIHx8IHR5cGVvZihvYmopPT0ib2JqZWN0IiB8fCB0eXBlb2Yob2JqKT09ImZ1bmN0aW9uIikgeyAvL2NoZWNrIHNlY29uZCBwYXJhbWV0ZXINCiAgICAgIHZhciBjb250ZXh0X29wdCA9IHsNCiAgICAgICAgcHJldmVudENvbnRleHRNZW51Rm9yUG9wdXA6IHRydWUsDQoJCSAgICBwcmV2ZW50U2VsZWN0OiB0cnVlLA0KCQkgICAgdGFwaG9sZDogZmFsc2UsDQogICAgICAgIGhpZGU6IHsNCiAgICAgICAgICBlZmZlY3Q6ICJmYWRlT3V0IiwNCiAgICAgICAgICBkdXJhdGlvbjogc2l0c19hbmltX3NwZWVkDQogICAgICAgIH0sDQogICAgICAgIHNob3c6IHsNCiAgICAgICAgICBlZmZlY3Q6ICJzbGlkZURvd24iLA0KICAgICAgICAgIGR1cmF0aW9uOiBzaXRzX2FuaW1fc3BlZWQNCiAgICAgICAgfSwNCiAgICAgICAgb3BlbjogZnVuY3Rpb24oZXZlbnQsdWkpIHsNCiAgICAgICAgICBzaXRzX2N1cnJlbnRfbWVudSA9IGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQ7IC8vc3RvcmUgYWN0aXZlIGVsZW1lbnQNCiAgICAgICAgICB2YXIgdl9tZW51ID0gJCh1aS5tZW51KTsNCiAgICAgICAgICB2X21lbnUuY3NzKCJ6LWluZGV4IiwyMTQ3NDgzNjQ3KTsgLy9oYWNrIHRvIG1ha2Ugc3VyZSBtZW51IGlzIGFsd2F5cyBhdCB0aGUgZnJvbnQNCiAgICAgICAgICB2X21lbnUuZmluZCgibGkudWktbWVudS1kaXZpZGVyIikuYXR0cigicm9sZSIsInNlcGFyYXRvciIpOyAvL2FkZCBzZXBhcmF0b3Igcm9sZXMNCiAgICAgICAgICB2X21lbnUuZmluZCgidWwiKS5hZGRCYWNrKCkuZWFjaChmdW5jdGlvbihpKSB7IC8vYWRkIGFyaWEgYXR0cmlidXRlcw0KICAgICAgICAgICAgdmFyIG9iaiA9ICQodGhpcyk7DQogICAgICAgICAgICBpZighb2JqLmhhc0NsYXNzKCJ1aS1jb250ZXh0bWVudSIpKSB7DQogICAgICAgICAgICAgIHZhciBwaWQgPSBvYmoucHJldigiYSIpLmF0dHIoImlkIik7DQogICAgICAgICAgICAgIGlmKHBpZCkgew0KICAgICAgICAgICAgICAgIG9iai5hdHRyKCJhcmlhLWxhYmVsbGVkYnkiLHBpZCk7IC8vYWRkICJsYWJlbGxlZGJ5IiB0byBzdWItbWVudXMNCiAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgdmFyIGxpcyA9IG9iai5jaGlsZHJlbigibGkudWktbWVudS1pdGVtIik7DQogICAgICAgICAgICB2YXIgdG90ID0gbGlzLmxlbmd0aDsNCiAgICAgICAgICAgIGxpcy5lYWNoKGZ1bmN0aW9uKGkpIHsgLy9hZGQgInBvc2luc2V0IiBhbmQgInNldHNpemUiIGZvciBtZW51IGl0ZW1zKGJyb3dzZXIgY291bnRzIHN1Yi1tZW51cyBpbmNvcnJlY3RseSkNCiAgICAgICAgICAgICAgJCh0aGlzKS5jaGlsZHJlbigiYSIpLmF0dHIoImFyaWEtcG9zaW5zZXQiLGkrMSkuYXR0cigiYXJpYS1zZXRzaXplIix0b3QpOw0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgfSk7DQogICAgICAgICAgdl9tZW51LmZvY3VzKCk7IC8vZm9jdXMgb24gbWVudSh3aGljaCBmb2N1c2VzIG9uIGZpcnN0IGl0ZW0pDQogICAgICAgIH0sDQogICAgICAgIGNsb3NlOiBmdW5jdGlvbihldmVudCkgew0KICAgICAgICAgIGlmKHNpdHNfY3VycmVudF9tZW51KSB7IC8vb3JpZ2luYWwgYWN0aXZlIGVsZW1lbnQgc3RvcmVkDQogICAgICAgICAgICB2YXIgdl9lbGVtID0gZG9jdW1lbnQuYWN0aXZlRWxlbWVudDsgLy9jdXJyZW50IGFjdGl2ZSBlbGVtZW50DQogICAgICAgICAgICBpZih2X2VsZW0gJiYgdl9lbGVtLnRhZ05hbWU9PSJVTCIgJiYgdl9lbGVtLnN0eWxlLnpJbmRleD09IjIxNDc0ODM2NDciKSB7IC8vc3RpbGwgZm9jdXNlZCBvbiBtZW51DQogICAgICAgICAgICAgIHNpdHNfY3VycmVudF9tZW51LmZvY3VzKCk7IC8vZm9jdXMgb24gb3JpZ2luYWwgYWN0aXZlIGVsZW1lbnQNCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9DQogICAgICAgICAgc2l0c19jdXJyZW50X21lbnUgPSBudWxsOw0KICAgICAgICB9DQogICAgICB9Ow0KICAgICAgaWYodHlwZW9mKG9wdCk9PSJvYmplY3QiKSB7IC8vUFBMMzY2NTMgLSBpbXBsZW1lbnQgb3B0IHBhcmFtZXRlcih3YXMgImZvciBmdXR1cmUgdXNlIiBiZWZvcmUpDQogICAgICAJY29udGV4dF9vcHQgPSAkLmV4dGVuZChjb250ZXh0X29wdCxvcHQsdHJ1ZSk7DQogICAgICB9DQogICAgICBpZih0eXBlb2Yob2JqKT09ImZ1bmN0aW9uIikgeyAvL2Z1bmN0aW9uDQogICAgICAgIGNvbnRleHRfb3B0Lm1lbnUgPSBbXTsNCiAgICAgICAgY29udGV4dF9vcHQuYmVmb3JlT3BlbiA9IGZ1bmN0aW9uKGV2ZW50LCB1aSkgew0KICAgICAgICAgIHZhciBuZXdtZW51ID0gb2JqLmNhbGwodGhpcywgZXZlbnQsIHVpKTsNCiAgICAgICAgICBpZihuZXdtZW51PT1udWxsKSB7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgfQ0KICAgICAgICAgICQodGhpcykuY29udGV4dG1lbnUoInJlcGxhY2VNZW51IixuZXdtZW51KTsNCiAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgfTsNCiAgICAgIH0NCiAgICAgIGVsc2UgeyAvL211c3QgYmUgb2JqZWN0IG9yIHN0cmluZw0KICAgICAgICBjb250ZXh0X29wdC5tZW51ID0gb2JqOw0KICAgICAgfQ0KICAgICAgdmFyIHZfc2VsID0gc2VsOw0KICAgICAgdmFyIHZfY29udCA9IG51bGw7DQogICAgICBpZih0eXBlb2Yoc2VsKT09Im9iamVjdCIpIHsNCiAgICAgICAgaWYodHlwZW9mKHNlbC5zZWxlY3Rvcik9PSJzdHJpbmciIHx8IHR5cGVvZihzZWwuc2VsZWN0b3IpPT0ib2JqZWN0Iikgew0KICAgICAgICAgIHZfc2VsID0gc2VsLnNlbGVjdG9yOw0KICAgICAgICB9DQogICAgICAgIGlmKHR5cGVvZihzZWwuY29udGV4dCk9PSJvYmplY3QiKSB7DQogICAgICAgICAgdl9jb250ID0gc2VsLmNvbnRleHQ7DQogICAgICAgIH0NCiAgICAgICAgaWYodHlwZW9mKHNlbC5kZWxlZ2F0ZSk9PSJzdHJpbmciKSB7DQogICAgICAgICAgY29udGV4dF9vcHQuZGVsZWdhdGUgPSBzZWwuZGVsZWdhdGU7DQogICAgICAgIH0NCiAgICAgIH0NCiAgICAgIGlmKHZfc2VsLmxlbmd0aD09MCkgew0KICAgICAgICByZXR1cm4gZmFsc2U7IC8vUFBMMzY2NTMgLSB1c2UgY29ycmVjdCBzZWxlY3Rvcih3YXMgc2VsKQ0KICAgICAgfQ0KICAgICAgaWYodl9jb250IT1udWxsKSB7DQogICAgICAgICQodl9zZWwsdl9jb250KS5jb250ZXh0bWVudShjb250ZXh0X29wdCk7IC8vY3JlYXRlIGNvbnRleHQgbWVudQ0KICAgICAgfQ0KICAgICAgZWxzZSB7DQogICAgICAgICQodl9zZWwpLmNvbnRleHRtZW51KGNvbnRleHRfb3B0KTsgLy9jcmVhdGUgY29udGV4dCBtZW51DQogICAgICB9DQogICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQogIH0NCiAgcmV0dXJuIGZhbHNlOw0KfQ0KDQovL0V4ZWN1dGVzIGFsbCBvZiB0aGUgc2NyaXB0IHRhZ3Mgd2l0aGluIGEgZGl2IGFmdGVyIGl0cyBpbm5lckhUTUwgaGFzIGJlZW4gc2V0DQovLyBzdHJpbmcgIGlkICA6IGluIDt0aGUgaWQgb2YgdGhlIGRpdg0KZnVuY3Rpb24gc2l0c19leGVjdXRlX3NjcmlwdChpZCkgew0KICB2YXIgZCA9IG51bGw7DQogIGlmKGQ9c2l0c19nZXRfb2JqZWN0KGlkKSkgeyAvL2dldCBkaXYgb2JqZWN0DQogICAgdmFyIGEgPSBkLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJzY3JpcHQiKTsgLy9nZXQgc2NyaXB0IG9iamVjdHMNCiAgICB2YXIgbCA9IGEubGVuZ3RoOw0KICAgIGZvcih2YXIgaT0wO2k8bDtpKyspIHsNCiAgICAgIHZhciBzID0gYVtpXS5pbm5lckhUTUw7IC8vZ2V0IGNvbnRlbnRzIG9mIHNjcmlwdCBvYmplY3QNCiAgICAgIGlmKHMhPSIiKSB7DQogICAgICAgIGlmKHdpbmRvdy5leGVjU2NyaXB0KSB7DQogICAgICAgICAgd2luZG93LmV4ZWNTY3JpcHQocyk7IC8vZXhlY3V0ZSBzY3JpcHQoSUUpDQogICAgICAgIH0NCiAgICAgICAgZWxzZSB7DQogICAgICAgICAgd2luZG93LnNldFRpbWVvdXQocywwKTsgLy9leGVjdXRlIHNjcmlwdChvdGhlcikNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0NCiAgICByZXR1cm4gdHJ1ZTsNCiAgfQ0KICByZXR1cm4gZmFsc2U7DQp9DQoNCi8vQ3JlYXRlcyBhIHByb2dyZXNzIGJhciBhbmQgZGlzcGxheXMgaXQgb24gdGhlIHNjcmVlbihQUEwwMTE3NzApDQovLyBzdHJpbmcgIG1lcyAgOiBpbiA7dGhlIG1lc3NhZ2UgdGV4dCBkaXNwbGF5ZWQgaW4gdGhlIHByb2dyZXNzIGJhcg0KLy8gc3RyaW5nICBpc3MgIDogaW4gO3RoZSBJU1MgY29kZSAtIGxlYXZlIGJsYW5rIHRvIHVzZSBzdGFuZGFyZCBtb2RlDQovLyBudW1lcmljICBzZWMgIDogaW4gO3RoZSBpbnRlcnZhbCBiZXR3ZWVuIHVwZGF0ZXMoaW4gc2Vjb25kcykNCi8vIHN0cmluZyAgcmVtICA6IGluIDt0aGUgbWVzc2FnZSB0ZXh0IGRpc3BsYXllZCBwcmlvciB0byB0aGUgcmVtYWluaW5nIHRpbWUNCi8vIGZ1bmN0aW9uICBmbmMgIDogaW4gO2NhbGwgYmFjayBmdW5jdGlvbiBjYWxsZWQgYWZ0ZXIgcHJvZ3Jlc3MgaXMgY29tcGxldGUNCmZ1bmN0aW9uIHNpdHNfcHJvZ3Jlc3MobWVzLGlzcyxzZWMscmVtLGZuYykgew0KICBpZih0eXBlb2YoaXNzKSE9InN0cmluZyIpIHsgLy9jaGVjayBJU1MgY29kZQ0KICAgIGlzcyA9ICIiOw0KICB9DQogIGlmKHR5cGVvZihzZWMpIT0ibnVtYmVyIiB8fCBzZWM8MSB8fCBzZWM+NjApIHsgLy9jaGVjayBpbnRlcnZhbA0KICAgIHNlYyA9IDE7DQogIH0NCiAgaWYodHlwZW9mKHJlbSkhPSJzdHJpbmciKSB7IC8vInJlbWFpbmluZyIgdGV4dA0KICAgIHJlbSA9ICIiOw0KICB9DQogIHNpdHNfcHJvZ3Jlc3NfaXNzID0gaXNzOyAvL3N0b3JlIElTUyBjb2RlDQogIHNpdHNfcHJvZ3Jlc3NfaW50ID0gc2VjKjEwMDA7IC8vc3RvcmUgaW50ZXJ2YWwNCiAgc2l0c19wcm9ncmVzc19jdXIgPSAwOyAvL3Jlc2V0IGNvdW50ZXINCiAgc2l0c19wcm9ncmVzc19ub3cgPSBuZXcgRGF0ZSgpOyAvL3N0b3JlIHN0YXJ0IHRpbWUNCiAgdmFyIGggPSBbXTsgLy9idWlsZCBkaWFsb2cgY29udGVudHMNCiAgaFswXSA9ICI8ZGl2IGNsYXNzPVwic3YtY29udGFpbmVyLWZsdWlkXCI+PGRpdiBjbGFzcz1cInN2LXJvd1wiPiI7DQogIGlmKGlzcykgew0KICAgIGhbaC5sZW5ndGhdID0gIjxkaXYgY2xhc3M9XCJzdi1jb2wtbWQtMTIgc3YtdGV4dC1jZW50ZXJcIj48cCBpZD1cInNpdHNfcHJvZ251bVwiIGRhdGEtbWF4dj1cIlwiPiZuYnNwOzwvcD48L2Rpdj4iOw0KICB9DQogIGVsc2Ugew0KICAgIGhbaC5sZW5ndGhdID0gIjxkaXYgY2xhc3M9XCJzdi1jb2wtbWQtMTIgc3YtdGV4dC1jZW50ZXJcIiBpZD1cInNpdHNfcHJvZ251bVwiIGRhdGEtbWF4dj1cIlwiPiZuYnNwOzwvZGl2PiI7DQogIH0NCiAgaFtoLmxlbmd0aF0gPSAiPC9kaXY+PGRpdiBjbGFzcz1cInN2LXJvd1wiPjxkaXYgY2xhc3M9XCJzdi1jb2wtbWQtMTJcIj48ZGl2IGlkPVwic2l0c19wcm9nYmFyXCI+PC9kaXY+PC9kaXY+PC9kaXY+IjsNCiAgaFtoLmxlbmd0aF0gPSAiPGRpdiBjbGFzcz1cInN2LXJvd1wiPjxkaXYgY2xhc3M9XCJzdi1jb2wtbWQtMTJcIj4mbmJzcDs8L2Rpdj48L2Rpdj4iOw0KICBpZihpc3MgJiYgcmVtKSB7DQogICAgaFtoLmxlbmd0aF0gPSAiPGRpdiBjbGFzcz1cInN2LXJvd1wiPjxkaXYgaWQ9XCJzaXRzX3Byb2dzdW1tXCIgY2xhc3M9XCJzdi1jb2wtbWQtMTIgc3YtdGV4dC1jZW50ZXJcIj4iOw0KICAgIGhbaC5sZW5ndGhdID0gIjxwPjxzcGFuIGlkPVwic2l0c19wcm9nbGFiXCIgY2xhc3M9XCJzdi1oaWRlXCI+IityZW0rIjwvc3Bhbj4mbmJzcDs8c3BhbiBpZD1cInNpdHNfcHJvZ3JlbVwiPjwvc3Bhbj48L3A+PC9kaXY+PC9kaXY+IjsNCiAgfQ0KICBoW2gubGVuZ3RoXSA9ICI8ZGl2IGNsYXNzPVwic3Ytcm93XCI+PGRpdiBpZD1cInNpdHNfcHJvZ21vcmVcIiBjbGFzcz1cInN2LXBhbmVsIHN2LXBhbmVsLWRlZmF1bHQgc3YtaGlkZVwiPiI7DQogIGhbaC5sZW5ndGhdID0gIjxkaXYgY2xhc3M9XCJzdi1wYW5lbC1oZWFkaW5nXCI+PGgyIGNsYXNzPVwic3YtcGFuZWwtdGl0bGVcIj4iOw0KICBoW2gubGVuZ3RoXSA9KHNpdHNfd2lkZ2V0X2JwLnVpICYmIHNpdHNfd2lkZ2V0X2JwLnVpLm1vcmVEZXRhaWxzIHx8ICJNb3JlIERldGFpbHMiKSsiPC9oMj48L2Rpdj48ZGl2IGNsYXNzPVwic3YtcGFuZWwtYm9keVwiPiI7DQogIGhbaC5sZW5ndGhdID0gIjxkaXYgY2xhc3M9XCJzdi1yb3dcIj48ZGl2IGNsYXNzPVwic3YtY29sLW1kLTEyIHN2LXRleHQtY2VudGVyXCI+PHAgaWQ9XCJzaXRzX3Byb2dudW0yXCI+Jm5ic3A7PC9wPjwvZGl2PjwvZGl2PiI7DQogIGhbaC5sZW5ndGhdID0gIjxkaXYgY2xhc3M9XCJzdi1yb3dcIj48ZGl2IGNsYXNzPVwic3YtY29sLW1kLTEyXCI+PGRpdiBpZD1cInNpdHNfcHJvZ2JhcjJcIj48L2Rpdj48L2Rpdj4iOw0KICBoW2gubGVuZ3RoXSA9ICI8L2Rpdj48L2Rpdj48L2Rpdj4iOw0KICBzaXRzX2RpYWxvZyhtZXMsaC5qb2luKCIiKSxudWxsLHRydWUsdHJ1ZSx0cnVlLG51bGwsInNpdHNfcHJvZ2RpYSIsdHJ1ZSw0MDApOyAvL3Nob3cgZGlhbG9nIG1lc3NhZ2UNCiAgc2l0c19jb2xsYXBzaWJsZV9wYW5lbCgiI3NpdHNfcHJvZ21vcmUiLGZhbHNlKTsgLy9jb2xsYXBzZSBtb3JlIGRldGFpbHMgcGFuZWwNCiAgc2l0c19kb19wcm9ncmVzc192YWwoInNpdHNfcHJvZ2JhciIsZmFsc2UpOyAvL2NyZWF0ZSBwcm9ncmVzcyBiYXIoc3RhcnQgaW5kZXRlcm1pbmF0ZSkNCiAgaWYoaXNzICYmIHNpdHNfcHJvZ3Jlc3NfaW50PjApIHsNCiAgICBzaXRzX2Jhcl9idXN5ID0gdHJ1ZTsNCiAgICBzZXRUaW1lb3V0KCJzaXRzX2RvX3Byb2dyZXNzMSgpOyIsc2l0c19wcm9ncmVzc19pbnQpOw0KICB9DQogIGlmKHR5cGVvZihmbmMpIT0iZnVuY3Rpb24iKSB7IC8vY2hlY2sgZm9yIGNhbGxiYWNrIGZ1bmN0aW9uDQogICAgZm5jID0gbnVsbDsNCiAgfQ0KICAkKCIjc2l0c19wcm9nZGlhIikuZGF0YSgiY2FsbGJhY2siLGZuYyk7IC8vc3RvcmUgY2FsbGJhY2sgZnVuY3Rpb24NCiAgcmV0dXJuIHRydWU7DQp9DQoNCi8vSW50ZXJuYWwgZnVuY3Rpb24gdG8gcG9sbCB0aGUgZGF0YWJhc2UNCmZ1bmN0aW9uIHNpdHNfZG9fcHJvZ3Jlc3MxKCkgew0KICBpZihzaXRzX2Jhcl9idXN5KSB7DQogICAgdmFyIGQgPSBudWxsOw0KICAgIGlmKGQ9c2l0c19nZXRfb2JqZWN0KCJzaXRzX3Byb2diYXIiKSkgeyAvL2dldCBwcm9ncmVzcyBiYXIgb2JqZWN0DQogICAgICB2YXIgcGFycyA9IHNpdHNfcHJvZ3Jlc3NfaXNzKyImIitzaXRzX2FqYXhfdmVyc2lvbisiJiIrKCsrc2l0c19wcm9ncmVzc19jdXIpOyAvL2luY3JlYXNlIGNvdW50ZXINCiAgICAgIHZhciBvcHQgPSB7dHlwZToiR0VUIix1cmw6InNpd19kbXUuYmFyX2dldCIsZGF0YTpwYXJzLGRhdGFUeXBlOiJodG1sIixjb21wbGV0ZTpzaXRzX2RvX3Byb2dyZXNzMn07IC8vY3JlYXRlIGFqYXggb3B0aW9ucyBvYmplY3QNCiAgICAgICQuYWpheChvcHQpOyAvL3NlbmQgYWpheCBxdWVyeQ0KICAgIH0NCiAgfQ0KICByZXR1cm4gZmFsc2U7DQp9DQoNCi8vSW50ZXJuYWwgZnVuY3Rpb24gdG8gdXBkYXRlIHRoZSBwcm9ncmVzcyBiYXINCi8vIG9iamVjdCB4bWwgOiBpbiA7dGhlIFhtbEh0dHBSZXF1ZXN0IG9iamVjdCBmcm9tIHRoZSBhamF4IGNhbGwNCi8vIHN0cmluZyBzdHMgOiBpbiA7dGhlIHN0YXR1cyBvZiB0aGUgcmVxdWVzdA0KZnVuY3Rpb24gc2l0c19kb19wcm9ncmVzczIoeG1sLHN0cykgew0KICB2YXIgdHh0ID0geG1sLnJlc3BvbnNlVGV4dDsgLy9nZXQgcmVzcG9uc2UgdGV4dA0KICB2YXIgdGFnID0gdHh0LnN1YnN0cigwLDQpOw0KICB2YXIgdmFsID0gdHh0LnN1YnN0cig0KTsNCiAgdmFyIGQgPSBudWxsOw0KICBpZihkPXNpdHNfZ2V0X29iamVjdCgic2l0c19wcm9nbnVtIikpIHsgLy9jaGVjayBmb3IgZXhpc3RpbmcgZGl2DQogICAgaWYodGFnPT0iPE9LPiIpIHsNCiAgICAgIHZhciBiZWcgPSB2YWwuc3Vic3RyKDAsNCkudG9VcHBlckNhc2UoKTsgLy91cHBlcmNhc2UgZmlyc3QgZm91ciBjaGFyYWN0ZXJzDQogICAgICB2YXIgYmVnMiA9IHZhbC5zdWJzdHIoMCw3KS50b1VwcGVyQ2FzZSgpOw0KICAgICAgaWYodmFsLnN1YnN0cigwLDEpPT0iIyIgfHwgYmVnMj09Ik5FV1NJV18iIHx8YmVnPT0iU0lXXyIgfHwgYmVnPT0iSFRUUCIgfHwgYmVnPT0iQFNJVyIgfHwgYmVnPT0iQExOSyIpIHsgLy9IRVBEMSBQUEwyMTIzMyAtIHByb3ZpZGUgYW4gb3B0aW9uIG9mIGZvcndhcmRpbmcgdG8gYSBsaW5rIGNyZWF0ZWQgYnkgTUVOX1lVUkwNCiAgICAgICAgdmFyIG1heHYgPSBkLmdldEF0dHJpYnV0ZSgiZGF0YS1tYXh2Iik7DQogICAgICAgIGlmKG1heHYpIHsNCiAgICAgICAgICBkLmlubmVySFRNTCA9IG1heHYrIiAvICIrbWF4disiIC0gMTAwJSI7IC8vdXBkYXRlIG51bWJlcnMNCiAgICAgICAgfQ0KICAgICAgICBlbHNlIHsNCiAgICAgICAgICBkLmlubmVySFRNTCA9ICIxMDAlIjsgLy91cGRhdGUgbnVtYmVycw0KICAgICAgICB9DQogICAgICAgIGlmKGQ9c2l0c19nZXRfb2JqZWN0KCJzaXRzX3Byb2dyZW0iKSkgew0KICAgICAgICAgIGQuaW5uZXJIVE1MID0gIjA6MDAiOyAvL3VwZGF0ZSByZW1haW5pbmcNCiAgICAgICAgfQ0KICAgICAgICBzaXRzX2RvX3Byb2dyZXNzX3ZhbCgic2l0c19wcm9nYmFyIiwxMDApOyAvL3VwZGF0ZSBwcm9ncmVzcyBiYXINCiAgICAgICAgc2l0c19iYXJfYnVzeSA9IGZhbHNlOw0KICAgICAgICB2YXIgYnRuID0ge307DQogICAgICAgIHZhciB2YmFyX2Jwb2sgPSBzaXRzX3dpZGdldF9icC51aSAmJiBzaXRzX3dpZGdldF9icC51aS5kaWFsb2dPayB8fCAiT2siOw0KICAgICAgICB2YXIgdmJhcl9icDAxNyA9ICIiOw0KICAgICAgICB2YXIgdmJhcl9icDAxOCA9ICIiOw0KICAgICAgICB2YXIgdmJhcl9icDAxNiA9ICIiOw0KICAgICAgICB2YXIgdmJhcl9icDI1NiA9ICIiOw0KICAgICAgICB0cnkgew0KICAgICAgICAgIHZiYXJfYnAwMTYgPSBiYXJfYnAwMTY7DQogICAgICAgICAgdmJhcl9icDAxNyA9IGJhcl9icDAxNzsNCiAgICAgICAgICB2YmFyX2JwMDE4ID0gYmFyX2JwMDE4Ow0KICAgICAgICB9DQogICAgICAgIGNhdGNoKGVycikgew0KICAgICAgICAgIHZiYXJfYnAwMTcgPSB2YmFyX2Jwb2s7DQogICAgICAgICAgdmJhcl9icDAxOCA9IHNpdHNfd2lkZ2V0X2JwLnVpICYmIHNpdHNfd2lkZ2V0X2JwLnVpLmRpYWxvZ0Nsb3NlIHx8ICJDbG9zZSI7DQogICAgICAgICAgdmJhcl9icDAxNiA9ICJBIGZpbGUgaGFzIGJlZW4gcHJvZHVjZWQgYW5kIGlzIHJlYWR5IHRvIGJlIGRvd25sb2FkZWQiOw0KICAgICAgICB9DQogICAgICAgIHRyeSB7DQogICAgICAgICAgdmJhcl9icDI1NiA9IGJhcl9icDI1NjsNCiAgICAgICAgfQ0KICAgICAgICBjYXRjaChlcnIpIHsNCiAgICAgICAgICB2YmFyX2JwMjU2ID0gIlRoZSBjb250ZW50IGhhcyBiZWVuIHByb2R1Y2VkIGFuZCBpcyByZWFkeSB0byBiZSB2aWV3ZWQgaW4gYSBuZXcgdGFiIG9yIHdpbmRvdyI7DQogICAgICAgIH0NCiAgICAgICAgaWYodmFsLnN1YnN0cigwLDEpPT0iIyIpIHsNCiAgICAgICAgICB2YXIgZm5jID0gJCgiI3NpdHNfcHJvZ2RpYSIpLmRhdGEoImNhbGxiYWNrIik7IC8vZ2V0IGNhbGxiYWNrIGZ1bmN0aW9uDQogICAgICAgICAgc2l0c19kaWFsb2dfY2xvc2UodHJ1ZSwic2l0c19wcm9nZGlhIik7IC8vY2xvc2UgcHJvZ3Jlc3MgYmFyDQogICAgICAgICAgaWYodHlwZW9mKGZuYyk9PSJmdW5jdGlvbiIpIHsNCiAgICAgICAgICAgIGZuYyh0cnVlLHZhbC5zdWJzdHIoMSkpOyAvL2ZpcmUgY2FsbGJhY2sgZnVuY3Rpb24NCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgZWxzZSBpZihiZWc9PSJAU0lXIikgeyAvL3NwZWNpYWwgY2FzZSBmb3Igc2l3X3BvZA0KICAgICAgICAgIGJ0blt2YmFyX2JwMDE4XSA9IGZ1bmN0aW9uKCkgeyAvL2FkZCAiY2FuY2VsIiBidXR0b24NCiAgICAgICAgICAgIHNpdHNfZGlhbG9nX2Nsb3NlKHRydWUsInNpdHNfcHJvZ2RpYSIpOw0KICAgICAgICAgICAgYmFyX2hpZGUoKTsNCiAgICAgICAgICAgIGJhcl9kZWxlKHZhbC5zdWJzdHIoMSkpOw0KICAgICAgICAgIH07DQogICAgICAgICAgYnRuW3ZiYXJfYnAwMTddID0gZnVuY3Rpb24oKSB7IC8vYWRkICJkb3dubG9hZCIgYnV0dG9uDQogICAgICAgICAgICBzaXRzX25hdmlnYXRlKHZhbC5zdWJzdHIoMSkpOyAvL3JlZGlyZWN0IHRvIHVybA0KICAgICAgICAgICAgc2l0c19kaWFsb2dfY2xvc2UodHJ1ZSwic2l0c19wcm9nZGlhIik7DQogICAgICAgICAgICBiYXJfaGlkZSgpOw0KICAgICAgICAgIH07DQogICAgICAgICAgc2l0c19kaWFsb2dfdXBkYXRlKCI8cCByb2xlPVwiYWxlcnRcIj4iK3ZiYXJfYnAwMTYrIjwvcD4iLGJ0biwic2l0c19wcm9nZGlhIik7IC8vdXBkYXRlIGRpYWxvZyBtZXNzYWdlDQogICAgICAgIH0NCiAgICAgICAgZWxzZSBpZihiZWc9PSJATE5LIikgeyAvL0Nhc2UgZm9yIFVSTCBidWlsdCBieSBNRU5fWVVSTA0KICAgICAgICAgIHNpdHNfbmF2aWdhdGUodmFsLnN1YnN0cig0KSk7IC8vcmVkaXJlY3QgdG8gdXJsDQogICAgICAgIH0NCiAgICAgICAgZWxzZSB7DQogICAgICAgICAgaWYoYmVnMj09Ik5FV1NJV18iKSB7DQogICAgICAgICAgICB2YWwgPSB2YWwuc3Vic3RyKDMpOw0KICAgICAgICAgICAgYnRuW3ZiYXJfYnAwMThdID0gZnVuY3Rpb24oKSB7IC8vYWRkICJjYW5jZWwiIGJ1dHRvbg0KICAgICAgICAgICAgICBzaXRzX2RpYWxvZ19jbG9zZSh0cnVlLCJzaXRzX3Byb2dkaWEiKTsNCiAgICAgICAgICAgICAgYmFyX2hpZGUoKTsNCiAgICAgICAgICAgICAgYmFyX2RlbGUodmFsKTsNCiAgICAgICAgICAgIH07DQogICAgICAgICAgICBidG5bdmJhcl9icG9rXSA9IGZ1bmN0aW9uKCkgeyAvL2FkZCAib2siIGJ1dHRvbg0KICAgICAgICAgICAgICB3aW5kb3cub3Blbih2YWwsIl9ibGFuayIpOyAvL29wZW4gdXJsIGluIG5ldyB3aW5kb3cvdGFiDQogICAgICAgICAgICAgIHNpdHNfZGlhbG9nX2Nsb3NlKHRydWUsInNpdHNfcHJvZ2RpYSIpOw0KICAgICAgICAgICAgICBiYXJfaGlkZSgpOw0KICAgICAgICAgICAgfTsNCiAgICAgICAgICAgIHNpdHNfZGlhbG9nX3VwZGF0ZSgiPHAgcm9sZT1cImFsZXJ0XCI+Iit2YmFyX2JwMjU2KyI8L3A+IixidG4sInNpdHNfcHJvZ2RpYSIpOw0KICAgICAgICAgIH0NCiAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgIHNpdHNfbmF2aWdhdGUodmFsKTsgLy9yZWRpcmVjdCB0byB1cmwNCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICB9DQogICAgICBlbHNlIHsNCiAgICAgICAgdmFyIGJvbyA9IHRydWU7DQogICAgICAgIGlmKHZhbCkgeyAvL3Jlc3VsdCByZXR1cm5lZA0KICAgICAgICAgIGlmKHZhbC5zdWJzdHIoMCwxKT09InsiKSB7DQogICAgICAgICAgICBib28gPSBzaXRzX2RvX3Byb2dyZXNzNChkLHZhbCk7IC8vcHJvY2VzcyBKU09OIHJlc3VsdA0KICAgICAgICAgIH0NCiAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgIGJvbyA9IHNpdHNfZG9fcHJvZ3Jlc3MzKGQsdmFsKTsgLy9wcm9jZXNzIHNpbXBsZSByZXN1bHQNCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgICAgaWYoYm9vKSB7IC8vY29udGludWUgcG9sbGluZw0KICAgICAgICAgIHNldFRpbWVvdXQoInNpdHNfZG9fcHJvZ3Jlc3MxKCk7IixzaXRzX3Byb2dyZXNzX2ludCk7DQogICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0NCiAgICAgIH0NCiAgICB9DQogIH0NCiAgdmFyIGVyciA9ICIiOw0KICB2YXIgZGlkID0gInNpdHNfcHJvZ251bSI7DQogIGlmKHRhZz09IjxOTz4iICYmIHZhbC5zdWJzdHIoMCwyMCkhPSI8IS0tIG1lc3NhZ2UgYm94IC0tPiIpIHsNCiAgICBlcnIgPSAiPGRpdiBjbGFzcz1cInN2LXBhbmVsIHN2LXBhbmVsLWRhbmdlciBzdi10ZXh0LWxlZnRcIiByb2xlPVwiYWxlcnRcIj4iOyAvL2NyZWF0ZSBtZXNzYWdlIGJveA0KICAgIGVyciArPSAiPGRpdiBjbGFzcz1cInN2LXBhbmVsLWhlYWRpbmdcIj4mbmJzcDs8L2Rpdj48ZGl2IGNsYXNzPVwic3YtcGFuZWwtYm9keVwiPiIrdmFsKyI8L2Rpdj48L2Rpdj4iOw0KICB9DQogIGVsc2Ugew0KICAgIHZhciBpbzEgPSB0eHQuaW5kZXhPZigiPCEtLSBtZXNzYWdlIGJveCAtLT4iKTsgLy9NRUMgb3IgTUVTDQogICAgaWYoaW8xPi0xKSB7DQogICAgICBpbzEgPSBpbzErMjA7DQogICAgICB2YXIgaW8yID0gdHh0LmluZGV4T2YoIjwhLS0gZW5kIG9mIG1lc3NhZ2UgYm94LS0+Iik7DQogICAgICBlcnIgPSB0eHQuc3Vic3RyKGlvMSxpbzItaW8xKTsgLy9zaG93IG1lc3NhZ2UgYm94DQogICAgICBkaWQgPSAic2l0c19wcm9nZGlhIjsNCiAgICB9DQogICAgZWxzZSB7DQogICAgICBpbzEgPSB0eHQuaW5kZXhPZigiPEgyPlJlc3VsdDo8L0gyPiIpOyAvL1lTT0QNCiAgICAgIGlmKGlvMT4wKSB7DQogICAgICAgIHZhciByZWcgPSBuZXcgUmVnRXhwKCI8L2JvZHk+PC9odG1sPiIsImdpIik7DQogICAgICAgIGVyciA9IHR4dC5zdWJzdHIoaW8xKzE2KS5yZXBsYWNlKHJlZywiIik7IC8vc2hvdyBZU09EDQogICAgICAgIGRpZCA9ICJzaXRzX3Byb2dkaWEiOw0KICAgICAgfQ0KICAgIH0NCiAgfQ0KICBpZihkPXNpdHNfZ2V0X29iamVjdChkaWQpKSB7IC8vZ2V0IG1lc3NhZ2Ugb2JqZWN0DQogICAgaWYoZGlkPT0ic2l0c19wcm9nbnVtIikgew0KICAgICAgc2l0c19oaWRlKCIjc2l0c19wcm9nYmFyLCNzaXRzX3Byb2dzdW1tIik7DQogICAgfQ0KICAgIGQuaW5uZXJIVE1MID0gZXJyOyAvL3Nob3cgZXJyb3IgbWVzc2FnZQ0KICB9DQogIHZhciBidG4gPSB7fTsgLy9jcmVhdGUgYnV0dG9uDQogIHZhciBsYWIgPSBzaXRzX3dpZGdldF9icC51aSAmJiBzaXRzX3dpZGdldF9icC51aS5kaWFsb2dPayB8fCAiT2siOyAvL2J1dHRvbiBsYWJlbA0KICBidG5bbGFiXSA9IGZ1bmN0aW9uKCkgew0KICAgIHNpdHNfZGlhbG9nX2Nsb3NlKHRydWUsInNpdHNfcHJvZ2RpYSIpOw0KICAgIGlmKHR5cGVvZihiYXJfaGlkZSk9PSJmdW5jdGlvbiIpIHsNCiAgICAgIGJhcl9oaWRlKCk7DQogICAgfQ0KICB9Ow0KICBzaXRzX2RpYWxvZ191cGRhdGUoZmFsc2UsYnRuLCJzaXRzX3Byb2dkaWEiKTsgLy9hZGQgIk9rIiBidXR0b24NCiAgc2l0c19kaWFsb2dfcmVzaXplKDYwLCJzaXRzX3Byb2dkaWEiKTsgLy9yZXNpemUgZGlhbG9nDQogIHNpdHNfYmFyX2J1c3kgPSBmYWxzZTsNCiAgdmFyIGZuYyA9ICQoIiNzaXRzX3Byb2dkaWEiKS5kYXRhKCJjYWxsYmFjayIpOyAvL2dldCBjYWxsYmFjayBmdW5jdGlvbg0KICBpZih0eXBlb2YoZm5jKT09ImZ1bmN0aW9uIikgew0KICAgIGZuYyhmYWxzZSk7IC8vZmlyZSBjYWxsYmFjayBmdW5jdGlvbg0KICB9DQogIHJldHVybiBmYWxzZTsNCn0NCg0KLy9JbnRlcm5hbCBmdW5jdGlvbiB0byBjYWxjdWxhdGUgdmFsdWUgZnJvbSBzaW1wbGUgcmVzdWx0DQovLyBlbGVtZW50IGQgIDogaW4gO3RoZSBwcm9ncmVzcyBiYXIgdGV4dCB3cmFwcGVyDQovLyBzdHJpbmcgdmFsIDogaW4gO3RoZSBwcm9ncmVzcyB2YWx1ZShlZy4gIjEvMTAwIikNCmZ1bmN0aW9uIHNpdHNfZG9fcHJvZ3Jlc3MzKGQsdmFsKSB7DQogIGlmKCQoIiNzaXRzX3Byb2dtb3JlOnZpc2libGUiKS5sZW5ndGg+MCkgeyAvL2hpZGUgc2Vjb25kIHByb2dyZXNzIGJhciAoaW4gY2FzZSBzd2l0Y2hpbmcgbW9kZSkNCiAgICBzaXRzX2hpZGUoIiNzaXRzX3Byb2dtb3JlOnZpc2libGUiKTsNCiAgICBzaXRzX2RvX3Byb2dyZXNzX3ZhbCgic2l0c19wcm9nYmFyIiwwKTsgLy9yZXNldCBwcm9ncmVzcyBiYXINCiAgfQ0KICBpZih2YWwuaW5kZXhPZigiKiIpPT0wKSB7DQogICAgcmV0dXJuIHNpdHNfZG9fcHJvZ3Jlc3NfdmFsKCJzaXRzX3Byb2diYXIiLGZhbHNlKTsgLy9pbmRldGVybWluYXRlIHByb2dyZXNzIGJhcg0KICB9DQogIHZhciBhcnIgPSB2YWwuc3BsaXQoIi8iKTsgLy92YWx1ZSBpcyBzZXQNCiAgaWYoYXJyLmxlbmd0aD09Mikgew0KICAgIHZhciBjdXIgPSBwYXJzZUludChhcnJbMF0sMTApOw0KICAgIHZhciB0b3QgPSBwYXJzZUludChhcnJbMV0sMTApOw0KICAgIHZhciBwZXIgPSBwYXJzZUludChjdXIqMTAwL3RvdCwxMCk7IC8vY2FsY3VsYXRlIHBlcmNlbnRhZ2UNCiAgICBkLnNldEF0dHJpYnV0ZSgiZGF0YS1tYXh2IixhcnJbMV0pOyAvL3VwZGF0ZSBtYXhpbXVtIHZhbHVlDQogICAgZC5pbm5lckhUTUwgPSBhcnJbMF0rIiAvICIrYXJyWzFdKyIgLSAiK3BlcisiJSI7IC8vdXBkYXRlIG51bWJlcnMNCiAgICBpZihjdXI+MCkgew0KICAgICAgaWYoZD1zaXRzX2dldF9vYmplY3QoInNpdHNfcHJvZ3JlbSIpKSB7DQogICAgICAgIHZhciBkaWYgPSgobmV3IERhdGUoKSktc2l0c19wcm9ncmVzc19ub3cpLzEwMDA7IC8vY2FsY3VsYXRlIHRvdGFsIHNlY29uZHMNCiAgICAgICAgdmFyIHJlbSA9IHBhcnNlSW50KChkaWYqdG90L2N1ciktZGlmLDEwKTsgLy9jYWxjdWxhdGUgcmVtYWluaW5nIHNlY29uZHMNCiAgICAgICAgdmFyIHByZSA9IGQuaW5uZXJIVE1MOyAvL2dldCBwcmV2aW91cyB2YWx1ZQ0KICAgICAgICBpZihwcmUuaW5kZXhPZigiOiIpPjApIHsNCiAgICAgICAgICBhcnIgPSBwcmUuc3BsaXQoIjoiKTsNCiAgICAgICAgICBwcmUgPShhcnJbMF0qNjApKyhhcnJbMV0qMSk7IC8vY2FsY3VsYXRlIHByZXZpb3VzIHNlY29uZHMNCiAgICAgICAgICByZW0gPSgocmVtKjAuNTUpKyhwcmUqMC40NSkpOyAvL2NhbGN1bGF0ZSBydW5uaW5nIGF2ZXJhZ2UNCiAgICAgICAgfQ0KICAgICAgICB2YXIgbSA9IE1hdGgubWF4KE1hdGguZmxvb3IocmVtLzYwKSwwKTsgLy9zZXBhcmF0ZSBtaW51dGVzIGFuZCBzZWNvbmRzDQogICAgICAgIHZhciBzID0gTWF0aC5tYXgocGFyc2VJbnQocmVtJTYwLDEwKSwwKTsNCiAgICAgICAgZC5pbm5lckhUTUwgPSBtKyI6IitzaXRzX2xlZnRfcGFkKHMsMiwiMCIpOyAvL3VwZGF0ZSByZW1haW5pbmcgdGltZQ0KICAgICAgICBzaXRzX3Nob3coIiNzaXRzX3Byb2dsYWIiKTsgLy9zaG93IGxhYmVsDQogICAgICB9DQogICAgfQ0KICAgIHNpdHNfZG9fcHJvZ3Jlc3NfdmFsKCJzaXRzX3Byb2diYXIiLHBlcik7IC8vdXBkYXRlIHByb2dyZXNzIGJhcg0KICAgIHJldHVybiB0cnVlOw0KICB9DQogIHJldHVybiBmYWxzZTsNCn0NCg0KLy9JbnRlcm5hbCBmdW5jdGlvbiB0byBjYWxjdWxhdGUgdmFsdWUgZnJvbSBKU09OIHJlc3VsdA0KLy8gZWxlbWVudCBkICA6IGluIDt0aGUgcHJvZ3Jlc3MgYmFyIHRleHQgd3JhcHBlcg0KLy8gc3RyaW5nIHZhbCA6IGluIDt0aGUgcHJvZ3Jlc3MgdmFsdWUgYXMgYSBKU09OIHN0cmluZw0KZnVuY3Rpb24gc2l0c19kb19wcm9ncmVzczQoZCx2YWwpIHsNCiAgdmFyIG9iaiA9IHNpdHNfcGFyc2VfanNvbih2YWwpOw0KICBpZihvYmogJiYgb2JqLmRhdGEpIHsNCiAgICB2YXIgb25lY3VyID0gMDsNCiAgICB2YXIgb25ldG90ID0gMDsNCiAgICB2YXIgYWxsY3VyID0gMDsNCiAgICB2YXIgYWxsdG90ID0gMDsNCiAgICB2YXIgcGVyID0gMDsNCiAgICB2YXIgb25ldHh0ID0gIiI7DQogICAgdmFyIGFsbHR4dCA9IG9iai50ZXh0IHx8ICIiOw0KICAgIHZhciBhcnIgPSBvYmouZGF0YTsNCiAgICB2YXIgc3RhY3VyID0gYXJyLmxlbmd0aDsgLy9udW1iZXIgb2Ygc3RhZ2VzDQogICAgdmFyIHN0YXRvdCA9IGFyci5sZW5ndGg7DQogICAgZm9yKHZhciBpPTA7aTxzdGF0b3Q7aSsrKSB7DQogICAgICBvYmogPSBhcnJbaV07DQogICAgICB2YXIgY3VyID0gcGFyc2VJbnQob2JqLmN1ciwxMCk7DQogICAgICB2YXIgdG90ID0gcGFyc2VJbnQob2JqLnRvdCwxMCk7DQogICAgICBpZihvbmV0b3Q9PTAgJiYgY3VyPHRvdCkgeyAvL2N1cnJlbnQgc3RhZ2UNCiAgICAgICAgb25lY3VyID0gY3VyOw0KICAgICAgICBvbmV0b3QgPSB0b3Q7DQogICAgICAgIG9uZXR4dCA9IG9iai50eHQgfHwgIiI7DQogICAgICAgIHN0YWN1ciA9IGkrMTsNCiAgICAgIH0NCiAgICAgIGFsbGN1ciArPSBjdXI7IC8vYWxsIHN0YWdlcw0KICAgICAgYWxsdG90ICs9IHRvdDsNCiAgICB9DQogICAgJChkKS5hdHRyKCJkYXRhLW1heHYiLCIiKS5odG1sKGFsbHR4dCk7IC8vdXBkYXRlIHN0YXR1cyB0ZXh0DQogICAgaWYoYWxsY3VyPjApIHsNCiAgICAgIGlmKGQ9c2l0c19nZXRfb2JqZWN0KCJzaXRzX3Byb2dyZW0iKSkgew0KICAgICAgICB2YXIgZGlmID0oKG5ldyBEYXRlKCkpLXNpdHNfcHJvZ3Jlc3Nfbm93KS8xMDAwOyAvL2NhbGN1bGF0ZSB0b3RhbCBzZWNvbmRzDQogICAgICAgIHZhciByZW0gPSBwYXJzZUludCgoZGlmKmFsbHRvdC9hbGxjdXIpLWRpZiwxMCk7IC8vY2FsY3VsYXRlIHJlbWFpbmluZyBzZWNvbmRzDQogICAgICAgIHZhciBwcmUgPSBkLmlubmVySFRNTDsgLy9nZXQgcHJldmlvdXMgdmFsdWUNCiAgICAgICAgaWYocHJlLmluZGV4T2YoIjoiKT4wKSB7DQogICAgICAgICAgYXJyID0gcHJlLnNwbGl0KCI6Iik7DQogICAgICAgICAgcHJlID0oYXJyWzBdKjYwKSsoYXJyWzFdKjEpOyAvL2NhbGN1bGF0ZSBwcmV2aW91cyBzZWNvbmRzDQogICAgICAgICAgcmVtID0oKHJlbSowLjU1KSsocHJlKjAuNDUpKTsgLy9jYWxjdWxhdGUgcnVubmluZyBhdmVyYWdlDQogICAgICAgIH0NCiAgICAgICAgdmFyIG0gPSBNYXRoLm1heChNYXRoLmZsb29yKHJlbS82MCksMCk7IC8vc2VwYXJhdGUgbWludXRlcyBhbmQgc2Vjb25kcw0KICAgICAgICB2YXIgcyA9IE1hdGgubWF4KHBhcnNlSW50KHJlbSU2MCwxMCksMCk7DQogICAgICAgIGQuaW5uZXJIVE1MID0gbSsiOiIrc2l0c19sZWZ0X3BhZChzLDIsIjAiKTsgLy91cGRhdGUgcmVtYWluaW5nIHRpbWUNCiAgICAgICAgc2l0c19zaG93KCIjc2l0c19wcm9nbGFiIik7IC8vc2hvdyBsYWJlbA0KICAgICAgfQ0KICAgIH0NCiAgICBwZXIgPSBwYXJzZUludChhbGxjdXIqMTAwL2FsbHRvdCwxMCk7IC8vY2FsY3VsYXRlIHBlcmNlbnRhZ2UNCiAgICBzaXRzX2RvX3Byb2dyZXNzX3ZhbCgic2l0c19wcm9nYmFyIixwZXIpOyAvL3VwZGF0ZSBwcm9ncmVzcyBiYXINCiAgICBkID0gJCgiI3NpdHNfcHJvZ21vcmUiKTsgLy9zZWNvbmQgcHJvZ3Jlc3MgYmFyDQogICAgaWYoZC5sZW5ndGg9PTEpIHsNCiAgICAgIGlmKGQuaGFzQ2xhc3MoInN2LWhpZGUiKSkgeyAvL2N1cnJlbnRseSBoaWRkZW4NCiAgICAgICAgc2l0c19kb19wcm9ncmVzc192YWwoInNpdHNfcHJvZ2JhcjIiLDApOyAvL2NyZWF0ZSBwcm9ncmVzcyBiYXINCiAgICAgICAgZC5zbGlkZURvd24oc2l0c19hbmltX3NwZWVkKTsgLy9kaXNwbGF5IG1pbmltaXNlZA0KICAgICAgfQ0KICAgICAgJCgiI3NpdHNfcHJvZ251bTIiKS5odG1sKG9uZXR4dCk7IC8vdXBkYXRlIHN0YWdlIHRleHQNCiAgICAgIHBlciA9IHBhcnNlSW50KG9uZWN1cioxMDAvb25ldG90LDEwKTsgLy9jYWxjdWxhdGUgcGVyY2VudGFnZQ0KICAgICAgc2l0c19kb19wcm9ncmVzc192YWwoInNpdHNfcHJvZ2JhcjIiLHBlcik7IC8vdXBkYXRlIHByb2dyZXNzIGJhcg0KICAgIH0NCiAgICByZXR1cm4gdHJ1ZTsNCiAgfQ0KICByZXR1cm4gZmFsc2U7DQp9DQoNCi8vSW50ZXJuYWwgZnVuY3Rpb24gdG8gc2V0IHByb2dyZXNzIGJhciB2YWx1ZQ0KLy8gc3RyaW5nIGlkIDogaW4gO3RoZSBJRCBvZiB0aGUgcHJvZ3Jlc3MgYmFyDQovLyBhbnkgdmFsIDogaW4gO3RoZSBwcm9ncmVzcyB2YWx1ZQ0KZnVuY3Rpb24gc2l0c19kb19wcm9ncmVzc192YWwoaWQsdmFsKSB7DQogIHZhciBvYmogPSAkKCIjIitzaXRzX2VzY2FwZV9zZWxlY3RvcihpZCkpOw0KICBpZihvYmoubGVuZ3RoIT09MSkgew0KICAgIHJldHVybiBmYWxzZTsgLy9vbmx5IGhhbmRsZSBvbmUgcHJvZ3Jlc3MgYmFyDQogIH0NCiAgdmFyIHRyYSA9ICIiOyAvL25vIHRyYW5zaXRpb24gYnkgZGVmYXVsdA0KICBpZih2YWw9PT1mYWxzZSkgeyAvL2luZGV0ZXJtaW5hdGUgcHJvZ3Jlc3MgYmFyDQogICAgaWYoaWQ9PSJzaXRzX3Byb2diYXIiICYmIG9iai5kYXRhKCJ1aS1wcm9ncmVzc2JhciIpICYmIG9iai5wcm9ncmVzc2JhcigidmFsdWUiKSE9PWZhbHNlKSB7DQogICAgICAkKCIjc2l0c19wcm9nbnVtLCNzaXRzX3Byb2dzdW1tIikuaHRtbCgiIik7IC8vaGlkZSBvdGhlciBiaXRzDQogICAgfQ0KICB9DQogIGVsc2UgeyAvL3Byb3BlciBwcm9ncmVzcyBiYXINCiAgICBpZih2YWw8MTAwKSB7DQogICAgICBpZihvYmouZGF0YSgidWktcHJvZ3Jlc3NiYXIiKSAmJiBvYmoucHJvZ3Jlc3NiYXIoInZhbHVlIik9PT1mYWxzZSkgew0KICAgICAgICBvYmoucHJvZ3Jlc3NiYXIoe3ZhbHVlOjB9KTsgLy9yZXNldCB0byB6ZXJvDQogICAgICAgIG9iai5maW5kKCJpbWciKS5yZW1vdmUoKTsNCiAgICAgIH0NCiAgICAgIHRyYSA9ICJ3aWR0aCAxcyI7IC8vc2xvdyB0cmFuc2l0aW9uDQogICAgfQ0KICAgIGVsc2Ugew0KICAgICAgdmFsID0gMTAwOyAvLzEwMCUgbWF4aW11bQ0KICAgIH0NCiAgfQ0KICBvYmouZmluZCgiLnVpLXByb2dyZXNzYmFyLXZhbHVlIikuY3NzKCJ0cmFuc2l0aW9uIix0cmEpOyAvL3NldCB0cmFuc2l0aW9uDQogIG9iai5wcm9ncmVzc2Jhcih7dmFsdWU6dmFsfSk7IC8vY3JlYXRlIHByb2dyZXNzIGJhcg0KICByZXR1cm4gdHJ1ZTsNCn0NCg0KLy9OYXZpZ2F0ZXMgdG8gYSBwYXJ0aWN1bGFyIHVybCwgYWZ0ZXIgYSBkZWxheQ0KLy8gc3RyaW5nIHVybCA6IGluIDt0aGUgdXJsIHRvIG5hdmlnYXRlIHRvDQpmdW5jdGlvbiBzaXRzX25hdmlnYXRlKHVybCkgew0KICBpZih0eXBlb2YodXJsKT09InN0cmluZyIgJiYgdXJsLmxlbmd0aD41KSB7DQogICAgc2V0VGltZW91dCgid2luZG93LmxvY2F0aW9uID0gJyIrdXJsKyInOyIsMTAwKTsgLy9yZWRpcmVjdCB0byB1cmwNCiAgICByZXR1cm4gdHJ1ZTsNCiAgfQ0KICByZXR1cm4gZmFsc2U7DQp9DQoNCi8vUmV0dXJucyBhbGwgdGhlIHBvc3QgZGF0YSBmcm9tIHRoZSBmaXJzdCBmb3JtIG9uIHRoZSBwYWdlDQovLyBzdHJpbmcgIGZpZCAgOiBpbiA7dGhlIGlkIG9mIHRoZSBmb3JtIHlvdSB3YW50IHRvIHN1Ym1pdA0KLy8gc3RyaW5nICBiaWQgIDogaW4gO3RoZSBpZCBvZiB0aGUgYnV0dG9uIHByZXNzIHlvdSBhcmUgc2ltdWxhdGluZw0KZnVuY3Rpb24gc2l0c19mb3JtX2RhdGEoZmlkLGJpZCkgew0KICB2YXIgZCA9ICIiOw0KICB2YXIgbSA9ICIiOw0KICB2YXIgZiA9IG51bGw7DQogIGlmKHR5cGVvZihmaWQpPT0ic3RyaW5nIiAmJiBmaWQubGVuZ3RoPjApIHsNCiAgICBmID0gc2l0c19nZXRfb2JqZWN0KGZpZCk7IC8vZ2V0IHNwZWNpZmllZCBmb3JtIG9iamVjdA0KICB9DQogICBpZih0eXBlb2YoZmlkKT09Im9iamVjdCIgJiYgZmlkLnRhZ05hbWU9PSJGT1JNIikgew0KICAgIGYgPSBmaWQ7IC8vZ2V0IHNwZWNpZmllZCBmb3JtIG9iamVjdA0KICB9DQogIGlmKCFmKSB7DQogICAgZiA9IGRvY3VtZW50LmZvcm1zWzBdOyAvL2dldCBmaXJzdCBmb3JtIG9iamVjdA0KICAgIGlmKCFmKSB7DQogICAgICByZXR1cm4gbnVsbDsNCiAgICB9DQogIH0NCiAgdmFyIGEgPSBmLmVsZW1lbnRzOyAvL2dldCBhbGwgZWxlbWVudHMgb24gdGhlIGZvcm0NCiAgdmFyIGwgPSBhLmxlbmd0aDsNCiAgZm9yKHZhciBpPTA7aTxsO2krKykgeyAvL2xvb3AgdGhyb3VnaCBlbGVtZW50cw0KICAgIHZhciB0ID0gYVtpXTsNCiAgICBpZih0LnRhZ05hbWUhPSJTVUJNSVQiICYmICEodC50YWdOYW1lPT0iSU5QVVQiICYmIHQudHlwZT09InN1Ym1pdCIpKSB7IC8vaWdub3JlIGJ1dHRvbnMNCiAgICAgIHZhciBuID0gdC5uYW1lIHx8ICIiIDsNCiAgICAgIGlmKG4hPW0gICYmIG4gIT0gIiIpIHsgLy9jaGVjayBmb3IgZHVwbGljYXRlIG5hbWVzDQogICAgICAgIGQgKz0gIiYiK3NpdHNfZXNjYXBlX3VybChuKSsiPSIrc2l0c19lc2NhcGVfdXJsKHNpdHNfZ2V0X3ZhbHVlKHQpKTsgLy9idWlsZCBkYXRhIHN0cmluZw0KICAgICAgICBtID0gbjsgLy9zdG9yZSBwcmV2aW91cyBuYW1lKGZvciBkdXBsaWNhdGUgY2hlY2spDQogICAgICB9DQogICAgfQ0KICB9DQogIGlmKGQpIHsgLy9kYXRhIGFuZCBidXR0b24gaWQgc3BlY2lmaWVkDQogICAgaWYoYmlkKSB7DQogICAgICB2YXIgYiA9IHNpdHNfZ2V0X29iamVjdChiaWQpOyAvL2dldCBidXR0b24gb2JqZWN0DQogICAgICBpZihiKSB7DQogICAgICAgIGQgPSBiLm5hbWUrIj0iK2IudmFsdWUrZDsgLy9wcmVmaXggYnV0dG9uIHZhbHVlIHRvIGRhdGEgc3RyaW5nDQogICAgICB9DQogICAgfQ0KICAgIGVsc2Ugew0KICAgICAgZCA9IGQuc3Vic3RyKDEpOyAvL3JlbW92ZSBsZWFkaW5nIGFtcGVyc2FuZA0KICAgIH0NCiAgICByZXR1cm4gZDsNCiAgfQ0KICByZXR1cm4gbnVsbDsNCn0NCg0KLy9BZGQgYSBkYXRlIHBpY2tlciB0byBhbiBpbnB1dCBmaWVsZChQUEwwMTM5OTQvMDI4NjMzKQ0KLy8gc3RyaW5nICAgc2VsICA6IGluIDtqUXVlcnkgc2VsZWN0b3IgdG8gYXBwbHkgdGhlIGRhdGUgcGlja2VyIHRvDQovLyBib29sZWFuICBpY28gIDogaW4gO3Nob3cgaWNvbiBuZXh0IHRvIGZpZWxkKGRlZmF1bHQgaXMgdHJ1ZSkNCi8vIHN0cmluZyAgbWluZCAgOiBpbiA7bWluaW11bSBkYXRlKGllOiAiLTF5IC0xbSIpIC0gY2FuIGFsc28gYmUgbnVtZXJpYyBudW1iZXIgb2YgZGF5cygtNykNCi8vIHN0cmluZyAgbWF4ZCAgOiBpbiA7bWF4aW11bSBkYXRlKGllOiAiKzF5ICsxbSIpIC0gY2FuIGFsc28gYmUgbnVtZXJpYyBudW1iZXIgb2YgZGF5cygrNykNCi8vIGZ1bmN0aW9uIGZuYyAgOiBpbiA7Y2FsbGJhY2sgZnVuY3Rpb24gd2hlbiBkYXRlIHNlbGVjdGVkDQpmdW5jdGlvbiBzaXRzX2RhdGVfcGlja2VyKHNlbCxpY28sbWluZCxtYXhkLGZuYykgew0KICB2YXIgbG9jID0gc2l0c19taW5pZmllZF9wYXRoKCIuLi9wbHVnaW5zL2phdmFzY3JpcHQvIiwibW9kZXJuaXpyLmpzIiwibW9kZXJuaXpyLm1pbi5qcyIpOw0KICBpZihzaXRzX25hdGl2ZV93aWRnZXRzPDEgfHwgc2l0c19maWxlc19hcnJheVtsb2NdPT0iWSIpIHsgLy9hbHJlYWR5IGxvYWRlZC4uLg0KICAgIHNpdHNfZG9fZGF0ZV9waWNrZXIoc2VsLGljbyxtaW5kLG1heGQsZm5jKTsgLy8uLi5zbyBjYWxsIHN0cmFpZ2h0IGF3YXkNCiAgfQ0KICBlbHNlIHsgLy9ub3QgbG9hZGVkIHlldC4uLg0KICAgIHZhciBwYXIgPSB7fTsgLy9jcmVhdGUgYW4gb2JqZWN0IG9mIHBhcmFtZXRlcnMNCiAgICBwYXIudXJsID0gbG9jOw0KICAgIHBhci5mbmMgPSBzaXRzX2RvX2RhdGVfcGlja2VyOw0KICAgIHBhci5wMDEgPSBzZWw7DQogICAgcGFyLnAwMiA9IGljbzsNCiAgICBwYXIucDAzID0gbWluZDsNCiAgICBwYXIucDA0ID0gbWF4ZDsNCiAgICBwYXIucDA1ID0gZm5jOw0KICAgIHZhciBsZW4gPSBzaXRzX3BhcmFtX2FycmF5LnB1c2gocGFyKTsgLy9zYXZlIGZvciBsYXRlcg0KICAgIHNpdHNfaW5jbHVkZV9maWxlKGxvYyk7DQogIH0NCiAgcmV0dXJuIHRydWU7DQp9DQoNCi8vSW50ZXJuYWwgZnVuY3Rpb24gdG8gYWRkIGEgZGF0ZSBwaWNrZXIgdG8gYW4gaW5wdXQgZmllbGQoUFBMMDI4NjMzKQ0KLy8gc3RyaW5nICAgc2VsICA6IGluIDtqUXVlcnkgc2VsZWN0b3IgdG8gYXBwbHkgdGhlIGRhdGUgcGlja2VyIHRvDQovLyBib29sZWFuICBpY28gIDogaW4gO3Nob3cgaWNvbiBuZXh0IHRvIGZpZWxkKGRlZmF1bHQgaXMgdHJ1ZSkNCi8vIHN0cmluZyAgbWluZCAgOiBpbiA7bWluaW11bSBkYXRlKGllOiAiLTF5IC0xbSIpIC0gY2FuIGFsc28gYmUgbnVtZXJpYyBudW1iZXIgb2YgZGF5cygtNykNCi8vIHN0cmluZyAgbWF4ZCAgOiBpbiA7bWF4aW11bSBkYXRlKGllOiAiKzF5ICsxbSIpIC0gY2FuIGFsc28gYmUgbnVtZXJpYyBudW1iZXIgb2YgZGF5cygrNykNCi8vIGZ1bmN0aW9uIGZuYyAgOiBpbiA7Y2FsbGJhY2sgZnVuY3Rpb24gd2hlbiBkYXRlIHNlbGVjdGVkDQpmdW5jdGlvbiBzaXRzX2RvX2RhdGVfcGlja2VyKHNlbCxpY28sbWluZCxtYXhkLGZuYykgew0KICBpZigodHlwZW9mKHNlbCk9PSJzdHJpbmciICYmIHNlbC5sZW5ndGg+MCkgfHwgdHlwZW9mKHNlbCk9PSJvYmplY3QiKSB7IC8vY2hlY2sgZmlyc3QgcGFyYW1ldGVyDQogICAgdmFyIGJvbyA9IGZhbHNlOw0KICAgIHN3aXRjaChzaXRzX25hdGl2ZV93aWRnZXRzKSB7DQogICAgICBjYXNlIDE6DQogICAgICAgIGlmKHR5cGVvZihNb2Rlcm5penIpPT0ib2JqZWN0IiAmJiBNb2Rlcm5penIuaW5wdXR0eXBlcy5kYXRlICYmIE1vZGVybml6ci50b3VjaCkgew0KICAgICAgICAgIGJvbyA9IHRydWU7IC8vdXNlIG5hdGl2ZSB3aWRnZXQgaWYgYXZhaWxhYmxlIGFuZCB0b3VjaCBkZXZpY2UNCiAgICAgICAgfQ0KICAgICAgICBicmVhazsNCiAgICAgIGNhc2UgMjoNCiAgICAgICAgaWYodHlwZW9mKE1vZGVybml6cik9PSJvYmplY3QiICYmIE1vZGVybml6ci5pbnB1dHR5cGVzLmRhdGUpIHsNCiAgICAgICAgICBib28gPSB0cnVlOyAvL3VzZSBuYXRpdmUgd2lkZ2V0IGlmIGF2YWlsYWJsZQ0KICAgICAgICB9DQogICAgICAgIGJyZWFrOw0KICAgIH0NCiAgICBpZihib28pIHsgLy91c2UgbmF0aXZlIHdpZGdldA0KICAgICAgdmFyIG9iaiA9ICQoc2VsKTsgLy9nZXQgb2JqZWN0IGFycmF5DQogICAgICBpZihvYmoubGVuZ3RoPjApIHsNCiAgICAgICAgb2JqLmVhY2goZnVuY3Rpb24oaSkgew0KICAgICAgICAgIGlmKHRoaXMudmFsdWUhPSIiKSB7DQogICAgICAgICAgICB0aGlzLnZhbHVlID0gc2l0c19kYXRlX3RvX2F0b20odGhpcy52YWx1ZSkgLy9jb252ZXJ0IHZhbHVlDQogICAgICAgICAgfQ0KICAgICAgICAgIHRoaXMudHlwZSA9ICJkYXRlIjsgLy9jaGFuZ2UgaW5wdXQgdHlwZQ0KICAgICAgICAgIGlmKHR5cGVvZihtaW5kKT09InN0cmluZyIgJiYgbWluZCE9IiIpIHsNCiAgICAgICAgICAgIHRoaXMubWluID0gc2l0c19kYXRlX3RvX2F0b20obWluZCk7IC8vbWluaW11bSBkYXRlDQogICAgICAgICAgfQ0KICAgICAgICAgIGlmKHR5cGVvZihtYXhkKT09InN0cmluZyIgJiYgbWF4ZCE9IiIpIHsNCiAgICAgICAgICAgIHRoaXMubWF4ID0gc2l0c19kYXRlX3RvX2F0b20obWF4ZCk7IC8vbWF4aW11bSBkYXRlDQogICAgICAgICAgfQ0KICAgICAgICB9KTsNCiAgICAgICAgaWYodHlwZW9mKGZuYyk9PSJmdW5jdGlvbiIpIHsNCiAgICAgICAgICBvYmouY2hhbmdlKGZuYyk7IC8vcmVnaXN0ZXIgb24gY2hhbmdlIGV2ZW50DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICB9DQogICAgICByZXR1cm4gZmFsc2U7DQogICAgfQ0KICAgIHJldHVybiBzaXRzX3VpX2RhdGVfcGlja2VyKHNlbCxpY28sbWluZCxtYXhkLGZuYyk7IC8vZmFsbCBiYWNrIHRvIGpRdWVyeSBVSQ0KICB9DQogIHJldHVybiBmYWxzZTsNCn0NCg0KLy9GdW5jdGlvbiB0byBjb252ZXJ0IGEgbG9jYWxpc2VkIGRhdGUgc3RyaW5nIGludG8gSVNPLTg2MDEgZGF0ZSBmb3JtYXQoUFBMMDI4NjMzKQ0KZnVuY3Rpb24gc2l0c19kYXRlX3RvX2F0b20odmFsdSkgew0KICBpZih0eXBlb2YodmFsdSk9PSJzdHJpbmciICYmIHZhbHUhPSIiICYmIHZhbHUubGVuZ3RoPjUpIHsNCiAgICBpZih2YWx1LnN1YnN0cig0LDEpIT0iLSIgfHwgdmFsdS5zdWJzdHIoNiwxKSE9Ii0iKSB7DQogICAgICBpZihzaXRzX2RhdGVzX2NhY2hlW3ZhbHVdKSB7IC8vY2hlY2sgY2FjaGUgZm9yIGNvbnZlcnRlZCB2YWx1ZQ0KICAgICAgICByZXR1cm4gc2l0c19kYXRlc19jYWNoZVt2YWx1XTsNCiAgICAgIH0NCiAgICAgIHZhciBvcmlnID0gdmFsdTsgLy9zdG9yZSBvcmlnaW5hbCB2YWx1ZQ0KICAgICAgdmFsdSA9IHNpdHNfZGF0ZV9jb252ZXJ0KHNpdHNfZGF0ZV9mb3JtYXQsInl5LW1tLWRkIix2YWx1KSB8fCBvcmlnOyAvL2NvbnZlcnQgZGF0ZSBmb3JtYXQNCiAgICAgIGlmKHZhbHU9PW9yaWcpIHsgLy9mYWlsZWQgdG8gY29udmVydCBkYXRlDQogICAgICAgIHZhbHUgPSBzaXRzX2RhdGVfdG9fc3RyaW5nKHZhbHUsInl5LW1tLWRkIikgfHwgb3JpZzsgLy90cnkgY29udmVydGluZyBVbmlmYWNlIGRhdGUgc3RyaW5nIGludG8gZGF0ZQ0KICAgICAgfQ0KICAgICAgaWYodmFsdT09b3JpZykgeyAvL2ZhaWxlZCB0byBjb252ZXJ0IGRhdGUNCiAgICAgICAgdmFyIGFyciA9IFtdOw0KICAgICAgICB2YWx1ID0gc2l0c19yZXBsYWNlKHZhbHUsIiAiLCIvIik7IC8vZml4IG90aGVyIGRlbGltaXRlcnMNCiAgICAgICAgdmFsdSA9IHNpdHNfcmVwbGFjZSh2YWx1LCItIiwiLyIpOw0KICAgICAgICB2YWx1ID0gc2l0c19yZXBsYWNlKHZhbHUsIi4iLCIvIik7DQogICAgICAgIHZhbHUgPSBzaXRzX3JlcGxhY2UodmFsdSwiLy8iLCIvIik7DQogICAgICAgIHZhciBiYWNrID0gdmFsdTsgLy9zdG9yZSBiYWNrdXAgdmFsdWUNCiAgICAgICAgc3dpdGNoKHNpdHNfZGF0ZV9mb3JtYXQuc3Vic3RyKDAsMSkudG9VcHBlckNhc2UoKSkgeyAvL3RyeSBvdGhlciBmb3JtYXRzIGJhc2VkIG9uIHJlZ2lvbiBhbmQgbGVuZ3RoDQogICAgICAgICAgY2FzZSAiRCI6IC8vZGF5IGZpcnN0IC0gQnJpdGlzaD8NCiAgICAgICAgICAgIHN3aXRjaChvcmlnLmxlbmd0aCkgew0KICAgICAgICAgICAgICBjYXNlIDY6DQogICAgICAgICAgICAgICAgYXJyID0gWyJkL20veSIsIm0vZC95IiwieS9tL2QiXTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgY2FzZSA3Og0KICAgICAgICAgICAgICAgIGFyciA9IFsiZC9tL3kiLCJkZC9tL3kiLCJkL21tL3kiLCJtL2QveSIsIm0vZGQveSIsIm1tL2QveSIsInkvbS9kIiwieS9tL2RkIiwieS9tbS9kIl07DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgIGNhc2UgODoNCiAgICAgICAgICAgICAgICBhcnIgPSBbImQvbS95IiwiZGQvbS95IiwiZC9tbS95IiwiZGQvbW0veSIsImQvbS95eSIsImQvTS95IiwiZC9NTS95IiwibS9kL3kiLCJtL2RkL3kiLCJtbS9kL3kiLCJtbS9kZC95IiwibS9kL3l5IiwiTS9kL3kiLCJNTS9kL3kiLCJ5L20vZCIsInkvbS9kZCIsInkvbW0vZCIsInkvbW0vZGQiLCJ5eS9tL2QiLCJ5L00vZCIsInkvTU0vZCJdOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICBjYXNlIDk6DQogICAgICAgICAgICAgICAgYXJyID0gWyJkL20veXkiLCJkZC9tL3l5IiwiZC9tbS95eSIsImQvTS95IiwiZGQvTS95IiwiZC9NTS95IiwiZGQvTU0veSIsIm0vZC95eSIsIm0vZGQveXkiLCJtbS9kL3l5IiwiTS9kL3kiLCJNL2RkL3kiLCJNTS9kL3kiLCJNTS9kZC95IiwieXkvbS9kIiwieXkvbS9kZCIsInl5L21tL2QiLCJ5L00vZCIsInkvTS9kZCIsInkvTU0vZCIsInkvTU0vZGQiXTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgY2FzZSAxMDoNCiAgICAgICAgICAgICAgICBhcnIgPSBbImQvbS95eSIsImRkL20veXkiLCJkL21tL3l5IiwiZGQvbW0veXkiLCJkL01NL3kiLCJkZC9NTS95IiwiZC9NL3l5IiwiZC9NTS95eSIsIm0vZC95eSIsIm0vZGQveXkiLCJtbS9kL3l5IiwibW0vZGQveXkiLCJNTS9kL3kiLCJNTS9kZC95IiwiTS9kL3l5IiwiTU0vZC95eSIsInl5L20vZCIsInl5L20vZGQiLCJ5eS9tbS9kIiwieXkvbW0vZGQiLCJ5L01NL2QiLCJ5L01NL2RkIiwieXkvTS9kIiwieXkvTU0vZCJdOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICBkZWZhdWx0Og0KICAgICAgICAgICAgICAgIGlmKG9yaWcubGVuZ3RoPjEwKSB7DQogICAgICAgICAgICAgICAgICBhcnIgPSBbImQvTU0veSIsImRkL01NL3kiLCJkL00veXkiLCJkZC9NL3l5IiwiZC9NTS95eSIsImRkL01NL3l5IiwiTU0vZC95IiwiTU0vZGQveSIsIk0vZC95eSIsIk0vZGQveXkiLCJNTS9kL3l5IiwiTU0vZGQveXkiLCJ5L01NL2QiLCJ5L01NL2RkIiwieXkvTS9kIiwieXkvTU0vZCIsInl5L01NL2RkIl07DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgY2FzZSAiTSI6IC8vbW9udGggZmlyc3QgLSBBbWVyaWNhbj8NCiAgICAgICAgICAgIHN3aXRjaChvcmlnLmxlbmd0aCkgew0KICAgICAgICAgICAgICBjYXNlIDY6DQogICAgICAgICAgICAgICAgYXJyID0gWyJtL2QveSIsImQvbS95IiwieS9tL2QiXTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgY2FzZSA3Og0KICAgICAgICAgICAgICAgIGFyciA9IFsibS9kL3kiLCJtL2RkL3kiLCJtbS9kL3kiLCJkL20veSIsImRkL20veSIsImQvbW0veSIsInkvbS9kIiwieS9tL2RkIiwieS9tbS9kIl07DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgIGNhc2UgODoNCiAgICAgICAgICAgICAgICBhcnIgPSBbIm0vZC95IiwibS9kZC95IiwibW0vZC95IiwibW0vZGQveSIsIm0vZC95eSIsIk0vZC95IiwiTU0vZC95IiwiZC9tL3kiLCJkZC9tL3kiLCJkL21tL3kiLCJkZC9tbS95IiwiZC9tL3l5IiwiZC9NL3kiLCJkL01NL3kiLCJ5L20vZCIsInkvbS9kZCIsInkvbW0vZCIsInkvbW0vZGQiLCJ5eS9tL2QiLCJ5L00vZCIsInkvTU0vZCJdOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICBjYXNlIDk6DQogICAgICAgICAgICAgICAgYXJyID0gWyJtL2QveXkiLCJtL2RkL3l5IiwibW0vZC95eSIsIk0vZC95IiwiTS9kZC95IiwiTU0vZC95IiwiTU0vZGQveSIsImQvbS95eSIsImRkL20veXkiLCJkL21tL3l5IiwiZC9NL3kiLCJkZC9NL3kiLCJkL01NL3kiLCJkZC9NTS95IiwieXkvbS9kIiwieXkvbS9kZCIsInl5L21tL2QiLCJ5L00vZCIsInkvTS9kZCIsInkvTU0vZCIsInkvTU0vZGQiXTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgY2FzZSAxMDoNCiAgICAgICAgICAgICAgICBhcnIgPSBbIm0vZC95eSIsIm0vZGQveXkiLCJtbS9kL3l5IiwibW0vZGQveXkiLCJNTS9kL3kiLCJNTS9kZC95IiwiTS9kL3l5IiwiTU0vZC95eSIsImQvbS95eSIsImRkL20veXkiLCJkL21tL3l5IiwiZGQvbW0veXkiLCJkL01NL3kiLCJkZC9NTS95IiwiZC9NL3l5IiwiZC9NTS95eSIsInl5L20vZCIsInl5L20vZGQiLCJ5eS9tbS9kIiwieXkvbW0vZGQiLCJ5L01NL2QiLCJ5L01NL2RkIiwieXkvTS9kIiwieXkvTU0vZCJdOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICBkZWZhdWx0Og0KICAgICAgICAgICAgICAgIGlmKG9yaWcubGVuZ3RoPjEwKSB7DQogICAgICAgICAgICAgICAgICBhcnIgPSBbIk1NL2QveSIsIk1NL2RkL3kiLCJNL2QveXkiLCJNL2RkL3l5IiwiTU0vZC95eSIsIk1NL2RkL3l5IiwiZC9NTS95IiwiZGQvTU0veSIsImQvTS95eSIsImRkL00veXkiLCJkL01NL3l5IiwiZGQvTU0veXkiLCJ5L01NL2QiLCJ5L01NL2RkIiwieXkvTS9kIiwieXkvTU0vZCIsInl5L01NL2RkIl07DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgY2FzZSAiWSI6IC8veWVhciBmaXJzdCAtIENhbmFkaWFuPw0KICAgICAgICAgICAgc3dpdGNoKG9yaWcubGVuZ3RoKSB7DQogICAgICAgICAgICAgIGNhc2UgNjoNCiAgICAgICAgICAgICAgICBhcnIgPSBbInkvbS9kIiwiZC9tL3kiLCJtL2QveSJdOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICBjYXNlIDc6DQogICAgICAgICAgICAgICAgYXJyID0gWyJ5L20vZCIsInkvbS9kZCIsInkvbW0vZCIsImQvbS95IiwiZGQvbS95IiwiZC9tbS95IiwibS9kL3kiLCJtL2RkL3kiLCJtbS9kL3kiXTsNCiAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgY2FzZSA4Og0KICAgICAgICAgICAgICAgIGFyciA9IFsieS9tL2QiLCJ5L20vZGQiLCJ5L21tL2QiLCJ5L21tL2RkIiwieXkvbS9kIiwieS9NL2QiLCJ5L01NL2QiLCJkL20veSIsImRkL20veSIsImQvbW0veSIsImRkL21tL3kiLCJkL20veXkiLCJkL00veSIsImQvTU0veSIsIm0vZC95IiwibS9kZC95IiwibW0vZC95IiwibW0vZGQveSIsIm0vZC95eSIsIk0vZC95IiwiTU0vZC95Il07DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgIGNhc2UgOToNCiAgICAgICAgICAgICAgICBhcnIgPSBbInl5L20vZCIsInl5L20vZGQiLCJ5eS9tbS9kIiwieS9NL2QiLCJ5L00vZGQiLCJ5L01NL2QiLCJ5L01NL2RkIiwiZC9tL3l5IiwiZGQvbS95eSIsImQvbW0veXkiLCJkL00veSIsImRkL00veSIsImQvTU0veSIsImRkL01NL3kiLCJtL2QveXkiLCJtL2RkL3l5IiwibW0vZC95eSIsIk0vZC95IiwiTS9kZC95IiwiTU0vZC95IiwiTU0vZGQveSJdOw0KICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICBjYXNlIDEwOg0KICAgICAgICAgICAgICAgIGFyciA9IFsieXkvbS9kIiwieXkvbS9kZCIsInl5L21tL2QiLCJ5eS9tbS9kZCIsImQvbS95eSIsImRkL20veXkiLCJkL21tL3l5IiwiZGQvbW0veXkiLCJkL01NL3kiLCJkZC9NTS95IiwiZC9NL3l5IiwiZC9NTS95eSIsIm0vZC95eSIsIm0vZGQveXkiLCJtbS9kL3l5IiwibW0vZGQveXkiLCJNTS9kL3kiLCJNTS9kZC95IiwiTS9kL3l5IiwiTU0vZC95eSIsInkvTU0vZCIsInkvTU0vZGQiLCJ5eS9NL2QiLCJ5eS9NTS9kIl07DQogICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgIGRlZmF1bHQ6DQogICAgICAgICAgICAgICAgaWYob3JpZy5sZW5ndGg+MTApIHsNCiAgICAgICAgICAgICAgICAgIGFyciA9IFsieS9NTS9kIiwieS9NTS9kZCIsInl5L00vZCIsInl5L01NL2QiLCJ5eS9NTS9kZCIsImQvTU0veSIsImRkL01NL3kiLCJkL00veXkiLCJkZC9NL3l5IiwiZC9NTS95eSIsImRkL01NL3l5IiwiTU0vZC95IiwiTU0vZGQveSIsIk0vZC95eSIsIk0vZGQveXkiLCJNTS9kL3l5IiwiTU0vZGQveXkiXTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgfQ0KICAgICAgICB2YXIgbCA9IGFyci5sZW5ndGg7DQogICAgICAgIGZvcih2YXIgaT0wO2k8bDtpKyspIHsgLy9sb29wIHRocm91Z2ggb3RoZXIgZm9ybWF0cw0KICAgICAgICAgIHZhciBmcm0gPSBhcnJbaV07DQogICAgICAgICAgaWYoZnJtIT1zaXRzX2RhdGVfZm9ybWF0KSB7DQogICAgICAgICAgICB2YWx1ID0gc2l0c19kYXRlX2NvbnZlcnQoZnJtLCJ5eS1tbS1kZCIsdmFsdSk7IC8vY29udmVydCBkYXRlIGZvcm1hdA0KICAgICAgICAgICAgaWYodmFsdSE9YmFjaykgew0KICAgICAgICAgICAgICBpID0gbCsxOyAvL2JyZWFrIG91dCBvZiBsb29wDQogICAgICAgICAgICB9DQogICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIGlmKHZhbHU9PWJhY2spIHsgLy9kYXRlIGhhcyBub3QgYmVlbiBjb252ZXJ0ZWQuLi4NCiAgICAgICAgICB2YWx1ID0gb3JpZzsgLy8uLi5zbyByZXN0b3JlIHRvIG9yaWdpbmFsDQogICAgICAgIH0NCiAgICAgIH0NCiAgICAgIHNpdHNfZGF0ZXNfY2FjaGVbb3JpZ10gPSB2YWx1OyAvL2NhY2hlIGNvbnZlcnRlZCB2YWx1ZQ0KICAgIH0NCiAgfQ0KICByZXR1cm4gdmFsdTsgLy9yZXR1cm4gY29udmVydGVkIHZhbHVlKG9yIG9yaWdpbmFsIHZhbHVlIGlmIGludmFsaWQgcGFyYW1ldGVycykNCn0NCg0KLy9GdW5jdGlvbiB0byBjb252ZXJ0IGFuIElTTy04NjAxIGRhdGUgc3RyaW5nIGludG8gbG9jYWxpc2VkIGRhdGUgZm9ybWF0KFBQTDAyODYzMykNCmZ1bmN0aW9uIHNpdHNfYXRvbV90b19kYXRlKHZhbHUpIHsNCiAgaWYodHlwZW9mKHZhbHUpPT0ic3RyaW5nIiAmJiB2YWx1IT0iIiAmJiB2YWx1Lmxlbmd0aD41KSB7DQogICAgaWYodmFsdS5zdWJzdHIoNCwxKT09Ii0iIHx8IHZhbHUuc3Vic3RyKDYsMSk9PSItIikgew0KICAgICAgdmFsdSA9IHNpdHNfZGF0ZV9jb252ZXJ0KCJ5eS1tbS1kZCIsc2l0c19kYXRlX2Zvcm1hdCx2YWx1KTsgLy9jb252ZXJ0IGRhdGUgZm9ybWF0DQogICAgfQ0KICB9DQogIHJldHVybiB2YWx1OyAvL3JldHVybiBjb252ZXJ0ZWQgdmFsdWUob3Igb3JpZ2luYWwgdmFsdWUgaWYgaW52YWxpZCBwYXJhbWV0ZXJzKQ0KfQ0KDQovL0Z1bmN0aW9uIHRvIGNvbnZlcnQgYSBzdHJpbmcgZGF0ZSB2YWx1ZSBpbnRvIGFub3RoZXIgZGF0ZSBmb3JtYXQoUFBMMDI4NjMzKQ0KLy8gc3RyaW5nIGZybWkgIDogaW4gO2Zvcm1hdCBvZiBkYXRlIHZhbHVlIChzZWUgaHR0cDovL2FwaS5qcXVlcnl1aS5jb20vZGF0ZXBpY2tlci8jdXRpbGl0eS1mb3JtYXREYXRlKQ0KLy8gc3RyaW5nIGZybW8gIDogaW4gO2Zvcm1hdCBvZiBkYXRlIHJlcXVpcmVkIChzZWUgYWJvdmUpDQovLyBzdHJpbmcgdmFsdSAgOiBpbiA7ZGF0ZSB2YWx1ZQ0KZnVuY3Rpb24gc2l0c19kYXRlX2NvbnZlcnQoZnJtaSxmcm1vLHZhbHUpIHsNCiAgaWYodHlwZW9mKGZybWkpPT0ic3RyaW5nIiAmJiBmcm1pIT0iIiAmJiB0eXBlb2YoZnJtbyk9PSJzdHJpbmciICYmIGZybW8hPSIiICYmIHR5cGVvZih2YWx1KT09InN0cmluZyIgJiYgdmFsdSE9IiIgJiYgdmFsdS5sZW5ndGg+NSkgew0KICAgIHZhciBvcmlnID0gdmFsdTsgLy9zdG9yZSBvcmlnaW5hbCB2YWx1ZQ0KICAgIHRyeSB7DQogICAgICB2YXIgb3B0ID0ge307IC8vZGVmaW5lIG9wdGlvbnMNCiAgICAgIG9wdC5zaG9ydFllYXJDdXRvZmYgPSBzaXRzX2NlbnR1cnlfYnJlYWs7DQogICAgICB2YXIgZGF0ID0gJC5kYXRlcGlja2VyLnBhcnNlRGF0ZShmcm1pLHZhbHUsb3B0KTsgLy9jb252ZXJ0IGZyb20gb3JpZ2luYWwgZm9ybWF0IGludG8gZGF0ZQ0KICAgICAgdmFsdSA9ICQuZGF0ZXBpY2tlci5mb3JtYXREYXRlKGZybW8sZGF0LG9wdCk7IC8vY29udmVydCBmcm9tIGRhdGUgaW50byBuZXcgZm9ybWF0DQogICAgfQ0KICAgIGNhdGNoKGUpIHsNCiAgICAgIHJldHVybiBvcmlnOyAvL3JldHVybiBvcmlnaW5hbCB2YWx1ZSBpcyBlcnJvcg0KICAgIH0NCiAgfQ0KICByZXR1cm4gdmFsdTsgLy9yZXR1cm4gY29udmVydGVkIHZhbHVlKG9yIG9yaWdpbmFsIHZhbHVlIGlmIGludmFsaWQgcGFyYW1ldGVycykNCn0NCg0KLy9GdW5jdGlvbiB0byBjb252ZXJ0IGEgVW5pZmFjZSBkYXRlL2RhdGV0aW1lIG51bWVyaWMgc3RyaW5nIHRvIGRhdGUNCi8vIHN0cmluZyB2YWx1ICA6IGluIDtkYXRlL2RhdGV0aW1lIHZhbHVlIGFzIGEgc3RyaW5nDQpmdW5jdGlvbiBzaXRzX3VuaWZhY2VfdG9fZGF0ZSh2YWx1KSB7DQogIGlmKHR5cGVvZih2YWx1KSE9InN0cmluZyIgfHwgdmFsdS5sZW5ndGg8OCB8fCBpc05hTih2YWx1KSkgew0KICAgIHJldHVybiB1bmRlZmluZWQ7DQogIH0NCiAgdmFyIG5ld2RhdGUgPSBuZXcgRGF0ZSgpOw0KICB2YXIgeWVhciA9IDA7DQogIHZhciBtb250aCA9IDA7DQogIHZhciBkYXkgPSAwOw0KICBzd2l0Y2godmFsdS5sZW5ndGgpIHsNCiAgICBjYXNlIDg6IC8vZGF0ZQ0KCQkgIHllYXIgPSBzaXRzX2dldF9pbnRlZ2VyKHZhbHUuc3Vic3RyKDAsNCkpOw0KCQkJbW9udGggPSBzaXRzX2dldF9pbnRlZ2VyKHZhbHUuc3Vic3RyKDQsMikpOw0KCQkJZGF5ID0gc2l0c19nZXRfaW50ZWdlcih2YWx1LnN1YnN0cig2LDIpKTsNCgkJCW5ld2RhdGUuc2V0RnVsbFllYXIoeWVhcixtb250aC0xLGRheSk7DQoJCQluZXdkYXRlLnNldEhvdXJzKDAsMCwwLDApOw0KCQkgIHJldHVybiBuZXdkYXRlOw0KICAgIGNhc2UgMTY6IC8vZGF0ZXRpbWUNCgkJICB5ZWFyID0gc2l0c19nZXRfaW50ZWdlcih2YWx1LnN1YnN0cigwLDQpKTsNCgkJCW1vbnRoID0gc2l0c19nZXRfaW50ZWdlcih2YWx1LnN1YnN0cig0LDIpKTsNCgkJCWRheSA9IHNpdHNfZ2V0X2ludGVnZXIodmFsdS5zdWJzdHIoNiwyKSk7DQoJCSAgdmFyIGhvdXJzID0gc2l0c19nZXRfaW50ZWdlcih2YWx1LnN1YnN0cig4LDIpKTsNCgkJCXZhciBtaW5zID0gc2l0c19nZXRfaW50ZWdlcih2YWx1LnN1YnN0cigxMCwyKSk7DQoJCQl2YXIgc2VjcyA9IHNpdHNfZ2V0X2ludGVnZXIodmFsdS5zdWJzdHIoMTIsMikpOw0KCQkJdmFyIHRpY3MgPSBzaXRzX2dldF9pbnRlZ2VyKHZhbHUuc3Vic3RyKDE0LDIpKTsNCgkJCW5ld2RhdGUuc2V0RnVsbFllYXIoeWVhcixtb250aC0xLGRheSk7DQoJCQluZXdkYXRlLnNldEhvdXJzKGhvdXJzLG1pbnMsc2Vjcyx0aWNzKjEwKTsNCgkJICByZXR1cm4gbmV3ZGF0ZTsNCiAgICBkZWZhdWx0Og0KICAgICAgcmV0dXJuIHVuZGVmaW5lZDsNCiAgfQ0KfQ0KDQovL0Z1bmN0aW9uIHRvIGNvbnZlcnQgYSBzdHJpbmcgZGF0ZSB2YWx1ZSBpbnRvIGEgZGF0ZSBvYmplY3QNCi8vIHN0cmluZyB2YWx1ICA6IGluIDtkYXRlIHZhbHVlIGFzIGEgc3RyaW5nDQovLyBzdHJpbmcgZnJtaSAgOiBpbiA7Zm9ybWF0IG9mIGRhdGUgdmFsdWUgKHNlZSBodHRwOi8vYXBpLmpxdWVyeXVpLmNvbS9kYXRlcGlja2VyLyN1dGlsaXR5LWZvcm1hdERhdGUpDQpmdW5jdGlvbiBzaXRzX3RvX2RhdGUodmFsdSxmcm1pKSB7DQogIGlmKHR5cGVvZihmcm1pKSE9InN0cmluZyIgfHwgZnJtaS5sZW5ndGg8MSkgew0KICAgIGZybWkgPSBzaXRzX2RhdGVfZm9ybWF0Ow0KICB9DQogIHZhciBkYXQgPSB1bmRlZmluZWQ7DQogIGlmKHR5cGVvZih2YWx1KT09InN0cmluZyIgJiYgdmFsdSE9IiIgJiYgdmFsdS5sZW5ndGg+NSkgew0KICAgIGRhdCA9IHNpdHNfdW5pZmFjZV90b19kYXRlKHZhbHUpOw0KICAgIGlmKGRhdCBpbnN0YW5jZW9mIERhdGUgJiYgIWlzTmFOKGRhdC52YWx1ZU9mKCkpKSB7IC8vbWFrZSBzdXJlIHdlIGhhdmUgYSBkYXRlDQogICAgICByZXR1cm4gZGF0Ow0KICAgIH0NCiAgICB0cnkgew0KICAgICAgdmFyIG9wdCA9IHt9OyAvL2RlZmluZSBvcHRpb25zDQogICAgICBvcHQuc2hvcnRZZWFyQ3V0b2ZmID0gc2l0c19jZW50dXJ5X2JyZWFrOw0KICAgICAgZGF0ID0gJC5kYXRlcGlja2VyLnBhcnNlRGF0ZShmcm1pLHZhbHUsb3B0KTsgLy9jb252ZXJ0IGZyb20gb3JpZ2luYWwgZm9ybWF0IGludG8gZGF0ZQ0KICAgIH0NCiAgICBjYXRjaChlKSB7DQogICAgICByZXR1cm4gdW5kZWZpbmVkOyAvL3JldHVybiB1bmRlZmluZWQgaWYgaW52YWxpZA0KICAgIH0NCiAgfQ0KCWlmKGRhdCBpbnN0YW5jZW9mIERhdGUgJiYgIWlzTmFOKGRhdC52YWx1ZU9mKCkpKSB7IC8vbWFrZSBzdXJlIHdlIGhhdmUgYSBkYXRlDQoJICByZXR1cm4gZGF0Ow0KCX0NCiAgcmV0dXJuIHVuZGVmaW5lZDsgLy9yZXR1cm4gdW5kZWZpbmVkIGlmIGludmFsaWQNCn0NCg0KLy9UdXJuIGEgdGltZSBzdHJpbmcgdG8gYSBEYXRlIG9iamVjdA0KLy8gc3RyaW5nICB0aW0gIDogaW4gO3RoZSB0aW1lIHN0cmluZw0KLy8gc3RyaW5nIGZybWkJOiBpbgk7dGhlIGZvcm1hdCBvZiB0aGUgdGltZSAodXNlICZEIG5vdGF0aW9uIEgyOk4yOlMyLlQyIHApDQpmdW5jdGlvbiBzaXRzX3RvX3RpbWUodGltLGZybWkpIHsNCiAgaWYodHlwZW9mKHRpbSkhPSJzdHJpbmciIHx8IHRpbS5sZW5ndGg8Mykgew0KICAgIHJldHVybiB1bmRlZmluZWQ7DQogIH0NCiAgaWYodHlwZW9mKGZybWkpIT0ic3RyaW5nIiB8fCBmcm1pLmxlbmd0aDwxKSB7DQogICAgZnJtaSA9ICIiOw0KICB9DQoJdmFyIHN0cmluZ3ZhbCA9ICIiOw0KICB2YXIgaXRlbXZhbCA9ICIiOw0KICB2YXIgaG91ciA9ICIiOw0KICB2YXIgbWlucyA9ICIiOw0KICB2YXIgc2VjcyA9ICIiOw0KICB2YXIgdGljayA9ICIiOw0KICB2YXIgYW1fcG0gPSAiIjsNCiAgdmFyIHRpbWVfZGVsaW0gPSAifiI7DQogIHZhciByZWcgPSBuZXcgUmVnRXhwKCdeWzAtOV0rJCcpOw0KICBpZihmcm1pPT0iIiAmJiByZWcudGVzdCh0aW0pKSB7CS8vIElmIG5vIGZvcm1hdCBhbmQgb25seSBkaWdpdHMgcHJvdmlkZWQ/DQogICAgaWYodGltLmxlbmd0aD09MTYpIHsJCS8vIElmIGEgMTYgZGlnaXQgbnVtYmVyIC0gdGhlbiBhbHJlYWR5IGluDQoJCSAgdGltID0gdGltLnN1YnN0cmluZyg4KTsNCiAgICB9DQogICAgaWYodGltLmxlbmd0aD09OCkJewkvLyBJZiBhIDggZGlnaXQgbnVtYmVyIC0gdGhlbiBhbHJlYWR5IGluDQoJCSAgaG91ciA9IHNpdHNfZ2V0X2ludGVnZXIodGltLnN1YnN0cigwLDIpKTsNCgkJCW1pbnMgPSBzaXRzX2dldF9pbnRlZ2VyKHRpbS5zdWJzdHIoMiwyKSk7DQoJCQlzZWNzID0gc2l0c19nZXRfaW50ZWdlcih0aW0uc3Vic3RyKDQsMikpOw0KCQkJdGljcyA9IHNpdHNfZ2V0X2ludGVnZXIodGltLnN1YnN0cig2LDIpKTsNCgkgICAgdmFyIG5ld2RhdGUgPSBuZXcgRGF0ZSgpOw0KCQkJbmV3ZGF0ZS5zZXRGdWxsWWVhcigxLDAsMSk7DQoJICAgIG5ld2RhdGUuc2V0SG91cnMoaG91cixtaW5zLHNlY3MsdGljcyoxMCk7DQogICAgICByZXR1cm4gbmV3ZGF0ZTsNCiAgICB9DQogIH0NCiAgaWYodGltLmxlbmd0aD09ZnJtaS5sZW5ndGgpIHsJCS8vIElmIGxlbmd0aCBvZiBmb3JtYXQgaXMgZXhhY3RseSB0aGUgc2FtZSBhcyB0aGUgdGltZSAtIHRoZW4gYXNzdW1lDQogICAgd2hpbGUoZnJtaSE9IiIpIHsJCQkJCQkJCQkJCS8vIGZvcm1hdCBpcyBzb21ldGhpbmcgbGlrZSBISDpOTiAtIGFuZCBleHRyYWN0IHBhcnRzIGluIHRoYXQgb3JkZXINCiAgICAgIHN3aXRjaChmcm1pLnRvVXBwZXJDYXNlKCkuc3Vic3RyKDAsMSkpIHsNCiAgICAgICAgY2FzZSAiSCI6DQogICAgICAgICAgaG91ciArPSB0aW0uc3Vic3RyKDAsMSk7DQoJCQkJCWJyZWFrOw0KICAgICAgICBjYXNlICJOIjoNCgkJCQljYXNlICJNIjoJLy8gTXVzdCB1c2UgIk4iIGZvciBNaW51dGVzIC0gYXMgTSBjYW4gYmUgTW9udGggb3IgQU0vUE0NCiAgICAgICAgICBtaW5zICs9IHRpbS5zdWJzdHIoMCwxKTsNCgkJCQkJYnJlYWs7DQogICAgICAgIGNhc2UgIlMiOg0KICAgICAgICAgIHNlY3MgKz0gdGltLnN1YnN0cigwLDEpOw0KCQkJCQlicmVhazsNCiAgICAgICAgY2FzZSAiVCI6DQogICAgICAgICAgdGljayArPSB0aW0uc3Vic3RyKDAsMSk7DQoJCQkJCWJyZWFrOw0KICAgICAgICBkZWZhdWx0Og0KICAgICAgICAgIGlmKGZybWkudG9VcHBlckNhc2UoKS5zdWJzdHIoMCwyKT09IkFNIiB8fCBmcm1pLnRvVXBwZXJDYXNlKCkuc3Vic3RyKDAsMik9PSJQTSIpIHsNCiAgICAgICAgICAgIGFtX3BtID0gdGltLnRvVXBwZXJDYXNlKCkuc3Vic3RyKDAsMik7DQogICAgICAgICAgICBmcm1pID0gZnJtaS5zdWJzdHIoMSk7CQkvLyByZW1vdmUgZmlyc3QgY2hhcmFjdGVyIG9mIEFNL1BNIC0gc2Vjb25kIGNoYXJhY3Rlcg0KICAgICAgICAgICAgdGltID0gdGltLnN1YnN0cigxKTsJCS8vIC4uLiByZW1vdmVkIGFzIG5vcm1hbCBhZnRlciBlbmRzZWxlY3RjYXNlDQogICAgICAgICAgfQ0KICAgICAgfQ0KICAgICAgZnJtaSA9IGZybWkuc3Vic3RyKDEpOw0KICAgICAgdGltID0gdGltLnN1YnN0cigxKTsNCiAgICB9DQoJCWhvdXIgPSBzaXRzX2dldF9pbnRlZ2VyKGhvdXIpOw0KCQltaW5zID0gc2l0c19nZXRfaW50ZWdlcihtaW5zKTsNCgkJc2VjcyA9IHNpdHNfZ2V0X2ludGVnZXIoc2Vjcyk7DQoJCXRpY2sgPSBzaXRzX2dldF9pbnRlZ2VyKHRpY2spOw0KCQlpZih0eXBlb2YgaG91ciAhPT0gIm51bWJlciIgfHwgaXNOYU4oaG91cikgfHwgaG91cjwwKSB7DQoJCQlob3VyID0gMDsNCgkJfQ0KCQlpZihhbV9wbT09IlBNIiAmJiBob3VyPDEyKSB7DQoJCQlob3VyID0gMTIraG91cjsNCgkJfQ0KCQlpZihob3VyPjIzKSB7DQoJCQlyZXR1cm4gdW5kZWZpbmVkOw0KCQl9DQoJCWlmKHR5cGVvZiBtaW5zICE9PSAibnVtYmVyIiB8fCBpc05hTihtaW5zKSB8fCBtaW5zPDApIHsNCgkJCW1pbnMgPSAwOw0KCQl9DQoJCWlmKG1pbnM+NTkpIHsNCgkJCXJldHVybiB1bmRlZmluZWQ7DQoJCX0NCgkJaWYodHlwZW9mIHNlY3MgIT09ICJudW1iZXIiIHx8IGlzTmFOKHNlY3MpIHx8IHNlY3M8MCkgew0KCQkJc2VjcyA9IDA7DQoJCX0NCgkJaWYoc2Vjcz41OSkgew0KCQkJcmV0dXJuIHVuZGVmaW5lZDsNCgkJfQ0KCQlpZih0eXBlb2YgdGljayAhPT0gIm51bWJlciIgfHwgaXNOYU4odGljaykgfHwgdGljazwwKSB7DQoJCQl0aWNrID0gMDsNCgkJfQ0KCQlpZih0aWNrPjk5OSkgew0KCQkJcmV0dXJuIHVuZGVmaW5lZDsNCgkJfQ0KCSAgdmFyIG5ld2RhdGUgPSBuZXcgRGF0ZSgpOw0KCSAgbmV3ZGF0ZS5zZXRGdWxsWWVhcigxLDAsMSk7DQoJICBuZXdkYXRlLnNldEhvdXJzKGhvdXIsbWlucyxzZWNzLHRpY2sqMTApOw0KICAgIHJldHVybiBuZXdkYXRlOw0KICB9DQoJdmFyIG9yZGVyID0gbmV3IEFycmF5KCk7DQoJdmFyIGRlbGltaXRlcnMgPSBuZXcgQXJyYXkoKTsNCiAgd2hpbGUoZnJtaSE9IiIpIHsJCQkJCS8vIElmIHRpbWUgZm9ybWF0IGdpdmUgLSBkZWNvZGUgZm9yIG9yZGVyIGFuZCBkZWxpbWl0ZXJzIC4uLg0KICAgIHN3aXRjaChmcm1pLnN1YnN0cigwLDEpLnRvVXBwZXJDYXNlKCkpIHsNCiAgICAgIGNhc2UgIkgiOg0KICAgICAgICBvcmRlci5wdXNoKCJIIik7DQogICAgICAgIGZybWkgPSBzaXRzX3JlcGxhY2UoZnJtaSwgJ2gnLCAiIik7CQkvLyBSZW1vdmUgYWxsIG90aGVyIEgncyhhcyBtYXkgZW50ZXIgSEgpDQoJCQkJZnJtaSA9IHNpdHNfcmVwbGFjZShmcm1pLCAnSCcsICIiKTsJCS8vIFJlbW92ZSBhbGwgb3RoZXIgSCdzKGFzIG1heSBlbnRlciBISCkNCgkJCQlicmVhazsNCiAgICAgIGNhc2UgIk4iOg0KCQkJY2FzZSAiTSI6DQogICAgICAgIG9yZGVyLnB1c2goIk4iKTsNCiAgICAgICAgZnJtaSA9IHNpdHNfcmVwbGFjZShmcm1pLCAnbicsICIiKTsJCS8vIFJlbW92ZSBhbGwgb3RoZXIgTidzKGFzIG1heSBlbnRlciBOTikNCgkJCQlmcm1pID0gc2l0c19yZXBsYWNlKGZybWksICdOJywgIiIpOwkJLy8gUmVtb3ZlIGFsbCBvdGhlciBOJ3MoYXMgbWF5IGVudGVyIE5OKQ0KCQkJCWZybWkgPSBzaXRzX3JlcGxhY2UoZnJtaSwgJ20nLCAiIik7CQkvLyBSZW1vdmUgYWxsIG90aGVyIE0ncyhhcyBtYXkgZW50ZXIgTU0pDQoJCQkJZnJtaSA9IHNpdHNfcmVwbGFjZShmcm1pLCAnTScsICIiKTsJCS8vIFJlbW92ZSBhbGwgb3RoZXIgTSdzKGFzIG1heSBlbnRlciBNTSkNCgkJCQlicmVhazsNCiAgICAgIGNhc2UgIlMiOg0KICAgICAgICBvcmRlci5wdXNoKCJTIik7DQogICAgICAgIGZybWkgPSBzaXRzX3JlcGxhY2UoZnJtaSwgJ3MnLCAiIik7CQkvLyBSZW1vdmUgYWxsIG90aGVyIHMncyhhcyBtYXkgZW50ZXIgU1MpDQoJCQkJZnJtaSA9IHNpdHNfcmVwbGFjZShmcm1pLCAnUycsICIiKTsJCS8vIFJlbW92ZSBhbGwgb3RoZXIgcydzKGFzIG1heSBlbnRlciBTUykNCgkJCQlicmVhazsNCiAgICAgIGNhc2UgIlQiOg0KICAgICAgICBvcmRlci5wdXNoKCJUIik7DQogICAgICAgIGZybWkgPSBzaXRzX3JlcGxhY2UoZnJtaSwgJ3QnLCAiIik7CQkvLyBSZW1vdmUgYWxsIG90aGVyIFQncyhhcyBtYXkgZW50ZXIgVFQpDQoJCQkJZnJtaSA9IHNpdHNfcmVwbGFjZShmcm1pLCAnVCcsICIiKTsJCS8vIFJlbW92ZSBhbGwgb3RoZXIgVCdzKGFzIG1heSBlbnRlciBUVCkNCgkJCQlicmVhazsNCiAgICAgIGRlZmF1bHQ6DQogICAgICAgIGlmKGZybWkudG9VcHBlckNhc2UoKS5zdWJzdHIoMCwyKT09IkFNIiB8fCBmcm1pLnRvVXBwZXJDYXNlKCkuc3Vic3RyKDAsMik9PSJQTSIpIHsNCgkJCQkJb3JkZXIucHVzaCgiQU1fUE0iKTsNCiAgICAgICAgICBmcm1pID0gZnJtaS5zdWJzdHIoMik7DQogICAgICAgIH0NCiAgICAgICAgZWxzZSB7DQoJCQkJCWRlbGltaXRlcnMucHVzaChmcm1pLnN1YnN0cigwLDEpKTsgLy9hbnl0aGluZyBlbHNlIG11c3QgYmUgYSBkZWxpbWl0ZXINCiAgICAgICAgICBmcm1pID0gZnJtaS5zdWJzdHIoMSk7DQogICAgICAgIH0NCiAgICB9DQogIH0NCiAgaWYob3JkZXI9PSIiKSB7DQogICAgb3JkZXIgPSBbIkgiLCAiTiIsICJTIiwgIlQiXTsNCiAgfQ0KICBpZihkZWxpbWl0ZXJzPT0iIikJewkJCQkvLyBTdGFuZGFyZCB0aW1lIGRlbGltaXRlcnMgaW5jbHVkZSBzcGFjZSwgLSwgLyBcIC4gLCBhbmQgOg0KCQlkZWxpbWl0ZXJzID0gWyIgIiwgIi8iLCAiXFwiLCAiLSIsICIuIiwgIiwiLCAiOiJdOw0KICB9DQogIGFtX3BtID0gIkFNIjsNCiAgc3RyaW5ndmFsID0gdGltOw0KICBpZihzdHJpbmd2YWwuc3Vic3RyKHN0cmluZ3ZhbC5sZW5ndGgsMSk9PSJaIikgewkJCQkvLyBJZiBYTUwgc3RhbmRhcmQgdGltZShlbmRzIGluIFopIC0gcmVtb3ZlIFoNCiAgICBzdHJpbmd2YWwgPSBzdHJpbmd2YWwuc3Vic3RyaW5nKDAsc3RyaW5ndmFsLmxlbmd0aCk7DQogIH0NCglmb3IodmFyIGFycmF5aWQgaW4gZGVsaW1pdGVycykgew0KICAgIHN0cmluZ3ZhbCA9IHNpdHNfcmVwbGFjZShzdHJpbmd2YWwsZGVsaW1pdGVyc1thcnJheWlkXSx0aW1lX2RlbGltKTsNCiAgfQ0KCXN0cmluZ3ZhbCA9IHNpdHNfcmVwbGFjZShzdHJpbmd2YWwsdGltZV9kZWxpbSt0aW1lX2RlbGltLHRpbWVfZGVsaW0pOyAvL1NvbWUgdGltZXMgdXNlIGRvdWJsZSBkZWxpbWl0ZXIgc3VjaCBhcyAiLiAiICENCiAgc3RyaW5ndmFsID0gc2l0c19yaWdodF90cmltKHNpdHNfbGVmdF90cmltKHN0cmluZ3ZhbCx0aW1lX2RlbGltKSx0aW1lX2RlbGltKTsJCS8vIFJlbW92ZSBhbnkgbGVhZGluZy90cmFpbGluZyBnb2xkIHNlbWljb2xvbnMNCiAgaWYoc3RyaW5ndmFsLnNwbGl0KHRpbWVfZGVsaW0pLmxlbmd0aD09MSkgewkJCQkJLy8gSWYgc3RpbGwgb25seSBvbmUgaXRlbSAtIHRyeSBzb21lIG90aGVyIGRlbGltaXRlcnMgLi4uDQogICAgc3RyaW5ndmFsID0gc2l0c19yZXBsYWNlKHN0cmluZ3ZhbCwiICIsdGltZV9kZWxpbSk7DQogICAgc3RyaW5ndmFsID0gc2l0c19yZXBsYWNlKHN0cmluZ3ZhbCwiXFwiLHRpbWVfZGVsaW0pOw0KICAgIHN0cmluZ3ZhbCA9IHNpdHNfcmVwbGFjZShzdHJpbmd2YWwsIiwiLHRpbWVfZGVsaW0pOw0KICAgIHN0cmluZ3ZhbCA9IHNpdHNfcmVwbGFjZShzdHJpbmd2YWwsIi4iLHRpbWVfZGVsaW0pOw0KICAgIHN0cmluZ3ZhbCA9IHNpdHNfcmVwbGFjZShzdHJpbmd2YWwsIi0iLHRpbWVfZGVsaW0pOw0KICAgIHN0cmluZ3ZhbCA9IHNpdHNfcmVwbGFjZShzdHJpbmd2YWwsIjoiLHRpbWVfZGVsaW0pOw0KICAgIHN0cmluZ3ZhbCA9IHNpdHNfcmVwbGFjZShzdHJpbmd2YWwsdGltZV9kZWxpbSt0aW1lX2RlbGltLHRpbWVfZGVsaW0pOwkJLy8gU29tZSB0aW1lcyB1c2UgZG91YmxlIGRlbGltaXRlciBzdWNoIGFzICIuICIgIQ0KICAgIHN0cmluZ3ZhbCA9IHNpdHNfcmlnaHRfdHJpbShzaXRzX2xlZnRfdHJpbShzdHJpbmd2YWwsdGltZV9kZWxpbSksdGltZV9kZWxpbSkJOwkvLyBSZW1vdmUgYW55IGxlYWRpbmcvdHJhaWxpbmcgZ29sZCBzZW1pY29sb25zDQogIH0NCglzdHJpbmd2YWwgPSBzdHJpbmd2YWwuc3BsaXQodGltZV9kZWxpbSk7DQogIGlmKHN0cmluZ3ZhbC5sZW5ndGg9PTEpIHsJCQkJLy8gSWYgc3RpbGwgb25seSBvbmUgc2VnbWVudD8NCiAgICBpZih0aW0ubGVuZ3RoPT02ICYmIHJlZy50ZXN0KHRpbSkpIHsJCS8vIGlmIDYgZGlnaXRzIC0gc3BsaXQgaW50byB0aHJlZSBzZWN0aW9ucyh4eDt4eDt4eCkNCiAgICAgIHN0cmluZ3ZhbCA9IFt0aW0uc3Vic3RyKDAsMiksIHRpbS5zdWJzdHIoMiwyKSwgdGltLnN1YnN0cig0LDIpXTsNCiAgICB9DQogICAgZWxzZSB7DQoJCSAgaWYodGltLmxlbmd0aD09OCAmJiByZWcudGVzdCh0aW0pKSB7CS8vIGlmIDggZGlnaXRzIC0gc3BsaXQgaW50byBmb3VyIHNlY3Rpb24gLi4uDQogICAgICAgIHN0cmluZ3ZhbCA9IFt0aW0uc3Vic3RyKDAsMiksIHRpbS5zdWJzdHIoMiwyKSwgdGltLnN1YnN0cig0LDIpLCB0aW0uc3Vic3RyKDYsMildOw0KCQkJfQ0KICAgIH0NCiAgfQ0KICBlbHNlIHsNCiAgICBpZihzdHJpbmd2YWwubGVuZ3RoPjUpIHsJCS8vIEZpdmUgc2VjdGlvbnMgYXJlIGFsbG93ZWQgYXMgd2UgbWlnaHQgaGF2ZSBISCBOTiBTUyBUVCBBTQ0KICAgICAgcmV0dXJuIHVuZGVmaW5lZDsNCiAgICB9DQogIH0NCiAgLy8gU3RyaW5nVmFsIG5vdyBjb250YWlucyBnb2xkIHNlbWkgY29sb24gZGVsaW1pdGVkIGhvdXIgbWludXRlcyBzZWNvbmRzIHRpY2tzIGFuZCBBTS9QTShpbiBzb21lIG9yZGVyIC0gc28gZXh0cmFjdCBlYWNoIGl0ZW0pDQogIGZvcih2YXIgYXJyYXlpZCBpbiBzdHJpbmd2YWwpIHsJCQkJLy8gbG9vcCB0aG91Z2ggZWFjaCBpdGVtIEhvdXIsIG1pTnV0ZSwgU2Vjb25kLCBUaWNrLCBBTS9QTQ0KCSAgaWYodHlwZW9mKHN0cmluZ3ZhbFthcnJheWlkXSk9PSJzdHJpbmciKSB7DQoJCQlpZihzdHJpbmd2YWxbYXJyYXlpZF0udG9VcHBlckNhc2UoKT09IkFNIiB8fCBzdHJpbmd2YWxbYXJyYXlpZF0udG9VcHBlckNhc2UoKT09IlBNIikgew0KCQkJCWFtX3BtID0gc3RyaW5ndmFsW2FycmF5aWRdLnRvVXBwZXJDYXNlKCk7DQoJCQl9DQogICAgICBlbHNlIHsNCgkJCQlzd2l0Y2gob3JkZXJbYXJyYXlpZF0pIHsJLy8gQ29udmVydCBpdGVtIG51bWJlciBpbnRvIGl0ZW0gdHlwZShkYXkvbW9udGgveWVhcik/DQoJCQkJCWNhc2UgIkgiOg0KCQkJCQkJaG91ciA9IHNpdHNfZ2V0X2ludGVnZXIoc3RyaW5ndmFsW2FycmF5aWRdKTsNCgkJCQkJCWJyZWFrOw0KCQkJCQljYXNlICJOIjoNCgkJCQkJCW1pbnMgPSBzaXRzX2dldF9pbnRlZ2VyKHN0cmluZ3ZhbFthcnJheWlkXSk7DQoJCQkJCQlicmVhazsNCgkJCQkJY2FzZSAiUyI6DQoJCQkJCQlzZWNzID0gc2l0c19nZXRfaW50ZWdlcihzdHJpbmd2YWxbYXJyYXlpZF0pOw0KCQkJCQkJYnJlYWs7DQoJCQkJCWNhc2UgIlQiOg0KCQkJCQkJdGljayA9IHNpdHNfZ2V0X2ludGVnZXIoc3RyaW5ndmFsW2FycmF5aWRdKTsNCgkJCQkJCWJyZWFrOw0KCQkJCX0NCgkJCX0NCgkJfQ0KICB9DQogIGlmKHR5cGVvZihob3VyKSE9PSJudW1iZXIiIHx8IGlzTmFOKGhvdXIpIHx8IGhvdXI8MCkgew0KICAgIGhvdXIgPSAwOw0KICB9DQogIGlmKGFtX3BtPT0iUE0iICYmIGhvdXI8MTIpIHsNCiAgICBob3VyID0gMTIraG91cjsNCiAgfQ0KICBpZihob3VyPjIzKSB7DQogICAgcmV0dXJuIHVuZGVmaW5lZDsNCiAgfQ0KICBpZih0eXBlb2YobWlucykhPT0ibnVtYmVyIiB8fCBpc05hTihtaW5zKSB8fCBtaW5zPDApIHsNCiAgICBtaW5zID0gMDsNCiAgfQ0KICBpZihtaW5zPjU5KSB7DQogICAgcmV0dXJuIHVuZGVmaW5lZDsNCiAgfQ0KICBpZih0eXBlb2Yoc2VjcykhPT0ibnVtYmVyIiB8fCBpc05hTihzZWNzKSB8fCBzZWNzPDApIHsNCiAgICBzZWNzID0gMDsNCiAgfQ0KICBpZihzZWNzPjU5KSB7DQogICAgcmV0dXJuIHVuZGVmaW5lZDsNCiAgfQ0KICBpZih0eXBlb2YodGljaykhPT0ibnVtYmVyIiB8fCBpc05hTih0aWNrKSB8fCB0aWNrPDApIHsNCiAgICB0aWNrID0gMDsNCiAgfQ0KICBpZih0aWNrPjk5OSkgew0KICAgIHJldHVybiB1bmRlZmluZWQ7DQogIH0NCgl2YXIgbmV3ZGF0ZSA9IG5ldyBEYXRlKCk7DQoJbmV3ZGF0ZS5zZXRGdWxsWWVhcigxLDAsMSk7DQoJbmV3ZGF0ZS5zZXRIb3Vycyhob3VyLG1pbnMsc2Vjcyx0aWNrKjEwKTsNCiAgcmV0dXJuIG5ld2RhdGU7DQp9DQoNCi8vVHVybiBhIGRhdGV0aW1lIHN0cmluZyB0byBhIERhdGUgb2JqZWN0DQovLyBzdHJpbmcgIGR0aW0gIDogaW4gO3RoZSB0aW1lIHN0cmluZw0KLy8gc3RyaW5nICBmcm1pCTogaW4JO3RoZSBmb3JtYXQgb2YgdGhlIGRhdGV0aW1lDQovLyAgICAgICAgICAgICAgREFURSBGT1JNQVQgPSBzZWUgaHR0cDovL2FwaS5qcXVlcnl1aS5jb20vZGF0ZXBpY2tlci8jdXRpbGl0eS1mb3JtYXREYXRlDQovLyAgICAgICAgICAgICAgVElNRSBGT1JNQVQgPSB1c2UgJkQgbm90YXRpb24gSDI6TjI6UzIuVDIgcA0KZnVuY3Rpb24gc2l0c190b19kYXRldGltZShkdGltLGZybWkpIHsNCiAgaWYodHlwZW9mKGZybWkpIT0ic3RyaW5nIiB8fCBmcm1pLmxlbmd0aDwxKSB7DQogICAgZnJtaSA9ICIiOw0KICB9DQogIHZhciBkYXQgPSB1bmRlZmluZWQ7DQogIGlmKHR5cGVvZihkdGltKT09InN0cmluZyIgJiYgZHRpbSE9IiIgJiYgZHRpbS5sZW5ndGg+Mykgew0KICAgIGRhdCA9IHNpdHNfdW5pZmFjZV90b19kYXRlKGR0aW0pOyAvL3RyeSB1bmlmYWNlIGZvcm1hdCBmaXJzdA0KICAgIGlmKHR5cGVvZihkYXQpPT0idW5kZWZpbmVkIikgew0KICAgICAgdmFyIGRzdHIgPSAiIjsNCiAgICAgIHZhciB0c3RyID0gIiI7DQogICAgICB2YXIgcG9zID0gZHRpbS5pbmRleE9mKCI6IiktMTsgLy90aW1lIGRlbGltaXRlciBpcyBhbHdheXMgY29sb24NCiAgICAgIGlmKHBvcz49MCkgew0KICAgICAgICB3aGlsZShwb3M+PTAgJiYgJC5pc051bWVyaWMoZHRpbS5jaGFyQXQocG9zKSkpIHsgLy9sb29wIGJhY2sgdG8gZmluZCBub24tbnVtZXJpYw0KICAgICAgICAgIHBvcy0tOw0KICAgICAgICB9DQogICAgICAgIGlmKHBvcz49MCkgew0KICAgICAgICAgIGRzdHIgPSBzaXRzX3doaXRlX3RyaW0oZHRpbS5zdWJzdHJpbmcoMCxwb3MpKTsgLy9zcGxpdCBkYXRlIGFuZCB0aW1lDQogICAgICAgICAgdHN0ciA9IHNpdHNfd2hpdGVfdHJpbShkdGltLnN1YnN0cihwb3MrMSkpOw0KICAgICAgICB9DQogICAgICAgIGVsc2Ugew0KICAgICAgICAgIHRzdHIgPSBkdGltOyAvL3RpbWUgb25seQ0KICAgICAgICB9DQogICAgICB9DQogICAgICBlbHNlIHsNCiAgICAgICAgZHN0ciA9IGR0aW07IC8vZGF0ZSBvbmx5DQogICAgICB9DQogICAgICB2YXIgZGZybSA9ICIiOw0KICAgICAgdmFyIHRmcm0gPSAiIjsNCiAgICAgIGlmKGZybWkhPSIiKSB7DQogICAgICAgIHZhciBoZnJtID0gIkgiOw0KICAgICAgICBwb3MgPSBmcm1pLmluZGV4T2YoaGZybSk7DQogICAgICAgIGlmKHBvczwwKSB7DQogICAgICAgICAgaGZybSA9ICJoIjsNCiAgICAgICAgICBwb3MgPSBmcm1pLmluZGV4T2YoaGZybSk7DQogICAgICAgIH0NCiAgICAgICAgaWYocG9zPT0wKSB7DQogICAgICAgICAgdGZybSA9IGZybWk7IC8vdGltZSBmb3JtYXQgb25seQ0KICAgICAgICB9DQogICAgICAgIGVsc2UgaWYocG9zPDApIHsNCiAgICAgICAgICBkZnJtID0gZnJtaTsgLy9kYXRlIGZvcm1hdCBvbmx5DQogICAgICAgIH0NCiAgICAgICAgZWxzZSB7DQogICAgICAgICAgdmFyIGFyciA9IGZybWkuc3BsaXQoaGZybSk7IC8vc3BsaXQgZGF0ZSBhbmQgdGltZQ0KICAgICAgICAgIGRmcm0gPSBzaXRzX3doaXRlX3RyaW0oYXJyLnNwbGljZSgwLDEpKTsNCiAgICAgICAgICB0ZnJtID0gc2l0c193aGl0ZV90cmltKGhmcm0rYXJyLmpvaW4oaGZybSkpOw0KICAgICAgICB9DQogICAgICB9DQogICAgICB2YXIgdGRhdCA9IHNpdHNfdG9fZGF0ZShkc3RyLGRmcm0pOyAvL2NvbnZlcnQgYm90aCBwYXJ0cw0KICAgICAgdmFyIHR0aW0gPSBzaXRzX3RvX3RpbWUodHN0cix0ZnJtKTsNCiAgICAgIGlmKHR5cGVvZih0ZGF0KSE9InVuZGVmaW5lZCIpIHsNCiAgICAgICAgaWYodHlwZW9mKHR0aW0pIT0idW5kZWZpbmVkIikgew0KICAgICAgICAgIHZhciBzdHIgPSBzaXRzX2RhdGVfdG9fc3RyaW5nKHRkYXQsInl5LW1tLWRkIikrIlQiK3NpdHNfdGltZV90b19zdHJpbmcodHRpbSwiSDI6TjI6UzIuVDIiKTsNCiAgICAgICAgICBkYXQgPSBuZXcgRGF0ZShzdHIpOyAvL2NvbWJpbmUgZGF0ZSBhbmQgdGltZQ0KICAgICAgICB9DQogICAgICAgIGVsc2Ugew0KICAgICAgICAgIGRhdCA9IHRkYXQ7IC8vZGF0ZSBvbmx5DQogICAgICAgIH0NCiAgICAgIH0NCiAgICAgIGVsc2Ugew0KICAgICAgICBpZih0eXBlb2YodHRpbSkhPSJ1bmRlZmluZWQiKSB7DQogICAgICAgICAgZGF0ID0gdHRpbTsgLy90aW1lIG9ubHkNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0NCiAgfQ0KICByZXR1cm4gZGF0Ow0KfQ0KDQovL0Z1bmN0aW9uIHRvIGNvbnZlcnQgYSBkYXRlIG9iamVjdCB0byBhIHN0cmluZw0KLy8gZGF0ZSB2YWx1ICA6IGluIDtkYXRlIG9iamVjdA0KLy8gc3RyaW5nIGZybWkgIDogaW4gO2Zvcm1hdCBvZiBkYXRlIHJlcXVpcmVkIChzZWUgaHR0cDovL2FwaS5qcXVlcnl1aS5jb20vZGF0ZXBpY2tlci8jdXRpbGl0eS1mb3JtYXREYXRlKQ0KZnVuY3Rpb24gc2l0c19kYXRlX3RvX3N0cmluZyh2YWx1LGZybWkpIHsNCiAgaWYodHlwZW9mKHZhbHUpPT0ic3RyaW5nIikgew0KICAgIHZhbHUgPSBzaXRzX3VuaWZhY2VfdG9fZGF0ZSh2YWx1KTsgLy90cnkgY29udmVydGluZyBVbmlmYWNlIGRhdGUgc3RyaW5nIGludG8gZGF0ZQ0KICB9DQogIGlmKHR5cGVvZihmcm1pKSE9InN0cmluZyIgfHwgZnJtaS5sZW5ndGg8MSkgew0KICAgIGZybWkgPSBzaXRzX2RhdGVfZm9ybWF0Ow0KICB9DQogIGlmKHZhbHUgaW5zdGFuY2VvZiBEYXRlICYmICFpc05hTih2YWx1LnZhbHVlT2YoKSkpIHsNCiAgICB0cnkgew0KICAgICAgdmFyIG9wdCA9IHt9OyAvL2RlZmluZSBvcHRpb25zDQogICAgICBvcHQuc2hvcnRZZWFyQ3V0b2ZmID0gc2l0c19jZW50dXJ5X2JyZWFrOw0KICAgICAgcmV0dXJuICQuZGF0ZXBpY2tlci5mb3JtYXREYXRlKGZybWksdmFsdSxvcHQpOyAvL2NvbnZlcnQgZnJvbSBvcmlnaW5hbCBmb3JtYXQgaW50byBkYXRlDQogICAgfQ0KICAgIGNhdGNoKGUpIHsNCiAgICAgIHJldHVybiAiIjsgLy9yZXR1cm4gYmxhbmsgaWYgaW52YWxpZA0KICAgIH0NCiAgfQ0KICByZXR1cm4gIiI7IC8vcmV0dXJuIGJsYW5rIGlmIGludmFsaWQNCn0NCg0KLy9UdXJucyB0aGUgdGltZSBwYXJ0IG9mIGEgRGF0ZSBvYmplY3QgaW50byBhIHN0cmluZw0KLy8gZGF0ZSB2YWx1ICA6IGluIDtkYXRlIG9iamVjdA0KLy8gc3RyaW5nIGZybWkgIDogaW4gO2Zvcm1hdCBvZiB0aW1lIHJlcXVpcmVkICh1c2UgJkQgbm90YXRpb24gSDI6TjI6UzIuVDIgcCkNCmZ1bmN0aW9uIHNpdHNfdGltZV90b19zdHJpbmcodmFsdSxmcm1pKSB7DQogIGlmKHR5cGVvZihmcm1pKSE9InN0cmluZyIgfHwgZnJtaS5sZW5ndGg8MSkgew0KICAgIGZybWkgPSBzaXRzX3RpbWVfZm9ybWF0Ow0KICB9DQogIGlmKHZhbHUgaW5zdGFuY2VvZiBEYXRlICYmICFpc05hTih2YWx1LnZhbHVlT2YoKSkpIHsNCgkgIHZhciBhbV9wbSA9ICJBTSI7DQoJCXZhciBob3VycyA9IHZhbHUuZ2V0SG91cnMoKTsNCgkJaWYoaG91cnM+MTIpIHsNCgkJICBhbV9wbSA9ICJQTSI7DQoJCX0NCgkJaWYoaG91cnM+MTIgJiYoZnJtaS5zZWFyY2goInAiKT4wIHx8IGZybWkuc2VhcmNoKCJQIik+MCkpIHsNCgkJICBob3VycyAtPSAxMjsNCgkJfQ0KCQl2YXIgaG91cnMyID0gIjAwIitob3VyczsNCgkJaG91cnMyID0gaG91cnMyLnN1YnN0cmluZyhob3VyczIubGVuZ3RoLTIpOw0KCQl2YXIgbWlucyA9IHZhbHUuZ2V0TWludXRlcygpOw0KCQl2YXIgbWluczIgPSAiMDAiK21pbnM7DQoJCW1pbnMyID0gbWluczIuc3Vic3RyaW5nKG1pbnMyLmxlbmd0aC0yKTsNCgkJdmFyIHNlY3MgPSB2YWx1LmdldFNlY29uZHMoKTsNCgkJdmFyIHNlY3MyID0gIjAwIitzZWNzOw0KCQlzZWNzMiA9IHNlY3MyLnN1YnN0cmluZyhzZWNzMi5sZW5ndGgtMik7DQoNCgkJLy9UaWNrcyBjYW4gYmUgMyBkaWdpdHMgc28gd2UgbmVlZCB0byB0dXJuIGl0IGludG8gMiBkaWdpdHMNCgkJdmFyIHRpY2tzID0gdmFsdS5nZXRNaWxsaXNlY29uZHMoKTsNCgkJaWYodGlja3MgPD0gOSkgew0KCQkgIHRpY2tzID0gTWF0aC5yb3VuZCgoIjAuMCIrdmFsdS5nZXRNaWxsaXNlY29uZHMoKSkqMTAwKTsNCgkJfQ0KICAgIGVsc2Ugew0KCQkgIHRpY2tzID0gTWF0aC5yb3VuZCgoIjAuIit2YWx1LmdldE1pbGxpc2Vjb25kcygpKSoxMDApOw0KCQl9DQoJCXZhciB0aWNrczIgPSAiMDAiK3RpY2tzOw0KCQl0aWNrczIgPSB0aWNrczIuc3Vic3RyaW5nKHRpY2tzMi5sZW5ndGgtMik7DQoJCWZybWkgPSBzaXRzX3JlcGxhY2UoZnJtaSwiSDIiLGhvdXJzMik7DQoJCWZybWkgPSBzaXRzX3JlcGxhY2UoZnJtaSwiaDIiLGhvdXJzMik7DQoJCWZybWkgPSBzaXRzX3JlcGxhY2UoZnJtaSwiSCIsaG91cnMpOw0KCQlmcm1pID0gc2l0c19yZXBsYWNlKGZybWksImgiLGhvdXJzKTsNCgkJZnJtaSA9IHNpdHNfcmVwbGFjZShmcm1pLCJOMiIsbWluczIpOw0KCQlmcm1pID0gc2l0c19yZXBsYWNlKGZybWksIm4yIixtaW5zMik7DQoJCWZybWkgPSBzaXRzX3JlcGxhY2UoZnJtaSwiTiIsbWlucyk7DQoJCWZybWkgPSBzaXRzX3JlcGxhY2UoZnJtaSwibiIsbWlucyk7DQoJCWZybWkgPSBzaXRzX3JlcGxhY2UoZnJtaSwiUzIiLHNlY3MyKTsNCgkJZnJtaSA9IHNpdHNfcmVwbGFjZShmcm1pLCJzMiIsc2VjczIpOw0KCQlmcm1pID0gc2l0c19yZXBsYWNlKGZybWksIlMiLHNlY3MpOw0KCQlmcm1pID0gc2l0c19yZXBsYWNlKGZybWksInMiLHNlY3MpOw0KCQlmcm1pID0gc2l0c19yZXBsYWNlKGZybWksIlQyIix0aWNrczIpOw0KCQlmcm1pID0gc2l0c19yZXBsYWNlKGZybWksInQyIix0aWNrczIpOw0KCQlmcm1pID0gc2l0c19yZXBsYWNlKGZybWksIlQiLHRpY2tzKTsNCgkJZnJtaSA9IHNpdHNfcmVwbGFjZShmcm1pLCJ0Iix0aWNrcyk7DQoJCWZybWkgPSBzaXRzX3JlcGxhY2UoZnJtaSwicCIsYW1fcG0udG9Mb3dlckNhc2UoKSk7DQoJCWZybWkgPSBzaXRzX3JlcGxhY2UoZnJtaSwiUCIsYW1fcG0pOw0KCQlyZXR1cm4gZnJtaTsNCgl9DQoJcmV0dXJuICIiOw0KfQ0KDQovL1R1cm5zIGEgRGF0ZSBvYmplY3QgaW50byBhIHN0cmluZw0KLy8gZGF0ZSB2YWx1ICA6IGluIDtkYXRlIG9iamVjdA0KLy8gc3RyaW5nIGZybWkgIDogaW4gO2Zvcm1hdCBvZiBkYXRldGltZSByZXF1aXJlZA0KLy8gICAgICAgICAgICAgIERBVEUgRk9STUFUID0gc2VlIGh0dHA6Ly9hcGkuanF1ZXJ5dWkuY29tL2RhdGVwaWNrZXIvI3V0aWxpdHktZm9ybWF0RGF0ZQ0KLy8gICAgICAgICAgICAgIFRJTUUgRk9STUFUID0gdXNlICZEIG5vdGF0aW9uIEgyOk4yOlMyLlQyIHANCmZ1bmN0aW9uIHNpdHNfZGF0ZXRpbWVfdG9fc3RyaW5nKHZhbHUsZnJtaSkgew0KICBpZih0eXBlb2YodmFsdSk9PSJzdHJpbmciKSB7DQogICAgdmFsdSA9IHNpdHNfdW5pZmFjZV90b19kYXRlKHZhbHUpOyAvL3RyeSBjb252ZXJ0aW5nIFVuaWZhY2UgZGF0ZSBzdHJpbmcgaW50byBkYXRlDQogIH0NCiAgaWYodHlwZW9mKGZybWkpIT0ic3RyaW5nIiB8fCBmcm1pLmxlbmd0aDwxKSB7DQogICAgZnJtaSA9IHNpdHNfZGF0ZV9mb3JtYXQrIiAiK3NpdHNfdGltZV9mb3JtYXQ7DQogIH0NCiAgdmFyIGZybWkxID0gIiI7DQoJdmFyIGZybWkyID0gIiI7DQoJdmFyIGNoYXJfdG9fc3BsaXQgPSBmcm1pLnRvVXBwZXJDYXNlKCkuc2VhcmNoKCJIIik7DQoJaWYoY2hhcl90b19zcGxpdDwwKSBjaGFyX3RvX3NwbGl0ID0gZnJtaS50b1VwcGVyQ2FzZSgpLnNlYXJjaCgiTiIpOw0KCWlmKGNoYXJfdG9fc3BsaXQ8MCkgY2hhcl90b19zcGxpdCA9IGZybWkudG9VcHBlckNhc2UoKS5zZWFyY2goIlMiKTsNCglpZihjaGFyX3RvX3NwbGl0PDApIGNoYXJfdG9fc3BsaXQgPSBmcm1pLnRvVXBwZXJDYXNlKCkuc2VhcmNoKCJUIik7DQoJaWYoY2hhcl90b19zcGxpdDwwKSBjaGFyX3RvX3NwbGl0ID0gZnJtaS50b1VwcGVyQ2FzZSgpLnNlYXJjaCgiUCIpOw0KCWlmKGNoYXJfdG9fc3BsaXQ+PTApIHsNCgkgIGZybWkxID0gZnJtaS5zdWJzdHJpbmcoMCxjaGFyX3RvX3NwbGl0KTsNCgkgIGZybWkyID0gZnJtaS5zdWJzdHJpbmcoY2hhcl90b19zcGxpdCk7DQoJfQ0KICBlbHNlIHsNCgkgIGZybWkxID0gZnJtaTsNCgl9DQogIHZhciBkYXRlcGFydCA9IHNpdHNfZGF0ZV90b19zdHJpbmcodmFsdSxmcm1pMSk7DQoJdmFyIHRpbWVwYXJ0ID0gc2l0c190aW1lX3RvX3N0cmluZyh2YWx1LGZybWkyKTsNCglpZihkYXRlcGFydCE9IiIgJiYgdGltZXBhcnQhPSIiKSB7DQoJICByZXR1cm4gZGF0ZXBhcnQrdGltZXBhcnQ7DQogIH0NCglyZXR1cm4gIiI7DQp9DQoNCi8vRnVuY3Rpb24gdG8gY29udmVydCBhIGRhdGUgb2JqZWN0KGRhdGUgcGFydCBvbmx5KSB0byB1bmlmYWNlIGRhdGV0aW1lIGZvcm1hdA0KLy8gZGF0ZSB2YWx1ICA6IGluIDtkYXRlIG9iamVjdA0KZnVuY3Rpb24gc2l0c19kYXRlX3RvX3VuaWZhY2UodmFsdSkgew0KICB2YXIgZGF0ZXBhcnQgPSBzaXRzX2RhdGVfdG9fc3RyaW5nKHZhbHUsInl5bW1kZCIpOw0KCWlmKGRhdGVwYXJ0IT0iIikgew0KCSAgcmV0dXJuIGRhdGVwYXJ0KyIwMDAwMDAwMCI7DQogIH0NCglyZXR1cm4gIiI7DQp9DQoNCi8vRnVuY3Rpb24gdG8gY29udmVydCBhIGRhdGUgb2JqZWN0KHRpbWUgcGFydCBvbmx5KSB0byB1bmlmYWNlIGRhdGV0aW1lIGZvcm1hdA0KLy8gZGF0ZSB2YWx1ICA6IGluIDtkYXRlIG9iamVjdA0KZnVuY3Rpb24gc2l0c190aW1lX3RvX3VuaWZhY2UodmFsdSkgew0KICB2YXIgdGltZXBhcnQgPSBzaXRzX3RpbWVfdG9fc3RyaW5nKHZhbHUsIkgyTjJTMlQyIik7DQoJaWYodGltZXBhcnQhPSIiKSB7DQoJICByZXR1cm4gIjAwMDAwMDAwIit0aW1lcGFydDsNCiAgfQ0KCXJldHVybiAiIjsNCn0NCg0KLy9GdW5jdGlvbiB0byBjb252ZXJ0IGEgZGF0ZSBvYmplY3QgdG8gdW5pZmFjZSBkYXRldGltZSBmb3JtYXQNCi8vIGRhdGUgdmFsdSAgOiBpbiA7ZGF0ZSBvYmplY3QNCmZ1bmN0aW9uIHNpdHNfZGF0ZXRpbWVfdG9fdW5pZmFjZSh2YWx1KSB7DQoJcmV0dXJuIHNpdHNfZGF0ZXRpbWVfdG9fc3RyaW5nKHZhbHUsInl5bW1kZEgyTjJTMlQyIik7DQp9DQoNCi8vSW50ZXJuYWwgZnVuY3Rpb24gdG8gYWRkIGEgZGF0ZSBwaWNrZXIgdG8gYW4gaW5wdXQgZmllbGQoUFBMMDI4NjMzKQ0KLy8gc3RyaW5nICAgIHNlbCAgOiBpbiA7alF1ZXJ5IHNlbGVjdG9yIHRvIGFwcGx5IHRoZSBkYXRlIHBpY2tlciB0bw0KLy8gYm9vbGVhbiAgIGljbyAgOiBpbiA7c2hvdyBpY29uIG5leHQgdG8gZmllbGQoZGVmYXVsdCBpcyB0cnVlKQ0KLy8gc3RyaW5nICAgbWluZCAgOiBpbiA7bWluaW11bSBkYXRlKGllOiAiLTF5IC0xbSIpIC0gY2FuIGFsc28gYmUgbnVtZXJpYyBudW1iZXIgb2YgZGF5cygtNykNCi8vIHN0cmluZyAgIG1heGQgIDogaW4gO21heGltdW0gZGF0ZShpZTogIisxeSArMW0iKSAtIGNhbiBhbHNvIGJlIG51bWVyaWMgbnVtYmVyIG9mIGRheXMoKzcpDQovLyBmdW5jdGlvbiAgZm5jICA6IGluIDtjYWxsYmFjayBmdW5jdGlvbiB3aGVuIGRhdGUgc2VsZWN0ZWQNCi8vIG51bWVyaWMgIG1vZGUgIDogaW4gOzA9ZGF0ZSwgMT10aW1lLCAyPWRhdGV0aW1lKGRlZmF1bHQgaXMgMCkNCmZ1bmN0aW9uIHNpdHNfdWlfZGF0ZV9waWNrZXIoc2VsLGljbyxtaW5kLG1heGQsZm5jLG1vZGUpIHsNCiAgaWYoKHR5cGVvZihzZWwpPT0ic3RyaW5nIiAmJiBzZWwubGVuZ3RoPjApIHx8IHR5cGVvZihzZWwpPT0ib2JqZWN0IikgeyAvL2NoZWNrIGZpcnN0IHBhcmFtZXRlcg0KICAgIGlmKHR5cGVvZihpY28pIT0iYm9vbGVhbiIpIHsNCiAgICAgIGljbyA9IHRydWU7IC8vY2hlY2sgc2Vjb25kIHBhcmFtZXRlcg0KICAgIH0NCiAgICBpZih0eXBlb2YobWluZCk9PSJ1bmRlZmluZWQiKSB7DQogICAgICBtaW5kID0gbnVsbDsgLy9jaGVjayB0aGlyZCBwYXJhbWV0ZXINCiAgICB9DQogICAgaWYodHlwZW9mKG1heGQpPT0idW5kZWZpbmVkIikgew0KICAgICAgbWF4ZCA9IG51bGw7IC8vY2hlY2sgZm91cnRoIHBhcmFtZXRlcg0KICAgIH0NCiAgICBpZih0eXBlb2YobW9kZSkhPSJudW1iZXIiKSB7DQogICAgICBtb2RlID0gMDsgLy9jaGVjayBzaXh0aCBwYXJhbWV0ZXINCiAgICB9DQogICAgdmFyIG9iaiA9ICQoc2VsKTsgLy9nZXQgb2JqZWN0IGFycmF5DQogICAgaWYob2JqLmxlbmd0aD4wKSB7DQogICAgICB2YXIgaW1nID0gIiI7DQogICAgICB2YXIgb3B0ID0ge307DQogICAgICBvcHQueWVhclJhbmdlID0gc2l0c195ZWFyX3JhbmdlOyAvL3NldCB5ZWFyIHJhbmdlLCBpZTogIi0xMDA6KzUwIg0KICAgICAgb3B0LmRhdGVGb3JtYXQgPSBzaXRzX2RhdGVfZm9ybWF0OyAvL3NldCBmb3JtYXQsIGllOiAiMDEvSmFuLzIwMDEiDQogICAgICBvcHQudGltZUZvcm1hdCA9IHNpdHNfdGltZV9mb3JtYXQucmVwbGFjZSgvSDIvZywiSEgiKS5yZXBsYWNlKC9OMi9nLCJtbSIpLnJlcGxhY2UoL04vZywibSIpOyAvL2NvbnZlcnQgZm9ybWF0DQogICAgICBvcHQuY2hhbmdlTW9udGggPSB0cnVlOw0KICAgICAgb3B0LmNoYW5nZVllYXIgPSB0cnVlOw0KICAgICAgb3B0LmR1cmF0aW9uID0gc2l0c19hbmltX3NwZWVkOw0KICAgICAgb3B0LnNob3J0WWVhckN1dG9mZiA9IHNpdHNfY2VudHVyeV9icmVhazsNCiAgICAgIHN3aXRjaChtb2RlKSB7DQogICAgICAgIGNhc2UgMTogLy90aW1lDQogICAgICAgICAgaW1nID0gIi4uL2ltYWdlcy9zaV9jbG9jay5naWYiOw0KICAgICAgICAgIG9wdC5idXR0b25UZXh0ID0gc2l0c193aWRnZXRfYnAudWkgJiYgc2l0c193aWRnZXRfYnAudWkuZGF0ZVBpY2tlclRpbWUgfHwgc2l0c19idXR0b25fdGV4dDsgLy9zZXQgYnV0dG9uIHRvb2x0aXAsIGllOiAiLi4uIg0KICAgICAgICAgIG9wdC5taW5UaW1lID0gbWluZCB8fCBudWxsOyAvL3NldCBtaW5pbXVtIHRpbWUNCiAgICAgICAgICBvcHQubWF4VGltZSA9IG1heGQgfHwgbnVsbDsgLy9zZXQgbWF4aW11bSB0aW1lDQogICAgICAgICAgb3B0LnRpbWVPbmx5ID0gdHJ1ZTsNCiAgICAgICAgICBvcHQuYWZ0ZXJJbmplY3QgPSBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgIHZhciBkaXYgPSAkKCJkaXYudWktdGltZXBpY2tlci1kaXYiKTsNCiAgICAgICAgICAgIGRpdi5maW5kKCJkaXYudWktd2lkZ2V0LWhlYWRlciIpLmFkZENsYXNzKCJ1aS1kYXRlcGlja2VyLWhlYWRlciIpOyAvL2ZpeCBoZWFkZXIgc3R5bGUNCiAgICAgICAgICAgIHNpdHNfaGlkZSgiYnV0dG9uLnVpLWRhdGVwaWNrZXItY3VycmVudCIpOw0KICAgICAgICAgICAgdmFyIGNscyA9ICQoIiN1aS1kYXRlcGlja2VyLWRpdiIpLmRhdGEoImRkLWFjdGl2ZSIpOw0KICAgICAgICAgICAgaWYoY2xzKSB7DQogICAgICAgICAgICAgICQoImRpdi4iK2NscyxkaXYpLmZpbmQoInNwYW4udWktc2xpZGVyLWhhbmRsZSIpLmFkZENsYXNzKCJ1aS1zdGF0ZS1mb2N1cyIpOyAvL2ZvY3VzIG9uIHNsaWRlcg0KICAgICAgICAgICAgfQ0KICAgICAgICAgIH07DQogICAgICAgICAgb3B0LmFkZFNsaWRlckFjY2VzcyA9IHRydWU7IC8vcmVxdWlyZXMgImpxdWVyeS11aS1zbGlkZXJBY2Nlc3MuanMiDQogICAgICAgICAgb3B0LnNsaWRlckFjY2Vzc0FyZ3MgPSB7fTsNCiAgICAgICAgICBvcHQgPSAkLmV4dGVuZChvcHQsc2l0c193aWRnZXRfYnAudHAgfHwge30pOyAvL3VzZSBib2lsZXJwbGF0ZXMNCiAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAyOiAvL2RhdGV0aW1lDQogICAgICAgICAgaW1nID0gIi4uL2ltYWdlcy9zaV9jYWxfY2xvY2suZ2lmIjsNCiAgICAgICAgICBvcHQuYnV0dG9uVGV4dCA9IHNpdHNfd2lkZ2V0X2JwLnVpICYmIHNpdHNfd2lkZ2V0X2JwLnVpLmRhdGVQaWNrZXJEYXRlVGltZSB8fCBzaXRzX2J1dHRvbl90ZXh0OyAvL3NldCBidXR0b24gdG9vbHRpcCwgaWU6ICIuLi4iDQogICAgICAgICAgb3B0Lm1pbkRhdGVUaW1lID0oc2l0c190eXBlX29mKG1pbmQpPT0iZGF0ZSIgPyBtaW5kIDogbnVsbCk7IC8vc2V0IG1pbmltdW0gZGF0ZXRpbWUNCiAgICAgICAgICBvcHQubWF4RGF0ZVRpbWUgPShzaXRzX3R5cGVfb2YobWF4ZCk9PSJkYXRlIiA/IG1heGQgOiBudWxsKTsgLy9zZXQgbWF4aW11bSBkYXRldGltZQ0KICAgICAgICAgIG9wdC50aW1lT25seSA9IGZhbHNlOw0KICAgICAgICAgIG9wdC5hZnRlckluamVjdCA9IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgdmFyIGRpdiA9ICQoImRpdi51aS10aW1lcGlja2VyLWRpdiIpOw0KICAgICAgICAgICAgZGl2LmZpbmQoImRpdi51aS13aWRnZXQtaGVhZGVyIikuYWRkQ2xhc3MoInVpLWRhdGVwaWNrZXItaGVhZGVyIik7IC8vZml4IGhlYWRlciBzdHlsZQ0KICAgICAgICAgICAgc2l0c19oaWRlKCJidXR0b24udWktZGF0ZXBpY2tlci1jdXJyZW50Iik7DQogICAgICAgICAgICB2YXIgY2xzID0gJCgiI3VpLWRhdGVwaWNrZXItZGl2IikuZGF0YSgiZGQtYWN0aXZlIik7DQogICAgICAgICAgICBpZihjbHMpIHsNCiAgICAgICAgICAgICAgJCgiZGl2LiIrY2xzLGRpdikuZmluZCgic3Bhbi51aS1zbGlkZXItaGFuZGxlIikuYWRkQ2xhc3MoInVpLXN0YXRlLWZvY3VzIik7IC8vZm9jdXMgb24gc2xpZGVyDQogICAgICAgICAgICB9DQogICAgICAgICAgfTsNCiAgICAgICAgICBvcHQuYWRkU2xpZGVyQWNjZXNzID0gdHJ1ZTsgLy9yZXF1aXJlcyAianF1ZXJ5LXVpLXNsaWRlckFjY2Vzcy5qcyINCiAgICAgICAgICBvcHQuc2xpZGVyQWNjZXNzQXJncyA9IHt9Ow0KICAgICAgICAgIG9wdCA9ICQuZXh0ZW5kKG9wdCxzaXRzX3dpZGdldF9icC50cCB8fCB7fSk7IC8vdXNlIGJvaWxlcnBsYXRlcw0KICAgICAgICAgIGJyZWFrOw0KICAgICAgICBkZWZhdWx0OiAvL2RhdGUNCiAgICAgICAgICBpbWcgPSAiLi4vaW1hZ2VzL3NpX2NhbGVuZGFyLmdpZiI7DQogICAgICAgICAgb3B0LmJ1dHRvblRleHQgPSBzaXRzX3dpZGdldF9icC51aSAmJiBzaXRzX3dpZGdldF9icC51aS5kYXRlUGlja2VyRGF0ZSB8fCBzaXRzX2J1dHRvbl90ZXh0OyAvL3NldCBidXR0b24gdG9vbHRpcCwgaWU6ICIuLi4iDQogICAgICAgICAgb3B0Lm1pbkRhdGUgPSBtaW5kOyAvL3NldCBtaW5pbXVtIGRhdGUNCiAgICAgICAgICBvcHQubWF4RGF0ZSA9IG1heGQ7IC8vc2V0IG1heGltdW0gZGF0ZQ0KICAgICAgfQ0KICAgICAgaWYoaWNvKSB7DQogICAgICAgIG9wdC5zaG93T24gPSAiYnV0dG9uIjsgLy9kaXNwbGF5IGljb24gbmV4dCB0byBmaWVsZA0KICAgICAgICBvcHQuYnV0dG9uSW1hZ2VPbmx5ID0gdHJ1ZTsNCiAgICAgICAgb3B0LmJ1dHRvbkltYWdlID0gaW1nOw0KICAgICAgfQ0KICAgICAgZWxzZSB7DQogICAgICAgIG9wdC5zaG93T24gPSAiZm9jdXMiOyAvL25vIGljb24gc28gZmlyZSBvbiBmb2N1cw0KICAgICAgfQ0KICAgICAgaWYodHlwZW9mKGZuYyk9PSJmdW5jdGlvbiIpIHsNCiAgICAgICAgb3B0Lm9uU2VsZWN0ID0gZm5jOyAvL2NhbGxiYWNrIGZ1bmN0aW9uIHdoZW4gdmFsdWUgc2VsZWN0ZWQNCiAgICAgIH0NCiAgICAgIG9wdC5iZWZvcmVTaG93ID0gZnVuY3Rpb24oaW5wLG9iaikgeyAvL3N0YWNraW5nIGZpeA0KICAgICAgICB2YXIganFfaW5wID0gJChpbnApOw0KICAgICAgICBpZihqcV9pbnAuaXMoIjpkaXNhYmxlZCxbcmVhZG9ubHldIikpIHsNCiAgICAgICAgICBqcV9pbnAuZGF0ZXBpY2tlcigiZGlzYWJsZSIpOyAvL2Rvbid0IHNob3cgcG9wdXAgaWYgZmllbGQgaXMgZGlzYWJsZWQgb3IgcmVhZG9ubHkNCiAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0NCiAgICAgICAgaWYodHlwZW9mKGRteF90b29sdGlwX3ZlcnNpb24pPT0ic3RyaW5nIikgew0KICAgICAgICAgICQoImJvZHkiKS50b29sdGlwKCJkaXNhYmxlIik7IC8vZGlzYWJsZSB0b29sdGlwcyB0byBhdm9pZCBjb25mbGljdA0KICAgICAgICB9DQogICAgICAgIHZhciBtcmcgPSAwOw0KICAgICAgICB2YXIgbGZ0ID0gMDsNCiAgICAgICAgdmFyIHBhciA9IGpxX2lucC5jbG9zZXN0KCJkaXYuc3YtaW5wdXQtZ3JvdXAiKTsNCiAgICAgICAgaWYocGFyLmxlbmd0aD09MSkgew0KICAgICAgICAgIG1yZyA9IHBhci5vdXRlcldpZHRoKCktb2JqLmRwRGl2Lm91dGVyV2lkdGgoKTsgLy9hbGlnbiB0byBpbnB1dCBncm91cA0KICAgICAgICAgIGxmdCA9IHBhci5vZmZzZXQoKS5sZWZ0Ow0KICAgICAgICB9DQogICAgICAgIGVsc2Ugew0KICAgICAgICAgIG1yZyA9IGpxX2lucC5vdXRlcldpZHRoKCktb2JqLmRwRGl2Lm91dGVyV2lkdGgoKTsgLy9hbGlnbiB0byBpbnB1dCBmaWVsZA0KICAgICAgICAgIGxmdCA9IGpxX2lucC5vZmZzZXQoKS5sZWZ0Ow0KICAgICAgICB9DQogICAgICAgIGlmKGxmdCttcmc+MCkgew0KICAgICAgICAgIG9iai5kcERpdi5jc3Moe21hcmdpbkxlZnQ6bXJnKyJweCJ9KTsgLy9yaWdodCBhbGlnbiBwb3B1cA0KICAgICAgICB9DQogICAgICAgIGVsc2Ugew0KICAgICAgICAgIG9iai5kcERpdi5jc3Moe21hcmdpbkxlZnQ6IiJ9KTsgLy9yZXNldCBtYXJnaW4NCiAgICAgICAgfQ0KICAgICAgICBpZihqcV9pbnAuaGFzQ2xhc3MoImhhc1RpbWVwaWNrZXIiKSAmJiBqcV9pbnAudmFsKCk9PSIiKSB7IC8vY2hlY2sgZm9yIGJsYW5rIHRpbWUgdmFsdWUNCiAgICAgICAgICB2YXIgdHBvID0gb2JqLnNldHRpbmdzLnRpbWVwaWNrZXI7DQogICAgICAgICAgdHBvLmhvdXIgPSAwOw0KICAgICAgICAgIHRwby5taW51dGUgPSAwOw0KICAgICAgICAgIHRwby5zZWNvbmQgPSAwOw0KICAgICAgICAgIHRwby5taWxsaXNlYyA9IDA7DQogICAgICAgICAgdHBvLm1pY3Jvc2VjID0gMDsNCiAgICAgICAgfQ0KICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgew0KICAgICAgICAgIHZhciBkaXYgPSAkKCIjdWktZGF0ZXBpY2tlci1kaXYiKTsgLy9nZXQgcG9wdXANCiAgICAgICAgICB2YXIgbWluID0gKGpxX2lucC5jc3MoInpJbmRleCIpKjEgfHwgMCk7IC8vbWluaW11bSBvcmRlciBpbiBzdGFjaw0KICAgICAgICAgIHZhciBwYXIgPSBqcV9pbnAuY2xvc2VzdCgiZGl2LnVpLWRpYWxvZyIpOyAvL2dldCBkaWFsb2cgZGl2DQogICAgICAgICAgaWYocGFyLmxlbmd0aD09MSkgew0KICAgICAgICAgICAgbWluID0gTWF0aC5tYXgoKHBhci5jc3MoInpJbmRleCIpKjEgfHwgMCksbWluKTsgLy9jaGVjayBpZiBkaWFsb2cgaXMgaGlnaGVyDQogICAgICAgICAgfQ0KICAgICAgICAgIGlmKCFpc05hTihtaW4pICYmIG1pbj4wKSB7DQogICAgICAgICAgICB2YXIgY3VyID0gZGl2LmNzcygiekluZGV4Iik7IC8vY3VycmVudCBvcmRlciBpbiBzdGFjaw0KICAgICAgICAgICAgaWYoaXNOYU4oY3VyKSB8fCBjdXIqMTw9bWluKjEpIHsNCiAgICAgICAgICAgICAgZGl2LmNzcygiekluZGV4IixtaW4qMSsxKTsgLy9zZXQgdG8gbWluaW11bSBvcmRlciBpZiBjdXJyZW50IGlzIGxlc3MNCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9DQogICAgICAgICAgdmFyIG10aCA9IHNpdHNfd2lkZ2V0X2JwLnVpICYmIHNpdHNfd2lkZ2V0X2JwLnVpLmRhdGVQaWNrZXJNb250aCB8fCAiU2VsZWN0IGEgbW9udGgiOw0KICAgICAgICAgIHZhciB5ZWEgPSBzaXRzX3dpZGdldF9icC51aSAmJiBzaXRzX3dpZGdldF9icC51aS5kYXRlUGlja2VyWWVhciB8fCAiU2VsZWN0IGEgeWVhciI7DQogICAgICAgICAgZGl2LmZpbmQoInNlbGVjdC51aS1kYXRlcGlja2VyLW1vbnRoIikuYXR0cigidGl0bGUiLG10aCk7IC8vYWRkIHRpdGxlcyBmb3IgYWNjZXNzaWJpbGl0eQ0KICAgICAgICAgIGRpdi5maW5kKCJzZWxlY3QudWktZGF0ZXBpY2tlci15ZWFyIikuYXR0cigidGl0bGUiLHllYSk7DQogICAgICAgICAgaWYob3B0LmJ1dHRvblRleHQhPXNpdHNfYnV0dG9uX3RleHQpIHsNCiAgICAgICAgICAgIHZhciBjYXAgPSAkKCI8Y2FwdGlvbj4iKS5hZGRDbGFzcygic3Ytc3Itb25seSIpLnRleHQob3B0LmJ1dHRvblRleHQpOyAvL2FkZCBjYXB0aW9uDQogICAgICAgICAgICBkaXYuZmluZCgidGFibGUudWktZGF0ZXBpY2tlci1jYWxlbmRhciIpLnByZXBlbmQoY2FwKTsNCiAgICAgICAgICB9DQogICAgICAgICAgZGl2LmZpbmQoIltjbGFzc149JyAnXSIpLmVhY2goZnVuY3Rpb24oaSkgew0KICAgICAgICAgICAgJCh0aGlzKS5hdHRyKCJjbGFzcyIsJC50cmltKHRoaXMuY2xhc3NOYW1lKSk7IC8vcmVtb3ZlIHdoaXRlc3BhY2UgZnJvbSBjbGFzcw0KICAgICAgICAgIH0pOw0KICAgICAgICB9LDEwKTsNCiAgICAgIH07DQogICAgICBvcHQub25DbG9zZSA9IGZ1bmN0aW9uKHN0cixvYmopIHsNCiAgICAgICAgaWYodHlwZW9mKGRteF90b29sdGlwX3ZlcnNpb24pPT0ic3RyaW5nIikgew0KICAgICAgICAgICQoImJvZHkiKS50b29sdGlwKCJlbmFibGUiKTsgLy9yZS1lbmFibGUgdG9vbHRpcHMgb24gY2xvc2UNCiAgICAgICAgfQ0KICAgICAgICBpZigkKGRvY3VtZW50LmFjdGl2ZUVsZW1lbnQpLnBhcmVudHMoIiN1aS1kYXRlcGlja2VyLWRpdiIpLmxlbmd0aD4wKSB7DQogICAgICAgICAgdGhpcy5mb2N1cygpOyAvL2ZvY3VzIGJhY2sgb24gdGhlIGlucHV0DQogICAgICAgIH0NCiAgICAgIH07DQogICAgICBzd2l0Y2gobW9kZSkgew0KICAgICAgICBjYXNlIDE6IC8vdGltZQ0KICAgICAgICAgIG9iai50aW1lcGlja2VyKG9wdCkuYWRkQ2xhc3MoImhhc1RpbWVwaWNrZXIiKTsgLy9jcmVhdGUgdGltZSBwaWNrZXINCiAgICAgICAgICBicmVhazsNCiAgICAgICAgY2FzZSAyOiAvL2RhdGV0aW1lDQogICAgICAgICAgb2JqLmRhdGV0aW1lcGlja2VyKG9wdCkuYWRkQ2xhc3MoImhhc1RpbWVwaWNrZXIiKTsgLy9jcmVhdGUgZGF0ZXRpbWUgcGlja2VyDQogICAgICAgICAgYnJlYWs7DQogICAgICAgIGRlZmF1bHQ6IC8vZGF0ZQ0KICAgICAgICAgIG9iai5kYXRlcGlja2VyKG9wdCk7IC8vY3JlYXRlIGRhdGUgcGlja2VyDQogICAgICB9DQogICAgICBvYmouZWFjaChmdW5jdGlvbigpIHsNCiAgICAgICAgdmFyIGlucCA9ICQodGhpcyk7DQogICAgICAgIHZhciBwYXIgPSBpbnAuY2xvc2VzdCgiZGl2LnN2LWlucHV0LWdyb3VwIik7IC8vZ2V0IHBhcmVudCBkaXYNCiAgICAgICAgaWYoaW5wLmhhc0NsYXNzKCJoYXNEYXRlcGlja2VyIikgJiYgaW5wLmxlbmd0aD09MSkgew0KICAgICAgICAgIHZhciBpbWcgPSBpbnAubmV4dCgiaW1nLnVpLWRhdGVwaWNrZXItdHJpZ2dlciIpOyAvL2dldCB0cmlnZ2VyIGltYWdlDQogICAgICAgICAgcGFyLmZpbmQoInNwYW4uc3YtaW5wdXQtZ3JvdXAtYWRkb24iKS5hcHBlbmQoaW1nKTsgLy9tb3ZlIGltYWdlIGludG8gaW5wdXQgZ3JvdXANCiAgICAgICAgfQ0KICAgICAgfSk7DQogICAgICBpZihvYmouYXR0cigiZGF0YS13ZWJ2YWxpZGF0aW9uIikhPSJvbiIpIHsgLy9oaWRlIHRoZSBjYWxlbmRhciB0byBzdGFydCB3aXRoDQogICAgICAgIG9iai5ibHVyKCk7IC8vdGhpcyBpcyBuZWVkZWQgdG8gdGhhdCB2YWx1ZXMgYXJlIG5vdCByZXNldCAtIHNvbWV0aGluZyB0byBkbyB3aXRoIGNhY2hpbmcgbWF5YmU/DQogICAgICB9DQogICAgICBlbHNlIHsNCiAgICAgICAgb2JqLmF0dHIoImRhdGEtd2VidmFsaWRhdGlvbiIsIm9mZiIpLmJsdXIoKS5hdHRyKCJkYXRhLXdlYnZhbGlkYXRpb24iLCJvbiIpOyAvL2hpZGUgYnV0IGRvbid0IGRvIHdlYiB2YWxpZGF0aW9uDQogICAgICB9DQogICAgICAkKCIjdWktZGF0ZXBpY2tlci1kaXYiKS5hZGRDbGFzcygidWktZnJvbnQiKS5jc3MoImRpc3BsYXkiLCJub25lIik7IC8vaGlkZSBpbml0aWFsbHkNCiAgICAgICQoImltZy51aS1kYXRlcGlja2VyLXRyaWdnZXIiKS5maWx0ZXIoIjpub3QoW3RhYmluZGV4XSkiKS5lYWNoKGZ1bmN0aW9uKGkpIHsNCiAgICAgICAgdmFyIGljbyA9ICQodGhpcykuYXR0cigicm9sZSIsImJ1dHRvbiIpOyAvL2dldCB0cmlnZ2VyIGljb24gYW5kIG1ha2UgaXQgYSBidXR0b24NCiAgICAgICAgdmFyIGlucCA9IGljby5wcmV2KCJpbnB1dCIpOyAvL2dldCBpbnB1dCBvYmplY3QNCiAgICAgICAgaWYoaW5wLmxlbmd0aDwxKSB7DQogICAgICAgICAgaW5wID0gaWNvLnBhcmVudCgic3BhbiIpLnByZXYoImlucHV0Iik7IC8vaGFuZGxlIGlucHV0IGdyb3VwDQogICAgICAgIH0NCiAgICAgICAgaWYoaW5wLmlzKCI6ZGlzYWJsZWQsW3JlYWRvbmx5XSIpKSB7DQogICAgICAgICAgaW5wLmRhdGVwaWNrZXIoImRpc2FibGUiKTsgLy9kb24ndCBzaG93IHBvcHVwIGlmIGZpZWxkIGlzIGRpc2FibGVkIG9yIHJlYWRvbmx5DQogICAgICAgICAgcmV0dXJuIHRydWU7DQogICAgICAgIH0NCiAgICAgICAgdmFyIHRpcCA9IGlucC5hdHRyKCJkYXRhLXR0aXAiKSB8fCBpbnAuYXR0cigidHRpcCIpOyAvL2dldCB0b29sdGlwIGZyb20gaW5wdXQNCiAgICAgICAgaWYodGlwKSB7DQogICAgICAgICAgaWNvLmF0dHIoImRhdGEtdHRpcCIsdGlwKTsgLy9jb3B5IHRvb2x0aXAgZnJvbSBpbnB1dCB0byBpY29uDQogICAgICAgIH0NCiAgICAgICAgaWNvLmtleWRvd24oZnVuY3Rpb24oZXZ0KSB7IC8vc2hvdyBkYXRlIHBpY2tlciBvbiBrZXkgZG93bg0KICAgICAgICAgIHZhciB0YWIgPSBldnQuRE9NX1ZLX1RBQiB8fCA5Ow0KICAgICAgICAgIHZhciBzaGYgPSBldnQuRE9NX1ZLX1NISUZUIHx8IDE2Ow0KICAgICAgICAgIHZhciBrZXkgPSBldnQud2hpY2g7IC8vZ2V0IGtleSBjb2RlDQogICAgICAgICAgaWYoa2V5IT10YWIgJiYga2V5IT1zaGYpIHsgLy9jaGVjayBub3QoYmFjayl0YWJiaW5nDQogICAgICAgICAgICAkKHRoaXMpLmNsaWNrKCk7IC8vZmlyZSBjbGljaw0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgICAgIGljby5wcm9wKCJ0YWJpbmRleCIsIjAiKTsgLy9tYWtlIGljb24gcHJvbXB0YWJsZQ0KICAgICAgfSk7DQogICAgICBpZihtb2RlPjAgJiYgIXNpdHNfZXZlbnRzLnRpbWVwaWNrZXJLZXlkb3duKSB7DQogICAgICAgICQoZG9jdW1lbnQpLm9uKCJrZXlkb3duIiwiLmhhc1RpbWVwaWNrZXIiLHNpdHNfdGltZV9waWNrZXJfa2V5ZG93bik7DQogICAgICAgIHNpdHNfZXZlbnRzLnRpbWVwaWNrZXJLZXlkb3duID0gdHJ1ZTsNCiAgICAgIH0NCiAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCiAgfQ0KICByZXR1cm4gZmFsc2U7DQp9DQoNCi8vQWRkIGEgZGF0ZXRpbWUgcGlja2VyIHRvIGFuIGlucHV0IGZpZWxkDQovLyBzdHJpbmcgICBzZWwgIDogaW4gO2pRdWVyeSBzZWxlY3RvciB0byBhcHBseSB0aGUgdGltZSBwaWNrZXIgdG8NCi8vIGJvb2xlYW4gIGljbyAgOiBpbiA7c2hvdyBpY29uIG5leHQgdG8gZmllbGQoZGVmYXVsdCBpcyB0cnVlKQ0KLy8gZGF0ZSAgICAgbWluZCAgOiBpbiA7bWluaW11bSBkYXRldGltZQ0KLy8gZGF0ZSAgICAgbWF4ZCAgOiBpbiA7bWF4aW11bSBkYXRldGltZQ0KLy8gZnVuY3Rpb24gIGZuYyAgOiBpbiA7Y2FsbGJhY2sgZnVuY3Rpb24gd2hlbiBkYXRldGltZSBzZWxlY3RlZA0KZnVuY3Rpb24gc2l0c19kYXRldGltZV9waWNrZXIoc2VsLGljbyxtaW5kLG1heGQsZm5jKSB7DQogIHJldHVybiBzaXRzX3RpbWVfcGlja2VyKHNlbCxpY28sbnVsbCxtaW5kLG1heGQsZm5jLHRydWUpOw0KfQ0KDQovL0FkZCBhIHRpbWUgcGlja2VyIHRvIGFuIGlucHV0IGZpZWxkDQovLyBzdHJpbmcgICBzZWwgIDogaW4gO2pRdWVyeSBzZWxlY3RvciB0byBhcHBseSB0aGUgdGltZSBwaWNrZXIgdG8NCi8vIGJvb2xlYW4gIGljbyAgOiBpbiA7c2hvdyBpY29uIG5leHQgdG8gZmllbGQoZGVmYXVsdCBpcyB0cnVlKQ0KLy8gYm9vbGVhbiAgc2VjICA6IGluIDtzaG93IHNlY29uZHMoSUdOT1JFRCAtIGNvbWVzIGZyb20gc2l0c190aW1lX2Zvcm1hdCBpbiBzZXR0aW5ncy5qcykNCi8vIHN0cmluZyAgIG1pbmQgIDogaW4gO21pbmltdW0gdGltZShzYW1lIGZvcm1hdCBhcyBzaXRzX3RpbWVfZm9ybWF0IGluIHNldHRpbmdzLmpzKQ0KLy8gc3RyaW5nICAgbWF4ZCAgOiBpbiA7bWF4aW11bSB0aW1lKHNhbWUgZm9ybWF0IGFzIHNpdHNfdGltZV9mb3JtYXQgaW4gc2V0dGluZ3MuanMpDQovLyBmdW5jdGlvbiAgZm5jICA6IGluIDtjYWxsYmFjayBmdW5jdGlvbiB3aGVuIGRhdGV0aW1lIHNlbGVjdGVkDQovLyBib29sZWFuICBkYXQgIDogaW4gO3Nob3cgZGF0ZShkZWZhdWx0IGlzIGZhbHNlKQ0KZnVuY3Rpb24gc2l0c190aW1lX3BpY2tlcihzZWwsaWNvLHNlYyxtaW5kLG1heGQsZm5jLGRhdCkgew0KICB2YXIgbW9kZSA9IChkYXQ9PT10cnVlID8gMiA6IDEpOyAvLzA9ZGF0ZSwgMT10aW1lLCAyPWRhdGV0aW1lDQogIHZhciBsb2MgPSBzaXRzX21pbmlmaWVkX3BhdGgoIi4uL3BsdWdpbnMvamF2YXNjcmlwdC90aW1lcGlja2VyLyIsInRpbWVwaWNrZXIuanMiLCJ0aW1lcGlja2VyLm1pbi5qcyIpOw0KICBpZihzaXRzX2ZpbGVzX2FycmF5W2xvY109PSJZIikgeyAvL2FscmVhZHkgbG9hZGVkLi4uDQogICAgc2l0c191aV9kYXRlX3BpY2tlcihzZWwsaWNvLG1pbmQsbWF4ZCxmbmMsbW9kZSk7IC8vLi4uc28gY2FsbCBzdHJhaWdodCBhd2F5DQogIH0NCiAgZWxzZSB7IC8vbm90IGxvYWRlZCB5ZXQuLi4NCiAgICB2YXIgcGFyID0ge307IC8vY3JlYXRlIGFuIG9iamVjdCBvZiBwYXJhbWV0ZXJzDQogICAgcGFyLnVybCA9IGxvYzsNCiAgICBwYXIuZm5jID0gc2l0c191aV9kYXRlX3BpY2tlcjsNCiAgICBwYXIucDAxID0gc2VsOw0KICAgIHBhci5wMDIgPSBpY287DQogICAgcGFyLnAwMyA9IG1pbmQ7DQogICAgcGFyLnAwNCA9IG1heGQ7DQogICAgcGFyLnAwNSA9IGZuYzsNCiAgICBwYXIucDA2ID0gbW9kZTsNCiAgICB2YXIgbGVuID0gc2l0c19wYXJhbV9hcnJheS5wdXNoKHBhcik7IC8vc2F2ZSBmb3IgbGF0ZXINCiAgICBzaXRzX2luY2x1ZGVfZmlsZShzaXRzX21pbmlmaWVkX3BhdGgoIi4uL3BsdWdpbnMvamF2YXNjcmlwdC90aW1lcGlja2VyLyIsImpxdWVyeS11aS1zbGlkZXJBY2Nlc3MuanMiLCJqcXVlcnktdWktc2xpZGVyQWNjZXNzLm1pbi5qcyIpLGZ1bmN0aW9uKGJvbykgew0KICAgICAgc2l0c19pbmNsdWRlX2ZpbGUoc2l0c19taW5pZmllZF9wYXRoKCIuLi9wbHVnaW5zL2phdmFzY3JpcHQvdGltZXBpY2tlci8iLCJ0aW1lcGlja2VyLmpzIiwidGltZXBpY2tlci5taW4uanMiKSk7DQogICAgfSk7DQogIH0NCiAgcmV0dXJuIHRydWU7DQp9DQoNCi8vSW50ZXJuYWwgZnVuY3Rpb24gdG8gaGFuZGxlIGtleWJvYXJkIG5hdmlnYXRpb24gZm9yIHRpbWUgcGlja2VyDQpmdW5jdGlvbiBzaXRzX3RpbWVfcGlja2VyX2tleWRvd24oZXZ0KSB7DQogIGlmKGV2dC5zaGlmdEtleSAmJiBldnQud2hpY2g+PTM3ICYmIGV2dC53aGljaDw9NDApIHsgLy9zaGlmdCBrZXkgbXVzdCBiZSBwcmVzc2VkIHdpdGggYW4gYXJyb3cga2V5DQogICAgdmFyIGRpdiA9ICQoIiN1aS1kYXRlcGlja2VyLWRpdiIpOw0KICAgIGlmKGRpdi5pcygiOnZpc2libGUiKSkgew0KICAgICAgdmFyIGRkcyA9IGRpdi5maW5kKCJkZDpub3QoLnVpX3RwaWNrZXJfdW5pdF9oaWRlKTpub3QoLnVpX3RwaWNrZXJfdGltZSkiKTsgLy9maW5kIHRpbWUgc2xpZGVycw0KICAgICAgaWYoZGRzLmxlbmd0aD4xKSB7DQogICAgICAgIHZhciBkZGEgPSAkKCJzcGFuLnVpLXN0YXRlLWZvY3VzIixkZHMpLmNsb3Nlc3QoImRkIik7IC8vZmluZCBjdXJyZW50bHkgZm9jdXNlZCB0aW1lIHNsaWRlcg0KICAgICAgICBzd2l0Y2goZXZ0LndoaWNoKSB7IC8vaGFuZGxlIGtleSBwcmVzc2VzDQogICAgICAgICAgY2FzZSAzNzogLy9sZWZ0DQogICAgICAgICAgICBzaXRzX3RpbWVfcGlja2VyX21vdmVfaG9yKGRkcyxkZGEsLTEpOyAvL3NoaWZ0IHNsaWRlciBsZWZ0DQogICAgICAgICAgICBicmVhazsNCiAgICAgICAgICBjYXNlIDM4OiAvL3VwDQogICAgICAgICAgICBzaXRzX3RpbWVfcGlja2VyX21vdmVfdmVyKGRkcyxkZGEsLTEpIC8vbW92ZSB0byBwcmV2aW91cyBzbGlkZXINCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgIGNhc2UgMzk6IC8vcmlnaHQNCiAgICAgICAgICAgIHNpdHNfdGltZV9waWNrZXJfbW92ZV9ob3IoZGRzLGRkYSwxKTsgLy9zaGlmdCBzbGlkZXIgcmlnaHQNCiAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgIGNhc2UgNDA6IC8vZG93bg0KICAgICAgICAgICAgc2l0c190aW1lX3BpY2tlcl9tb3ZlX3ZlcihkZHMsZGRhLDEpIC8vbW92ZSB0byBuZXh0IHNsaWRlcg0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgIH0NCiAgICAgICAgdmFyIGNscyA9ICIiOw0KICAgICAgICB2YXIgZHZhID0gJCgic3Bhbi51aS1zdGF0ZS1mb2N1cyIsZGRzKS5jbG9zZXN0KCJkaXYiKTsgLy9nZXQgYWN0aXZlIHNsaWRlcg0KICAgICAgICBpZihkdmEubGVuZ3RoPT0xKSB7DQogICAgICAgICAgY2xzID0gc2l0c19yZXBsYWNlKGR2YS5nZXQoMCkuY2xhc3NOYW1lLCIgIiwiLiIpOyAvL3N0b3JlIGFjdGl2ZSBzbGlkZXIgY2xhc3Mgc2VsZWN0b3INCiAgICAgICAgfQ0KICAgICAgICBkaXYuZGF0YSgiZGQtYWN0aXZlIixjbHMpOw0KICAgICAgICByZXR1cm4gc2l0c19jYW5jZWxfZXZlbnQoZXZ0KTsgLy9oYW5kbGVkIHNvIGNhbmNlbCBldmVudA0KICAgICAgfQ0KICAgIH0NCiAgfQ0KICByZXR1cm4gdHJ1ZTsNCn0NCg0KLy9JbnRlcm5hbCBmdW5jdGlvbiB0byBoYW5kbGUga2V5Ym9hcmQgbmF2aWdhdGlvbiBmb3IgdGltZSBwaWNrZXIodmVydGljYWwpDQpmdW5jdGlvbiBzaXRzX3RpbWVfcGlja2VyX21vdmVfdmVyKGRkcyxkZGEsZGlyKSB7DQogIGlmKGRkYS5sZW5ndGg9PTEpIHsNCiAgICB2YXIgc2VsID0gImRkOm5vdCgudWlfdHBpY2tlcl91bml0X2hpZGUpOm5vdCgudWlfdHBpY2tlcl90aW1lKTpmaXJzdCI7IC8vc2VsZWN0b3IgZm9yIHRpbWUgc2xpZGVycw0KICAgIHZhciBkZG8gPShkaXI9PTEgPyBkZGEubmV4dEFsbChzZWwpIDogZGRhLnByZXZBbGwoc2VsKSk7IC8vZ2V0IG5leHQvcHJldmlvdXMgc2xpZGVyDQogICAgaWYoZGRvLmxlbmd0aD09MSkgew0KICAgICAgZGRhLmZpbmQoInNwYW4udWktc2xpZGVyLWhhbmRsZSIpLnJlbW92ZUNsYXNzKCJ1aS1zdGF0ZS1mb2N1cyIpOyAvL3VuLWZvY3VzIG90aGVyIHNsaWRlcnMNCiAgICAgIGRkby5maW5kKCJzcGFuLnVpLXNsaWRlci1oYW5kbGUiKS5hZGRDbGFzcygidWktc3RhdGUtZm9jdXMiKTsgLy9mb2N1cyBvbiBzbGlkZXINCiAgICB9DQogIH0NCiAgZWxzZSB7DQogICAgZGRhLmZpbmQoInNwYW4udWktc2xpZGVyLWhhbmRsZSIpLnJlbW92ZUNsYXNzKCJ1aS1zdGF0ZS1mb2N1cyIpOyAvL3VuLWZvY3VzIG90aGVyIHNsaWRlcnMNCiAgICBkZHMuZmlsdGVyKChkaXI9PTE/IjpmaXJzdCI6IjpsYXN0IikpLmZpbmQoInNwYW4udWktc2xpZGVyLWhhbmRsZSIpLmFkZENsYXNzKCJ1aS1zdGF0ZS1mb2N1cyIpOyAvL2ZvY3VzIG9uIHNsaWRlcg0KICB9DQogIHJldHVybiB0cnVlOw0KfQ0KDQovL0ludGVybmFsIGZ1bmN0aW9uIHRvIGhhbmRsZSBrZXlib2FyZCBuYXZpZ2F0aW9uIGZvciB0aW1lIHBpY2tlcihob3Jpem9udGFsKQ0KZnVuY3Rpb24gc2l0c190aW1lX3BpY2tlcl9tb3ZlX2hvcihkZHMsZGRhLGRpcikgew0KICBpZihkZGEubGVuZ3RoPT0xKSB7DQogICAgdmFyIG9iaiA9IGRkYS5maW5kKCJkaXYiKTsgLy9nZXQgc2xpZGVyIG9iamVjdA0KICAgIHZhciB2YWx1ZSA9IG9iai5zbGlkZXIoInZhbHVlIik7DQogICAgdmFyIHN0ZXAgPSBvYmouc2xpZGVyKCJvcHRpb24iLCJzdGVwIik7DQogICAgdmFyIG1pbnZhbCA9IG9iai5zbGlkZXIoIm9wdGlvbiIsIm1pbiIpOw0KICAgIHZhciBtYXh2YWwgPSBvYmouc2xpZGVyKCJvcHRpb24iLCJtYXgiKTsNCiAgICB2YXIgc2xpZGVlID0gb2JqLnNsaWRlcigib3B0aW9uIiwgInNsaWRlIikgfHwgZnVuY3Rpb24oKSB7fTsNCiAgICB2YXIgc3RvcGUgPSBvYmouc2xpZGVyKCJvcHRpb24iLCAic3RvcCIpIHx8IGZ1bmN0aW9uKCkge307DQogICAgdmFyIG5ld3ZhbCA9IHZhbHVlKyhzdGVwKjEqZGlyKTsgLy9jYWxjdWxhdGUgbmV3IHZhbHVlDQogICAgaWYobmV3dmFsPj1taW52YWwgJiYgbmV3dmFsPD1tYXh2YWwpIHsgLy9jaGVjayBuZXcgdmFsdWUgaXMgaW4gcmFuZ2UNCiAgICAgIG9iai5zbGlkZXIoInZhbHVlIixuZXd2YWwpOyAvL3NldCBuZXcgdmFsdWUNCiAgICAgIHNsaWRlZS5jYWxsKG9iaixudWxsLHt2YWx1ZTpuZXd2YWx9KTsgLy90cmlnZ2VyIGV2ZW50cyBtYW51YWxseQ0KICAgICAgc3RvcGUuY2FsbChvYmosbnVsbCx7dmFsdWU6bmV3dmFsfSk7DQogICAgfQ0KICB9DQogIHJldHVybiB0cnVlOw0KfQ0KDQovL0NvbnZlcnQgYW4gZW1wdHkgdGFibGUgaW50byBhIGdyaWQgd2lkZ2V0KFBQTDAxMzk5NCkNCi8vIHN0cmluZyAgIGlkICA6IGluIDtpZCBvZiB0aGUgdGFibGUgb2JqZWN0DQovLyBzdHJpbmcgIG5rZXkgIDogaW4gO3ZhbGlkIHNlc3Npb24ga2V5DQovLyBzdHJpbmcgIGdrZXkgIDogaW4gO3ZhbGlkIGdyaWQga2V5DQovLyBzdHJpbmcgIGNhcHQgIDogaW4gO3RhYmxlIGNhcHRpb24oZGVmYXVsdCBpcyAiRW50bmFtZShFTlRDKSByZWNvcmRzIikNCi8vIGJvb2xlYW4gICBtdWx0ICAgOiBpbiA7c2VsZWN0IG11bHRpcGxlIHJvd3MoZGVmYXVsdCBpcyBmYWxzZSkNCi8vIGZ1bmN0aW9uICBmbmMgIDogaW4gO2NhbGwgYmFjayBmdW5jdGlvbiBjYWxsZWQgYWZ0ZXIgZ3JpZCBoYXMgbG9hZGVkDQpmdW5jdGlvbiBzaXRzX2dyaWRfd2lkZ2V0KGlkLG5rZXksZ2tleSxjYXB0LG11bHQsZm5jKSB7DQogIGlmKHNpdHNfZmlsZXNfYXJyYXlbIi4uL3BsdWdpbnMvamF2YXNjcmlwdC9qcWdyaWQvanF1ZXJ5LmpxZ3JpZC5taW4uanMiXT09IlkiKSB7IC8vYWxyZWFkeSBsb2FkZWQuLi4NCiAgICBzaXRzX2RvX2dyaWRfd2lkZ2V0KGlkLG5rZXksZ2tleSxjYXB0LG11bHQsZm5jKTsgLy8uLi5zbyBjYWxsIHN0cmFpZ2h0IGF3YXkNCiAgfQ0KICBlbHNlIHsgLy9ub3QgbG9hZGVkIHlldA0KICAgIHZhciBwYXIgPSB7fTsgLy9jcmVhdGUgYW4gb2JqZWN0IG9mIHBhcmFtZXRlcnMNCiAgICBwYXIudXJsID0gIi4uL3BsdWdpbnMvamF2YXNjcmlwdC9qcWdyaWQvanF1ZXJ5LmpxZ3JpZC5taW4uanMiOw0KICAgIHBhci5mbmMgPSBzaXRzX2RvX2dyaWRfd2lkZ2V0Ow0KICAgIHBhci5wMDEgPSBpZDsNCiAgICBwYXIucDAyID0gbmtleTsNCiAgICBwYXIucDAzID0gZ2tleTsNCiAgICBwYXIucDA0ID0gY2FwdDsNCiAgICBwYXIucDA1ID0gbXVsdDsNCiAgICBwYXIucDA2ID0gZm5jOw0KICAgIHZhciBsZW4gPSBzaXRzX3BhcmFtX2FycmF5LnB1c2gocGFyKTsgLy9zYXZlIGZvciBsYXRlcg0KICAgIHNpdHNfaW5jbHVkZV9maWxlKCIuLi9qYXZhc2NyaXB0L3NpdHNfZ3JpZC5qcyIsZnVuY3Rpb24oYm9vKSB7DQogICAgICBzaXRzX2luY2x1ZGVfZmlsZSgiLi4vcGx1Z2lucy9jc3MvanFncmlkL3VpLmpxZ3JpZC5jc3MiLGZ1bmN0aW9uKGJvbykgew0KICAgICAgICBzaXRzX2luY2x1ZGVfZmlsZSgiLi4vcGx1Z2lucy9qYXZhc2NyaXB0L2pxZ3JpZC9ncmlkLmxvY2FsZS1lbi5qcyIsZnVuY3Rpb24oYm9vKSB7DQogICAgICAgICAgc2l0c19pbmNsdWRlX2ZpbGUoIi4uL3BsdWdpbnMvamF2YXNjcmlwdC9qcWdyaWQvanF1ZXJ5LmpxZ3JpZC5taW4uanMiLGZ1bmN0aW9uKGJvbykgew0KICAgICAgICAgICAgJC5qZ3JpZC5mb3JtYXR0ZXIuaW50ZWdlciA9IHt0aG91c2FuZHNTZXBhcmF0b3I6IiwifTsNCiAgICAgICAgICB9KTsNCiAgICAgICAgfSk7DQogICAgICB9KTsNCiAgICB9KTsNCiAgfQ0KICByZXR1cm4gdHJ1ZTsNCn0NCg0KLy9JbnRlcm5hbCBmdW5jdGlvbiB0byBhZGQgZ3JpZCB3aWRnZXQoUFBMMDEzOTk0KQ0KLy8gc3RyaW5nICAgaWQgIDogaW4gO2lkIG9mIHRoZSB0YWJsZSBvYmplY3QNCi8vIHN0cmluZyBua2V5ICA6IGluIDt2YWxpZCBzZXNzaW9uIGtleQ0KLy8gc3RyaW5nIGdrZXkgIDogaW4gO3ZhbGlkIGdyaWQga2V5DQovLyBzdHJpbmcgY2FwdCAgOiBpbiA7dGFibGUgY2FwdGlvbihkZWZhdWx0IGlzICJFbnRuYW1lKEVOVEMpIHJlY29yZHMiKQ0KLy8gYm9vbGVhbiAgbXVsdCAgOiBpbiA7c2VsZWN0IG11bHRpcGxlIHJvd3MoZGVmYXVsdCBpcyBmYWxzZSkNCi8vIGZ1bmN0aW9uIGZuYyA6IGluIDtjYWxsIGJhY2sgZnVuY3Rpb24gY2FsbGVkIGFmdGVyIGdyaWQgaGFzIGxvYWRlZA0KZnVuY3Rpb24gc2l0c19kb19ncmlkX3dpZGdldChpZCxua2V5LGdrZXksY2FwdCxtdWx0LGZuYykgew0KICByZXR1cm4gc2l0c19kb19ncmlkX3dpZGdldDEoaWQsbmtleSxna2V5LGNhcHQsbXVsdCxmbmMpIHx8IGZhbHNlOyAvL2luICJzaXRzX2dyaWQuanMiDQp9DQoNCi8vUmV0dXJucyB0aGUgdHlwZSBvZiB2YXJpYWJsZSB0aGF0IHdhcyBzcGVjaWZpZWQNCi8vIGFueSAgb2JqIDppbjt2YXJpYWJsZSB0byBhc3Nlc3MNCmZ1bmN0aW9uIHNpdHNfdHlwZV9vZihvYmopIHsNCiAgaWYob2JqPT09bnVsbCkgeyAvL2NoZWNrIGZvciBudWxsDQogICAgcmV0dXJuICJudWxsIjsNCiAgfQ0KICB2YXIgdHlwID0gdHlwZW9mKG9iaik7DQogIGlmKHR5cD09Im9iamVjdCIpIHsgLy90cnkgdG8gZGV0ZXJtaW5lIG9iamVjdCBzdWItdHlwZQ0KICAgIGlmKG9iai5jb25zdHJ1Y3Rvcj09KG5ldyBBcnJheSkuY29uc3RydWN0b3IpIHsNCiAgICAgIHJldHVybiAiYXJyYXkiOw0KICAgIH0NCiAgICBpZihvYmouY29uc3RydWN0b3I9PShuZXcgRGF0ZSkuY29uc3RydWN0b3IpIHsNCiAgICAgIHJldHVybiAiZGF0ZSI7DQogICAgfQ0KICAgIGlmKG9iai5jb25zdHJ1Y3Rvcj09KG5ldyBSZWdFeHApLmNvbnN0cnVjdG9yKSB7DQogICAgICByZXR1cm4gInJlZ2V4IjsNCiAgICB9DQogICAgaWYob2JqLm5vZGVUeXBlICYmIG9iai5ub2RlVHlwZT4wICYmIG9iai5ub2RlVHlwZTwxMykgew0KICAgICAgaWYob2JqLm5vZGVUeXBlPT05KSB7DQogICAgICAgIHJldHVybiAiZG9jdW1lbnQiOw0KICAgICAgfQ0KICAgICAgcmV0dXJuICJlbGVtZW50IjsNCiAgICB9DQogICAgaWYob2JqLnNldEludGVydmFsICYmIG9iai5zZXRUaW1lb3V0KSB7DQogICAgICByZXR1cm4gIndpbmRvdyI7DQogICAgfQ0KICAgIGlmKG9iai5qcXVlcnkgJiYgb2JqLmpxdWVyeT09JC5mbi5qcXVlcnkpIHsNCiAgICAgIHJldHVybiAianF1ZXJ5IjsNCiAgICB9DQogICAgaWYob2JqLnR5cGUpIHsNCiAgICAgIHZhciBldnQgPSAiLGJsdXIsY2hhbmdlLGNsaWNrLGRibGNsaWNrLGVycm9yLGZvY3VzLGtleWRvd24sa2V5cHJlc3Msa2V5dXAsbG9hZCxtb3VzZWRvd24sbW91c2VlbnRlcixtb3VzZWxlYXZlLG1vdXNlbW92ZSxtb3VzZW91dCxtb3VzZW92ZXIsbW91c2V1cCxyZXNpemUsc2Nyb2xsLHNlbGVjdCxzdWJtaXQsdW5sb2FkLHRvdWNoc3RhcnQsdG91Y2hlbmQsdG91Y2hjYW5jZWwsdG91Y2htb3ZlLCI7DQogICAgICBpZihldnQuaW5kZXhPZigiLCIrb2JqLnR5cGUudG9Mb3dlckNhc2UoKSsiLCIpPi0xKSB7DQogICAgICAgIHJldHVybiAiZXZlbnQiOw0KICAgICAgfQ0KICAgIH0NCiAgfQ0KICByZXR1cm4gdHlwOyAvL3JldHVybiBzdGFuZGFyZCB0eXBlDQp9DQoNCi8vUmV0dXJucyB0aGUgc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIHRoZSB2YXJpYWJsZSB0aGF0IHdhcyBzcGVjaWZpZWQNCi8vIGFueSAgb2JqIDogaW4gO3ZhcmlhYmxlIHRvIHJlcHJlc2VudA0KLy8gYm9vbGVhbiByZWMgOiBpbiA7SU5URVJBTCAtIGluZGljYXRlcyB3aGV0aGVyIHRoaXMgaXMgYSByZWN1cnNpdmUgY2FsbA0KZnVuY3Rpb24gc2l0c190b19zdHJpbmcob2JqLHJlYykgew0KICB2YXIgY2FwID0gMTE7IC8vY2FwIGZvciAiZm9yIGVhY2giIGxvb3BzDQogIHZhciBhcnIgPSBbXTsNCiAgaWYodHlwZW9mKHJlYykhPSJib29sZWFuIikgew0KICAgIHJlYyA9IGZhbHNlOyAvL2ZpcnN0IGNhbGwgaXMgbm90IHJlY3Vyc2l2ZQ0KICB9DQogIHN3aXRjaChzaXRzX3R5cGVfb2Yob2JqKSkgeyAvL2dldCB0eXBlIG9mIHZhcmlhYmxlDQogICAgY2FzZSAibnVsbCI6DQogICAgICByZXR1cm4gIntudWxsfSI7IC8vcmV0dXJuIG51bGwgYXMgb2JqZWN0IHN0cmluZw0KICAgIGNhc2UgImFycmF5IjoNCiAgICAgIHZhciBzdHIgPSBvYmoudG9TdHJpbmcoKTsgLy90cnkgYmFzaWMgZnVuY3Rpb24NCiAgICAgIGlmKHN0cj09IiIgfHwgc3RyLmluZGV4T2YoIm9iamVjdCBPYmplY3QiKT4tMSkgew0KICAgICAgICBmb3IodmFyIGsgaW4gb2JqKSB7DQogICAgICAgICAgYXJyLnB1c2goaysiPSIrc2l0c190b19zdHJpbmcob2JqW2tdLHRydWUpKTsgLy9saXN0IGFsbCBpdGVtcyBpbiBhcnJheQ0KICAgICAgICAgIGlmKC0tY2FwPDEpIHsNCiAgICAgICAgICAgIGJyZWFrOyAvL2JyZWFrIG91dCBvZiBsb29wDQogICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIHN0ciA9IGFyci5qb2luKCIsIikrKGNhcDwxPyIuLi4iOiIiKTsNCiAgICAgIH0NCiAgICAgIHJldHVybiAiWyIrc3RyKyJdIjsgLy9yZXR1cm4gYXMgYXJyYXkgc3RyaW5nDQogICAgY2FzZSAiZGF0ZSI6DQogICAgICByZXR1cm4gInsiK29iai50b1N0cmluZygpKyJ9IjsgLy9yZXR1cm4gZGF0ZSBhcyBvYmplY3Qgc3RyaW5nDQogICAgY2FzZSAibnVtYmVyIjoNCiAgICAgIHJldHVybiAiIitvYmo7IC8vcmV0dXJuIGFzIG51bWVyaWMgc3RyaW5nDQogICAgY2FzZSAib2JqZWN0IjogY2FzZSAicmVnZXgiOg0KICAgICAgdmFyIGwgPSBvYmoubGVuZ3RoOw0KICAgICAgaWYodHlwZW9mKGwpIT0idW5kZWZpbmVkIikgeyAvL2NoZWNrIGZvciBpbmRleGVkIG9iamVjdA0KICAgICAgICBmb3IodmFyIGk9MDtpPGw7aSsrKSB7DQogICAgICAgICAgYXJyLnB1c2goaSsiOiIrc2l0c190b19zdHJpbmcob2JqW2ldLHRydWUpKTsgLy9pbmRleCBhbGwgcHJvcGVydGllcyBvZiBvYmplY3QNCiAgICAgICAgICBpZigtLWNhcDwxKSB7DQogICAgICAgICAgICBicmVhazsgLy9icmVhayBvdXQgb2YgbG9vcA0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgfQ0KICAgICAgZWxzZSB7DQogICAgICAgIGZvcih2YXIgaiBpbiBvYmopIHsNCiAgICAgICAgICBhcnIucHVzaChqKyI6IitzaXRzX3RvX3N0cmluZyhvYmpbal0sdHJ1ZSkpOyAvL2xpc3QgYWxsIHByb3BlcnRpZXMgb2Ygb2JqZWN0DQogICAgICAgICAgaWYoLS1jYXA8MSkgew0KICAgICAgICAgICAgYnJlYWs7IC8vYnJlYWsgb3V0IG9mIGxvb3ANCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgIH0NCiAgICAgIHJldHVybiAieyIrYXJyLmpvaW4oIiwiKSsoY2FwPDE/Ii4uLiI6IiIpKyJ9IjsgLy9yZXR1cm4gcHJvcGVydHkgbGlzdCBhcyBvYmplY3Qgc3RyaW5nDQogICAgY2FzZSAiZnVuY3Rpb24iOg0KICAgICAgcmV0dXJuIG9iai50b1N0cmluZygpOyAvL3JldHVybiBhcyBmdW5jdGlvbiBzdHJpbmcNCiAgICBjYXNlICJlbGVtZW50IjoNCiAgICAgIHN3aXRjaChvYmoubm9kZVR5cGUpIHsNCiAgICAgICAgY2FzZSAxOg0KICAgICAgICAgIHZhciB0YWcgPSBvYmoudGFnTmFtZS50b0xvd2VyQ2FzZSgpOw0KICAgICAgICAgIGlmKHRhZz09ImlucHV0Iikgew0KICAgICAgICAgICAgdGFnICs9ICI6IitvYmoudHlwZS50b0xvd2VyQ2FzZSgpOw0KICAgICAgICAgIH0NCiAgICAgICAgICBpZihvYmouaWQpIHsNCiAgICAgICAgICAgIHRhZyArPSAiIyIrb2JqLmlkOw0KICAgICAgICAgIH0NCiAgICAgICAgICBpZihvYmouY2xhc3NOYW1lKSB7DQogICAgICAgICAgICB0YWcgKz0gIi4iK29iai5jbGFzc05hbWU7DQogICAgICAgICAgfQ0KICAgICAgICAgIHJldHVybiAiPCIrdGFnKyI+IjsgLy9yZXR1cm4gYXMgZWxlbWVudCBzdHJpbmcNCiAgICAgICAgY2FzZSA5Og0KICAgICAgICAgIHJldHVybiAiPGRvY3VtZW50PiI7IC8vcmV0dXJuIGFzIGRvY3VtZW50IHN0cmluZw0KICAgICAgICBkZWZhdWx0Og0KICAgICAgICAgIHJldHVybiAiPE5PREU6IitvYmoubm9kZVR5cGUrIj4iOyAvL3JldHVybiBhcyBvdGhlciBub2RlIHN0cmluZw0KICAgICAgfQ0KICAgIGNhc2UgImV2ZW50IjoNCiAgICAgIHZhciBzdHIgPSBvYmoudHlwZTsNCiAgICAgIGlmKHN0ci5pbmRleE9mKCJrZXkiKT4tMSkgeyAvL2tleWJvYXJkDQogICAgICAgIHZhciBrZXkgPSBvYmoua2V5Q29kZSB8fCBvYmoud2hpY2g7DQogICAgICAgIHN0ciArPSAiOiIra2V5Ow0KICAgICAgICBpZihvYmouc2hpZnRLZXkpIHsNCiAgICAgICAgICBzdHIgKz0gIitzaGlmdCI7DQogICAgICAgIH0NCiAgICAgICAgaWYob2JqLmN0cmxLZXkpIHsNCiAgICAgICAgICBzdHIgKz0gIitjdHJsIjsNCiAgICAgICAgfQ0KICAgICAgICBpZihvYmouYWx0S2V5KSB7DQogICAgICAgICAgc3RyICs9ICIrYWx0IjsNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgICAgZWxzZSBpZihzdHIuaW5kZXhPZigibW91c2UiKT4tMSB8fCBzdHIuaW5kZXhPZigiY2xpY2siKT4tMSkgeyAvL21vdXNlDQogICAgICAgIHZhciBwb3MgPSBzaXRzX21vdXNlX29mZnNldChvYmopOw0KICAgICAgICBzdHIgKz0gIjoiK3NpdHNfbW91c2VfYnV0dG9uKG9iaikrIi0iK3Bvcy54KyIsIitwb3MueTsNCiAgICAgIH0NCiAgICAgIHJldHVybiAieyIrc2l0c190b19zdHJpbmcoc2l0c19nZXRfdGFyZ2V0KG9iaiksdHJ1ZSkrIiBvbiIrc3RyKyJ9IjsgLy9yZXR1cm4gYXMgZXZlbnQgc3RyaW5nDQogICAgY2FzZSAiZG9jdW1lbnQiOg0KICAgICAgcmV0dXJuICJ7ZG9jdW1lbnR9IjsgLy9yZXR1cm4gYXMgZG9jdW1lbnQgc3RyaW5nDQogICAgY2FzZSAid2luZG93IjoNCiAgICAgIHJldHVybiAie3dpbmRvd30iOyAvL3JldHVybiBhcyB3aW5kb3cgc3RyaW5nDQogICAgY2FzZSAianF1ZXJ5IjoNCiAgICAgIHZhciBzdHIgPSAiIjsNCiAgICAgIGlmKG9iai5sZW5ndGg9PTEpIHsNCiAgICAgICAgc3RyID0gc2l0c190b19zdHJpbmcob2JqWzBdLHRydWUpOyAvL3Nob3cgZWxlbWVudCBzdHJpbmcgaWYgc2luZ2xlDQogICAgICB9DQogICAgICBlbHNlIHsNCiAgICAgICAgb2JqLmVhY2goZnVuY3Rpb24oaSkgew0KICAgICAgICAgIGlmKC0tY2FwPjApIHsNCiAgICAgICAgICAgIHN0ciArPSAiLCIrdGhpcy50YWdOYW1lLnRvTG93ZXJDYXNlKCk7IC8vanVzdCBsaXN0IHRhZyBuYW1lcyBpZiBtdWx0aXBsZQ0KICAgICAgICAgIH0NCiAgICAgICAgfSk7DQogICAgICAgIHN0ciA9IHN0ci5zdWJzdHIoMSkrKGNhcDwxPyIuLi4iK29iai5sZW5ndGg6IiIpOyAvL2FkZCBjb3VudCBpZiBjYXBwZWQNCiAgICAgIH0NCiAgICAgIHJldHVybiAiJCgiK3N0cisiKSI7IC8vcmV0dXJuIGFzIGpxdWVyeSBzdHJpbmcNCiAgfQ0KICByZXR1cm4gIiIrb2JqOyAvL3JldHVybiBhcyBzdHJpbmcNCn0NCg0KLy9DYW5jZWxzIHRoZSBjdXJyZW50IGV2ZW50IGFuZCBwcmV2ZW50cyBkZWZhdWx0IGFjdGlvbihQUEwwMTM1ODMpDQovLyBvYmplY3QgZXZ0IDogaW4gO2V2ZW50IG9iamVjdA0KZnVuY3Rpb24gc2l0c19jYW5jZWxfZXZlbnQoZXZ0KSB7DQogIGV2dCA9IGV2dCB8fCB3aW5kb3cuZXZlbnQ7DQogIGlmKGV2dC5zdG9wUHJvcGFnYXRpb24pIHsgLy9wcmV2ZW50IGJ1YmJsaW5nDQogICAgZXZ0LnN0b3BQcm9wYWdhdGlvbigpOw0KICB9DQogIGVsc2Ugew0KICAgIGV2dC5jYW5jZWxCdWJibGUgPSB0cnVlOw0KICB9DQogIGlmKGV2dC5wcmV2ZW50RGVmYXVsdCkgeyAvL3ByZXZlbnQgZGVmYXVsdCBhY3Rpb24NCiAgICBldnQucHJldmVudERlZmF1bHQoKTsNCiAgfQ0KICBlbHNlIHsNCiAgICBldnQucmV0dXJuVmFsdWUgPSBmYWxzZTsNCiAgfQ0KICByZXR1cm4gZmFsc2U7IC8vY2FuY2VsIGV2ZW50DQp9DQoNCi8vUGFyc2VzIGEgSlNPTiBzdHJpbmcgdG8gY3JlYXRlIGFuIG9iamVjdChQUEwwMTM1ODMpDQovLyBzdHJpbmcgc3RyIDogaW4gO3RoZSBKU09OIHN0cmluZw0KZnVuY3Rpb24gc2l0c19wYXJzZV9qc29uKHN0cikgew0KICBzdHIgPSBzaXRzX3doaXRlX3RyaW0oc3RyKTsgLy9yZW1vdmUgd2hpdGUgc3BhY2UNCiAgaWYoc3RyPT0iIikgeyAvL2NoZWNrIGZvciBlbXB0eSBzdHJpbmcNCiAgICBzaXRzX3B1dG1lc3MoIkpTT04uUEFSU0U6IEVtcHR5IHN0cmluZyIpOw0KICAgIHJldHVybiBudWxsOw0KICB9DQogIGlmKHN0ci5pbmRleE9mKFN0cmluZy5mcm9tQ2hhckNvZGUoOSkpPi0xKSB7DQogICAgc2l0c19wdXRtZXNzKCJKU09OLlBBUlNFOiBTdHJpbmcgY29udGFpbnMgdGFiIGNoYXJhY3RlcnMiKTsNCiAgfQ0KICB0cnkgew0KICAgIGlmKHR5cGVvZihKU09OKT09Im9iamVjdCIgJiYgdHlwZW9mKEpTT04ucGFyc2UpPT0iZnVuY3Rpb24iKSB7DQogICAgICByZXR1cm4gSlNPTi5wYXJzZShzdHIpOyAvL3VzZSBuYXRpdmUgcGFyc2VyIGlmIGF2YWlsYWJsZQ0KICAgIH0NCiAgICBlbHNlIHsNCiAgICAgIHJldHVybiBldmFsKCIoIitzdHIrIikiKTsgLy9vdGhlcndpc2UgZXZhbHVhdGUNCiAgICB9DQogIH0NCiAgY2F0Y2goZXJyKSB7DQogICAgc2l0c19wdXRtZXNzKCJKU09OLlBBUlNFOiBTdHJpbmcgY291bGQgbm90IGJlIHBhcnNlZCIpOw0KICAgIHJldHVybiBudWxsOyAvL3N0cmluZyBjb3VsZCBub3QgYmUgcGFyc2VkDQogIH0NCn0NCg0KLy9SZXR1cm5zIHRoZSBzdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgdGhlIHZhcmlhYmxlIHRoYXQgd2FzIHNwZWNpZmllZChQUEwwMTM1ODMpDQovLyBvYmplY3QgIG9iaiA6IGluIDt0aGUgb2JqZWN0IHRvIG5vdGF0ZQ0KZnVuY3Rpb24gc2l0c190b19qc29uKG9iaikgew0KICB2YXIgYXJyID0gW107DQogIGZvcih2YXIgaiBpbiBvYmopIHsNCiAgICB2YXIgdmFsID0gb2JqW2pdOyAvL2dldCBwcm9wZXJ0eSB2YWx1ZQ0KICAgIHN3aXRjaChzaXRzX3R5cGVfb2YodmFsKSkgew0KICAgICAgY2FzZSAibnVsbCI6DQogICAgICAgIHZhbCA9ICJudWxsIjsNCiAgICAgICAgYnJlYWs7DQogICAgICBjYXNlICJzdHJpbmciOg0KICAgICAgICB2YWwgPSAiXCIiK3NpdHNfZXNjYXBlX3N0cmluZyh2YWwpKyJcIiI7DQogICAgICAgIGJyZWFrOw0KICAgICAgY2FzZSAib2JqZWN0IjoNCiAgICAgICAgdmFsID0gc2l0c190b19qc29uKHZhbCk7DQogICAgICAgIGJyZWFrOw0KICAgICAgZGVmYXVsdDogLy9ib29sZWFuLG51bWJlcixldGMNCiAgICAgICAgdmFsID0gc2l0c190b19zdHJpbmcodmFsKTsNCiAgICAgICAgYnJlYWs7DQogICAgfQ0KICAgIGFyci5wdXNoKCJcIiIraisiXCI6Iit2YWwpOyAvL2xpc3QgYWxsIHByb3BlcnRpZXMgb2Ygb2JqZWN0DQogIH0NCiAgcmV0dXJuICJ7IithcnIuam9pbigiLCIpKyJ9IjsgLy9yZXR1cm4gcHJvcGVydHkgbGlzdCBhcyBvYmplY3Qgc3RyaW5nDQp9DQoNCi8vRmluZCBhbmQgcmV0dXJuIGFuIGl0ZW0gZnJvbSBhIGxpc3QoUFBMMDEzNTgzKQ0KLy8gc3RyaW5nIGxpc3QgOiBpbiA7dGhlIGxpc3Qgc3RyaW5nDQovLyBzdHJpbmcgaXRlbSA6IGluIDt0aGUgaXRlbSBzdHJpbmcNCi8vIHN0cmluZyBkZWwgOiBpbiA7dGhlIGxpc3QgZGVsaW1pdGVyDQpmdW5jdGlvbiBzaXRzX2dldF9pdGVtKGxpc3QsaXRlbSxkZWwpIHsNCiAgaWYodHlwZW9mKGxpc3QpPT0ic3RyaW5nIiAmJiBsaXN0Lmxlbmd0aD4wKSB7IC8vY2hlY2sgZmlyc3QgcGFyYW1ldGVyDQogICAgaWYodHlwZW9mKGl0ZW0pPT0ic3RyaW5nIiAmJiBpdGVtLmxlbmd0aD4wKSB7IC8vY2hlY2sgc2Vjb25kIHBhcmFtZXRlcg0KICAgICAgaWYodHlwZW9mKGRlbCk9PSJzdHJpbmciICYmIGRlbC5sZW5ndGg+MCkgeyAvL2NoZWNrIHRoaXJkIHBhcmFtZXRlcg0KICAgICAgICB2YXIgYXJyID0gbGlzdC5zcGxpdChkZWwpOw0KICAgICAgICB2YXIgbCA9IGFyci5sZW5ndGg7DQogICAgICAgIGZvcih2YXIgaT0wO2k8bDtpKyspIHsgLy9sb29wIHRocm91Z2ggbGlzdCBpdGVtcw0KICAgICAgICAgIHZhciB0ZW1wID0gYXJyW2ldOw0KICAgICAgICAgIHZhciBpZHBhcnQgPSB0ZW1wLnN1YnN0cigwLGl0ZW0ubGVuZ3RoKzEpOyAvL2dldCBpZCBwYXJ0IG9mIGl0ZW0NCiAgICAgICAgICBpZihpZHBhcnQ9PWl0ZW0rIj0iKSB7DQogICAgICAgICAgICByZXR1cm4gdGVtcC5zdWJzdHIoaXRlbS5sZW5ndGgrMSk7IC8vcmV0dXJuIHZhbHVlIHBhcnQgb2YgaXRlbQ0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0NCiAgfQ0KICByZXR1cm4gIiI7IC8vaXRlbSBub3QgZm91bmQgc28gcmV0dXJuIGJsYW5rIHN0cmluZw0KfQ0KDQovL0ZpbmQgYW5kIHJlbW92ZSBhbiBpdGVtIGZyb20gYSBsaXN0KFBQTDAxMzU4MykNCi8vIHN0cmluZyBsaXN0IDogaW4gO3RoZSBsaXN0IHN0cmluZw0KLy8gc3RyaW5nIGl0ZW0gOiBpbiA7dGhlIGl0ZW0gc3RyaW5nDQovLyBzdHJpbmcgZGVsIDogaW4gO3RoZSBsaXN0IGRlbGltaXRlcg0KZnVuY3Rpb24gc2l0c19kZWxfaXRlbShsaXN0LGl0ZW0sZGVsKSB7DQogIGlmKHR5cGVvZihsaXN0KT09InN0cmluZyIgJiYgbGlzdC5sZW5ndGg+MCkgeyAvL2NoZWNrIGZpcnN0IHBhcmFtZXRlcg0KICAgIGlmKHR5cGVvZihpdGVtKT09InN0cmluZyIgJiYgaXRlbS5sZW5ndGg+MCkgeyAvL2NoZWNrIHNlY29uZCBwYXJhbWV0ZXINCiAgICAgIGlmKHR5cGVvZihkZWwpPT0ic3RyaW5nIiAmJiBkZWwubGVuZ3RoPjApIHsgLy9jaGVjayB0aGlyZCBwYXJhbWV0ZXINCiAgICAgICAgdmFyIGFyciA9IGxpc3Quc3BsaXQoZGVsKTsNCiAgICAgICAgdmFyIGwgPSBhcnIubGVuZ3RoOw0KICAgICAgICBmb3IodmFyIGk9MDtpPGw7aSsrKSB7IC8vbG9vcCB0aHJvdWdoIGxpc3QgaXRlbXMNCiAgICAgICAgICB2YXIgdGVtcCA9IGFycltpXTsNCiAgICAgICAgICB2YXIgaWRwYXJ0ID0gdGVtcC5zdWJzdHIoMCxpdGVtLmxlbmd0aCsxKTsgLy9nZXQgaWQgcGFydCBvZiBpdGVtDQogICAgICAgICAgaWYoaWRwYXJ0PT1pdGVtKyI9Iikgew0KICAgICAgICAgICAgYXJyLnNwbGljZShpLDEpOyAvL3JlbW92ZSB0aGlzIGl0ZW0gZnJvbSB0aGUgbGlzdA0KICAgICAgICAgICAgaS0tOw0KICAgICAgICAgICAgbC0tOw0KICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgICAgICByZXR1cm4gYXJyLmpvaW4oZGVsKTsgLy9yZXR1cm4gbW9kaWZpZWQgbGlzdCBzdHJpbmcNCiAgICAgIH0NCiAgICB9DQogIH0NCiAgcmV0dXJuIGxpc3Q7IC8vcmV0dXJuIG9yaWdpbmFsIGxpc3Qgc3RyaW5nDQp9DQoNCi8vRmluZCBhbmQgcmVwbGFjZSBhbiBpdGVtIGZyb20gYSBsaXN0KFBQTDAxMzU4MykNCi8vIHN0cmluZyBsaXN0IDogaW4gO3RoZSBsaXN0IHN0cmluZw0KLy8gc3RyaW5nIGl0ZW0gOiBpbiA7dGhlIGl0ZW0gc3RyaW5nDQovLyBzdHJpbmcgbmV3diA6IGluIDt0aGUgbmV3IHZhbHVlDQovLyBzdHJpbmcgZGVsIDogaW4gO3RoZSBsaXN0IGRlbGltaXRlcg0KZnVuY3Rpb24gc2l0c19wdXRfaXRlbShsaXN0LGl0ZW0sbmV3dixkZWwpIHsNCiAgaWYodHlwZW9mKGxpc3QpPT0ic3RyaW5nIikgeyAvL2NoZWNrIGZpcnN0IHBhcmFtZXRlcg0KICAgIGlmKHR5cGVvZihpdGVtKT09InN0cmluZyIgJiYgaXRlbS5sZW5ndGg+MCkgeyAvL2NoZWNrIHNlY29uZCBwYXJhbWV0ZXINCiAgICAgIGlmKHR5cGVvZihkZWwpPT0ic3RyaW5nIiAmJiBkZWwubGVuZ3RoPjApIHsgLy9jaGVjayB0aGlyZCBwYXJhbWV0ZXINCiAgICAgICAgaWYobGlzdC5sZW5ndGg+MCkgew0KICAgICAgICAgIHZhciBib28gPSBmYWxzZTsNCiAgICAgICAgICB2YXIgYXJyID0gbGlzdC5zcGxpdChkZWwpOw0KICAgICAgICAgIHZhciBsID0gYXJyLmxlbmd0aDsNCiAgICAgICAgICBmb3IodmFyIGk9MDtpPGw7aSsrKSB7IC8vbG9vcCB0aHJvdWdoIGxpc3QgaXRlbXMNCiAgICAgICAgICAgIHZhciB0ZW1wID0gYXJyW2ldOw0KICAgICAgICAgICAgdmFyIGlkcGFydCA9IHRlbXAuc3Vic3RyKDAsaXRlbS5sZW5ndGgrMSk7IC8vZ2V0IGlkIHBhcnQgb2YgaXRlbQ0KICAgICAgICAgICAgaWYoaWRwYXJ0PT1pdGVtKyI9Iikgew0KICAgICAgICAgICAgICBhcnJbaV0gPSBpdGVtKyI9IituZXd2OyAvL3JlcGxhY2UgdGhpcyBpdGVtIGluIHRoZSBsaXN0DQogICAgICAgICAgICAgIGJvbyA9IHRydWU7DQogICAgICAgICAgICB9DQogICAgICAgICAgfQ0KICAgICAgICAgIGlmKGJvbykgew0KICAgICAgICAgICAgbGlzdCA9IGFyci5qb2luKGRlbCk7IC8vdXBkYXRlIG1vZGlmaWVkIGxpc3Qgc3RyaW5nDQogICAgICAgICAgfQ0KICAgICAgICAgIGVsc2Ugew0KICAgICAgICAgICAgbGlzdCArPSBkZWwraXRlbSsiPSIrbmV3djsgLy9hcHBlbmQgbmV3IHZhbHVlIHRvIGxpc3Qgc3RyaW5nDQogICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIGVsc2Ugew0KICAgICAgICAgIGxpc3QgPSBpdGVtKyI9IituZXd2OyAvL2NyZWF0ZSBuZXcgbGlzdCBzdHJpbmcNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0NCiAgfQ0KICByZXR1cm4gbGlzdDsgLy9yZXR1cm4gbW9kaWZpZWQgbGlzdCBzdHJpbmcNCn0NCg0KLy9HZXQgdGhlIGJ1dHRvbiBjbGlja2VkIHJlZ2FyZGxlc3Mgb2YgYnJvd3NlcihQUEwwMTE1NDIpDQovLyBvYmplY3QgZXZ0IDogaW4gO2V2ZW50IG9iamVjdA0KZnVuY3Rpb24gc2l0c19tb3VzZV9idXR0b24oZXZ0KSB7DQogIGV2dCA9IGV2dCB8fCB3aW5kb3cuZXZlbnQ7DQogIHZhciBudW0gPSBldnQuYnV0dG9uOw0KICBpZighJC5zdXBwb3J0LmNzc0Zsb2F0KSB7IC8vY2hlY2sgZm9yIElFDQogICAgc3dpdGNoKG51bSkgew0KICAgICAgY2FzZSAxOiByZXR1cm4gIkwiOw0KICAgICAgY2FzZSAyOiByZXR1cm4gIlIiOw0KICAgICAgY2FzZSA0OiByZXR1cm4gIk0iOw0KICAgIH0NCiAgfQ0KICBlbHNlIHsNCiAgICBzd2l0Y2gobnVtKSB7DQogICAgICBjYXNlIDA6IHJldHVybiAiTCI7DQogICAgICBjYXNlIDE6IHJldHVybiAiTSI7DQogICAgICBjYXNlIDI6IHJldHVybiAiUiI7DQogICAgfQ0KICB9DQogIHJldHVybiAiIjsgLy9idXR0b24gbm90IHJlY29nbmlzZWQNCn0NCg0KLy9SZS1idWlsZCB0aGUgb3B0aW9ucyBpbiBhIGRyb3Bkb3duIGxpc3QoUFBMMDExNTQyKQ0KLy8gc3RyaW5nIGlkICA6IGluIDt0aGUgaWQgb2YgdGhlIG9iamVjdCB0byBnZXQgdGhlIHZhbHVlIG9mDQovLyBvYmplY3Qgb3B0IDogaW4gO29iamVjdCBjb250YWluaW5nIG9wdGlvbnMNCmZ1bmN0aW9uIHNpdHNfYnVpbGRfc2VsZWN0KGlkLG9wdCkgew0KICB2YXIgb2JqID0gbnVsbDsNCiAgaWYodHlwZW9mKGlkKT09InN0cmluZyIpIHsNCiAgICBvYmogPSBzaXRzX2dldF9vYmplY3QoaWQpOyAvL2dldCBvYmplY3QgZnJvbSBpZA0KICB9DQogIGVsc2Ugew0KICAgIG9iaiA9IGlkOyAvL29iamVjdCB3YXMgcGFzc2VkIGluDQogIH0NCiAgaWYoIW9iaikgew0KICAgIHJldHVybiBmYWxzZTsgLy9vYmplY3Qgbm90IGZvdW5kDQogIH0NCiAgaWYob2JqLnRhZ05hbWUhPSJTRUxFQ1QiKSB7DQogICAgcmV0dXJuIGZhbHNlOyAvL29iamVjdCBub3QgYSBkcm9wZG93biBsaXN0DQogIH0NCiAgdmFyIGkgPSAwOw0KICBvYmoub3B0aW9ucy5sZW5ndGggPSAwOyAvL2NsZWFyIGV4aXN0aW5nIG9wdGlvbnMNCiAgZm9yKHZhciB2YWwgaW4gb3B0KSB7DQogICAgb2JqLm9wdGlvbnNbaSsrXSA9IG5ldyBPcHRpb24ob3B0W3ZhbF0sdmFsKTsgLy9idWlsZCBvcHRpb25zDQogIH0NCiAgcmV0dXJuIHRydWU7DQp9DQoNCi8vU2hvdyBhIGRpYWxvZyBzaW1pbGFyIHRvIFlEQUwgaW4gY2xpZW50KElSRUwxIFBQTDAxNDEyMSkNCi8vIHN0cmluZyBkY3QgOiBpbiA7ZGljdGlvbmFyeShEQ1QpIGNvZGUNCi8vIHN0cmluZyBlbnQgOiBpbiA7ZW50aXR5KEVOVCkgY29kZQ0KLy8gc3RyaW5nIHR0bCA6IGluIDt0aGUgZGlhbG9nIHRpdGxlDQovLyBzdHJpbmcgdHh0IDogaW4gO25vIGxvbmdlciB1c2VkDQovLyBzdHJpbmcgdGlkIDogaW4gO3RoZSBpZCBvZiB0aGUgdGFyZ2V0IGZpZWxkDQovLyBzdHJpbmcgbW9kIDogaW4gO3RoZSBtb2RlKEZJRUxEVkFMIG9yIFNPUlQpIC0gZGVmYXVsdCBpcyAiRklFTERWQUwiDQovLyBzdHJpbmcgdWRmc29ubHkgOmluIG9ubHkgcmV0cmlldmUgdGhlIFVERlMgZm9yIHRoZSBlbnRpdHkNCmZ1bmN0aW9uIHNpdHNfeWRhbF9sc3QoZGN0LGVudCx0dGwsdHh0LHRpZCxtb2QsdWRmc29ubHkpIHsNCiAgc2l0c195ZGFsX3NlbGVjdCA9IG51bGw7IC8vZ2xvYmFsIHZhcmlhYmxlIGhvbGRpbmcgdGhlIGZpZWxkDQogIHNpdHNfeWRhbF9zZWxlY3Rfc3J0ID0gbnVsbDsgLy9nbG9iYWwgdmFyaWFibGUgaG9sZGluZyB0aGUgZmllbGQNCiAgaWYodHlwZW9mKGRjdCk9PSJzdHJpbmciICYmIGRjdC5sZW5ndGg+MCkgeyAvL2NoZWNrIGZpcnN0IHBhcmFtZXRlcg0KICAgIGlmKHR5cGVvZihlbnQpPT0ic3RyaW5nIiAmJiBlbnQubGVuZ3RoPjApIHsgLy9jaGVjayBzZWNvbmQgcGFyYW1ldGVyDQogICAgICBpZih0eXBlb2YodGlkKT09InN0cmluZyIgJiYgdGlkLmxlbmd0aD4wKSB7IC8vY2hlY2sgZmlmdGggcGFyYW1ldGVyDQogICAgICAgIGlmKHNpdHNfZ2V0X29iamVjdCh0aWQpIT1udWxsKSB7IC8vY2hlY2sgdGFyZ2V0IGZpZWxkIGV4aXN0cw0KICAgICAgICAgIGRjdCA9IHNpdHNfZXNjYXBlX3VybChkY3QudG9VcHBlckNhc2UoKSk7DQogICAgICAgICAgZW50ID0gc2l0c19lc2NhcGVfdXJsKGVudC50b1VwcGVyQ2FzZSgpKTsNCiAgICAgICAgICB0dGwgPSB0dGwgfHwgIiI7DQogICAgICAgICAgaWYobW9kIT0iU09SVCIpIHsNCiAgICAgICAgICAgIG1vZCA9ICJGSUVMRFZBTCI7IC8vZGVmYXVsdA0KICAgICAgICAgIH0NCiAgICAgICAgICBzaXRzX2RpYWxvZ19sb2FkaW5nKHRydWUsIkxPQUQiLCJzaXRzX3lkYWxkaWFfbG9hZGluZyIpOyAvL2NyZWF0ZSBsb2FkaW5nIGRpYWxvZw0KICAgICAgICAgICQoIiNzaXRzX3lkYWxkaWFfbG9hZGluZyIpLmRhdGEoInRpdGxlIix0dGwpOw0KICAgICAgICAgIHZhciBwYXIgPSAiRENUPSIrZGN0KyImRU5UPSIrZW50KyImRElBPXNpdHNfeWRhbGRpYSZUQVJHRVQ9Iit0aWQrIiZZTU9ERT0iK21vZCsiJlVERlM9Iit1ZGZzb25seTsgLy9idWlsZCBwYXJhbWV0ZXJzDQogICAgICAgICAgcmV0dXJuIHNpdHNfc2VuZF9xdWVyeSgiUE9TVCIsInNpd19kbXUueWRhbCIscGFyLHRydWUsInNpdHNfZG9feWRhbF9yZXR1cm4iKTsgLy9nZXQgZmllbGQgbGlzdA0KICAgICAgICB9DQogICAgICB9DQogICAgfQ0KICB9DQogIHJldHVybiBmYWxzZTsNCn0NCg0KLy9DYWxsZWQgdG8gcHJvY2VzcyBzdGF0dXMgcmV0dXJuZWQgZnJvbSAieWRhbCIgcXVlcmllcyhJUkVMMSBQUEwwMTQxMjEpDQovLyBzdHJpbmcgcmVzIDogaW4gO3RoZSByZXNwb25zZSBzdHJpbmcNCmZ1bmN0aW9uIHNpdHNfZG9feWRhbF9yZXR1cm4ocmVzKSB7DQogIHZhciBzdWIgPSByZXMuc3Vic3RyKDAsNCk7DQogIHJlcyA9IHJlcy5zdWJzdHIoNCk7DQogIGlmKHN1YiE9IjxPSz4iKSB7DQogICAgcmV0dXJuIGZhbHNlOyAvL2Vycm9yDQogIH0NCiAgdmFyIGZsZExpc3RPYmogPSBzaXRzX3BhcnNlX2pzb24ocmVzKTsgLy9jcmVhdGUgb2JqZWN0DQogIHZhciB0aGVib3ggPSBmbGRMaXN0T2JqLkRJQTsNCiAgZGVsZXRlIGZsZExpc3RPYmouRElBOw0KICB2YXIgYnBzID0gZmxkTGlzdE9iai5CT0lMRVJTOw0KICBkZWxldGUgZmxkTGlzdE9iai5CT0lMRVJTOw0KICB2YXIgeW1vZGUgPSBmbGRMaXN0T2JqLllNT0RFOw0KICBkZWxldGUgZmxkTGlzdE9iai5ZTU9ERTsNCiAgdmFyIHRhcmdldGZsZCA9IHNpdHNfZ2V0X29iamVjdChmbGRMaXN0T2JqLlRBUkdFVCk7DQogIGRlbGV0ZSBmbGRMaXN0T2JqLlRBUkdFVDsNCiAgdmFyIHZhbHMgPSB0YXJnZXRmbGQudmFsdWU7DQogIGlmKHZhbHMhPSIiKSB7DQogICAgdmFscyA9IHZhbHMuc3BsaXQoIjsiKTsgLy9jcmVhdGVzIGluZGV4ZWQgYXJyYXkNCiAgfQ0KDQogIHZhciBvcHRpb24gPSBudWxsOw0KICBpZih5bW9kZT09IlNPUlQiKSB7IC8vc29ydCBtb2RlDQogICAgc2l0c195ZGFsX3NlbGVjdF9zcnQgPSAiPG9wdGlvbiB2YWx1ZT1cIlwiPjwvb3B0aW9uPiI7DQogICAgc2l0c195ZGFsX3NlbGVjdF9zcnQgKz0gIjxvcHRpb24gdmFsdWU9XCJEXCI+IiticHNbIkJQMDI0Il0rIjwvb3B0aW9uPiI7DQogICAgc2l0c195ZGFsX3NlbGVjdF9zcnQgKz0gIjxvcHRpb24gdmFsdWU9XCJBXCI+IiticHNbIkJQMDIzIl0rIjwvb3B0aW9uPiI7DQogIH0NCiAgdmFyIHR0bCA9ICQoIiNzaXRzX3lkYWxkaWFfbG9hZGluZyIpLmRhdGEoInRpdGxlIik7DQogIHNpdHNfeWRhbF9zZWxlY3QgPSAiPG9wdGlvbiB2YWx1ZT1cIlwiPjwvb3B0aW9uPiI7Ly88c2VsZWN0IGNsYXNzPVwic3YtZm9ybS1jb250cm9sXCI+IjsNCiAgJC5lYWNoKGZsZExpc3RPYmosZnVuY3Rpb24oaSxrKSB7DQogICAgc2l0c195ZGFsX3NlbGVjdCs9ICI8b3B0aW9uIHZhbHVlPVwiIitpKyJcIj4iK2srIjwvb3B0aW9uPiI7DQogIH0pOw0KICB2YXIgeWRhbGh0bWwgPSAiPGRpdiBjbGFzcz1cInN2LWNvbnRhaW5lci1mbHVpZCB5ZGFsZGl2XCIgZGF0YS15bW9kZT1cIiIreW1vZGUrIlwiIGRhdGEtdGFyZ2V0PVwiIit0YXJnZXRmbGQuaWQrIlwiPjxkaXYgY2xhc3M9XCJzdi1yb3dcIj48ZGl2IGNsYXNzPVwic3YtY29sLW1kLTEyXCI+PGRpdiBjbGFzcz1cInN2LWZvcm0tY29udGFpbmVyXCI+PGRpdiBjbGFzcz1cInN2LWZvcm0taG9yaXpvbnRhbFwiPjxmaWVsZHNldCBpZD1cInlkYWxmc2V0XCI+PGxlZ2VuZCBjbGFzcz1cInN2LXNyLW9ubHlcIj4iK3R0bCsiPC9sZWdlbmQ+IjsNCiAgeWRhbGh0bWwgKz0gIjwvZmllbGRzZXQ+PC9kaXY+PC9kaXY+PC9kaXY+PC9kaXY+PC9kaXY+IjsNCg0KICB2YXIgYnRuID0ge307DQogIGJ0blticHNbIkJQMDIyIl1dID0gZnVuY3Rpb24oKSB7ICQoIiNzaXRzX3lkYWxkaWEiKS5vZmYoKTtzaXRzX2RpYWxvZ19jbG9zZSh0cnVlLCJzaXRzX3lkYWxkaWEiKX07IC8vYWRkICJjbG9zZSIgYnV0dG9uDQogIGJ0blticHNbIkJQMDIxIl1dID0gc2l0c19kb195ZGFsX2FjY2VwdDsgLy9hZGQgZnVuY3Rpb24gYWNjZXB0DQoJc2l0c19kaWFsb2dfbG9hZGluZyhmYWxzZSwiIiwic2l0c195ZGFsZGlhX2xvYWRpbmciKTsNCiAgc2l0c19kaWFsb2codHRsLHlkYWxodG1sLGJ0bix0cnVlLHRydWUsdHJ1ZSwiIiwic2l0c195ZGFsZGlhIix0cnVlLDYwKTsgLy9jcmVhdGUgZGlhbG9nDQogICQoIiNzaXRzX3lkYWxkaWEiKS5vbigiY2hhbmdlIiwic2VsZWN0LnlkYWxmbGRzZWxlY3QiLGZ1bmN0aW9uKCkgew0KICAgIGlmKHNpdHNfZG9feWRhbF9jaGFuZ2UoKSkgew0KICAgICAgc2l0c19kb195ZGFsX2FwcGVuZCgiIixicHMpOyAvL2FkZCBibGFuayByb3cNCiAgICB9DQogIH0pOw0KICAkKCIjc2l0c195ZGFsZGlhIikub24oImNsaWNrIiwiLnlkYWxkZWxldGUiLCBzaXRzX2RvX3lkYWxfZGVsZXRlKTsNCiAgaWYodmFscyE9IiIpIHsNCiAgICAkLmVhY2godmFscyxmdW5jdGlvbihpLGspIHsNCiAgICAgIHNpdHNfZG9feWRhbF9hcHBlbmQoayxicHMpOyAvL2xvb3AgdGhyb3VnaCB2YWxzIGFuZCBidWlsZCByb3cgZm9yIGVhY2gNCiAgICB9KQ0KICB9DQogIHNpdHNfZG9feWRhbF9hcHBlbmQoIiIsYnBzKTsgLy9hZGQgYmxhbmsgcm93DQogICQoIiNzaXRzX3lkYWxkaWEiKS5maW5kKCJzZWxlY3Q6Zmlyc3QiKS5mb2N1cygpOw0KICByZXR1cm4gdHJ1ZTsNCn0NCi8vQ2FsbGVkIGZyb20gInNpdHNfZG9feWRhbF9yZXN1bHRzIiB0byBhcHBlbmQgYSBuZXcgcm93KElSRUwxIFBQTDAxNDEyMSkNCi8vIHN0cmluZyB2YWwgOiBpbiA7dGhlIHJvdyB2YWx1ZQ0KZnVuY3Rpb24gc2l0c19kb195ZGFsX2FwcGVuZCh2YWwsYnBzKSB7DQogIHZhciBuVGFiID0gc2l0c19nZXRfb2JqZWN0KCJ5ZGFsZnNldCIpOyAvL2dldCB0YWJsZSBvYmplY3QNCiAgdmFyIHltb2RlID0gJCgiLnlkYWxkaXYiKS5hdHRyKCJkYXRhLXltb2RlIik7DQogIHZhciB5ZGFsaWQgPSBzaXRzX3V1aWQoKTsNCiAgdmFyIGZTZWxlY3QgPSAiPHNlbGVjdCBjbGFzcz1cInN2LWZvcm0tY29udHJvbCB5ZGFsZmxkc2VsZWN0XCIgaWQ9XCJzZWxmbGQiK3lkYWxpZCsiXCI+IitzaXRzX3lkYWxfc2VsZWN0KyI8L3NlbGVjdD4iOyAvL2Nsb25lIHNlbGVjdCBvYmplY3QNCiAgdmFyIG5JbnB1dCA9IG51bGw7IC8vY3JlYXRlIGlucHV0IGZpZWxkDQogIGlmKHltb2RlIT0iU09SVCIpIHsNCiAgICBuSW5wdXQgPSAiPGlucHV0IHR5cGU9XCJ0ZXh0XCIgaWQ9XCJ2YWxmbGQiK3lkYWxpZCsiXCIgY2xhc3M9XCJzdi1mb3JtLWNvbnRyb2xcIj4iOw0KICB9ZWxzZSB7DQogICAgbklucHV0ID0gIjxzZWxlY3QgY2xhc3M9XCJzdi1mb3JtLWNvbnRyb2xcIiBpZD1cInZhbGZsZCIreWRhbGlkKyJcIj4iK3NpdHNfeWRhbF9zZWxlY3Rfc3J0KyI8L3NlbGVjdD4iOw0KICB9DQogIHZhciByZW1pY29uID0gIjxzcGFuIGNsYXNzPVwiZ2x5cGhpY29uIGdseXBoaWNvbi1yZW1vdmVcIiBhcmlhLWhpZGRlbj1cInRydWVcIiA+PC9zcGFuPiI7DQogIHZhciBuSW1hZ2UgID0gIjxidXR0b24gY2xhc3M9XCJ5ZGFsZGVsZXRlIHN2LWJ0biBzdi1idG4tZGVmYXVsdFwiIHRpdGxlPVwiIiticHNbIkJQMDk2Il0rIlwiPiIrcmVtaWNvbisiPC9idXR0b24+IjsNCg0KDQogIHZhciBmb3JtZ3JvdXBodG1sID0gIjxkaXYgY2xhc3M9XCJzdi1mb3JtLWdyb3VwXCI+PGxhYmVsIGNsYXNzPVwic3YtY29sLXNtLTIgc3YtY29udHJvbC1sYWJlbFwiIGZvcj1cInNlbGZsZCIreWRhbGlkKyJcIj4iK2Jwc1siQlAwMTgiXSsiPC9sYWJlbD48ZGl2IGNsYXNzPVwic3YtY29sLXNtLTRcIj4iK2ZTZWxlY3QrIjwvZGl2PiI7DQogIGZvcm1ncm91cGh0bWwrPSAiPGxhYmVsIGNsYXNzPVwic3YtY29sLXNtLTIgc3YtY29udHJvbC1sYWJlbFwiIGZvcj1cInZhbGZsZCIreWRhbGlkKyJcIj4iK2Jwc1siQlAwMTkiXSsiPC9sYWJlbD48ZGl2IGNsYXNzPVwic3YtY29sLXNtLTNcIj4iK25JbnB1dCsiPC9kaXY+PGRpdiBjbGFzcz1cInN2LWNvbC1zbS0xXCI+IituSW1hZ2UrIjwvZGl2PjwvZGl2PiI7DQogICQoblRhYikuYXBwZW5kKGZvcm1ncm91cGh0bWwpOw0KDQoNCi8vICAkKCJidXR0b24ueWRhbGRlbGV0ZSIpLmJ1dHRvbih7IGljb25zOiB7IHByaW1hcnk6ICJ1aS1pY29uLWNsb3NldGhpY2siIH0sdGV4dDpmYWxzZX0pOw0KICBpZigkKCIueWRhbGRlbGV0ZSIpLmxlbmd0aD4xKSB7DQogICAgJCgiLnlkYWxkZWxldGUiKS5wcm9wKCJkaXNhYmxlZCIsIiIpOw0KICB9ZWxzZSB7DQogICAgJCgiLnlkYWxkZWxldGUiKS5wcm9wKCJkaXNhYmxlZCIsImRpc2FibGVkIik7DQogIH0NCiAgaWYodHlwZW9mKHZhbCk9PSJzdHJpbmciICYmIHZhbC5pbmRleE9mKCI9Iik+LTEpIHsgLy9pZiB2YWx1ZSBwYXNzZWQgdGhyb3VnaCBzZXQgaXQNCiAgICBzaXRzX3NldF92YWx1ZSgic2VsZmxkIit5ZGFsaWQsdmFsLnN1YnN0cigwLHZhbC5pbmRleE9mKCI9IikpKTsNCiAgICBpZih5bW9kZSE9IlNPUlQiKSB7DQogICAgICBzaXRzX3NldF92YWx1ZSgidmFsZmxkIit5ZGFsaWQsdmFsLnN1YnN0cih2YWwuaW5kZXhPZigiPSIpKzEpKTsNCiAgICB9ZWxzZSB7DQogICAgICBzaXRzX3NldF92YWx1ZSgidmFsZmxkIit5ZGFsaWQsdmFsLnN1YnN0cih2YWwuaW5kZXhPZigiPSIpKzEpKTsNCiAgICB9DQogIH1lbHNlIHsNCiAgICBzaXRzX3NldF92YWx1ZSgic2VsZmxkIit5ZGFsaWQsIiIpOw0KICAgIGlmKHltb2RlIT0iU09SVCIpIHsNCiAgICAgIHNpdHNfc2V0X3ZhbHVlKCJ2YWxmbGQiK3lkYWxpZCwiIik7DQogICAgfQ0KICAgIGVsc2Ugew0KICAgICAgc2l0c19zZXRfdmFsdWUoInZhbGZsZCIreWRhbGlkLCIiKTsNCiAgICB9DQogIH0NCiAgcmV0dXJuIHRydWU7DQp9DQoNCi8vQ2FsbGVkIHdoZW4gY2hhbmdpbmcgZmllbGQgY29kZSB0byBhZGQgYSBuZXcgcm93KFBQTDAxNDEyMSkNCi8vIG9iamVjdCBldnQgOiBpbiA7dGhlIGV2ZW50IG9iamVjdA0KZnVuY3Rpb24gc2l0c19kb195ZGFsX2NoYW5nZSgpIHsNCiAgdmFyIG5UYWIgPSBzaXRzX2dldF9vYmplY3QoInlkYWxmc2V0Iik7IC8vZ2V0IHRhYmxlIG9iamVjdA0KICB2YXIgeW1vZGUgPSAkKG5UYWIpLmNsb3Nlc3QoImRpdi55ZGFsZGl2IikuYXR0cigiZGF0YS15bW9kZSIpOw0KICB2YXIgc2VsZWN0cyA9IG51bGw7DQogIGlmKHltb2RlPT0iU09SVCIpIHsNCiAgICBzZWxlY3RzID0gJChuVGFiKS5maW5kKCJzZWxlY3Q6ZXZlbiIpOw0KICB9ZWxzZSB7DQogICAgc2VsZWN0cyA9ICQoblRhYikuZmluZCgic2VsZWN0Iik7DQogIH0NCiAgdmFyIHZhbCA9IHNpdHNfZ2V0X3ZhbHVlKHNlbGVjdHNbc2VsZWN0cy5sZW5ndGgtMV0pOw0KICBpZih2YWwhPSIiKSB7IC8vY2hlY2sgaWYgbGFzdCBzZWxlY3QgaXMgYmxhbmsNCiAgICAgcmV0dXJuIHRydWU7DQogIH0NCiAgcmV0dXJuIGZhbHNlOw0KfQ0KDQovL0NhbGxlZCB3aGVuIGNsaWNraW5nIG9uIGRlbGV0ZSBpY29uIHRvIGRlbGV0ZSBhIHJvdyhQUEwwMTQxMjEpDQovLyBvYmplY3QgZXZ0IDogaW4gO3RoZSBldmVudCBvYmplY3QNCmZ1bmN0aW9uIHNpdHNfZG9feWRhbF9kZWxldGUoZXZ0KSB7DQogIGV2dCA9IHNpdHNfZ2V0X3RhcmdldChldnQpOw0KICBpZigkKCIueWRhbGRlbGV0ZSIpLmxlbmd0aD4xKSB7DQogICAgdmFyIHBhcmVudCA9ICQoZXZ0KS5jbG9zZXN0KCJkaXYuc3YtZm9ybS1ncm91cCIpOw0KICAgIGlmKHBhcmVudC5wcmV2KCJkaXYuc3YtZm9ybS1ncm91cCIpLmxlbmd0aD4wKSB7DQogICAgICBwYXJlbnQucHJldigiZGl2LnN2LWZvcm0tZ3JvdXAiKS5maW5kKCJzZWxlY3Q6Zmlyc3QiKS5mb2N1cygpOw0KICAgIH1lbHNlIHsNCiAgICAgIHBhcmVudC5uZXh0KCJkaXYuc3YtZm9ybS1ncm91cCIpLmZpbmQoInNlbGVjdDpmaXJzdCIpLmZvY3VzKCk7DQogICB9DQogICAgcGFyZW50LnJlbW92ZSgpOw0KICB9DQogIGlmKCQoIi55ZGFsZGVsZXRlIikubGVuZ3RoPjEpIHsNCiAgICAkKCIueWRhbGRlbGV0ZSIpLnByb3AoImRpc2FibGVkIiwiIik7DQogIH1lbHNlIHsNCiAgICAkKCIueWRhbGRlbGV0ZSIpLnByb3AoImRpc2FibGVkIiwiZGlzYWJsZWQiKTsNCiAgfQ0KDQogIHJldHVybjsNCn0NCg0KLy9DYWxsZWQgZnJvbSAib2siIGJ1dHRvbiBvbiBZREFMIHNjcmVlbiB0byBwb3B1bGF0ZSB0YXJnZXQgZmllbGQoSVJFTDEgUFBMMDE0MTIxKQ0KZnVuY3Rpb24gc2l0c19kb195ZGFsX2FjY2VwdCgpIHsNCiAgdmFyIG5UYWIgPSAkKCIueWRhbGRpdiIpOyAvL2dldCB0YWJsZSBvYmplY3QNCiAgdmFyIHltb2RlID0gblRhYi5hdHRyKCJkYXRhLXltb2RlIik7DQogIHZhciBzZWxlY3RzID0gbnVsbDsNCiAgdmFyIGlucHV0cyA9IG51bGw7DQogIGlmKHltb2RlPT0iU09SVCIpIHsNCiAgICBzZWxlY3RzID0gblRhYi5maW5kKCJzZWxlY3Q6ZXZlbiIpOw0KICAgIGlucHV0cyA9ICBuVGFiLmZpbmQoInNlbGVjdDpvZGQiKTsNCiAgfWVsc2Ugew0KICAgIHNlbGVjdHMgPSBuVGFiLmZpbmQoInNlbGVjdCIpOw0KICAgIGlucHV0cyA9IG5UYWIuZmluZCgiaW5wdXQiKTsNCiAgfQ0KICB2YXIgbGd0aCA9IHNlbGVjdHMubGVuZ3RoOw0KICB2YXIgZCA9IHt9Ow0KICBmb3IodmFyIGk9MDtpPGxndGg7aSsrKSB7IC8vbG9vcCB0aHJvdWdoIGFsbCBzZWxlY3RzIGFuZCBidWlsZCBhcnJheQ0KICAgIHZhciB2YWwgPSBzaXRzX2dldF92YWx1ZShzZWxlY3RzW2ldKTsNCiAgICBpZih2YWwhPSIiKSB7DQogICAgICBkW3ZhbF0gPSBzaXRzX2dldF92YWx1ZShpbnB1dHNbaV0pOyAvL3RoaXMgb3ZlcndyaXRlcyBkdXBsaWNhdGUgZmllbGRzDQogICAgfQ0KICB9DQogIHZhciB0aGV2YWx1ZSA9ICIiOw0KICBmb3IodmFyIGsgaW4gZCkgew0KICAgIHRoZXZhbHVlICs9ICI7IitrKyI9IitkW2tdOyAvL2J1aWxkIGZpZWxkPXZhbHVlIGxpc3QNCiAgfQ0KICB0aGV2YWx1ZSA9IHRoZXZhbHVlLnN1YnN0cigxKTsgIC8vc3RyaXAgb2ZmIGZpcnN0OyBjaGFyYWN0ZXINCiAgdmFyIHRoZXRhcmcgPSAkKG5UYWIpLmF0dHIoImRhdGEtdGFyZ2V0Iik7DQogIGlmKHRoZXZhbHVlPT0iPSIpIHsNCiAgICB0aGV2YWx1ZSA9ICIiOyAvL2NoZWNrIGZvciBibGFuayBzdHJpbmcNCiAgfQ0KICBzaXRzX3NldF92YWx1ZSh0aGV0YXJnLHRoZXZhbHVlKTsgLy9tdXN0IHVwZGF0ZSBiZWZvcmUgY2xvc2luZyENCiAgJCgiI3NpdHNfeWRhbGRpYSIpLm9mZigpDQogIHNpdHNfZGlhbG9nX2Nsb3NlKHRydWUsInNpdHNfeWRhbGRpYSIpOw0KICByZXR1cm4gdHJ1ZTsNCn0NCg0KLy9DYWxsZWQgdG8gaHRtbCBlbmNvZGUgY2hhcmFjdGVycyhQUEwwMTE1NDIpDQovLyBzdHJpbmcgc3RyIDogaW4gO3N0cmluZyB0byBiZSBlbmNvZGVkDQpmdW5jdGlvbiBzaXRzX2h0bWxfZW5jb2RlKHN0cikgew0KICBzdHIgPSBzaXRzX3JlcGxhY2Uoc3RyLCImIiwiJmFtcDsiKTsNCiAgc3RyID0gc2l0c19yZXBsYWNlKHN0ciwiICIsIiZuYnNwOyIpOw0KICBzdHIgPSBzaXRzX3JlcGxhY2Uoc3RyLCJcIiIsIiZxdW90OyIpOw0KICBzdHIgPSBzaXRzX3JlcGxhY2Uoc3RyLCLCoyIsIiZwb3VuZDsiKTsNCiAgc3RyID0gc2l0c19yZXBsYWNlKHN0ciwiPCIsIiZsdDsiKTsNCiAgc3RyID0gc2l0c19yZXBsYWNlKHN0ciwiPiIsIiZndDsiKTsNCiAgcmV0dXJuIHN0cjsNCn0NCg0KLy9DYWxsZWQgdG8gZGVjb2RlIGh0bWwgY2hhcmFjdGVycyhQUEwwMTE1NDIpDQovLyBzdHJpbmcgc3RyIDogaW4gO3N0cmluZyB0byBiZSBkZWNvZGVkDQpmdW5jdGlvbiBzaXRzX2h0bWxfZGVjb2RlKHN0cikgew0KICBzdHIgPSBzaXRzX3JlcGxhY2Uoc3RyLCImZ3Q7IiwiPiIpOw0KICBzdHIgPSBzaXRzX3JlcGxhY2Uoc3RyLCImbHQ7IiwiPCIpOw0KICBzdHIgPSBzaXRzX3JlcGxhY2Uoc3RyLCImcG91bmQ7IiwiwqMiKTsNCiAgc3RyID0gc2l0c19yZXBsYWNlKHN0ciwiJnF1b3Q7IiwiXCIiKTsNCiAgc3RyID0gc2l0c19yZXBsYWNlKHN0ciwiJm5ic3A7IiwiICIpOw0KICBzdHIgPSBzaXRzX3JlcGxhY2Uoc3RyLCImYW1wOyIsIiYiKTsNCiAgcmV0dXJuIHN0cjsNCn0NCg0KLy9DYWxsZWQgdG8gZmxvYXQgdGhlIGhlYWRlciBvZiBhIHRhYmxlKFBQTDAxMzI1NSkNCi8vIHN0cmluZyAgIGlkIDogaW4gO2lkIG9mIHRoZSB0YWJsZSB0byBhcHBseSB0aGUgZmxvYXRpbmcgdG8NCmZ1bmN0aW9uIHNpdHNfZmxvYXRfaGVhZGVyKGlkKSB7DQogIGlmKHNpdHNfZmlsZXNfYXJyYXlbIi4uL3BsdWdpbnMvamF2YXNjcmlwdC9mbG9hdGhlYWRlci5qcyJdPT0iWSIpIHsgLy9hbHJlYWR5IGxvYWRlZC4uLg0KICAgIHNpdHNfZG9fZmxvYXRfaGVhZGVyKGlkKTsgLy8uLi5zbyBjYWxsIHN0cmFpZ2h0IGF3YXkNCiAgfQ0KICBlbHNlIHsgLy9ub3QgbG9hZGVkIHlldA0KICAgIHZhciBwYXIgPSB7fTsgLy9jcmVhdGUgYW4gb2JqZWN0IG9mIHBhcmFtZXRlcnMNCiAgICBwYXIudXJsID0gIi4uL3BsdWdpbnMvamF2YXNjcmlwdC9mbG9hdGhlYWRlci5qcyI7DQogICAgcGFyLmZuYyA9IHNpdHNfZG9fZmxvYXRfaGVhZGVyOw0KICAgIHBhci5wMDEgPSBpZDsNCiAgICB2YXIgbGVuID0gc2l0c19wYXJhbV9hcnJheS5wdXNoKHBhcik7IC8vc2F2ZSBmb3IgbGF0ZXINCiAgICBzaXRzX2luY2x1ZGVfZmlsZShzaXRzX21pbmlmaWVkX3BhdGgoIi4uL3BsdWdpbnMvamF2YXNjcmlwdC8iLCJqcXVlcnktbWlncmF0ZS5qcyIsImpxdWVyeS1taWdyYXRlLm1pbi5qcyIpLGZ1bmN0aW9uKGJvbykgew0KICAgICAgc2l0c19pbmNsdWRlX2ZpbGUoIi4uL3BsdWdpbnMvamF2YXNjcmlwdC9mbG9hdGhlYWRlci5qcyIpOw0KICAgIH0pOw0KICB9DQogIHJldHVybiB0cnVlOw0KfQ0KDQovL0ludGVybmFsIGZ1bmN0aW9uIHRvIGZsb2F0IHRoZSBoZWFkZXIgb2YgYSB0YWJsZShQUEwwMTMyNTUpDQovLyBzdHJpbmcgICBpZCA6IGluIDtpZCBvZiB0aGUgdGFibGUgdG8gYXBwbHkgdGhlIGZsb2F0aW5nIHRvDQpmdW5jdGlvbiBzaXRzX2RvX2Zsb2F0X2hlYWRlcihpZCkgew0KICBpZih0eXBlb2YoaWQpPT0ic3RyaW5nIiAmJiBpZC5sZW5ndGg+MCkgeyAvL2NoZWNrIHBhcmFtZXRlcg0KICAgIGlkID0gc2l0c19kb19nZXRfb2JqZWN0KGlkKTsNCiAgICB2YXIgdGFiID0gJCgiIyIraWQrIl9mbG9hdCIpOw0KICAgIGlmKHRhYi5sZW5ndGg+MCkgeyAvL2NoZWNrIGlmIGFscmVhZHkgZG9uZQ0KICAgICAgdmFyIGZsb2F0Um93ID0gdGFiLmZpbmQoInRyLnNpdHNfZmxvYXQiKS5lbXB0eSgpOyAvL2RlbGV0ZSBjbG9uZSBjZWxscw0KICAgICAgJCgiIyIraWQrIiB0ci5zaXRzX2Zsb2F0IikuY2hpbGRyZW4oKS5lYWNoKGZ1bmN0aW9uKCkgew0KICAgICAgICB2YXIgY2VsbCA9ICQodGhpcyk7DQogICAgICAgIHZhciBmbG9hdENlbGwgPSBjZWxsLmNsb25lKCk7IC8vcmUtY2xvbmUgY2VsbA0KICAgICAgICBpZighJC5zdXBwb3J0LmNzc0Zsb2F0KSB7IC8vY2hlY2sgZm9yIElFDQogICAgICAgICAgZmxvYXRDZWxsLmNzcygid2lkdGgiLGNlbGwub3V0ZXJXaWR0aCgpKTsNCiAgICAgICAgICBmbG9hdENlbGwuY3NzKCJwYWRkaW5nIiwiMCAwIDAgMCIpOw0KICAgICAgICB9DQogICAgICAgIGVsc2Ugew0KICAgICAgICAgIGZsb2F0Q2VsbC5jc3MoIndpZHRoIixjZWxsLndpZHRoKCkpOw0KICAgICAgICB9DQogICAgICAgIGZsb2F0Um93LmFwcGVuZChmbG9hdENlbGwpOyAvL2FwcGVuZCB0byBjbG9uZSByb3cNCiAgICAgIH0pOw0KICAgICAgJCgiIyIraWQrIl9mbG9hdCAqW2lkXSIpLmF0dHIoImlkIiwiIik7IC8vcmVtb3ZlIGR1cGxpY2F0ZWQgaWRzDQogICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQogICAgZWxzZSB7DQogICAgICB2YXIgb3B0ID0ge307IC8vZGVmaW5lIG9wdGlvbnMNCiAgICAgIG9wdC5mYWNlSW4gPSAwOw0KICAgICAgb3B0LmZhZGVPdXQgPSAwOw0KICAgICAgb3B0LmZvcmNlQ2xhc3MgPSB0cnVlOw0KICAgICAgb3B0Lm1hcmtlckNsYXNzID0gInNpdHNfZmxvYXQiOw0KICAgICAgJCgiIyIraWQpLmZsb2F0SGVhZGVyKG9wdCk7IC8vY3JlYXRlIGZsb2F0aW5nIGhlYWRlcnMNCiAgICAgICQoImRpdi5mbG9hdEhlYWRlciAjIitpZCkuZmluZCgiKltpZF0iKS5hdHRyKCJpZCIsIiIpLmVuZCgpLmF0dHIoImlkIixpZCsiX2Zsb2F0Iik7IC8vcmVtb3ZlIGR1cGxpY2F0ZWQgaWRzDQogICAgICByZXR1cm4gdHJ1ZTsNCiAgICB9DQogIH0NCiAgcmV0dXJuIGZhbHNlOw0KfQ0KDQovL0NhbGxlZCB0byBhZGQgcG9zdGNvZGUgbG9va3VwIHRvIGEgYnV0dG9uKFBQTDAxNjU0OCkNCi8vIFNNSUo2LCAyMC8xMC8yMDE1IG1vdmVkIGFsbCBwb3N0b2RlIGZ1bmN0aW9ucyBpbnRvIG5ldyBmaWxlLCAzMTQxODUNCi8vIHN0cmluZyAgIGlkIDogaW4gO2lkIG9mIHRoZSBidXR0b24gdG8gaGlqYWNrDQovLyBzdHJpbmcgICBwY291bnRyeV9maWVsZF9pZCA6IGluIDtpZCBvZiB0aGUgY291bnRyeSBmaWVsZCBhc3NvY2lhdGVkIHRvIHRoZSBmaW5kIGFkZHJlc3MgYnV0dG9uIHBhc3NlZCBpbg0KLy8gc3RyaW5nICAgcHBvc3Rjb2RlX2ZpZWxkX2lkIDogaW4gO2lkIG9mIHRoZSBwb3N0Y29kZSBmaWVsZCBhc3NvY2lhdGVkIHRvIHRoZSBmaW5kIGFkZHJlc3MgYnV0dG9uIHBhc3NlZCBpbg0KZnVuY3Rpb24gc2l0c19wb3N0Y29kZShpZCxwY291bnRyeV9maWVsZF9pZCxwcG9zdGNvZGVfZmllbGRfaWQpIHsNCiAgaWYoc2l0c19maWxlc19hcnJheVsiLi4vamF2YXNjcmlwdC9zaXRzX2FqYXhfcG9zdGNvZGUuanMiXT09IlkiKSB7IC8vYWxyZWFkeSBsb2FkZWQuLi4NCiAgICBzaXRzX2RvX3Bvc3Rjb2RlKGlkLCBwY291bnRyeV9maWVsZF9pZCwgcHBvc3Rjb2RlX2ZpZWxkX2lkKTsgLy8uLi5zbyBjYWxsIHN0cmFpZ2h0IGF3YXkNCiAgfQ0KICBlbHNlIHsgLy9ub3QgbG9hZGVkIHlldC4uLg0KICAgIHZhciBwYXIgPSB7fTsgLy9jcmVhdGUgYW4gb2JqZWN0IG9mIHBhcmFtZXRlcnMNCiAgICBwYXIudXJsID0gIi4uL2phdmFzY3JpcHQvc2l0c19hamF4X3Bvc3Rjb2RlLmpzIjsNCiAgICBwYXIuZm5jID0gc2l0c19kb19wb3N0Y29kZTsNCiAgICBwYXIucDAxID0gaWQ7DQogICAgcGFyLnAwMiA9IHBjb3VudHJ5X2ZpZWxkX2lkOw0KICAgIHBhci5wMDMgPSBwcG9zdGNvZGVfZmllbGRfaWQ7DQogICAgdmFyIGxlbiA9IHNpdHNfcGFyYW1fYXJyYXkucHVzaChwYXIpOyAvL3NhdmUgZm9yIGxhdGVyDQogICAgc2l0c19pbmNsdWRlX2ZpbGUoIi4uL2phdmFzY3JpcHQvc2l0c19hamF4X3Bvc3Rjb2RlLmpzIik7DQogIH0NCiAgcmV0dXJuIHRydWU7DQp9DQoNCmZ1bmN0aW9uIHNpdHNfZG9fcG9zdGNvZGUoaWQscGNvdW50cnlfZmllbGRfaWQscHBvc3Rjb2RlX2ZpZWxkX2lkKSB7DQogIGlmKHR5cGVvZihzaXRzX3Bvc3Rjb2RlX3N0YXJ0KT09ImZ1bmN0aW9uIikgew0KICAgIHJldHVybiBzaXRzX3Bvc3Rjb2RlX3N0YXJ0KGlkLHBjb3VudHJ5X2ZpZWxkX2lkLHBwb3N0Y29kZV9maWVsZF9pZCk7IC8vIGluIHNpdHNfYWpheF9wb3N0Y29kZS5qcygzMTQxODUpDQogIH0NCiAgcmV0dXJuIGZhbHNlOw0KfQ0KDQovL01vdmUgY3Vyc29yIHRvIHRoZSBlbmQgb2YgdGhlIHRleHQgaW4gYSBmaWVsZA0KLy8gZWxlbWVudCAgZmxkIDogaW4gO3RoZSBmaWVsZA0KZnVuY3Rpb24gc2l0c19zZWxlY3Rpb25fZW5kKGZsZCkgew0KICBpZihmbGQuY3JlYXRlVGV4dFJhbmdlKSB7IC8vSUUNCiAgICB2YXIgdGVtcCA9IGZsZC5jcmVhdGVUZXh0UmFuZ2UoKTsNCiAgICB0ZW1wLm1vdmVTdGFydCgiY2hhcmFjdGVyIixmbGQudmFsdWUubGVuZ3RoKTsNCiAgICB0ZW1wLnNlbGVjdCgpOw0KICAgIHJldHVybiB0cnVlOw0KICB9DQogIGVsc2UgaWYoZmxkLnNldFNlbGVjdGlvblJhbmdlKSB7IC8vT3RoZXINCiAgICBmbGQuc2V0U2VsZWN0aW9uUmFuZ2UoZmxkLnZhbHVlLmxlbmd0aCxmbGQudmFsdWUubGVuZ3RoKTsNCiAgICByZXR1cm4gdHJ1ZTsNCiAgfQ0KICByZXR1cm4gZmFsc2U7DQp9DQoNCi8vQ291bnQgdGhlIG51bWJlciBvZiBjaGFyYWN0ZXJzIHNlbGVjdGVkIGluIGEgZmllbGQNCi8vIGVsZW1lbnQgIGZsZCA6IGluIDt0aGUgZmllbGQNCmZ1bmN0aW9uIHNpdHNfc2VsZWN0aW9uX2xlbihmbGQpIHsNCiAgdmFyIG91dCA9IC0xOw0KICBpZihmbGQuY3JlYXRlVGV4dFJhbmdlKSB7IC8vSUUNCiAgICB2YXIgdGVtcCA9IGRvY3VtZW50LnNlbGVjdGlvbi5jcmVhdGVSYW5nZSgpLmR1cGxpY2F0ZSgpOw0KICAgIG91dCA9IHRlbXAudGV4dC5sZW5ndGg7DQogIH0NCiAgZWxzZSBpZihmbGQuc2V0U2VsZWN0aW9uUmFuZ2UpIHsgLy9PdGhlcg0KICAgIHRyeSB7DQogICAgICBvdXQgPSBmbGQuc2VsZWN0aW9uRW5kLWZsZC5zZWxlY3Rpb25TdGFydDsNCiAgICB9DQogICAgY2F0Y2goZSkgew0KICAgICAgb3V0ID0gLTE7DQogICAgfQ0KICB9DQogIHJldHVybiBvdXQ7IC8vcmV0dXJuIGNvdW50DQp9DQoNCi8vQ2FsY3VsYXRlIHRoZSBwb3NpdGlvbiBvZiB0aGUgZmlyc3Qgc2VsZWN0ZWQgY2hhcmFjdGVyDQovLyBlbGVtZW50ICBmbGQgOiBpbiA7dGhlIGZpZWxkDQpmdW5jdGlvbiBzaXRzX3NlbGVjdGlvbl9wb3MoZmxkKSB7DQogIHZhciBvdXQgPSAtMTsNCiAgaWYoZmxkLmNyZWF0ZVRleHRSYW5nZSkgeyAvL0lFDQogICAgdmFyIHRlbXAgPSBkb2N1bWVudC5zZWxlY3Rpb24uY3JlYXRlUmFuZ2UoKS5kdXBsaWNhdGUoKTsNCiAgICB0ZW1wLm1vdmVFbmQoInRleHRlZGl0IiwxKTsNCiAgICBvdXQgPSBmbGQudmFsdWUubGVuZ3RoLXRlbXAudGV4dC5sZW5ndGg7DQogIH0NCiAgZWxzZSBpZihmbGQuc2V0U2VsZWN0aW9uUmFuZ2UpIHsgLy9PdGhlcg0KICAgIHRyeSB7DQogICAgICBvdXQgPSBmbGQuc2VsZWN0aW9uU3RhcnQ7DQogICAgfQ0KICAgIGNhdGNoKGUpIHsNCiAgICAgIG91dCA9IC0xOw0KICAgIH0NCiAgfQ0KICByZXR1cm4gb3V0OyAvL3JldHVybiBwb3NpdGlvbg0KfQ0KDQovL1JldHVybnMgdHJ1ZSBpZiB1bmljb2RlIGNoYXJzIGV4aXN0IGluIGFueSBvZiB0aGUgdGV4dCBmaWVsZHMgbWF0Y2hlZCBieSB0aGUgc2VsZWN0b3INCi8vIHN0cmluZyAgIHNlbCAgOiBpbiA7alF1ZXJ5IHNlbGVjdG9yIHRvIGFwcGx5IHRoZSBjb250ZXh0IG1lbnUgdG8NCi8vIHN0cmluZyAgIGNscyAgOiBpbiA7Y2xhc3MgdG8gYXBwbHkgdG8gZmllbGRzIHdpdGggdW5pY29kZShkZWZhdWx0cyB0byAid3lzX25vdW5pIikNCi8vIGJvb2xlYW4gIGV4dCAgOiBpbiA7ZXhjZXB0IFVDQVMgdW5pY29kZSByYW5nZQ0KZnVuY3Rpb24gc2l0c19ub25fdW5pY29kZShzZWwsY2xzLGV4dCkgew0KICBpZih0eXBlb2Yoc2VsKSE9InN0cmluZyIgfHwgc2VsPT0iIikgeyAvL2NoZWNrIHNlbGVjdG9yDQogICAgc2VsID0gImlucHV0W3R5cGU9dGV4dF0sIHRleHRhcmVhIjsNCiAgfQ0KICBpZih0eXBlb2YoY2xzKSE9InN0cmluZyIpIHsgLy9jaGVjayBjbGFzcw0KICAgIGNscyA9ICJ3eXNfbm91bmkiOw0KICB9DQogIGlmKHR5cGVvZihleHQpIT0iYm9vbGVhbiIpIHsgLy9jaGVjayBVQ0FTDQogICAgZXh0ID0gZmFsc2U7DQogIH0NCiAgdmFyIGJvbyA9IGZhbHNlOw0KICB2YXIgaW5wID0gJChzZWwpOyAvL2dldCBhbGwgZmllbGRzIGZvciBzZWxlY3Rvcg0KICBpZihzZWwhPSJpbnB1dFt0eXBlPXRleHRdLCB0ZXh0YXJlYSIgJiYgc2VsIT0iaW5wdXRbdHlwZT10ZXh0XSIgJiYgc2VsIT0idGV4dGFyZWEiKSB7DQogICAgaW5wLmZpbHRlcigiaW5wdXRbdHlwZT10ZXh0XSwgdGV4dGFyZWEiKTsgLy9maWx0ZXIgaW5wdXRzIGFuZCB0ZXh0YXJlYXMgb25seQ0KICB9DQogIGlmKGNscyE9IiIpIHsNCiAgICBpbnAucmVtb3ZlQ2xhc3MoY2xzKTsgLy9yZW1vdmUgY2xhc3MNCiAgfQ0KICBpbnAuZWFjaChmdW5jdGlvbihpKSB7DQogICAgdmFyIHllcyA9IGZhbHNlOw0KICAgIGlmKGV4dCAmJiAvW15cdTAwMjAtXHUwMDdmfF5cdTAwYTAtXHUwMjRmfF5cdTFlMDAtXHUxZWZmXS8udGVzdCh0aGlzLnZhbHVlKSkgeyAvL2NoZWNrIGZvciBVQ0FTIGFsbG93ZWQgY2hhcmFjdGVycw0KICAgICAgeWVzID0gdHJ1ZTsNCiAgICB9DQogICAgZWxzZSBpZighZXh0ICYmIC9bXlx1MDAwMC1cdTAwZmZdLy50ZXN0KHRoaXMudmFsdWUpKSB7IC8vY2hlY2sgZm9yIHVuaWNvZGUgY2hhcmFjdGVycw0KICAgICAgeWVzID0gdHJ1ZTsNCiAgICB9DQogICAgaWYoeWVzKSB7DQogICAgICBib28gPSB0cnVlOw0KICAgICAgaWYoY2xzIT0iIikgew0KICAgICAgICAkKHRoaXMpLmFkZENsYXNzKGNscyk7IC8vYWRkIGNsYXNzIHRvIGhpZ2hsaWdodCBlcnJvcg0KICAgICAgfQ0KICAgIH0NCiAgfSk7DQogIHJldHVybiBib287IC8vcmV0dXJuIHdoZXRoZXIgdW5pY29kZSBjaGFyYWN0ZXJzIGZvdW5kDQp9DQoNCi8vQ2hlY2sgaWYgYSB2YWx1ZSBpcyBhbiBpbnRlZ2VyIHZhbHVlIG9yIG5vdA0KLy8gYW55dGhpbmcgdmFsIDogaW4gO3ZhbHVlIHRvIGNoZWNrDQpmdW5jdGlvbiBzaXRzX2lzX2ludCh2YWwpIHsNCiAgdmFyIG51bSA9IHBhcnNlSW50KHZhbCwxMCk7IC8vcGFyc2UgaW50ZWdlcg0KICBpZihpc05hTihudW0pKSB7DQogICAgcmV0dXJuIGZhbHNlOyAvL25vdCBldmVuIGEgbnVtYmVyDQogIH0NCiAgcmV0dXJuIHZhbD09bnVtICYmIHZhbC50b1N0cmluZygpPT1udW0udG9TdHJpbmcoKTsgLy9jaGVjayB2YWx1ZXMgbWF0Y2gNCn0NCg0KLy9BZGQgYSBjaGFyYWN0ZXIgY291bnQgdG8gYSB0ZXh0YXJlYSBmaWVsZChQUEwwMTg5MzUpDQovLyBzdHJpbmcgICBzZWwgIDogaW4gO2pRdWVyeSBzZWxlY3RvciB0byBhcHBseSB0aGUgY291bnRlciB0bw0KLy8gbnVtZXJpYyAgbGltICA6IGluIDtjaGFyYWN0ZXIgbGltaXQNCmZ1bmN0aW9uIHNpdHNfY2hhcmFjdGVyX2NvdW50KHNlbCxsaW0pIHsNCiAgaWYoc2l0c19maWxlc19hcnJheVsiLi4vcGx1Z2lucy9qYXZhc2NyaXB0L2NoYXJjb3VudC9jaGFyY291bnQuanMiXT09IlkiKSB7IC8vYWxyZWFkeSBsb2FkZWQuLi4NCiAgICBzaXRzX2RvX2NoYXJhY3Rlcl9jb3VudChzZWwsbGltKTsgLy8uLi5zbyBjYWxsIHN0cmFpZ2h0IGF3YXkNCiAgfQ0KICBlbHNlIHsgLy9ub3QgbG9hZGVkIHlldC4uLg0KICAgIHZhciBwYXIgPSB7fTsgLy9jcmVhdGUgYW4gb2JqZWN0IG9mIHBhcmFtZXRlcnMNCiAgICBwYXIudXJsID0gIi4uL3BsdWdpbnMvamF2YXNjcmlwdC9jaGFyY291bnQvY2hhcmNvdW50LmpzIjsNCiAgICBwYXIuZm5jID0gc2l0c19kb19jaGFyYWN0ZXJfY291bnQ7DQogICAgcGFyLnAwMSA9IHNlbDsNCiAgICBwYXIucDAyID0gbGltOw0KICAgIHZhciBsZW4gPSBzaXRzX3BhcmFtX2FycmF5LnB1c2gocGFyKTsgLy9zYXZlIGZvciBsYXRlcg0KICAgIHNpdHNfaW5jbHVkZV9maWxlKCIuLi9wbHVnaW5zL2Nzcy9jaGFyY291bnQvY2hhcmNvdW50LmNzcyIsZnVuY3Rpb24oYm9vKSB7DQogICAgICBzaXRzX2luY2x1ZGVfZmlsZSgiLi4vcGx1Z2lucy9qYXZhc2NyaXB0L2NoYXJjb3VudC9jaGFyY291bnQuanMiKTsNCiAgICB9KTsNCiAgfQ0KICByZXR1cm4gdHJ1ZTsNCn0NCg0KLy9JbnRlcm5hbCBmdW5jdGlvbiB0byBhZGQgYSBjaGFyYWN0ZXIgY291bnQoUFBMMDE4OTM1KQ0KLy8gc3RyaW5nICAgc2VsICA6IGluIDtqUXVlcnkgc2VsZWN0b3IgdG8gYXBwbHkgdGhlIGNvdW50ZXIgdG8NCi8vIG51bWVyaWMgIGxpbSAgOiBpbiA7Y2hhcmFjdGVyIGxpbWl0DQpmdW5jdGlvbiBzaXRzX2RvX2NoYXJhY3Rlcl9jb3VudChzZWwsbGltKSB7DQogIGlmKCh0eXBlb2Yoc2VsKT09InN0cmluZyIgJiYgc2VsLmxlbmd0aD4wKSB8fCB0eXBlb2Yoc2VsKT09Im9iamVjdCIpIHsgLy9jaGVjayBmaXJzdCBwYXJhbWV0ZXINCiAgICBpZih0eXBlb2YobGltKT09Im51bWJlciIgJiYgbGltPjApIHsgLy9jaGVjayBzZWNvbmQgcGFyYW1ldGVyDQogICAgICAkKHNlbCkuY2hhckNvdW50KGxpbSk7IC8vc2hvdyBjaGFyYWN0ZXIgY291bnQNCiAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCiAgfQ0KICByZXR1cm4gZmFsc2U7DQp9DQoNCi8vQWRkIGEgem9vbSBidXR0b24gdG8gYSB0ZXh0YXJlYSBmaWVsZChQUEwwMTg5MzUpDQovLyBzdHJpbmcgICBzZWwgIDogaW4gO2pRdWVyeSBzZWxlY3RvciB0byBhcHBseSB0aGUgYnV0dG9uIHRvDQovLyBzdHJpbmcgICB2YWwgIDogaW4gO3ZhbHVlIG9mIHRoZSB6b29tIGJ1dHRvbihkZWZhdWx0cyB0byAiWm9vbSIpDQovLyBzdHJpbmcgICBib2sgIDogaW4gO3ZhbHVlIG9mIHRoZSBvayBidXR0b24oZGVmYXVsdHMgdG8gIk9rIikNCi8vIHN0cmluZyAgIGJjYSAgOiBpbiA7dmFsdWUgb2YgdGhlIGNhbmNlbCBidXR0b24oZGVmYXVsdHMgdG8gIkNhbmNlbCIpDQpmdW5jdGlvbiBzaXRzX3pvb21fZmllbGQoc2VsLHZhbCxib2ssYmNhKSB7DQogIGlmKHR5cGVvZihzZWwpIT0ic3RyaW5nIiB8fCBzZWw9PSIiKSB7IC8vY2hlY2sgc2VsZWN0b3INCiAgICBzZWwgPSAiaW5wdXRbdHlwZT10ZXh0XSwgdGV4dGFyZWEiOw0KICB9DQogIGlmKHR5cGVvZih2YWwpIT0ic3RyaW5nIikgeyAvL2NoZWNrICJ6b29tIiB2YWx1ZQ0KICAgIHZhbCA9IHNpdHNfd2lkZ2V0X2JwLnVpICYmIHNpdHNfd2lkZ2V0X2JwLnVpLnpvb21UZXh0IHx8ICJab29tIjsNCiAgfQ0KICBpZih0eXBlb2YoYm9rKSE9InN0cmluZyIpIHsgLy9jaGVjayAib2siIHZhbHVlDQogICAgYm9rID0gc2l0c193aWRnZXRfYnAudWkgJiYgc2l0c193aWRnZXRfYnAudWkuZGlhbG9nT2sgfHwgIk9rIjsNCiAgfQ0KICBpZih0eXBlb2YoYmNhKSE9InN0cmluZyIpIHsgLy9jaGVjayAiY2FuY2VsIiB2YWx1ZQ0KICAgIGJjYSA9IHNpdHNfd2lkZ2V0X2JwLnVpICYmIHNpdHNfd2lkZ2V0X2JwLnVpLmRpYWxvZ0NhbmNlbCB8fCAiQ2FuY2VsIjsNCiAgfQ0KICB2YXIgYm9vID0gZmFsc2U7DQogIHZhciBpbnAgPSAkKHNlbCk7IC8vZ2V0IGFsbCBmaWVsZHMgZm9yIHNlbGVjdG9yDQogIGlmKHNlbCE9ImlucHV0W3R5cGU9dGV4dF0sIHRleHRhcmVhIiAmJiBzZWwhPSJpbnB1dFt0eXBlPXRleHRdIiAmJiBzZWwhPSJ0ZXh0YXJlYSIpIHsNCiAgICBpbnAuZmlsdGVyKCJpbnB1dFt0eXBlPXRleHRdLCB0ZXh0YXJlYSIpOyAvL2ZpbHRlciBpbnB1dHMgYW5kIHRleHRhcmVhcyBvbmx5DQogIH0NCiAgaW5wLmVhY2goZnVuY3Rpb24oaSkgew0KICAgIHZhciBidG4gPSAkKCI8aW5wdXQgdHlwZT1cImJ1dHRvblwiIHZhbHVlPVwiIitzaXRzX2VzY2FwZV9hdHRyKHZhbCkrIlwiPiIpOyAvL2NyZWF0ZSBidXR0b24NCiAgICBidG4uY2xpY2soZnVuY3Rpb24oZSkgeyAvL2F0dGFjaCBjbGljayBldmVudA0KICAgICAgdmFyIGlucCA9ICQodGhpcykucHJldigpOyAvL2dldCBpbnB1dCBmaWVsZA0KICAgICAgdmFyIGJ0biA9IHt9Ow0KICAgICAgYnRuW2JjYV0gPSBmdW5jdGlvbigpIHsgLy9hZGQgImNhbmNlbCIgYnV0dG9uDQogICAgICAgIHNpdHNfZGlhbG9nX2Nsb3NlKHRydWUsInNpdHNfem9vbWRpYSIpOw0KICAgICAgfTsNCiAgICAgIGJ0bltib2tdID0gZnVuY3Rpb24oKSB7IC8vYWRkICJvayIgYnV0dG9uDQogICAgICAgIGlucC52YWwoJCgiI3NpdHNfem9vbWRpYSIpLmZpbmQoInRleHRhcmVhIikudmFsKCkpOyAvL2NvcHkgdmFsdWUgYmFjayB0byBmaWVsZA0KICAgICAgICBzaXRzX2RpYWxvZ19jbG9zZSh0cnVlLCJzaXRzX3pvb21kaWEiKTsNCiAgICAgIH07DQogICAgICB2YXIgYXR0ID0gIiI7DQogICAgICBpZihpbnAuaXMoIjpkaXNhYmxlZCxbcmVhZG9ubHldIikpIHsgLy9jaGVjayBlZGl0YWJpbGl0eQ0KICAgICAgICBhdHQgPSAiIGRpc2FibGVkPVwiZGlzYWJsZWRcIiI7DQogICAgICB9DQogICAgICB2YXIgY29uID0gIjxkaXYgc3R5bGU9XCJ3aWR0aDoxMDAlO3RleHQtYWxpZ246Y2VudGVyO21hcmdpbi10b3A6MTJweFwiPiI7DQogICAgICB2YXIgaGd0ID0gc2l0c19nZXRfaW50ZWdlcigoKHNpdHNfd2luZG93X3NpemUoKSkueSkqMC44KTsNCiAgICAgIGNvbiArPSAiPHRleHRhcmVhIHN0eWxlPVwid2lkdGg6MTAwJTtoZWlnaHQ6IitoZ3QrInB4XCIiK2F0dCsiPiIraW5wLnZhbCgpKyI8L3RleHRhcmVhPjwvZGl2PiI7DQogICAgICBzaXRzX2RpYWxvZyh0aGlzLnZhbHVlLGNvbixidG4sdHJ1ZSx0cnVlLHRydWUsMjAwMCwic2l0c196b29tZGlhIix0cnVlLDAuOCk7DQogICAgfSk7DQogICAgJCh0aGlzKS5hZnRlcihidG4pOyAvL2luc2VydCBidXR0b24gbmV4dCB0byBmaWVsZA0KICAgIGJvbyA9IHRydWU7DQogIH0pOw0KICByZXR1cm4gYm9vOyAvL3JldHVybiB3aGV0aGVyIGJ1dHRvbnMgd2VyZSBhZGRlZA0KfQ0KDQovL2ZpeCBhdHRyaWJ1dGUgc3RyaW5ncyB0byByZW1vdmUgcXVvdGVzDQovLyBzdHJpbmcgIG9yaWcgIDogaW4gO3RoZSBvcmlnaW5hbCBzdHJpbmcNCmZ1bmN0aW9uIHNpdHNfZXNjYXBlX2F0dHIob3JpZykgew0KICByZXR1cm4gc2l0c19yZXBsYWNlX2FsbChvcmlnLCciJywiJnF1b3Q7Iik7DQp9DQoNCi8vQWRkIGEgbXVsdGkgc2VsZWN0IGRyb3AgZG93biBhcyBhbiBpbnB1dCBmaWVsZChQUEwwMjI4MTEpDQovLyBzdHJpbmcgICBzZWwgIDogaW4gO2pRdWVyeSBzZWxlY3RvciB0byBhcHBseSB0aGUgbXVsdGlzZWxlY3QgcGlja2VyIHRvDQovLyBudW1lcmljICBpdG0gIDogaW4gO251bWJlciBvZiBpdGVtcyB0byBkaXNwbGF5LCBiZWZvcmUgYW1hbGdhbWF0aW9uIG9jdXJycyhkZWZhdWx0IGlzIDMpDQovLyBzdHJpbmcgIHR4dCAgOiBpbiA7dGV4dCB0byBkaXNwbGF5IGluIGhlYWRlcihkZWZhdWx0IGlzIFNlbGVjdCkNCi8vIGJvb2xlYW4gIGZpbCAgOiBpbiA7ZGlzcGxheSBmaWx0ZXIgYm94KGRlZmF1bHQgaXMgZmFsc2UpDQovLyBib29sZWFuICBtdWx0aSAgOiBpbiA7ZGlzcGxheSBmaWx0ZXIgYm94KGRlZmF1bHQgaXMgZmFsc2UpDQovLyBib29sZWFuIGRlcCA6IGluIDsgY29udHJvbHMgd2hldGhlciB0aGUgZmllbGQgaGFzIG90aGVycyBkZXBlbmRlbnQgb24gaXQoZGVmYXVsdCBpcyBmYWxzZSkNCi8vIGJvb2xlYW4gZGlzIDogaW4gOyBDb250cm9scyBpZiB0aGUgZmllbGQgaXMgZGlzYWJsZWQgb3Igbm90IChwcGwzMTE1OTUpDQpmdW5jdGlvbiBzaXRzX211bHRpc2VsZWN0KHNlbCxpdG0sdHh0LGZpbCxtdWx0aSxkZXAsZGlzKSB7DQogIHZhciBsb2MgPSBzaXRzX21pbmlmaWVkX3BhdGgoIi4uL3BsdWdpbnMvamF2YXNjcmlwdC9tdWx0aXNlbGVjdC8iLCJqcXVlcnkubXVsdGlzZWxlY3QuanMiLCJqcXVlcnkubXVsdGlzZWxlY3QubWluLmpzIik7DQogIGlmKHNpdHNfZmlsZXNfYXJyYXlbbG9jXT09IlkiKSB7IC8vYWxyZWFkeSBsb2FkZWQuLi4NCiAgICBzaXRzX2RvX211bHRpc2VsZWN0KHNlbCxpdG0sdHh0LGZpbCxtdWx0aSxkZXAsZGlzKTsgLy8uLi5zbyBjYWxsIHN0cmFpZ2h0IGF3YXkNCiAgfQ0KICBlbHNlIHsgLy9ub3QgbG9hZGVkIHlldC4uLg0KICAgIHZhciBwYXIgPSB7fTsgLy9jcmVhdGUgYW4gb2JqZWN0IG9mIHBhcmFtZXRlcnMNCiAgICBwYXIudXJsID0gbG9jDQogICAgcGFyLmZuYyA9IHNpdHNfZG9fbXVsdGlzZWxlY3Q7DQogICAgcGFyLnAwMSA9IHNlbDsNCiAgICBwYXIucDAyID0gaXRtOw0KICAgIHBhci5wMDMgPSB0eHQ7DQogICAgcGFyLnAwNCA9IGZpbDsNCiAgICBwYXIucDA1ID0gbXVsdGk7DQogICAgcGFyLnAwNiA9IGRlcDsNCglwYXIucDA3ID0gZGlzOw0KICAgIHZhciBsZW4gPSBzaXRzX3BhcmFtX2FycmF5LnB1c2gocGFyKTsgLy9zYXZlIGZvciBsYXRlcg0KICAgIHNpdHNfaW5jbHVkZV9maWxlKHNpdHNfbWluaWZpZWRfcGF0aCgiLi4vcGx1Z2lucy9qYXZhc2NyaXB0L211bHRpc2VsZWN0LyIsImpxdWVyeS5tdWx0aXNlbGVjdC5maWx0ZXIuanMiLCJqcXVlcnkubXVsdGlzZWxlY3QuZmlsdGVyLm1pbi5qcyIpLGZ1bmN0aW9uKGJvbykgew0KICAgICAgc2l0c19pbmNsdWRlX2ZpbGUoc2l0c19taW5pZmllZF9wYXRoKCIuLi9wbHVnaW5zL2phdmFzY3JpcHQvbXVsdGlzZWxlY3QvIiwianF1ZXJ5Lm11bHRpc2VsZWN0LmpzIiwianF1ZXJ5Lm11bHRpc2VsZWN0Lm1pbi5qcyIpLGZ1bmN0aW9uKGJvbykgew0KICAgICAgICBzaXRzX2luY2x1ZGVfZmlsZSgiLi4vcGx1Z2lucy9jc3MvbXVsdGlzZWxlY3QvanF1ZXJ5Lm11bHRpc2VsZWN0LmNzcyIsZnVuY3Rpb24oYm9vKSB7DQogICAgICAgICAgc2l0c19pbmNsdWRlX2ZpbGUoIi4uL3BsdWdpbnMvY3NzL211bHRpc2VsZWN0L2pxdWVyeS5tdWx0aXNlbGVjdC5maWx0ZXIuY3NzIik7DQogICAgICAgIH0pOw0KICAgICAgfSk7DQogICAgfSk7DQogIH0NCiAgcmV0dXJuIHRydWU7DQp9DQoNCi8vSW50ZXJuYWwgZnVuY3Rpb24gdG8gbXVsdGkgc2VsZWN0IGRyb3AgZG93biBhcyBhbiBpbnB1dCBmaWVsZChQUEwwMjI4MTEpDQovLyBzdHJpbmcgICBzZWwgIDogaW4gO2pRdWVyeSBzZWxlY3RvciB0byBhcHBseSB0aGUgbXVsdGlzZWxlY3QgcGlja2VyIHRvDQovLyBudW1lcmljICBpdG0gIDogaW4gO251bWJlciBvZiBpdGVtcyB0byBkaXNwbGF5LCBiZWZvcmUgYW1hbGdhbWF0aW9uIG9jdXJycyhkZWZhdWx0IGlzIDMpDQovLyBzdHJpbmcgIHR4dCAgOiBpbiA7dGV4dCB0byBkaXNwbGF5IGluIGhlYWRlcihkZWZhdWx0IGlzIFNlbGVjdCkNCi8vIGJvb2xlYW4gIGZpbCAgOiBpbiA7ZGlzcGxheSBmaWx0ZXIgYm94KGRlZmF1bHQgaXMgZmFsc2UpDQovLyBib29sZWFuICBtdWx0aSAgOiBpbiA7ZGlzcGxheSBmaWx0ZXIgYm94KGRlZmF1bHQgaXMgZmFsc2UpDQovLyBib29sZWFuIGRlcCA6IGluIDsgY29udHJvbHMgd2hldGhlciB0aGUgZmllbGQgaGFzIG90aGVycyBkZXBlbmRlbnQgb24gaXQoZGVmYXVsdCBpcyBmYWxzZSkNCi8vIGJvb2xlYW4gZGlzIDogaW4gOyBDb250cm9scyBpZiB0aGUgZmllbGQgaXMgZGlzYWJsZWQgb3Igbm90IChwcGwzMTE1OTUpDQpmdW5jdGlvbiBzaXRzX2RvX211bHRpc2VsZWN0KHNlbCxpdG0sdHh0LGZpbCxtdWx0aSxkZXAsZGlzKSB7DQogIGlmKCh0eXBlb2Yoc2VsKT09InN0cmluZyIgJiYgc2VsLmxlbmd0aD4wKSB8fCB0eXBlb2Yoc2VsKT09Im9iamVjdCIpIHsgLy9jaGVjayBmaXJzdCBwYXJhbWV0ZXINCiAgICBpZihpdG08MCB8fCBpdG0+MTApIHsNCiAgICAgIGl0bSA9IDM7IC8vZGVmYXVsdCB0aGUgbnVtZXJpYyBvZiBpdGVtcyB0byBkaXNwbGF5IG9wdGlvbg0KICAgIH0NCiAgICBpZih0eXBlb2YodHh0KSE9InN0cmluZyIgfHwgdHh0PT0iIikgew0KICAgICAgdHh0ID0gIlNlbGVjdCI7IC8vZGVmYXVsdCB0aGUgdGV4dA0KICAgIH0NCiAgICBpZihmaWwpIHsNCiAgICAgIGlmKG11bHRpKSB7DQogICAgICAgICQoc2VsKS5tdWx0aXNlbGVjdCh7DQogICAgICAgICAgc2VsZWN0ZWRMaXN0Oml0bSwgbm9uZVNlbGVjdGVkVGV4dDogdHh0LCBtdWx0aXBsZTogdHJ1ZSwNCiAgICAgICAgICBjcmVhdGU6IGZ1bmN0aW9uKGV2ZW50LCB1aSkgeyBzaXRzX211bHRpX2NyZWF0ZWQodGhpcyk7IH0gIC8vVXNlIG9mIG5ldyBjcmVhdGUgZXZlbnQgZnJvbSBKUXVlcnkgVXBncmFkZQ0KICAgICAgICB9KS5tdWx0aXNlbGVjdGZpbHRlcigpOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgJChzZWwpLm11bHRpc2VsZWN0KHsNCiAgICAgICAgICBzZWxlY3RlZExpc3Q6aXRtLCBub25lU2VsZWN0ZWRUZXh0OiB0eHQsIG11bHRpcGxlOiBmYWxzZSwNCiAgICAgICAgICBjcmVhdGU6IGZ1bmN0aW9uKGV2ZW50LCB1aSkgeyBzaXRzX211bHRpX2NyZWF0ZWQodGhpcyk7IH0gIC8vVXNlIG9mIG5ldyBjcmVhdGUgZXZlbnQgZnJvbSBKUXVlcnkgVXBncmFkZQ0KICAgICAgICB9KS5tdWx0aXNlbGVjdGZpbHRlcigpOw0KICAgICAgfQ0KICAgIH0NCiAgICBlbHNlIHsNCiAgICAgIGlmKG11bHRpKSB7DQogICAgICAgICQoc2VsKS5tdWx0aXNlbGVjdCh7DQogICAgICAgICAgc2VsZWN0ZWRMaXN0Oml0bSwgbm9uZVNlbGVjdGVkVGV4dDogdHh0LCBtdWx0aXBsZTogdHJ1ZSwNCiAgICAgICAgICBjcmVhdGU6IGZ1bmN0aW9uKGV2ZW50LCB1aSkgeyBzaXRzX211bHRpX2NyZWF0ZWQodGhpcyk7IH0gIC8vVXNlIG9mIG5ldyBjcmVhdGUgZXZlbnQgZnJvbSBKUXVlcnkgVXBncmFkZQ0KICAgICAgICB9KTsNCiAgICAgIH0gZWxzZSB7DQogICAgICAgICQoc2VsKS5tdWx0aXNlbGVjdCh7DQogICAgICAgICAgc2VsZWN0ZWRMaXN0Oml0bSwgbm9uZVNlbGVjdGVkVGV4dDogdHh0LCBtdWx0aXBsZTogZmFsc2UsDQogICAgICAgICAgY3JlYXRlOiBmdW5jdGlvbihldmVudCwgdWkpIHsgc2l0c19tdWx0aV9jcmVhdGVkKHRoaXMpOyB9ICAvL1VzZSBvZiBuZXcgY3JlYXRlIGV2ZW50IGZyb20gSlF1ZXJ5IFVwZ3JhZGUNCiAgICAgICAgfSk7DQogICAgICB9DQogICAgfQ0KDQogICAgaWYoZGVwKSB7DQogICAgICAkKHNlbCkuYmluZCgibXVsdGlzZWxlY3RjbG9zZSIsIGZ1bmN0aW9uKGV2ZW50LCB1aSkgeyBzaXRzX2dldF9hbmRfcG9zdF9maWVsZF92YWxzX3BvZF9tcyh0aGlzKTsgfSk7DQogICAgfQ0KDQoJaWYoZGlzKSB7DQoJICAkKHNlbCkubXVsdGlzZWxlY3QoImRpc2FibGUiKTsgLy9hYmlsaXR5IHRvIGRpc2FibGUgdGhlIGZpZWxkDQogICAgfQ0KDQogICAgJChzZWwpLmJpbmQoIm11bHRpc2VsZWN0dW5jaGVja2FsbCIsIGZ1bmN0aW9uKGV2ZW50LCB1aSkgeyBzaXRzX211bHRpX3VuY2hlY2tfYWxsKHRoaXMpOyB9KTsNCiAgICAkKHNlbCkuYmluZCgibXVsdGlzZWxlY3RjaGVja2FsbCIsIGZ1bmN0aW9uKGV2ZW50LCB1aSkgeyBzaXRzX211bHRpX2NoZWNrX2FsbCh0aGlzKTsgfSk7DQogIH0NCiAgcmV0dXJuIGZhbHNlOw0KfQ0KDQovL0ludGVybmFsIGZ1bmN0aW9uIHRvIGdldCB2YWx1ZXMgZnJvbSBzY3JlZW4oU0lXX1BPRF9NUykgYW5kIHBvc3QgYmFjayB0byB1c3AoUFBMMDIyODExLyBQUEwwMjU4OTMpDQpmdW5jdGlvbiBzaXRzX2dldF9hbmRfcG9zdF9maWVsZF92YWxzX3BvZF9tcyhvYmopIHsNCiAgICB2YXIgdlZhbHVlX2xpc3QgPSAiIjsNCiAgICB2YXIgdlZhbCA9ICIiOw0KICAgIHZhciB2V2hpcmx5SWQgPSAiIjsNCiAgICB2YXIgZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCJmb3JtIik7DQogICAgZm9yKHZhciBpPTA7IGk8ZS5lbGVtZW50cy5sZW5ndGg7IGkrKykgew0KICAgICAgaWYoZS5lbGVtZW50c1tpXS5pZCE9IiIpIHsNCiAgICAgIHZWYWwgPSBzaXRzX2dldF92YWx1ZShlLmVsZW1lbnRzW2ldLmlkKTsNCiAgICAgIGlmKGUuZWxlbWVudHNbaV0udHlwZT09ImNoZWNrYm94IikgeyAvLyBkZWZhdWx0IHRoZSBjZWhlY2sgYm94IHRvIEZhbHNlIGlzIG51bGwNCiAgICAgICAgaWYodlZhbD09IlkiKSB7DQogICAgICAgICAgdlZhbCA9ICJUcnVlIjsNCiAgICAgICAgfQ0KICAgICAgICBlbHNlIHsNCiAgICAgICAgICB2VmFsID0gIkZhbHNlIjsNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgICAgaWYodlZhbHVlX2xpc3Q9PSIiKSB7DQogICAgICAgIHZWYWx1ZV9saXN0ID0gZS5lbGVtZW50c1tpXS5pZCsiPSIrc2l0c19lc2NhcGVfdXJsKHZWYWwpOw0KICAgICAgfQ0KICAgICAgZWxzZSB7DQogICAgICAgIHZWYWx1ZV9saXN0ID0gdlZhbHVlX2xpc3QrIn4iK2UuZWxlbWVudHNbaV0uaWQrIj0iK3NpdHNfZXNjYXBlX3VybCh2VmFsKTsNCiAgICAgIH0NCiAgICB9DQogIH0NCiAgdldoaXJseUlkID0gb2JqLmlkKyItV2hpcmx5IjsNCiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQodldoaXJseUlkKS5zdHlsZS5kaXNwbGF5ID0gImlubGluZSI7DQogIHNpdHNfc2VuZF9xdWVyeSgiUE9TVCIsInNpd19wb2RfbXMuYW1lbmRQYXJhbXMiLHZWYWx1ZV9saXN0LGZhbHNlLCJzaXRzX3Byb2Nlc3NfcmVwb3J0X3BhcmFtcyIpOyAvL3NlbmQgZmllbGQgbGlzdCwgdGhlIHByb2Nlc3MgcmVzdWx0cw0KfQ0KDQovLyBGdW5jdGlvbiBjYWxsZWQgd2hlbiBBSkFYIHJlc3BvbnNlIHJldHVybnMgZnJvbSBTSVdfUE9EX01TDQpmdW5jdGlvbiBzaXRzX3Byb2Nlc3NfcmVwb3J0X3BhcmFtcyhyZXNwb25zZSkgew0KICB2YXIgcG9zID0gMDsNCiAgdmFyIGlkID0gIiI7DQogIHZhciB2YWwgPSAiIjsNCiAgdmFyIG9iaiA9ICIiOw0KICB2YXIgZSA9ICIiOw0KICB2YXIgdldoaXJseUlkID0gIiI7DQogIGlmKHJlc3BvbnNlLnN1YnN0cigwLDQpPT0iPE9LPiIpIHsNCiAgICBxdWVyeSA9IHJlc3BvbnNlLnN1YnN0cig0KTsNCglpZihxdWVyeSE9IiIpIHsNCiAgICAgIHZhciBhcnIgPSBxdWVyeS5zcGxpdCgifiIpOw0KICAgICAgZm9yKHZhciBpPTA7IGk8YXJyLmxlbmd0aDsgaSsrKSB7DQogICAgICAgIHBvcyA9IGFycltpXS5pbmRleE9mKCI9Iik7DQogICAgICAgIGlkID0gYXJyW2ldLnN1YnN0cmluZygwLCBwb3MpOw0KICAgICAgICB2YWwgPSBhcnJbaV0uc3Vic3RyaW5nKHBvcysxLCBhcnJbaV0ubGVuZ3RoKTsNCiAgICAgICAgZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTsNCiAgICAgICAgaWYoZS50eXBlPT0ic2VsZWN0LW9uZSIgfHwgZS50eXBlPT0ic2VsZWN0LW11bHRpcGxlIikgeyAvLyBvbmx5IHJlc2V0IG11bHRpLXNlbGVjdCB3aWRnZXRzDQogICAgICAgICAgJChlKS5odG1sKHZhbCk7DQogICAgICAgICAgb2JqID0gc2l0c19nZXRfb2JqZWN0KGlkKTsNCiAgICAgICAgICAkKG9iaikubXVsdGlzZWxlY3QoInJlZnJlc2giKTsNCiAgICAgICAgICB2V2hpcmx5SWQgPSBlLmlkKyItV2hpcmx5IjsNCiAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCh2V2hpcmx5SWQpLnN0eWxlLmRpc3BsYXkgPSAibm9uZSI7DQogICAgICAgIH0NCgkJaWYoZS50eXBlPT0idGV4dCIpDQoJCXsNCiAgICAgICAgICB2V2hpcmx5SWQgPSBlLmlkKyItV2hpcmx5IjsNCiAgICAgICAgICB2YXIgdldoaXJseSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKHZXaGlybHlJZCk7DQogICAgICAgICAgaWYodldoaXJseSkgew0KICAgICAgICAgICAgdldoaXJseS5zdHlsZS5kaXNwbGF5ID0gIm5vbmUiOw0KICAgICAgICAgIH0NCgkJfQ0KICAgICAgfQ0KICAgIH0NCiAgfQ0KICBlbHNlIHsNCiAgICBpZihyZXNwb25zZS5zdWJzdHIoMCw0KT09IjxOTz4iKSB7DQogICAgICBhbGVydChyZXNwb25zZS5zdWJzdHIoNCkpOw0KICAgIH0NCiAgICBlbHNlIHsNCiAgICAgIGlmKHJlc3BvbnNlIT0iIikgew0KICAgICAgICBhbGVydCgiRm9yIHNlY3VyaXR5IHJlYXNvbnMsIHlvdSBoYXZlIGJlZW4gYXV0b21hdGljYWxseSBsb2dnZWQgb3V0IG9mIHRoZSBzeXN0ZW0sIHBsZWFzZSByZS1sb2dpbi4iKTsgLy8gZXJyb3IgZGVjcnlwdGluZyBOS0VZDQogICAgICB9DQogICAgfQ0KICB9DQogIHNpdHNfbXVsdGlfc3RhdGUoKTsNCn0NCg0KLy8gRnVuY3Rpb24gdG8gZml4IHVuY2hlY2sgYWxsIGZ1bmN0aW9uIG9uIG11bHRpc2VsZWN0IHdpZGdldHMgLSB3YXMgcHJldmlvdXNseSB0b2dnbGluZw0KZnVuY3Rpb24gc2l0c19tdWx0aV91bmNoZWNrX2FsbChvYmopIHsNCiAgdmFyIGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChvYmouaWQpOw0KICBmb3IodmFyIGk9MDtpPGUub3B0aW9ucy5sZW5ndGg7aSsrKSB7DQogICAgZS5vcHRpb25zW2ldLnNlbGVjdGVkID0gZmFsc2U7DQogIH0NCiAgJChvYmopLm11bHRpc2VsZWN0KCJyZWZyZXNoIik7DQp9DQoNCi8vIEZ1bmN0aW9uIHRvIGZpeCBjaGVjayBhbGwgZnVuY3Rpb24gb24gbXVsdGlzZWxlY3Qgd2lkZ2V0cyAtIHdhcyBwcmV2aW91c2x5IHRvZ2dsaW5nDQpmdW5jdGlvbiBzaXRzX211bHRpX2NoZWNrX2FsbChvYmopIHsNCiAgdmFyIGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChvYmouaWQpOw0KICBmb3IodmFyIGk9MDtpPGUub3B0aW9ucy5sZW5ndGg7aSsrKSB7DQogICAgZS5vcHRpb25zW2ldLnNlbGVjdGVkID0gdHJ1ZTsNCiAgfQ0KICAkKG9iaikubXVsdGlzZWxlY3QoInJlZnJlc2giKTsNCn0NCg0KLy8gRnVuY3Rpb24gZm9yIGluaXRpYWxpc2luZyBtdWx0aS1zZWxlY3Qgc3RhdGUNCmZ1bmN0aW9uIHNpdHNfbXVsdGlfY3JlYXRlZChvYmopIHsNCiAgdmFyIGUgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChvYmouaWQpOw0KICBpZihlLm9wdGlvbnMubGVuZ3RoPT0wKSB7DQogICAgJChlKS5tdWx0aXNlbGVjdCgiZGlzYWJsZSIpOw0KICB9IGVsc2Ugew0KICAgICQoZSkubXVsdGlzZWxlY3QoImVuYWJsZSIpOw0KICB9DQp9DQoNCi8vIEZ1bmN0aW9uIHRvIGVuYWJsZS9kaXNhYmxlIG11bHRpLXNlbGVjdHMgYmFzZWQgb24gd2hldGhlciB0aGV5IGhhdmUgb3B0aW9ucyBhdmFpbGFibGUNCmZ1bmN0aW9uIHNpdHNfbXVsdGlfc3RhdGUoKSB7DQogIHZhciBlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoImZvcm0iKTsNCiAgZm9yKHZhciBpPTA7IGk8ZS5lbGVtZW50cy5sZW5ndGg7IGkrKykgew0KICAgIGlmKGUuZWxlbWVudHNbaV0uaWQhPSIiICYmIGUuZWxlbWVudHNbaV0uaWQhPSJSRVBPUlRfTElTVC5EVU1NWS5NRU5TWVMiKSB7DQogICAgICBpZihlLmVsZW1lbnRzW2ldLnR5cGU9PSJzZWxlY3Qtb25lIiB8fCBlLmVsZW1lbnRzW2ldLnR5cGU9PSJzZWxlY3QtbXVsdGlwbGUiKSB7IC8vIG9ubHkgcmVzZXQgbXVsdGktc2VsZWN0IHdpZGdldHMNCiAgICAgICAgaWYoZS5lbGVtZW50c1tpXS5vcHRpb25zLmxlbmd0aD09MCkgew0KICAgICAgICAgICQoZS5lbGVtZW50c1tpXSkubXVsdGlzZWxlY3QoImRpc2FibGUiKTsNCiAgICAgICAgfQ0KICAgICAgICBlbHNlIHsNCiAgICAgICAgICAkKGUuZWxlbWVudHNbaV0pLm11bHRpc2VsZWN0KCJlbmFibGUiKTsNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgIH0NCiAgfQ0KfQ0KDQovLyBodHRwOi8vd3d3LmlldGYub3JnL3JmYy9yZmM0MTIyLnR4dA0KZnVuY3Rpb24gc2l0c191dWlkKCkgew0KICB2YXIgcyA9IFtdOw0KICB2YXIgaGV4RGlnaXRzID0gIjAxMjM0NTY3ODlhYmNkZWYiOw0KICBmb3IodmFyIGk9MDtpPDM2O2krKykgew0KICAgIHNbaV0gPSBoZXhEaWdpdHMuc3Vic3RyKE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDB4MTApLDEpOw0KICB9DQogIHNbMTRdID0gIjQiOyAgLy8gYml0cyAxMi0xNSBvZiB0aGUgdGltZV9oaV9hbmRfdmVyc2lvbiBmaWVsZCB0byAwMDEwDQogIHNbMTldID0gaGV4RGlnaXRzLnN1YnN0cigoc1sxOV0gJiAweDMpIHwgMHg4LCAxKTsgIC8vIGJpdHMgNi03IG9mIHRoZSBjbG9ja19zZXFfaGlfYW5kX3Jlc2VydmVkIHRvIDAxDQogIHNbOF0gPSBzWzEzXSA9IHNbMThdID0gc1syM10gPSAiLSI7DQogIHJldHVybiBzLmpvaW4oIiIpOw0KfQ0KDQovL1JldHVybnMgdGhlIGZ1bGwgZmlsZXBhdGggb2YgdGhlIG1pbmlmaWVkIG9yIG5vbi1taW5pZmllZCBmaWxlDQpmdW5jdGlvbiBzaXRzX21pbmlmaWVkX3BhdGgoZmlsZXBhdGgsdW5taW5pZmllZCxtaW5maWxlZCkgew0KICBpZihzaXRzX3VzZV9taW5pZmllZCkgew0KICAgIHJldHVybiBmaWxlcGF0aCttaW5maWxlZDsNCiAgfQ0KICBlbHNlIHsNCiAgICByZXR1cm4gZmlsZXBhdGgrdW5taW5pZmllZDsNCiAgfQ0KfQ0KDQovL0NvbnZlcnQgYW4gZW1wdHkgZGl2IGludG8gYSB0aW1ldGFibGUgd2lkZ2V0DQovLyBzdHJpbmcgICAgaWQgICAgICAgICA6IGluIDtpZCBvZiB0aGUgdGFibGUgb2JqZWN0DQovLyBzdHJpbmcgICAgYWN0aW9uICAgIDogaW4gO2FjdGlvbiBmb3IgdGltZXRhYmxlDQovLyBvYmplY3QgICAgb3B0aW9ucyAgICA6IGluIDtvcHRpb25zIGZvciB0aW1ldGFibGUgc2V0dXANCi8vIG9iamVjdCAgICBldmVudGRhdGEgIDogaW4gO1RoZSBldmVudCBkYXRhDQpmdW5jdGlvbiBzaXRzX3RpbWV0YWJsZV93aWRnZXQoaWQsYWN0aW9uLG9wdHMsZWRhdCkgew0KICB2YXIgbG9jID0gc2l0c19taW5pZmllZF9wYXRoKCIuLi9wbHVnaW5zL2phdmFzY3JpcHQvc2l0c2pxdGltZXRhYmxlLyIsInNpdHNqcXRpbWV0YWJsZS5qcyIsInNpdHNqcXRpbWV0YWJsZS5taW4uanMiKTsNCiAgaWYoc2l0c19maWxlc19hcnJheVtsb2NdPT0iWSIpIHsgLy9hbHJlYWR5IGxvYWRlZC4uLg0KICAgIHNpdHNfZG9fdGltZXRhYmxlX3dpZGdldDEoaWQsYWN0aW9uLG9wdHMsZWRhdCk7IC8vLi4uc28gY2FsbCBzdHJhaWdodCBhd2F5DQogIH0NCiAgZWxzZSB7IC8vbm90IGxvYWRlZCB5ZXQNCiAgICB2YXIgcGFyID0ge307IC8vY3JlYXRlIGFuIG9iamVjdCBvZiBwYXJhbWV0ZXJzDQogICAgcGFyLnVybCA9IGxvYzsNCiAgICBwYXIuZm5jID0gc2l0c19kb190aW1ldGFibGVfd2lkZ2V0MTsNCiAgICBwYXIucDAxID0gaWQ7DQoJCXBhci5wMDIgPSBhY3Rpb247DQogICAgcGFyLnAwMyA9IG9wdHM7DQogICAgcGFyLnAwNCA9IGVkYXQ7DQogICAgdmFyIGxlbiA9IHNpdHNfcGFyYW1fYXJyYXkucHVzaChwYXIpOyAvL3NhdmUgZm9yIGxhdGVyDQogICAgc2l0c19pbmNsdWRlX2ZpbGUoIi4uL3BsdWdpbnMvY3NzL3NpdHNqcXRpbWV0YWJsZS9jc3Mvc2l0c2pxdGltZXRhYmxlLmNzcyIsZnVuY3Rpb24oYm9vKSB7DQogICAgICBzaXRzX2luY2x1ZGVfZmlsZSgiLi4vamF2YXNjcmlwdC9kbXhfdG9vbHRpcC5qcyIsZnVuY3Rpb24oYm9vKSB7DQogICAgICAgIHNpdHNfaW5jbHVkZV9maWxlKHNpdHNfbWluaWZpZWRfcGF0aCgiLi4vcGx1Z2lucy9qYXZhc2NyaXB0L3NpdHNqcXRpbWV0YWJsZS8iLCJqcXVlcnkuYmEtcmVzaXplLmpzIiwianF1ZXJ5LmJhLXJlc2l6ZS5taW4uanMiKSxmdW5jdGlvbihib28pIHsNCiAgICAgICAgICBzaXRzX2luY2x1ZGVfZmlsZShzaXRzX21pbmlmaWVkX3BhdGgoIi4uL3BsdWdpbnMvamF2YXNjcmlwdC9zaXRzanF0aW1ldGFibGUvIiwic2l0c2pxdGltZXRhYmxlLmpzIiwic2l0c2pxdGltZXRhYmxlLm1pbi5qcyIpKTsNCiAgICAgICAgfSk7DQogICAgICB9KTsNCiAgICB9KTsNCiAgfQ0KICByZXR1cm4gdHJ1ZTsNCn0NCg0KLy9JbnRlcm5hbCBmdW5jdGlvbiB0byBhZGQgdGltZXRhYmxlIHdpZGdldA0KLy8gc3RyaW5nICAgIGlkICAgICAgICAgOiBpbiA7aWQgb2YgdGhlIHRhYmxlIG9iamVjdA0KLy8gc3RyaW5nICAgIGFjdGlvbiAgICA6IGluIDthY3Rpb24gZm9yIHRpbWV0YWJsZQ0KLy8gb2JqZWN0ICAgIG9wdGlvbnMgICAgOiBpbiA7b3B0aW9ucyBmb3IgdGltZXRhYmxlIHNldHVwDQovLyBvYmplY3QgICAgZXZlbnRkYXRhICA6IGluIDtUaGUgZXZlbnQgZGF0YQ0KZnVuY3Rpb24gc2l0c19kb190aW1ldGFibGVfd2lkZ2V0MShpZCxhY3Rpb24sb3B0cyxlZGF0KSB7DQogIGlmKHR5cGVvZihpZCk9PSJzdHJpbmciICYmIGlkLmxlbmd0aD4wKSB7IC8vY2hlY2sgZmlyc3QgcGFyYW1ldGVyDQogICAgJChpZCkuc2l0c2pxdGltZXRhYmxlKGFjdGlvbixvcHRzLGVkYXQpOw0KICAgIHJldHVybiB0cnVlOw0KICB9DQogIHJldHVybiBmYWxzZTsNCn0NCg0KLy8gQ2hlY2sgaWYgdGhlIGN1cnJlbnQgYnJvd3NlciBpcyBJRSBhbmQgdGhhdCBpdHMgYSBzdXBwb3J0ZWQgdmVyc2lvbiwgcmV0dXJuIHZhbHVlcyBhcmU6DQovLyBVTlNVUFBPUlRFRF9JRSAtIElFIHZlcnNpb24gNyBvciBsb3dlcg0KLy8gSUVfOCAtIElFIHZlcnNpb24gOA0KLy8gSUUgLSBJRSB2ZXJzaW9uIDkgb3IgZ3JlYXRlcg0KLy8gTk9UX0lFIC0gTm90IGFuIElFIGJyb3dzZXINCmZ1bmN0aW9uIHNpdHNfaWVfc3VwcG9ydGVkKCkgew0KICAvL09uY2Ugd2UgZHJvcCBJRTggd2UgY2FuIGp1c3QgY2hlY2sgdG8gc2VlIGlmIGRvY3VtZW50LmhlYWQgZXhpc3RzDQoJLy9Pbmx5IG91ciBzdXBwb3J0ZWQgYnJvd3NlcnMgKHdpdGggSUU4IHRoZSBleGNlcHRpb24pIHN1cHBvcnQgZG9jdW1lbnQuaGVhZA0KICBpZihzaXRzX2llX3ZlcnNpb24pIHsNCiAgICByZXR1cm4gc2l0c19pZV92ZXJzaW9uOyAvL2NhY2hlZCBmcm9tIGZpcnN0IHJ1bmZuYw0KICB9DQoNCgl2YXIgaWV2ZXJzaW9uID0gMzsNCgl2YXIgZGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7DQoJdmFyIGFsbCA9IGRpdi5nZXRFbGVtZW50c0J5VGFnTmFtZSgnaScpOw0KDQoJLy9UcnkgY29uZGl0aW9uYWwgc3RhdGVtZW50cyB0byB3b3JrIG91dCBpZSB2ZXJzaW9uIChvbmx5IHdvcmtzIHVwIHRvIGFuZCBpbmNsdWRpbmcgSUUgOSkNCgl3aGlsZShkaXYuaW5uZXJIVE1MID0gIjwhLS1baWYgZ3QgSUUgIisoKytpZXZlcnNpb24pKyJdPjxpPjwvaT48IVtlbmRpZl0tLT4iLCBhbGxbMF0pIHt9Ow0KDQoJLy9JZiB0aGUgdmVyc2lvbiBpcyBJRTcgb3IgbGVzcywgaXRzIHVuc3VwcG9ydGVkDQoJaWYoaWV2ZXJzaW9uPjQgJiYgaWV2ZXJzaW9uIDw9IDcpIHsNCgkJc2l0c19pZV92ZXJzaW9uID0gIklFX1VOU1VQUE9SVEVEIjsNCiAgICByZXR1cm4gc2l0c19pZV92ZXJzaW9uOw0KCX0NCiAgZWxzZSBpZihpZXZlcnNpb249PTgpIHsgLy9vciB0aGUgdmVyc2lvbiBpcyBJRTggd2hpY2ggaXMgc3VwcG9ydGVkIGJ1dCBoYXMgcXVpcmtzIQ0KCSAgc2l0c19pZV92ZXJzaW9uID0gIklFXzgiOw0KICAgIHJldHVybiBzaXRzX2llX3ZlcnNpb247DQoJfQ0KCS8vRWxzZSBtdXN0IGJlIHN1cHBvcnRlZCBidXQgbWFrZSBzdXJlIHRoaXMgaXMgYXQgbGVhc3QgYW4gSUUgYnJvd3Nlcg0KCWlmKHdpbmRvdy5BY3RpdmVYT2JqZWN0IHx8ICJBY3RpdmVYT2JqZWN0IiBpbiB3aW5kb3cpIHsNCgkJc2l0c19pZV92ZXJzaW9uID0gIklFIjsNCiAgICByZXR1cm4gc2l0c19pZV92ZXJzaW9uOw0KCX0NCglzaXRzX2llX3ZlcnNpb24gPSAiTk9UX0lFIjsNCiAgcmV0dXJuIHNpdHNfaWVfdmVyc2lvbjsNCn0NCg0KLy8gU3RhcnQgdGhlIEpRdWVyeSB0b29sdGlwIHVwDQovLyBzdHJpbmcgICBzZWwgIDogaW4gO2pRdWVyeSBzZWxlY3RvciB0byBhcHBseSB0aGUgdG9vbHRpcCB0bw0KLy8gc3RyaW5nCQljb250IDogaW4JO0NvbnRlbnQgb2YgdGhlIHRvb2x0aXAoQkxBTksgdG8gZGVzdHJveSkNCmZ1bmN0aW9uIHNpdHNfdG9vbHRpcChzZWwsY29udCkgew0KICBpZigodHlwZW9mKHNlbCk9PSJzdHJpbmciICYmIHNlbC5sZW5ndGg+MCkgfHwgdHlwZW9mKHNlbCk9PSJvYmplY3QiKSB7IC8vY2hlY2sgZmlyc3QgcGFyYW1ldGVyDQoJICBpZihjb250PT0iIikgew0KCQkgICQoc2VsKS5maWx0ZXIoIi5zdi10b29sdGlwLWZpbHRlciIpLnRvb2x0aXAoImRlc3Ryb3kiKTsNCgkJfQ0KICAgIGVsc2Ugew0KCQkJJChzZWwpLmZpbHRlcigiOm5vdCguc3YtZGlzYWJsZWQsW2Rpc2FibGVkXSxbcmVhZG9ubHldKSIpLnRvb2x0aXAoew0KICAgICAgICBpdGVtczogIjpub3QoLnN2LWRpc2FibGVkLFtkaXNhYmxlZF0sW3JlYWRvbmx5XSkiLCAvL2Rpc2FibGVkIGVsZW1lbnRzIGhhdmUgaW5jb25zaXN0ZW50IGJlaGF2aW9yIGFjcm9zcyBicm93c2VycygjODY2MSkNCgkJCQl0cmFjazogdHJ1ZSwNCgkJCQlzaG93OiB7ZGVsYXk6NTAwfSwgLy9zaXRzX2FuaW1fc3BlZWQgbWFrZXMgdGhlIHRvb2x0aXAgYXBwZWFyIHRvbyBmYXN0DQoJCQkJaGlkZTogc2l0c19hbmltX3NwZWVkLA0KCQkJCXRvb2x0aXBDbGFzczogInN2LXRvb2x0aXAiLA0KCQkJCWNvbnRlbnQ6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICQoImRpdi51aS10b29sdGlwIikuZWFjaChmdW5jdGlvbihpKSB7IC8vbGluZ2VyaW5nIHRvb2x0aXBzDQogICAgICAgICAgICB2YXIgdGlkID0gJCh0aGlzKS5hdHRyKCJpZCIpOyAvL2dldCB0b29sdGlwIGlkDQogICAgICAgICAgICB2YXIgZWxlID0gJCgiW2FyaWEtZGVzY3JpYmVkYnk9Iit0aWQrIl0iKTsgLy9nZXQgcmVsYXRlZCBlbGVtZW50DQogICAgICAgICAgICBpZihlbGUuZGF0YSgidWktdG9vbHRpcCIpKSB7DQogICAgICAgICAgICAgIGVsZS50b29sdGlwKCJjbG9zZSIpOyAvL2Nsb3NlIHRvb2x0aXANCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9KTsNCiAgICAgICAgICByZXR1cm4gY29udDsNCiAgICAgICAgfQ0KCQkJfSkuYWRkQ2xhc3MoInN2LXRvb2x0aXAtZmlsdGVyIik7DQogICAgfQ0KCX0NCiAgcmV0dXJuIHRydWU7DQp9DQoNCi8vQ3JlYXRlIGFuIGFic29sdXRlIFVSTCB0byB0aGUgc3BlY2lmaWVkIHByb2dyYW0NCi8vIHN0cmluZyBwcmFjIDogaW4gO3RoZSBwcm9ncmFtIHRvIGxpbmsgdG8NCmZ1bmN0aW9uIHNpdHNfYnVpbGRfdXJsKHByYWMpIHsNCiAgdmFyIHVybCA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmOw0KICBpZih0eXBlb2YocHJhYykhPSJzdHJpbmciKSB7IC8vcHJhYyBub3Qgc3BlY2lmaWVkDQogICAgcmV0dXJuIHVybDsNCiAgfQ0KICB2YXIgcXVlcyA9IHVybC5pbmRleE9mKCI/Iik7IC8vcmVtb3ZlIHF1ZXJ5IHN0cmluZw0KICBpZihxdWVzPi0xKSB7DQogICAgdXJsID0gdXJsLnN1YnN0cmluZygwLHF1ZXMpOw0KICB9DQogIGlmKHVybC5jaGFyQXQodXJsLmxlbmd0aC0xKT09Ii8iKSB7IC8vaWYgbGFzdCBjaGFyYWN0ZXIgaXMgc2xhc2ggcmVtb3ZlDQogICAgdXJsLnNsaWNlKDAsLTEpOw0KICB9DQogIHZhciBsYXN0c2xhc2ggPSB1cmwubGFzdEluZGV4T2YoIi8iKTsgLy9yZW1vdmUgY2hhcnMgYWZ0ZXIgbGFzdCBzbGFzaCAtIHRoZSBwcmV2aW91cyBwcm9ncmFtIG5hbWUNCiAgaWYobGFzdHNsYXNoPi0xKSB7DQogICAgdXJsID0gdXJsLnN1YnN0cmluZygwLGxhc3RzbGFzaCk7DQogIH0NCiAgcmV0dXJuIHVybCsiLyIrcHJhYzsNCn0NCg0KLy9Db252ZXJ0IGEgdGFibGUgZWxlbWVudCBpbnRvIGEgZGF0YXRhYmxlcyB3aWRnZXQoUFBMMDMzNDEzKQ0KLy8gc3RyaW5nICAgc2VsIDogaW4gO2pRdWVyeSBzZWxlY3RvciB0byBhcHBseSB0aGUgZGF0YXRhYmxlcyB3aWRnZXQgdG8NCi8vIG9iamVjdCAgIG9wdCA6IGluIDtvYmplY3QgY29udGFpbmluZyBvcHRpb25zIGZvciBkYXRhdGFibGVzIHdpZGdldA0KLy8gc3RyaW5nICAgcGFyY3NzZmlsZSA6IGluIDtzdHJpbmcgY29udGFpbmluZyBjc3MgZmlsZSBuYW1lLCBtdXN0IGJlIGluIHRoZSAgLi4vcGx1Z2lucy9jc3MvZGF0YXRhYmxlcy9jc3MvIHBhdGgNCmZ1bmN0aW9uIHNpdHNfZGF0YXRhYmxlc193aWRnZXQoc2VsLG9wdCxwYXJjc3NmaWxlKSB7DQogIHZhciBsb2MgPSAiLi4vcGx1Z2lucy9qYXZhc2NyaXB0L2RhdGF0YWJsZXMvbWVkaWEvanMvanF1ZXJ5LmRhdGFUYWJsZXMubWluLmpzIjsNCiAgaWYodHlwZW9mICQuZm4uRGF0YVRhYmxlPT09ImZ1bmN0aW9uIikgeyAvL2FscmVhZHkgbG9hZGVkLi4uDQogICAgc2l0c19kb19kYXRhdGFibGVzX3dpZGdldChzZWwsb3B0KTsgLy8uLi5zbyBjYWxsIHN0cmFpZ2h0IGF3YXkNCiAgfQ0KICBlbHNlIHsgLy9ub3QgbG9hZGVkIHlldC4uLg0KICAgIHZhciBwYXIgPSB7fTsgLy9jcmVhdGUgYW4gb2JqZWN0IG9mIHBhcmFtZXRlcnMNCiAgICBwYXIudXJsID0gbG9jOw0KICAgIHBhci5mbmMgPSBzaXRzX2RvX2RhdGF0YWJsZXNfd2lkZ2V0Ow0KICAgIHBhci5wMDEgPSBzZWw7DQogICAgcGFyLnAwMiA9IG9wdDsNCiAgICB2YXIgbGVuID0gc2l0c19wYXJhbV9hcnJheS5wdXNoKHBhcik7IC8vc2F2ZSBmb3IgbGF0ZXINCiAgICBpZihwYXJjc3NmaWxlIT0iIikgew0KICAgICAgc2l0c19pbmNsdWRlX2ZpbGUoIi4uL3BsdWdpbnMvY3NzL2RhdGF0YWJsZXMvY3NzLyIrcGFyY3NzZmlsZSk7DQogICAgfQ0KICAgIHNpdHNfaW5jbHVkZV9maWxlKGxvYyk7DQogIH0NCiAgcmV0dXJuIHRydWU7DQp9DQoNCi8vR2V0IGRhdGF0YWJsZSBwYXJhbWV0ZXJzIGJhc2VkIG9uIEhUTUw1IGRhdGEgYXR0cmlidXRlcyBhbmQgYW4gb2JqZWN0IHBhcmFtZXRlcg0KLy9vYmplY3Qgb2JqIDogaW4gO0RPTSBlbGVtZW50IG9yIGpRdWVyeSBvYmplY3QgcmVwcmVzZW50aW5nIHRoZSB0YWJsZSB0byBnZXQgcGFyYW1ldGVycyBmb3INCi8vb2JqZWN0IG9wdCA6IGluIDsob3B0aW9uYWwpIG9iamVjdCBjb250YWluaW5nIG9wdGlvbnMgZm9yIHRoaXMgZGF0YXRhYmxlDQovL29iamVjdCBkdF9icmVha3BvaW50cyA6aW47KG9wdGlvbmFsKSBhbnkgYnJlYWtwb2ludHMgdG8gdXNlIHdpdGggcmVzcG9uc2l2ZSBwbHVnaW4oZGVmYXVsdGVkIGZyb20gc2l0c19nZXRfZHRfYnJlYWtwb2ludHMgaWYgbm90IHBhc3NlZCBpbikNCmZ1bmN0aW9uIHNpdHNfZGF0YXRhYmxlX3BhcmFtcyhvYmosb3B0LGR0X2JyZWFrcG9pbnRzKSB7DQoJaWYodHlwZW9mIG9iaiE9PSJvYmplY3QiKSByZXR1cm4gb3B0Ow0KDQoJaWYodHlwZW9mIG9wdCE9PSJvYmplY3QiKSBvcHQgPSB7fTsNCglpZih0eXBlb2YgZHRfYnJlYWtwb2ludHMhPT0ib2JqZWN0IikgZHRfYnJlYWtwb2ludHMgPSBzaXRzX2dldF9kdF9icmVha3BvaW50cygpOw0KDQoJLy9qUXVlcnkgVUkgc3R5bGluZyBpbnRlcmZlcmVzIHdpdGggQm9vdHN0cmFwIHN0eWxpbmcsIHNvIGRpc2FibGUgaXQoaXQgd2lsbCBiZSBkZXByZWNhdGVkIGJ5IHRoZSBwbHVnaW4gaW4gMS4xMSBhbnl3YXkpDQoJaWYob3B0LmpRdWVyeVVJPT09dHJ1ZSkgZGVsZXRlIG9wdC5qUXVlcnlVSTsNCgllbHNlIGlmKG9wdC5iSlF1ZXJ5VUk9PT10cnVlKSBkZWxldGUgb3B0LmJKUXVlcnlVSTsNCg0KCW9iaiA9ICQob2JqKTsgLy9lbnN1cmUgaXQgaXMgYSBqUXVlcnkgb2JqZWN0DQoJaWYob2JqLmxlbmd0aCE9PTEpIHJldHVybiBvcHQ7DQoNCgkvL21lcmdlIGFueSBIVE1MNSBkYXRhIGF0dHJpYnV0ZXMgb24gdGhlIHRhYmxlIHdpdGggYm90aCBvcHRpb25zIHBhc3NlZCBpbiBhbmQgYW55IGRlZmF1bHRzDQoJaWYodHlwZW9mIG9wdC5yZXNwb25zaXZlPT09InVuZGVmaW5lZCIpIG9wdC5yZXNwb25zaXZlID0oIXNpdHNfZGF0YXRhYmxlX3Jlc3BvbnNpdmV8fG9iai5kYXRhKCJzdi1kdC1yZXNwb25zaXZlIik9PT0iTiIpP2ZhbHNlOnsiYnJlYWtwb2ludHMiOiBkdF9icmVha3BvaW50c307IC8vc2l0c19kYXRhdGFibGVfcmVzcG9uc2l2ZSBzZXR0aW5nIGNvbnRyb2xzIGRlZmF1bHQNCgllbHNlIGlmKG9wdC5yZXNwb25zaXZlPT09dHJ1ZSkgb3B0LnJlc3BvbnNpdmUgPSB7ImJyZWFrcG9pbnRzIjogZHRfYnJlYWtwb2ludHN9OyAvL3JlcGxhY2Ugd2l0aCBrbm93biBicmVha3BvaW50cyhzbyB3ZSBvdmVycmlkZSBEVCBkZWZhdWx0cykNCg0KCWlmKG9wdC5yZXNwb25zaXZlIT09ZmFsc2UpIHsgLy9zY3JvbGxZIG9wdGlvbiBkb2Vzbid0IHdvcmsgd2l0aCByZXNwb25zaXZlLCBzbyBkaXNhYmxlIGl0DQoJCWlmKHR5cGVvZiBvcHQuc2Nyb2xsWSE9PSJ1bmRlZmluZWQiKSBkZWxldGUgb3B0LnNjcm9sbFk7DQoJCWVsc2UgaWYodHlwZW9mIG9wdC5zU2Nyb2xsWSE9PSJ1bmRlZmluZWQiKSBkZWxldGUgb3B0LnNTY3JvbGxZOw0KDQoJCS8vd2UgYWxzbyBuZWVkIHRvIHdvcmsgdGhyb3VnaCB0aGUgY29sdW1uIHNldHRpbmdzIGFuZCBwcm9jZXNzIGFueSB0aGF0IGFyZSBub3Qgc3VwcG9zZWQgdG8gYmUgdmlzaWJsZShhcyBiVmlzaWJsZSBpcyBvdmVycmlkZGVuIGJ5IHJlc3BvbnNpdmUpDQoJCXZhciBjb2xPYmogPSh0eXBlb2Ygb3B0LmNvbHVtbkRlZnM9PT0ib2JqZWN0Iik/b3B0LmNvbHVtbkRlZnM6b3B0LmNvbHVtbnM7DQoJCWlmKHR5cGVvZiBjb2xPYmohPT0ib2JqZWN0Iikgew0KCQkJY29sT2JqID0odHlwZW9mIG9wdC5hb0NvbHVtbkRlZnM9PT0ib2JqZWN0Iik/b3B0LmFvQ29sdW1uRGVmczpvcHQuYW9Db2x1bW5zOw0KCQl9DQoJCWlmKHR5cGVvZiBjb2xPYmo9PT0ib2JqZWN0Iikgew0KCQkJdmFyIGNvbDsNCgkJCWZvcih2YXIgaWR4PTA7aWR4PGNvbE9iai5sZW5ndGg7aWR4KyspIHsNCgkJCQljb2wgPSBjb2xPYmpbaWR4XTsNCgkJCQlpZihjb2wuY2xhc3NOYW1lIT09Im5ldmVyIiYmKGNvbC5iVmlzaWJsZT09PWZhbHNlfHxjb2wudmlzaWJsZT09PWZhbHNlKSkgY29sLmNsYXNzTmFtZSA9ICJuZXZlciI7IC8vIm5ldmVyIiBjbGFzcyBpcyB0aGUgcmVzcG9uc2l2ZSBlcXVpdmFsZW50IG9mIGJWaXNpYmxlDQoJCQl9DQoJCX0NCgl9DQoNCglpZih0eXBlb2Ygb3B0LnBhZ2luZz09PSJ1bmRlZmluZWQiJiZ0eXBlb2Ygb3B0LmJQYWdpbmF0ZT09PSJ1bmRlZmluZWQiKSBvcHQucGFnaW5nID0gKG9iai5kYXRhKCJzdi1kdC1wYWdpbmciKSE9PSJOIik/dHJ1ZTpmYWxzZTsgLy9wYWdpbmcgZW5hYmxlZCBieSBkZWZhdWx0IChjb3VsZCBhZmZlY3QgZm9ybSBzdWJtaXNzaW9uIHRob3VnaCkNCglpZih0eXBlb2Ygb3B0LnBhZ2luZ1R5cGU9PT0idW5kZWZpbmVkIiYmdHlwZW9mIG9wdC5zUGFnaW5hdGlvblR5cGU9PT0idW5kZWZpbmVkIikgb3B0LnBhZ2luZ1R5cGUgPSAiZnVsbF9udW1iZXJzIjsgLy9zZXQgcmVjb3JkIGJhciB0eXBlIHRvICJmdWxsIiAoaS5lLiBpbmNsdWRpbmcgRmlyc3QvTGFzdCBidXR0b25zKQ0KICBpZih0eXBlb2Ygb3B0Lmxlbmd0aENoYW5nZT09PSJ1bmRlZmluZWQiJiZ0eXBlb2Ygb3B0LmJMZW5ndGhDaGFuZ2U9PT0idW5kZWZpbmVkIikgb3B0Lmxlbmd0aENoYW5nZSA9IGZhbHNlOyAvL2Rpc2FibGUgY2hhbmdpbmcgb2YgcGFnZSBzaXplIChjb3VsZCBhZmZlY3QgZm9ybSBzdWJtaXNzaW9uIG90aGVyd2lzZSkNCiAgaWYodHlwZW9mIG9wdC5zZWFyY2hpbmc9PT0idW5kZWZpbmVkIiYmdHlwZW9mIG9wdC5iRmlsdGVyPT09InVuZGVmaW5lZCIpIG9wdC5zZWFyY2hpbmcgPSAob2JqLmRhdGEoInN2LWR0LXNlYXJjaGluZyIpIT09IlkiKT9mYWxzZTp0cnVlOyAvL2ZpbHRlcmluZyBkaXNhYmxlZCBieSBkZWZhdWx0IChzcGVjaWZpYyBjb2RlIG1pZ2h0IGJlIG5lZWRlZCAtIGlmIHRoZSB0YWJsZSBjb250YWlucyBlZGl0YWJsZSBmaWVsZHMpDQogIGlmKHR5cGVvZiBvcHQub3JkZXJpbmc9PT0idW5kZWZpbmVkIiYmdHlwZW9mIG9wdC5iU29ydD09PSJ1bmRlZmluZWQiKSBvcHQub3JkZXJpbmcgPSAob2JqLmRhdGEoInN2LWR0LW9yZGVyaW5nIik9PT0iTiIpP2ZhbHNlOnRydWU7IC8vb3JkZXJpbmcgZW5hYmxlZCBieSBkZWZhdWx0DQogIGlmKHR5cGVvZiBvcHQuaW5mbz09PSJ1bmRlZmluZWQiJiZ0eXBlb2Ygb3B0LmJJbmZvPT09InVuZGVmaW5lZCIpIG9wdC5pbmZvID0gKG9iai5kYXRhKCJzdi1kdC1pbmZvIikhPT0iTiIpP3RydWU6ZmFsc2U7IC8vaW5mbyBkaXNwbGF5IGVuYWJsZWQgYnkgZGVmYXVsdA0KDQoJLy9pbmNsdWRlIGFueSBkZWZhdWx0IGxhbmd1YWdlIGluZm9ybWF0aW9uKGlmIGl0IGlzIGF2YWlsYWJsZSkNCglpZih0eXBlb2Ygc2l0c193aWRnZXRfYnA9PT0ib2JqZWN0IiYmdHlwZW9mIHNpdHNfd2lkZ2V0X2JwLmR0PT09Im9iamVjdCIpIHsNCgkJdmFyIGxhbmd1YWdlID0gb3B0Lmxhbmd1YWdlIHx8IG9wdC5vTGFuZ3VhZ2U7DQoJCWlmKHR5cGVvZiBsYW5ndWFnZT09PSJvYmplY3QiJiZ0eXBlb2YgbGFuZ3VhZ2UudXJsPT09InVuZGVmaW5lZCImJnR5cGVvZiBsYW5ndWFnZS5zVXJsPT09InVuZGVmaW5lZCIpIHsgLy93ZSBpZ25vcmUgdGhlIHNVcmwgcGFyYW1ldGVyIG5vdywgYXMgZGVmYXVsdHMgc2hvdWxkIGJlIGF2YWlsYWJsZSBvbiBlYWNoIHBhZ2Ugc28gd2UgZG9uJ3QgbmVlZCB0aGUgQUpBWCBjYWxsDQoJCQkvL2xhbmd1YWdlIGluZm9ybWF0aW9uIGFscmVhZHkgcHJvdmlkZWQsIHNvIG1lcmdlIGl0IHdpdGggdGhlIGRlZmF1bHRzDQoJCQlvcHQubGFuZ3VhZ2UgPSAkLmV4dGVuZCh0cnVlLHt9LHNpdHNfd2lkZ2V0X2JwLmR0LGxhbmd1YWdlKTsNCgkJfQ0KCQllbHNlIHsNCgkJCS8vdXNlIHRoZSBkZWZhdWx0IGxhbmd1YWdlDQoJCQlvcHQubGFuZ3VhZ2UgPSAkLmV4dGVuZCh0cnVlLHt9LHNpdHNfd2lkZ2V0X2JwLmR0KTsNCgkJfQ0KCQlkZWxldGUgb3B0Lm9MYW5ndWFnZTsNCgl9DQoNCglyZXR1cm4gb3B0Ow0KfQ0KDQovL1JlY2FsY3VsYXRlIGNvbHVtbiB3aWR0aHMgYW5kIHJlc3BvbnNpdmUgZGlzcGxheSBmb3IgYSBkYXRhdGFibGUoYWZ0ZXIgYSByZXNpemUsIG9yIHNob3dpbmcvaGlkaW5nIHRoZSBwYXJlbnQgY29udGFpbmVyLCBmb3IgZXhhbXBsZSkNCi8vIHN0cmluZyAgIHNlbCA6IGluIDtqUXVlcnkgc2VsZWN0b3IgdG8gYXBwbHkgdGhlIGRhdGF0YWJsZXMgcmVjYWxjdWxhdGlvbiB0bw0KZnVuY3Rpb24gc2l0c19kYXRhdGFibGVzX3JlY2FsYyhzZWwpIHsNCglpZigodHlwZW9mKHNlbCk9PT0ic3RyaW5nIiAmJiBzZWwubGVuZ3RoPjApIHx8IHR5cGVvZihzZWwpPT09Im9iamVjdCIpIHsgLy9jaGVjayBmaXJzdCBwYXJhbWV0ZXINCgkJdmFyIGRhdGF0YWJsZTsNCg0KCQkvL2dldCBhIHJlZmVyZW5jZSB0byBlYWNoIERhdGFUYWJsZSh1c2luZyB0aGUgQVBJKSBhbmQgcGVyZm9ybSB0aGUgYWRqdXN0bWVudHMNCgkJJChzZWwpLmVhY2goZnVuY3Rpb24oKSB7DQoJCQlkYXRhdGFibGUgPSAkKHRoaXMpLkRhdGFUYWJsZSgpOw0KCQkJaWYodHlwZW9mIGRhdGF0YWJsZT09PSJvYmplY3QiKSB7DQoJCQkJZGF0YXRhYmxlLmNvbHVtbnMuYWRqdXN0KCk7IC8vYWRqdXN0IGNvbHVtbiB3aWR0aHMNCgkJCQlpZih0eXBlb2YgZGF0YXRhYmxlLnJlc3BvbnNpdmUhPT0idW5kZWZpbmVkIikgew0KCQkJCQlkYXRhdGFibGUucmVzcG9uc2l2ZS5yZWNhbGMoKTsgLy9pZiByZXNwb25zaXZlIGlzIGF2YWlsYWJsZSB0aGVuIHJlY2FsY3VsYXRlIHRoZSBjb2x1bW4gZGlzcGxheQ0KCQkJCX0NCgkJCX0NCgkJfSk7DQoJfQ0KfQ0KDQovL0ludGVybmFsIGZ1bmN0aW9uIHRvIGNvbnZlcnQgYSBzZWxlY3QgZWxlbWVudCBpbnRvIGEgZGF0YXRhYmxlcyB3aWRnZXQoUFBMMDMzMTk0KQ0KLy8gc3RyaW5nICAgc2VsIDogaW4gO2pRdWVyeSBzZWxlY3RvciB0byBhcHBseSB0aGUgZGF0YXRhYmxlcyB3aWRnZXQgdG8NCi8vIG9iamVjdCAgIG9wdCA6IGluIDtvYmplY3QgY29udGFpbmluZyBvcHRpb25zIGZvciBkYXRhdGFibGVzIHdpZGdldA0KZnVuY3Rpb24gc2l0c19kb19kYXRhdGFibGVzX3dpZGdldChzZWwsb3B0KSB7DQogIGlmKCh0eXBlb2Yoc2VsKT09InN0cmluZyIgJiYgc2VsLmxlbmd0aD4wKSB8fCB0eXBlb2Yoc2VsKT09Im9iamVjdCIpIHsgLy9jaGVjayBmaXJzdCBwYXJhbWV0ZXINCiAgICAkKHNlbCkuZWFjaChmdW5jdGlvbihpKSB7DQogICAgICB2YXIgdGhpc29iaiA9ICQodGhpcyk7DQogICAgICB2YXIgdGhpc29wdCA9IHNpdHNfZGF0YXRhYmxlX3BhcmFtcyh0aGlzb2JqLG9wdCk7IC8vYnVpbGQgbG9jYWwgb3B0aW9ucyB3aXRoIHRleHQgZnJvbSBmaWVsZCBhdHRyaWJ1dGVzDQogICAgICB0aGlzb2JqLmRhdGFUYWJsZSh0aGlzb3B0KTsNCiAgICB9KTsNCiAgICByZXR1cm4gdHJ1ZTsNCiAgfQ0KICByZXR1cm4gZmFsc2U7DQp9DQoNCi8vQ29udmVydCBhbiBleGlzdGluZyB0YWJsZSB1c2luZyB0aGUgdGFibGVzYXcgd2lkZ2V0IC0gdXNlcyBIVE1MNSBkYXRhIGF0dHJpYnV0ZXMgdG8gY29udHJvbCBvcHRpb25zDQovLyBzdHJpbmcgICBzZWwgOiBpbiA7alF1ZXJ5IHNlbGVjdG9yIHRvIGFwcGx5IHRoZSB0YWJsZXNhdyB3aWRnZXQgdG8NCi8vIHN0cmluZwkJbW9kZSA6aW47dGhlIFRhYmxlc2F3IG1vZGUgdG8gdXNlIGZvciB0aGUgdGFibGUoc3dpcGUsIHN0YWNrLCBvciBjb2x0b2dnbGUpIC0gZGVmYXVsdGVkIGZyb20gZGF0YS10YWJsZXNhdy1tb2RlIGlmIHVuZGVmaW5lZCBvciBibGFuaw0KLy8gb2JqZWN0CQlicmVha3BvaW50IDppbjt0aGUgYnJlYWtwb2ludCBvYmplY3QoaW4gdGhlIGZvcm1hdCByZXR1cm5lZCBieSBzaXRzX2dldF9icmVha3BvaW50KSB0byB1c2UgLSBkZWZhdWx0ZWQgZnJvbSBzaXRzX2dldF9icmVha3BvaW50IGlmIHVuZGVmaW5lZCBvciBibGFuaw0KLy8gYm9vbGVhbiAgb3ZlcnJpZGVkZWZlciA6aW47c2hvdWxkIHdlIG92ZXJyaWRlIHRoZSBkZWZlci1pbml0IG9wdGlvbihpLmUuIHdoZXJlIHRoZSB0YWJsZXNhdy1kZWZlci1pbml0IGRhdGEgYXR0cmlidXRlIGlzIFkpDQpmdW5jdGlvbiBzaXRzX3RhYmxlc2F3X3dpZGdldChzZWwsbW9kZSxicmVha3BvaW50LG92ZXJyaWRlZGVmZXIpIHsNCgkvL3NlZSBpZiB0YWJsZXNhdyBpcyBhdmFpbGFibGUoaS5lLiBoYXMgdGhlIEpTIGJlZW4gbG9hZGVkKQ0KCWlmKHR5cGVvZiBUYWJsZXNhdyE9PSJvYmplY3QiKSByZXR1cm4gZmFsc2U7DQoNCgkvL3NlZSBpZiBzZWxlY3RvciBpcyBzcGVjaWZpZWQNCglpZigodHlwZW9mKHNlbCkhPT0ic3RyaW5nInx8c2VsLmxlbmd0aD09PTApICYmIHR5cGVvZihzZWwpIT09Im9iamVjdCIpIHJldHVybiBmYWxzZTsNCg0KCS8vYXJlIHdlIHVzaW5nIHRoZSB0YWJsZXNhdy1kZWZlci1pbml0IGRhdGEgYXR0cmlidXRlLCBvciBqdXN0IGlnbm9yaW5nIGl0DQoJaWYodHlwZW9mKG92ZXJyaWRlZGVmZXIpIT09ImJvb2xlYW4iKSBvdmVycmlkZWRlZmVyID0gZmFsc2U7DQoNCgkvL2lmIHdlJ3JlIGluIHRoZSBwb3J0YWwgdGhlbiB3ZSBtYXkgbmVlZCB0byBwZXJmb3JtIGFkZGl0aW9uYWwgcHJvY2Vzc2luZw0KCXZhciB0YWJsZXNhd19wb3J0YWxfY2hlY2sgPSBmYWxzZTsNCglpZihzaXRzX3BvcnRhbF9vYmplY3QuaGFzQWZmZWN0ZWQmJiFzaXRzX3BvcnRhbF9vYmplY3QuaXNEaXNhYmxlZCkgew0KCQkvL3dlJ3JlIGluIHRoZSBwb3J0YWwgYW5kIGFkZGl0aW9uYWwgcHJvY2Vzc2luZyBpcyBlbmFibGVkKGkuZS4gdGhlcmUgYXJlIG11bHRpcGxlIGNvbHVtbnMgaW4gdXNlKSwgc28gd2UgbmVlZCB0byBjaGVjayB0YWJsZSBieSB0YWJsZQ0KCQl0YWJsZXNhd19wb3J0YWxfY2hlY2sgPSB0cnVlOw0KCX0NCg0KICAvL2ZpbmQgYWxsIHRoZSB0YWJsZXMgb24gdGhlIHBhZ2UgYW5kIGRlY2lkZSB3aGF0IHRvIGRvIGZvciBlYWNoDQogIHZhciB0YWJsZSwgdGFibGVzYXdfbW9kZSwgdGFibGVfY29udmVydGVkID0gZmFsc2UsIGluaXRfdGFibGUsIHBlcmZvcm1fc3RhY2s7DQogICQoc2VsKS5lYWNoKGZ1bmN0aW9uKCkgew0KICAJdGFibGUgPSAkKHRoaXMpOw0KDQogICAgLy9pZiB0aGlzIHRhYmxlIGlzIHVzaW5nIHRoZSB0YWJsZXNhdyB3aWRnZXQgaW5pdGlhbGlzZSBpdA0KICAgIHRhYmxlc2F3X21vZGUgPSh0eXBlb2YgbW9kZSE9PSJ1bmRlZmluZWQiJiZtb2RlIT0iIik/bW9kZTp0YWJsZS5kYXRhKCJ0YWJsZXNhdy1tb2RlIikNCiAgICBpZih0YWJsZXNhd19tb2RlJiYhdGFibGUuaGFzQ2xhc3MoInRhYmxlc2F3IikpIHsgLy9pbml0aWFsaXNlIHRhYmxlc2F3DQogICAgCWluaXRfdGFibGUgPSB0cnVlOw0KDQogICAgCS8vaWYgdGhlIHRhYmxlIGluaXRpYWxpc2F0aW9uIGlzIGRlZmVycmVkLCBhbmQgd2UncmUgbm90IG92ZXJyaWRpbmcgaXQsIHRoZW4gc2VlIGlmIHdlIHNob3VsZCBpbml0aWFsaXNlKGFzICJzdGFjayIgbW9kZSBpZ25vcmVzIHRoZSBhdHRyaWJ1dGUgZm9yIGJldHRlciBtb2JpbGUgZXhwZXJpZW5jZSkNCgkJCWlmKCFvdmVycmlkZWRlZmVyJiZ0YWJsZXNhd19tb2RlIT09InN0YWNrIikgew0KCQkJCWlmKHRhYmxlLmF0dHIoImRhdGEtdGFibGVzYXctZGVmZXItaW5pdCIpPT09IlkiKSB7DQoJCQkJCWluaXRfdGFibGUgPSBmYWxzZTsNCgkJCQl9DQoJCQl9DQoNCiAgICAgIC8vaWYgdGhlIHRhYmxlIGlzIG5vcm1hbGx5IGFuIGFsdGVybmF0aXZlIG1vZGUgYnV0IGRvZXMgYWxsb3cgc3RhY2sgdGhlbiBzZWUgaWYgd2UncmUgaW4gYSBzdGFja2luZyBicmVha3BvaW50KGFsbG93cyB1cyB0byB1c2Ugc3RhY2sgZm9yIG1vYmlsZSBidXQgb3RoZXIgbW9kZXMgZm9yIGxhcmdlciBzY3JlZW5zKQ0KCQkJaWYodGFibGVzYXdfbW9kZSE9PSJzdGFjayImJnRhYmxlLmF0dHIoImRhdGEtdGFibGVzYXctYWxsb3ctc3RhY2siKT09PSJZIikgew0KCQkJCS8va2VlcCBhIGNvcHkgb2YgdGhlIHN0YXJ0aW5nIG1vZGUsIHNvIHdlIGNhbiB1c2UgaXQgaWYgdGhlIHNjcmVlbnNpemUgY2hhbmdlcw0KCQkJCXRhYmxlLmF0dHIoImRhdGEtdGFibGVzYXctb3JpZy1tb2RlIix0YWJsZXNhd19tb2RlKTsNCg0KCQkJCS8vZGV0ZXJtaW5lIHdoZXRoZXIgdG8gZm9yY2Ugc3RhY2sgbW9kZShpbiB0aGUgbW9iaWxlIHBob25lIHNjcmVlbnNpemUpDQoJCQkJcGVyZm9ybV9zdGFjayA9IGZhbHNlOw0KDQoJCQkJaWYodGFibGVzYXdfcG9ydGFsX2NoZWNrKSB7DQoJCQkJCS8vaW4gcG9ydGFsIGNvbnRlbnQgbW9kZSB3aXRoIG1vcmUgdGhhbiBvbmUgY29sdW1uLCBzbyB1c2UgYW55IGRlZmluZWQgbXVsdGlwbGllciB0byBhZGp1c3QgdGhlIGJyZWFrcG9pbnQgbWluIGFuZCBtYXggdmFsdWVzDQoJCQkJCWlmKHNpdHNfZG9fZ2V0X3BvcnRhbF9icmVha3BvaW50KHRhYmxlKT09PSJ4cyIpIHsNCgkJCQkJCXBlcmZvcm1fc3RhY2sgPSB0cnVlOw0KCQkJCQl9DQoJCQkJfQ0KCQkJCWVsc2Ugew0KCQkJCQlpZih0eXBlb2YoYnJlYWtwb2ludCk9PT0idW5kZWZpbmVkInx8YnJlYWtwb2ludD09PSIiKSBicmVha3BvaW50ID0gc2l0c19nZXRfYnJlYWtwb2ludCgpOw0KDQoJCQkJCS8vbm90IGluIHBvcnRhbCBjb250ZW50IG1vZGUob3Igb25seSBzaW5nbGUgY29sdW1uKSwgc28gc3RhY2sgb25seSBpbiB0aGUgbm9ybWFsIHhzIGJyZWFrcG9pbnQNCgkJCQkJaWYoYnJlYWtwb2ludD09PSJ4cyIpIHsNCgkJCQkJCXBlcmZvcm1fc3RhY2sgPSB0cnVlOw0KCQkJCQl9DQoJCQkJfQ0KDQoJCQkJLy9pZiB3ZSdyZSBpbiBhbiBhZmZlY3RlZCBzY3JlZW5zaXplIHRoZW4gc3dhcCB0byBzdGFjayBhcyBhIHN0YXJ0aW5nIHBvaW50DQoJCQkJaWYocGVyZm9ybV9zdGFjaykgew0KCQkJCQlpbml0X3RhYmxlID0gdHJ1ZTsgLy9vdmVycmlkZSBhbnkgZGVmZXJyZWQgaW5pdCBhcyBzdGFjayBpZ25vcmVzIGl0DQoJCQkJCXRhYmxlLmF0dHIoImRhdGEtdGFibGVzYXctbW9kZSIsInN0YWNrIik7DQoJCQkJfQ0KCQkJfQ0KDQoJCQlpZihpbml0X3RhYmxlKSB7DQoJCQkJdGFibGVfY29udmVydGVkID0gdHJ1ZTsgLy93ZSd2ZSBjb252ZXJ0ZWQgYXQgbGVhc3Qgb25lIHRhYmxlDQoNCiAgICAJCS8vcmVtb3ZlIHRoZSBkZWZhdWx0L2ZhbGxiYWNrIGNsYXNzKGFzIGl0IGFmZmVjdHMgdGFibGUgd2lkdGgpDQogICAgICAJdGFibGUucGFyZW50KCkucmVtb3ZlQ2xhc3MoInN2LXRhYmxlLXJlc3BvbnNpdmUiKTsNCg0KICAgICAgCS8vcmVtb3ZlIHRoZSBkZWZlciBhdHRyaWJ1dGUgYXMgaXQgaXNuJ3QgcmVxdWlyZWQgYWZ0ZXIgdGhlIHRhYmxlIGlzIGluaXRpYWxpc2VkIHRoZSBmaXJzdCB0aW1lDQogICAgICAJdGFibGUucmVtb3ZlQXR0cigiZGF0YS10YWJsZXNhdy1kZWZlci1pbml0Iik7DQoNCiAgICAgICAgLy9hcHBseSBjdXN0b20gc29ydGluZw0KICAgICAgICB0YWJsZS5maW5kKCJ0aFtkYXRhLXNvcnRhYmxlLWRhdGVdIikuZGF0YSgidGFibGVzYXctc29ydCIsZnVuY3Rpb24oYXNjKSB7DQogICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGEsYikgew0KICAgICAgICAgICAgaWYoYS5jZWxsPT1iLmNlbGwpIHsNCiAgICAgICAgICAgICAgcmV0dXJuIDA7DQogICAgICAgICAgICB9DQogICAgICAgICAgICB2YXIgYXYgPSBzaXRzX2RhdGVfdG9fYXRvbShhLmNlbGwpOw0KICAgICAgICAgICAgdmFyIGJ2ID0gc2l0c19kYXRlX3RvX2F0b20oYi5jZWxsKTsNCiAgICAgICAgICAgIGlmKGF2PT1idikgew0KICAgICAgICAgICAgICByZXR1cm4gMDsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGlmKGFzYykgew0KICAgICAgICAgICAgICByZXR1cm4oYXY+YnYgPyAxIDogLTEpOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZWxzZSB7DQogICAgICAgICAgICAgIHJldHVybihhdjxidiA/IDEgOiAtMSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgfTsNCiAgICAgICAgfSk7DQoNCgkJCQkvL2luaXRpYWxpc2UgdGhlIHdpZGdldA0KICAgICAgCXRhYmxlLnRhYmxlKCk7DQoJCQl9DQogICAgfQ0KICB9KTsNCg0KCXJldHVybiB0YWJsZV9jb252ZXJ0ZWQ7DQp9DQoNCi8vUmV0dXJuIGFuIGluc3RhbmNlIG9mIHRoZSBUYWJsZXNhdyB3aWRnZXQgZm9yIGEgdGFibGUocHJvdmlkaW5nIHRoZSB3aWRnZXQgaGFzIGJlZW4gaW5zdGFudGlhdGVkIG9uIHRoYXQgdGFibGUpDQovLyBzdHJpbmcgICBzZWwgOiBpbiA7alF1ZXJ5IHNlbGVjdG9yIG9yIG9iamVjdCB0byByZXR1cm4gdGhlIGluc3RhbmNlIGZvcg0KZnVuY3Rpb24gc2l0c190YWJsZXNhd19pbnN0YW5jZShzZWwpIHsNCgkvL3NlZSBpZiB0YWJsZXNhdyBpcyBhdmFpbGFibGUoaS5lLiBoYXMgdGhlIEpTIGJlZW4gbG9hZGVkKQ0KCWlmKHR5cGVvZiBUYWJsZXNhdyE9PSJvYmplY3QiKSByZXR1cm47DQoNCgkvL3NlZSBpZiBzZWxlY3RvciBpcyBzcGVjaWZpZWQNCglpZigodHlwZW9mKHNlbCkhPT0ic3RyaW5nInx8c2VsLmxlbmd0aD09PTApICYmIHR5cGVvZihzZWwpIT09Im9iamVjdCIpIHJldHVybjsNCg0KCS8vcmV0dXJuIHRoZSBpbnN0YW5jZShvciB1bmRlZmluZWQgaWYgdGhlcmUgaXNuJ3Qgb25lKQ0KCXJldHVybiAkKHNlbCkuZGF0YSgidGFibGUiKTsNCn0NCg0KLy9yZWZyZXNoIGEgdGFibGVzYXcgaW5zdGFuY2UgLSBhZnRlciBhbWVuZGluZyBjb250ZW50IGZvciBleGFtcGxlDQovLyBzdHJpbmcgICBzZWwgOiBpbiA7alF1ZXJ5IHNlbGVjdG9yIGZvciB0aGUgdGFibGUocykgdG8gcmVmcmVzaA0KLy8gYm9vbGVhbiAgcnN0IDogaW4gO3Jlc2V0IHRoZSBjb2x1bW4gZGlzcGxheSAoaS5lLiByZXNldCBhbnkgc3dpcGluZyB0aGUgdXNlciBoYXMgZG9uZSkNCi8vIGFycmF5IGNvbGxpc3QgOmluIDt2aXNpYmxlIGNvbHVtbiBsaXN0IChvcHRpb25hbCkgLSBpbiB0aGUgZm9ybWF0IHJldHVybmVkIGJ5IHRoZSB0YWJsZXNhdyB0cmliYWxHZXRWaXNpYmxlIGZ1bmN0aW9uDQpmdW5jdGlvbiBzaXRzX3RhYmxlc2F3X3JlZnJlc2goc2VsLHJzdCxjb2xsaXN0KXsNCgl2YXIgdGFibGUgPSAkKHNlbCk7DQoNCglpZih0eXBlb2YgcnN0IT09ImJvb2xlYW4iKXsgLy9zaG91bGQgd2UgcmVzZXQgdGhlIGNvbHVtbnMNCgkJcnN0ID0gdHJ1ZTsgLy95ZXMsIGJ5IGRlZmF1bHQNCgl9DQoNCgkvL2dldCB0aGUgY3VycmVudCBpbnN0YW5jZSBvZiB0YWJsZXNhdyAoaWYgdGhlcmUgaXMgb25lKQ0KCXZhciBpbnN0ID0gc2l0c190YWJsZXNhd19pbnN0YW5jZSh0YWJsZSk7DQoJaWYodHlwZW9mIGluc3QhPT0idW5kZWZpbmVkIil7DQoJCS8vZ2V0IHRoZSBjdXJyZW50IGRpc3BsYXllZCBjb2x1bW4gbGlzdCAtIHNvIHdlIGNhbiByZXN0b3JlIGl0IChpZiByZXF1ZXN0ZWQpDQoJCWlmKCFyc3QmJnR5cGVvZiBjb2xsaXN0IT09Im9iamVjdCIpew0KCQkJY29sbGlzdCA9IGluc3QudHJpYmFsR2V0VmlzaWJsZSgpOw0KCQl9DQoNCgkJLy9kZXN0cm95IHRoZSBjdXJyZW50IGluc3RhbmNlIG9mIHRoZSB0YWJsZQ0KCQlpbnN0LmRlc3Ryb3koKTsNCgl9DQoNCgkvL2luaXRpYWxpc2UgdGFibGVzYXcNCglzaXRzX3RhYmxlc2F3X3dpZGdldCh0YWJsZSwiIiwiIix0cnVlKTsNCg0KCS8vcmVzZXQgdGhlIGNvbHVtbiBkaXNwbGF5IChpZiBuZWNlc3NhcnkpDQoJaWYoIXJzdCYmdHlwZW9mIGNvbGxpc3QhPT0idW5kZWZpbmVkIil7DQoJCWluc3QgPSBzaXRzX3RhYmxlc2F3X2luc3RhbmNlKHRhYmxlKTsNCgkJaWYodHlwZW9mIGluc3QhPT0idW5kZWZpbmVkIil7DQoJCQlpbnN0LnRyaWJhbFNldFZpc2libGUoY29sbGlzdCk7DQoJCX0NCgl9DQp9DQoNCi8vQ29udmVydCBhIHNlbGVjdCBlbGVtZW50IGludG8gYSBjaG9zZW4gd2lkZ2V0KFBQTDAzMzE5NCkNCi8vIHN0cmluZyAgIHNlbCA6IGluIDtqUXVlcnkgc2VsZWN0b3IgdG8gYXBwbHkgdGhlIGNob3NlbiB3aWRnZXQgdG8NCi8vIG9iamVjdCAgIG9wdCA6IGluIDtvYmplY3QgY29udGFpbmluZyBvcHRpb25zIGZvciBjaG9zZW4gd2lkZ2V0DQpmdW5jdGlvbiBzaXRzX2Nob3Nlbl93aWRnZXQoc2VsLG9wdCkgew0KICB2YXIgbG9jID0gc2l0c19taW5pZmllZF9wYXRoKCIuLi9wbHVnaW5zL2phdmFzY3JpcHQvY2hvc2VuLyIsImNob3Nlbi5qcXVlcnkuanMiLCJjaG9zZW4uanF1ZXJ5Lm1pbi5qcyIpOw0KICBpZihzaXRzX2ZpbGVzX2FycmF5W2xvY109PSJZIikgeyAvL2FscmVhZHkgbG9hZGVkLi4uDQogICAgc2l0c19kb19jaG9zZW5fd2lkZ2V0KHNlbCxvcHQpOyAvLy4uLnNvIGNhbGwgc3RyYWlnaHQgYXdheQ0KICB9DQogIGVsc2UgeyAvL25vdCBsb2FkZWQgeWV0Li4uDQogICAgdmFyIHBhciA9IHt9OyAvL2NyZWF0ZSBhbiBvYmplY3Qgb2YgcGFyYW1ldGVycw0KICAgIHBhci51cmwgPSBsb2M7DQogICAgcGFyLmZuYyA9IHNpdHNfZG9fY2hvc2VuX3dpZGdldDsNCiAgICBwYXIucDAxID0gc2VsOw0KICAgIHBhci5wMDIgPSBvcHQ7DQogICAgdmFyIGxlbiA9IHNpdHNfcGFyYW1fYXJyYXkucHVzaChwYXIpOyAvL3NhdmUgZm9yIGxhdGVyDQogICAgc2l0c19pbmNsdWRlX2ZpbGUoIi4uL3BsdWdpbnMvY3NzL2Nob3Nlbi9jaG9zZW4uY3NzIik7DQogICAgc2l0c19pbmNsdWRlX2ZpbGUobG9jKTsNCiAgfQ0KICByZXR1cm4gdHJ1ZTsNCn0NCg0KLy9JbnRlcm5hbCBmdW5jdGlvbiB0byBjb252ZXJ0IGEgc2VsZWN0IGVsZW1lbnQgaW50byBhIGNob3NlbiB3aWRnZXQoUFBMMDMzMTk0KQ0KLy8gc3RyaW5nICAgc2VsIDogaW4gO2pRdWVyeSBzZWxlY3RvciB0byBhcHBseSB0aGUgY2hvc2VuIHdpZGdldCB0bw0KLy8gb2JqZWN0ICAgb3B0IDogaW4gO29iamVjdCBjb250YWluaW5nIG9wdGlvbnMgZm9yIGNob3NlbiB3aWRnZXQNCmZ1bmN0aW9uIHNpdHNfZG9fY2hvc2VuX3dpZGdldChzZWwsb3B0KSB7DQogIGlmKCh0eXBlb2Yoc2VsKT09InN0cmluZyIgJiYgc2VsLmxlbmd0aD4wKSB8fCB0eXBlb2Yoc2VsKT09Im9iamVjdCIpIHsgLy9jaGVjayBmaXJzdCBwYXJhbWV0ZXINCiAgICBpZih0eXBlb2Yob3B0KT09Im9iamVjdCIpIHsgLy9jaGVjayBzZWNvbmQgcGFyYW1ldGVyDQogICAgICAkKHNlbCkuZWFjaChmdW5jdGlvbihpKSB7DQogICAgICAgIHZhciB0aGlzb2JqID0gJCh0aGlzKTsNCiAgICAgICAgdmFyIHRoaXNvcHQgPSBvcHQ7IC8vYnVpbGQgbG9jYWwgb3B0aW9ucyB3aXRoIHRleHQgZnJvbSBmaWVsZCBhdHRyaWJ1dGVzDQogICAgICAgIGlmKHRoaXNvYmouYXR0cigiZGF0YS1jaG9zZW5ub3RleHQiKSAmJiB0aGlzb2JqLmF0dHIoImRhdGEtY2hvc2Vubm90ZXh0IikhPSIiKSB7DQogICAgICAgICAgdGhpc29wdC5ub19yZXN1bHRzX3RleHQgPSB0aGlzb2JqLmF0dHIoImRhdGEtY2hvc2Vubm90ZXh0Iik7DQogICAgICAgIH0NCiAgICAgICAgaWYodGhpc29iai5hdHRyKCJkYXRhLXBsYWNlaG9sZGVyYSIpICYmIHRoaXNvYmouYXR0cigiZGF0YS1wbGFjZWhvbGRlcmEiKSE9IiIpIHsNCiAgICAgICAgICB0aGlzb3B0LnBsYWNlaG9sZGVyX3RleHRfc2luZ2xlID0gdGhpc29iai5hdHRyKCJkYXRhLXBsYWNlaG9sZGVyYSIpOw0KICAgICAgICAgIHRoaXNvcHQucGxhY2Vob2xkZXJfdGV4dF9tdWx0aXBsZSA9IHRoaXNvYmouYXR0cigiZGF0YS1wbGFjZWhvbGRlcmEiKTsNCiAgICAgICAgfQ0KICAgICAgICBpZih0aGlzb2JqLmhhc0NsYXNzKCJzdi1mb3JtLWNvbnRyb2wiKSkgew0KICAgICAgICAgIHRoaXNvYmoucmVtb3ZlQ2xhc3MoInN2LWZvcm0tY29udHJvbCIpOw0KCSAgICAgICAgdGhpc29wdC53aWR0aCA9ICIxMDAlIjsNCiAgICAgICAgfQ0KICAgICAgICB0aGlzb3B0LnNlYXJjaF9jb250YWlucyA9IHRydWU7DQogICAgICAgIHRoaXNvcHQuc2luZ2xlX2JhY2tzdHJva2VfZGVsZXRlID0gZmFsc2U7DQogICAgICAgIHRoaXNvYmouY2hvc2VuKHRoaXNvcHQpOw0KICAgICAgICB2YXIgbGFiZWxmb3IgPSB0aGlzb2JqLmF0dHIoImlkIik7DQogICAgICAgIHZhciBsYWJlbHRleHQgID0gIiI7DQogICAgICAgIGlmKHR5cGVvZihsYWJlbGZvcik9PSJzdHJpbmciICYmIGxhYmVsZm9yLmxlbmd0aD4wKSB7DQogICAgICAgICAgbGFiZWxmb3IgPSBzaXRzX2RvX2dldF9vYmplY3QobGFiZWxmb3IpOw0KICAgICAgICAgIGxhYmVsdGV4dCA9ICQoImxhYmVsW2Zvcj0iK2xhYmVsZm9yKyJdIikuaHRtbCgpOw0KICAgICAgICAgICQoIiMiK2xhYmVsZm9yKyJfY2hvc2VuIikuZmluZCgiaW5wdXQiKS5hdHRyKCJ0aXRsZSIsbGFiZWx0ZXh0KTsNCiAgICAgICAgICAkKCIjIitsYWJlbGZvcisiX2Nob3NlbiIpLmNzcygibWluLXdpZHRoIiwiMTUwcHgiKTsgIC8vIHdvcmthcm91bmQgZm9yIHNhZmFyaSBidWcNCiAgICAgICAgfQ0KICAgICAgICBzaXRzX2RvX2Nob3Nlbl93aWRnZXRfYWNjZXNzaWJpbGl0eSh0aGlzb2JqLGxhYmVsdGV4dCk7DQogICAgICAgIHNpdHNfZG9fY2hvc2VuX3dpZGdldF9hY2Nlc3NpYmlsaXR5X2V2ZW50cyh0aGlzb2JqKTsNCiAgICAgICAgaWYoIXRoaXNvYmoubmV4dCgiZGl2IikuaGFzQ2xhc3MoImNob3Nlbi1jb250YWluZXIiKSkgew0KICAgICAgICAgIHRoaXNvYmouYWRkQ2xhc3MoInN2LWZvcm0tY29udHJvbCIpOw0KICAgICAgICB9DQogICAgICB9KTsNCiAgICAgIHJldHVybiB0cnVlOw0KICAgIH0NCiAgfQ0KICByZXR1cm4gZmFsc2U7DQp9DQpmdW5jdGlvbiBzaXRzX2RvX2Nob3Nlbl93aWRnZXRfYWNjZXNzaWJpbGl0eV9ldmVudHModGhpc29iaikgew0KICB0aGlzb2JqLm9uKCdjaG9zZW46c2hvd2luZ19kcm9wZG93bicsZnVuY3Rpb24oYSxiKSB7DQogICAgdGhpc29iaiA9ICQoYS50YXJnZXQpDQogICAgdmFyIHRoaXNpZCA9IHRoaXNvYmouYXR0cigiaWQiKQ0KICAgIHRoaXNvYmoubmV4dCgiZGl2LmNob3Nlbi1jb250YWluZXIiKS5maW5kKCJ1bC5jaG9zZW4tcmVzdWx0cyBsaSIpLmVhY2goZnVuY3Rpb24oaSkgew0KICAgICAgJCh0aGlzKS5hdHRyKHsiaWQiOnRoaXNpZCtpLCJyb2xlIjoib3B0aW9uIiwidGFiaW5kZXgiOi0xfSk7DQogICAgfSk7DQogIH0pOw0KICB0aGlzb2JqLm9uKCdjaG9zZW46aGlkaW5nX2Ryb3Bkb3duJyxmdW5jdGlvbihhLGIpIHsNCiAgICB0aGlzb2JqID0gJChhLnRhcmdldCkNCiAgICB2YXIgdGhpc2lkID0gdGhpc29iai5hdHRyKCJpZCIpDQogICAgJCh0aGlzb2JqKS5uZXh0KCJkaXYuY2hvc2VuLWNvbnRhaW5lciIpLmZpbmQoImlucHV0IikucmVtb3ZlQXR0cigiYXJpYS1hY3RpdmVkZXNjZW5kYW50Iik7DQogICAgdGhpc29iai5uZXh0KCJkaXYuY2hvc2VuLWNvbnRhaW5lciIpLmZpbmQoInVsLmNob3Nlbi1yZXN1bHRzIGxpIikuZWFjaChmdW5jdGlvbihpKSB7DQogICAgICAkKHRoaXMpLmF0dHIoeyJpZCI6dGhpc2lkK2ksInJvbGUiOiJvcHRpb24iLCJ0YWJpbmRleCI6LTF9KTsNCiAgICB9KTsNCiAgICB2YXIgc2luZ2xlRGl2SWQgPSB0aGlzb2JqLm5leHQoImRpdi5jaG9zZW4tY29udGFpbmVyLXNpbmdsZSIpLmF0dHIoImlkIik7DQogICAgaWYodHlwZW9mKHNpbmdsZURpdklkKT09InN0cmluZyIpIHsNCiAgICAgIHRoaXNvYmoubmV4dCgiZGl2LmNob3Nlbi1jb250YWluZXItc2luZ2xlIikuYXR0cigidGFiaW5kZXgiLCItMSIpLmZpbmQoInNwYW46Zmlyc3QiKS5hdHRyKCJpZCIsc2luZ2xlRGl2SWQrInNwYW4iKQ0KICAgIH0NCiAgICB0aGlzb2JqLm5leHQoImRpdi5jaG9zZW4tY29udGFpbmVyLXNpbmdsZSIpLmZpbmQoImlucHV0OmZpcnN0IikuYXR0cigidGl0bGUiLCQoIiMiK3NpbmdsZURpdklkKyJzcGFuIikuaHRtbCgpKTsNCiAgfSk7DQogIHRoaXNvYmoub24oJ2NoYW5nZScsIGZ1bmN0aW9uKGEsIGIpIHsNCiAgICB0aGlzb2JqID0gJChhLnRhcmdldCk7DQogICAgdmFyIHNpbmdsZURpdklkID0gdGhpc29iai5uZXh0KCJkaXYuY2hvc2VuLWNvbnRhaW5lci1zaW5nbGUiKS5hdHRyKCJpZCIpOw0KICAgIGlmKHR5cGVvZihzaW5nbGVEaXZJZCk9PSJzdHJpbmciKSB7DQogICAgICB0aGlzb2JqLm5leHQoImRpdi5jaG9zZW4tY29udGFpbmVyLXNpbmdsZSIpLmF0dHIoInRhYmluZGV4IiwiLTEiKS5maW5kKCJzcGFuOmZpcnN0IikuYXR0cigiaWQiLHNpbmdsZURpdklkKyJzcGFuIik7DQogICAgfQ0KICAgIHRoaXNvYmoubmV4dCgiZGl2LmNob3Nlbi1jb250YWluZXItc2luZ2xlIikuZmluZCgiaW5wdXQ6Zmlyc3QiKS5hdHRyKCJ0aXRsZSIsJCgiIyIrc2luZ2xlRGl2SWQrInNwYW4iKS5odG1sKCkpOw0KICB9KTsNCn0NCmZ1bmN0aW9uIHNpdHNfZG9fY2hvc2VuX3dpZGdldF9hY2Nlc3NpYmlsaXR5X2Rlc2ModGhpc29iaikgew0KICB2YXIgdGhpc2lkID0gdGhpc29iai5hdHRyKCJpZCIpOw0KICAkKHRoaXNvYmopLm5leHQoImRpdi5jaG9zZW4tY29udGFpbmVyIikuZmluZCgiaW5wdXQiKS5yZW1vdmVBdHRyKCJhcmlhLWFjdGl2ZWRlc2NlbmRhbnQiKTsNCiAgICB0aGlzb2JqLm5leHQoImRpdi5jaG9zZW4tY29udGFpbmVyIikuZmluZCgidWwuY2hvc2VuLXJlc3VsdHMgbGkiKS5lYWNoKGZ1bmN0aW9uKGkpIHsNCiAgICAkKHRoaXMpLmF0dHIoeyJpZCI6dGhpc2lkK2ksInJvbGUiOiJvcHRpb24iLCJ0YWJpbmRleCI6LTF9KTsNCiAgICBpZigkKHRoaXMpLmhhc0NsYXNzKCJoaWdobGlnaHRlZCIpKSB7DQogICAgICAkKCIjIitzaXRzX2RvX2dldF9vYmplY3QodGhpc2lkKSkubmV4dCgiZGl2LmNob3Nlbi1jb250YWluZXIiKS5maW5kKCJpbnB1dCIpLmF0dHIoImFyaWEtYWN0aXZlZGVzY2VuZGFudCIsdGhpc2lkK2kpOw0KICAgIH0NCiAgfSk7DQp9DQpmdW5jdGlvbiBzaXRzX2RvX2Nob3Nlbl93aWRnZXRfYWNjZXNzaWJpbGl0eSh0aGlzb2JqLGxhYmVsdGV4dCkgew0KICB2YXIgdGhpc2lkID0gdGhpc29iai5hdHRyKCJpZCIpOw0KICB2YXIgZGF0YXR0aXAgPSB0aGlzb2JqLmF0dHIoImRhdGEtdHRpcCIpIHx8ICIiOw0KICB2YXIgY2hvc2VuY29udGFpbmVyID0gdGhpc29iai5uZXh0KCJkaXYuY2hvc2VuLWNvbnRhaW5lciIpOw0KICAvL2FjY2Vzc2liaWxpdHkgY29kZQ0KICB2YXIgdWxJZCA9IHRoaXNvYmouYXR0cigiaWQiKSsiX3VsIjsNCiAgdmFyIGF0dHJzID0gew0KICAgICJhcmlhLW93bnMiOnVsSWQsDQogICAgLy8iYXJpYS1hdXRvY29tcGxldGUiOiJsaXN0IiwNCiAgICAicm9sZSI6ImNvbWJvYm94IiwNCiAgICAvLyAiYXJpYS1sYWJlbGxlZGJ5IjosDQogICAgInRhYmluZGV4IjoiMCIsDQogICAgLy8iYXJpYS1yZWFkb25seSI6InRydWUiLA0KICAgICJhcmlhLWFjdGl2ZWRlc2NlbmRhbnQiOiIiDQogIH07DQogIHZhciBhdHRyczIgPSB7DQogICAgInJvbGUiOiJjb21ib2JveCIsDQogICAgInRhYmluZGV4IjoiLTEiLA0KICAgICJhcmlhLWV4cGFuZGVkIjoiZmFsc2UiLA0KICAgICJpZCI6dWxJZA0KICB9DQogIGlmKGRhdGF0dGlwIT0iIikgew0KICAgIGNob3NlbmNvbnRhaW5lci5hdHRyKCJkYXRhLXR0aXAiLGRhdGF0dGlwKTsNCiAgfQ0KICBjaG9zZW5jb250YWluZXIuZmluZCgiZGl2LmNob3Nlbi1zZWFyY2ggaW5wdXQiKS5hdHRyKGF0dHJzKTsNCiAgY2hvc2VuY29udGFpbmVyLmZpbmQoInVsLmNob3Nlbi1yZXN1bHRzIikuYXR0cihhdHRyczIpOw0KICBzaXRzX2RvX2Nob3Nlbl93aWRnZXRfYWNjZXNzaWJpbGl0eV9kZXNjKHRoaXNvYmopOw0KICB0aGlzb2JqLm5leHQoImRpdi5jaG9zZW4tY29udGFpbmVyLW11bHRpIikuYXR0cigidGFiaW5kZXgiLCIwIik7DQogIGlmKHR5cGVvZihsYWJlbHRleHQpPT0ic3RyaW5nIikgew0KICAgIHRoaXNvYmoubmV4dCgiZGl2LmNob3Nlbi1jb250YWluZXItbXVsdGkiKS5hdHRyKCJhcmlhLWxhYmVsIixsYWJlbHRleHQpOw0KICB9DQogIC8vIGZvY3VzIG9uIHNpbmdsZSBzZWxlY3QgZ2V0IHNjcmVlbiByZWFkZXIgdG8gcmVhZCBvdXQgdmFsdWUNCiAgdmFyIHNpbmdsZURpdklkID0gdGhpc29iai5uZXh0KCJkaXYuY2hvc2VuLWNvbnRhaW5lci1zaW5nbGUiKS5hdHRyKCJpZCIpOw0KICBpZih0eXBlb2Yoc2luZ2xlRGl2SWQpPT0ic3RyaW5nIikgew0KICAgIHRoaXNvYmoubmV4dCgiZGl2LmNob3Nlbi1jb250YWluZXItc2luZ2xlIikuYXR0cigidGFiaW5kZXgiLCItMSIpLmZpbmQoInNwYW46Zmlyc3QiKS5hdHRyKCJpZCIsc2luZ2xlRGl2SWQrInNwYW4iKTsNCiAgfQ0KICB0aGlzb2JqLm5leHQoImRpdi5jaG9zZW4tY29udGFpbmVyLXNpbmdsZSIpLmZpbmQoImlucHV0OmZpcnN0IikuYXR0cigidGl0bGUiLCQoIiMiK3NpbmdsZURpdklkKyJzcGFuIikuaHRtbCgpKTsNCn0NCi8vQ3JlYXRlcyBhIHRhYiBzZXQgd2l0aCBhdXRvLXNpemluZyB0YWJzDQovLyBzdHJpbmcgICBzZWwgOiBpbiA7alF1ZXJ5IHNlbGVjdG9yIHRvIGFwcGx5IHRoZSB0YWJzIHRvIChvciBlbGVtZW50KQ0KLy8gb2JqZWN0ICAgb3B0IDogaW4gO29iamVjdCBjb250YWluaW5nIG9wdGlvbnMgZm9yIHRhYnMNCi8vIGJvb2xlYW4gIGNscyA6IGluIDthbGxvdyB0YWJzIHRvIGJlIGNsb3NlZD8gKGRlZmF1bHQgaXMgZmFsc2UpDQovLyBib29sZWFuICByc3ogOiBpbiA7YXV0by1yZXNpemUgdGFicz8gKGRlZmF1bHQgaXMgdHJ1ZSkNCmZ1bmN0aW9uIHNpdHNfdGFicyhzZWwsb3B0LGNscyxyc3opIHsNCiAgdmFyIG9iaiA9ICQoc2VsKTsNCiAgaWYob2JqLmxlbmd0aDwxKSB7DQogICAgcmV0dXJuIGZhbHNlOyAvL25vIG9iamVjdHMgZm91bmQNCiAgfQ0KICBpZighb3B0KSB7DQogICAgb3B0ID0ge307DQogIH0NCiAgaWYoIW9wdC5hY3RpdmUpIHsNCiAgICBvcHQuYWN0aXZlID0gMDsgLy9sb2FkIGZpcnN0IHRhYiBmaXJzdA0KICB9DQogIHZhciB0YWIgPSBvYmoudGFicyhvcHQpOyAvL2NvbnZlcnQgdG8gdGFiIHNldA0KICB2YXIgbmF2ID0gdGFiLmNoaWxkcmVuKCJ1bC51aS10YWJzLW5hdiIpOw0KICBpZihuYXYubGVuZ3RoPDEpIHsNCiAgICBuYXYgPSB0YWIuY2hpbGRyZW4oImRpdi51aS10YWJzLXNjcm9sbC10YWJzIikuY2hpbGRyZW4oImRpdi51aS10YWJzLXNjcm9sbC13cmFwIikuY2hpbGRyZW4oInVsLnVpLXRhYnMtbmF2Iik7DQogIH0NCiAgdmFyIGFuYyA9IG5hdi5jaGlsZHJlbigibGkiKS5jaGlsZHJlbigiYS51aS10YWJzLWFuY2hvciIpOyAvL29ubHkgY2hpbGRyZW4gaW4gY2FzZSBvZiBuZXN0ZWQgdGFicw0KICBhbmMuZWFjaChmdW5jdGlvbigpIHsNCiAgICB2YXIgb2xpID0gJCh0aGlzKS5wYXJlbnQoKTsNCiAgICBpZighb2xpLmF0dHIoInRpdGxlIikgfHwgb2xpLmF0dHIoInRpdGxlIik9PSIiKSB7DQogICAgICBvbGkuYXR0cigidGl0bGUiLCQodGhpcykudGV4dCgpKTsgLy9zZXQgYW5jaG9yIHRpdGxlIGlmIGJsYW5rDQogICAgfQ0KICB9KTsNCiAgaWYodHlwZW9mKGNscyk9PSJib29sZWFuIiAmJiBjbHMpIHsgLy9hbGxvdyB0YWJzIHRvIGJlIGNsb3NlZCAoZGVmYXVsdCBmYWxzZSkNCiAgICB0YWIuYWRkQ2xhc3MoInVpLXRhYnMtY2FuY2xvc2UiKTsNCiAgICBpZihhbmMubGVuZ3RoPjEpIHsNCiAgICAgIHZhciB0eHQgPSBzaXRzX3dpZGdldF9icC51aSAmJiBzaXRzX3dpZGdldF9icC51aS50YWJzQ2xvc2UgfHwgIkNsb3NlIjsgLy9idWlsZCBjbG9zZSBpY29uDQogICAgICB2YXIgaHRtID0gIjxzcGFuIGNsYXNzPVwidWktaWNvbiB1aS1pY29uLWNsb3NlXCIgcm9sZT1cImJ1dHRvblwiIHRhYmluZGV4PVwiMFwiPiIrdHh0KyI8L3NwYW4+IjsNCiAgICAgIGFuYy5hZGRDbGFzcygidWktdGFicy1jYW5jbG9zZSIpLmFwcGVuZChodG0pOyAvL2FkZCBjbG9zZSBpY29ucw0KICAgIH0NCiAgICB0YWIub24oIm1vdXNlZG93biBrZXlkb3duIiwic3Bhbi51aS1pY29uLWNsb3NlIixmdW5jdGlvbihldnQpIHsgLy9oYW5kbGUgY2xpY2sgb24gY2xvc2UgaWNvbg0KICAgICAgaWYoZXZ0LnR5cGU9PSJrZXlkb3duIiAmJiBldnQud2hpY2ghPTEzICYmIGV2dC53aGljaCE9MzIpIHsgLy9jaGVjayBmb3IgcmV0dXJuIG9yIHNwYWNlIGtleQ0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgIH0NCiAgICAgIGlmKGV2dC50eXBlPT0ibW91c2Vkb3duIiAmJiBldnQud2hpY2ghPTEpIHsgLy9jaGVjayBmb3IgbGVmdCBjbGljaw0KICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgIH0NCiAgICAgIHZhciB0aHMgPSAkKHRoaXMpOw0KICAgICAgdmFyIGxpcyA9IHRocy5jbG9zZXN0KCJ1bCIpLmNoaWxkcmVuKCJsaSIpOyAvL2dldCB0YWJzDQogICAgICB2YXIgc3BuID0gbGlzLmNoaWxkcmVuKCJhIikuY2hpbGRyZW4oInNwYW4udWktaWNvbi1jbG9zZSIpOyAvL2dldCByZW1haW5pbmcgY2xvc2UgaWNvbnMNCiAgICAgIHZhciBpbmQgPSBzcG4uaW5kZXgodGhzKSsxOw0KICAgICAgdmFyIHRpZCA9IHRocy5jbG9zZXN0KCJsaSIpLnJlbW92ZSgpLmF0dHIoImFyaWEtY29udHJvbHMiKTsgLy9yZW1vdmUgdGFiIGFuZCBnZXQgaWQNCiAgICAgICQoIiMiK3RpZCkucmVtb3ZlKCk7IC8vcmVtb3ZlIHRoZSB0YWIgY29udGVudHMNCiAgICAgIGlmKHNwbi5sZW5ndGg8Mykgew0KICAgICAgICBzcG4uY2xvc2VzdCgiYS51aS10YWJzLWFuY2hvciIpLnJlbW92ZUNsYXNzKCJ1aS10YWJzLWNhbmNsb3NlIik7DQogICAgICAgIHNwbi5yZW1vdmUoKTsgLy9oaWRlIGNyb3NzIGlmIG9ubHkgb25lIHRhYiBsZWZ0DQogICAgICB9DQogICAgICB0YWIudGFicygicmVmcmVzaCIpOyAvL3JlZnJlc2ggdGhlIHRhYiBzZXQNCiAgICAgIHNpdHNfdGFic19yZXNpemUoKTsgLy9yZXNpemUgYWZ0ZXIgdGFiIHJlbW92ZWQNCiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7DQogICAgICAgIGxpcy5maWx0ZXIoIi51aS10YWJzLWFjdGl2ZSIpLmZvY3VzKCk7IC8vZm9jdXMgb24gYWN0aXZlIHRhYiAoYWZ0ZXIgZXZlbnQpDQogICAgICB9LDApOw0KICAgICAgaWYoZXZ0LnR5cGU9PSJrZXlkb3duIikgew0KICAgICAgICByZXR1cm4gc2l0c19jYW5jZWxfZXZlbnQoZXZ0KTsNCiAgICAgIH0NCiAgICB9KTsNCiAgICB0YWIub24oInRhYnNiZWZvcmVhY3RpdmF0ZSIsZnVuY3Rpb24oZXZ0LHVpKSB7DQogICAgICB2YXIgc3BuID0gdWkubmV3VGFiLmNoaWxkcmVuKCJhIikuY2hpbGRyZW4oInNwYW4iKTsNCiAgICAgIGlmKHNwbi5sZW5ndGg9PTEgJiYgc3BuLmdldCgwKT09ZG9jdW1lbnQuYWN0aXZlRWxlbWVudCkgew0KICAgICAgICByZXR1cm4gZmFsc2U7IC8vY2FuY2VsIGFjdGl2YXRlIGlzIHRhYiBpcyBjbG9zaW5nDQogICAgICB9DQogICAgfSk7DQogICAgaWYoIXNpdHNfZXZlbnRzLnRhYnNDbG9zZUZvY3VzKSB7DQogICAgICAkKGRvY3VtZW50KS5vbigiZm9jdXMiLCJzcGFuLnVpLWljb24tY2xvc2UiLGZ1bmN0aW9uKGV2dCkgew0KICAgICAgICB2YXIgdHJnID0gZXZ0LnRhcmdldDsNCiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHsNCiAgICAgICAgICBzaXRzX2RvX3RhYnNfc2Nyb2xsKHRyZyk7IC8vY2hlY2sgY2hldnJvbnMgKGFmdGVyIGZvY3VzLCBub3QgZHVyaW5nKQ0KICAgICAgICB9LDApOw0KICAgICAgfSk7DQogICAgICBzaXRzX2V2ZW50cy50YWJzQ2xvc2VGb2N1cyA9IHRydWU7DQogICAgfQ0KICB9DQogIGlmKHR5cGVvZihyc3opIT0iYm9vbGVhbiIgfHwgcnN6KSB7IC8vYXV0by1yZXNpemUgKGRlZmF1bHQgdHJ1ZSkNCiAgICB0YWIuYWRkQ2xhc3MoInVpLXRhYnMtYXV0b3NpemUiKTsNCiAgICBhbmMuYWRkQ2xhc3MoInVpLXRhYnMtYXV0b3NpemUiKTsNCiAgICBpZighc2l0c19ldmVudHMudGFic1Jlc2l6ZSkgew0KICAgIAlzaXRzX2lzX3Jlc2l6ZWQoIlNpdHNUYWJzIik7IC8vaW5pdGlhbGlzZSBhdXRvLXJlc2l6ZSB3aWR0aA0KICAgICAgJCh3aW5kb3cpLm9uKCJyZXNpemUiLHNpdHNfZGVib3VuY2VfZXZlbnQoc2l0c19kb190YWJzX3Jlc2l6ZSwyNTApKTsNCiAgICAgIHNpdHNfZXZlbnRzLnRhYnNSZXNpemUgPSB0cnVlOw0KICAgIH0NCiAgICBzZXRUaW1lb3V0KCJzaXRzX3RhYnNfcmVzaXplKCkiLDI1MCk7IC8vcmVzaXplIGFmdGVyIGNyb3NzZXMgZHJhd24NCiAgfQ0KICByZXR1cm4gdHJ1ZTsNCn0NCg0KLy9JbnRlcm5hbCBmdW5jdGlvbiB0byBkZWFsIHdpdGggd2luZG93IHJlc2l6aW5nIGFuZCB0YWJzDQpmdW5jdGlvbiBzaXRzX2RvX3RhYnNfcmVzaXplKCkgew0KCS8vZGV0ZXJtaW5lIHdoZXRoZXIgdGhlIHdpbmRvdyBzaXplIGhhcyBhY3R1YWxseSBjaGFuZ2VkIC0gZGVhbCB3aXRoIGlzc3VlcyBpbiBJT1MgYW5kIElFOCB3aGVyZSByZXNpemUgY2FuIGJlIHRyaWdnZXJlZCBldmVuIGlmIHRoZSB3aW5kb3cgc2l6ZSBoYXNuJ3QgY2hhbmdlZA0KCWlmKHNpdHNfaXNfcmVzaXplZCgiU2l0c1RhYnMiKT09PSJub25lIil7DQoJCXJldHVybjsNCgl9DQoNCgkvL3Jlc2l6ZSB0aGUgdGFicw0KCXNpdHNfdGFic19yZXNpemUoKTsNCn0NCg0KLy9DYXB0dXJlcyBzY3JlZW4gcmVzaXplIGZvciB0YWJzDQpmdW5jdGlvbiBzaXRzX3RhYnNfcmVzaXplKCkgew0KICAkKCJkaXYudWktdGFicy1hdXRvc2l6ZSIpLmVhY2goZnVuY3Rpb24oKSB7IC8vbG9vcCB0aHJvdWdoIHRhYiBzZXRzDQogICAgdmFyIHRhYiA9ICQodGhpcyk7DQogICAgdmFyIG5hdiA9IHRhYi5jaGlsZHJlbigidWwudWktdGFicy1uYXYiKTsgLy9vbmx5IGNoaWxkcmVuIGluIGNhc2Ugb2YgbmVzdGVkIHRhYnMNCiAgICBpZihuYXYubGVuZ3RoPDEpIHsNCiAgICAgIG5hdiA9IHRhYi5jaGlsZHJlbigiZGl2LnVpLXRhYnMtc2Nyb2xsLXRhYnMiKS5jaGlsZHJlbigiZGl2LnVpLXRhYnMtc2Nyb2xsLXdyYXAiKS5jaGlsZHJlbigidWwudWktdGFicy1uYXYiKTsNCiAgICB9DQogICAgdmFyIGxpcyA9IG5hdi5jaGlsZHJlbigibGkiKTsNCiAgICB2YXIgYWN0ID0gbGlzLmZpbHRlcigiLnVpLXRhYnMtYWN0aXZlIik7IC8vcmVtZW1iZXIgYWN0aXZlIHRhYg0KICAgIHZhciBsZW4gPSBsaXMubGVuZ3RoOw0KICAgIHZhciBiaWcgPSAwOw0KICAgIHZhciB0b3QgPSAwOw0KICAgIHZhciBtYXggPSB0YWIuaW5uZXJXaWR0aCgpOyAvL2NhbGN1bGF0ZSBtYXhpbXVtIHdpZHRoIGF2YWlsYWJsZQ0KICAgIGlmKG1heD09MCkgew0KICAgICAgcmV0dXJuOyAvL2Nhbid0IGNhbGN1bGF0ZSBpZiBtYXhpbXVtIHdpZHRoIGlzIHplcm8NCiAgICB9DQogICAgdmFyIGludyA9IG1heDsNCiAgICBtYXggLT0gc2l0c19nZXRfaW50ZWdlcih0YWIuY3NzKCJwYWRkaW5nLXJpZ2h0IikpOw0KICAgIG1heCAtPSBzaXRzX2dldF9pbnRlZ2VyKHRhYi5jc3MoInBhZGRpbmctbGVmdCIpKTsNCiAgICBtYXggLT0gc2l0c19nZXRfaW50ZWdlcihuYXYuY3NzKCJwYWRkaW5nLXJpZ2h0IikpOw0KICAgIG1heCAtPSBzaXRzX2dldF9pbnRlZ2VyKG5hdi5jc3MoInBhZGRpbmctbGVmdCIpKTsNCiAgICBsaXMuZWFjaChmdW5jdGlvbihpKSB7DQogICAgICB2YXIgb2xpID0gJCh0aGlzKTsNCiAgICAgIHZhciB3ZHQgPSBvbGkuZGF0YSgib3JpZy13aWR0aCIpOyAvL2dldCBzdG9yZWQgdGFiIHdpZHRoDQogICAgICBpZih0eXBlb2Yod2R0KT09InVuZGVmaW5lZCIgfHwgd2R0PT0iIiB8fCB3ZHQ8c2l0c19taW5fdGFiX3dpZHRoKSB7DQogICAgICAgIG9saS5jaGlsZHJlbigiYS51aS10YWJzLWFuY2hvciIpLmNzcygid2lkdGgiLCIiKTsgLy9jbGVhciBhbmNob3IgZml4ZWQgd2lkdGgNCiAgICAgICAgd2R0ID0gc2l0c19nZXRfaW50ZWdlcihvbGkub3V0ZXJXaWR0aCh0cnVlKSk7IC8vY2FsY3VsYXRlIHRhYiB3aWR0aA0KICAgICAgICBvbGkuZGF0YSgib3JpZy13aWR0aCIsd2R0KTsgLy9zdG9yZSBmb3IgbmV4dCB0aW1lDQogICAgICB9DQogICAgICBpZih3ZHQ+YmlnKSB7DQogICAgICAgIGJpZyA9IHdkdCsxOyAvL2NhbGN1bGF0ZSBiaWdnZXN0IHRhYiB3aWR0aA0KICAgICAgfQ0KICAgICAgdG90ICs9IHdkdDsgLy9jYWxjdWxhdGUgdG90YWwgdGFiIHdpZHRoDQogICAgICBtYXggLT0gc2l0c19nZXRfaW50ZWdlcihvbGkuY3NzKCJtYXJnaW4tcmlnaHQiKSk7IC8vYWNjb3VudCBmb3IgbWFyZ2lucw0KICAgICAgbWF4IC09IHNpdHNfZ2V0X2ludGVnZXIob2xpLmNzcygibWFyZ2luLWxlZnQiKSk7DQogICAgfSk7DQogICAgdmFyIHdycCA9IG5hdi5wYXJlbnQoImRpdi51aS10YWJzLXNjcm9sbC13cmFwIik7IC8vZ2V0IHNjcm9sbCB3cmFwcGVyIChtYXkgbm90IGV4aXN0KQ0KICAgIHZhciB3ZHQgPSBiaWc7DQogICAgaWYobGVuKmJpZz5tYXgpIHsNCiAgICAgIHdkdCA9IE1hdGgubWF4KHNpdHNfZ2V0X2ludGVnZXIobWF4L2xlbiksc2l0c19taW5fdGFiX3dpZHRoKTsgLy9maWxsIHNwYWNlIHdpdGggZXF1YWxseSBzaXplZCB0YWJzDQogICAgICB0b3QgPSBsZW4qd2R0Ly8rbGVuOyAvL3VwZGF0ZSB0b3RhbCAoY29udHJvbHMgc2Nyb2xsaW5nKQ0KICAgIH0NCiAgICBsaXMuZWFjaChmdW5jdGlvbihpKSB7IC8vcmVzaXplIHRhYnMNCiAgICAgIHZhciBvbGkgPSAkKHRoaXMpOw0KICAgICAgdmFyIGFuYyA9IG9saS5jaGlsZHJlbigiYS51aS10YWJzLWFuY2hvciIpOyAvL2dldCBhbmNob3Igb2JqZWN0DQogICAgICB2YXIgY3VyID0gc2l0c19nZXRfaW50ZWdlcihhbmMud2lkdGgoKSk7IC8vZ2V0IGN1cnJlbnQgd2lkdGgNCiAgICAgIHZhciBkaWYgPSBzaXRzX2dldF9pbnRlZ2VyKG9saS5vdXRlcldpZHRoKHRydWUpKS13ZHQ7IC8vY2FsY3VsYXRlIGRpZmZlcmVuY2UNCiAgICAgIHZhciBub3cgPSBNYXRoLm1heChjdXItZGlmLTEsMCk7IC8vY2FsY3VsYXRlIG5ldyB3aWR0aA0KICAgICAgYW5jLndpZHRoKG5vdysicHgiKTsgLy9yZXNpemUgYW5jaG9yDQogICAgfSk7DQogICAgaWYodG90Pm1heCkgeyAvL25lZWRzIHRvIHNjcm9sbA0KICAgICAgdmFyIGlldiA9IHNpdHNfaWVfc3VwcG9ydGVkKCk7DQogICAgICBpZihpZXYhPSJJRV84IiAmJiBpZXYhPSJJRV9VTlNVUFBPUlRFRCIpIHsgLy9kb24ndCBzY3JvbGwgZm9yIG9sZCBJRQ0KICAgICAgICBpZih3cnAubGVuZ3RoPT0wKSB7DQogICAgICAgICAgbmF2LndyYXAoIjxkaXYgY2xhc3M9XCJ1aS10YWJzLXNjcm9sbC13cmFwXCI+Iik7IC8vYWRkIHdyYXBwZXIgYW5kIGNoZXZyb25zDQogICAgICAgICAgd3JwID0gbmF2LnBhcmVudCgiZGl2LnVpLXRhYnMtc2Nyb2xsLXdyYXAiKTsNCiAgICAgICAgICB3cnAud3JhcCgiPGRpdiBjbGFzcz1cInVpLXRhYnMtc2Nyb2xsLXRhYnNcIj4iKTsNCiAgICAgICAgICB2YXIgbGZ0ID0gc2l0c193aWRnZXRfYnAudWkgJiYgc2l0c193aWRnZXRfYnAudWkudGFic1Njcm9sbExlZnQgfHwgIlNjcm9sbCBsZWZ0IjsNCiAgICAgICAgICB2YXIgcmd0ID0gc2l0c193aWRnZXRfYnAudWkgJiYgc2l0c193aWRnZXRfYnAudWkudGFic1Njcm9sbFJpZ2h0IHx8ICJTY3JvbGwgcmlnaHQiOw0KICAgICAgICAgIHdycC5wcmVwZW5kKCI8c3BhbiBjbGFzcz1cInVpLXRhYnMtc2Nyb2xsLWxlZnQgZ2x5cGhpY29uIGdseXBoaWNvbi1jaGV2cm9uLWxlZnQgc3YtZGlzYWJsZWRcIiByb2xlPVwiYnV0dG9uXCIgYXJpYS1kaXNhYmxlZD1cInRydWVcIiB0aXRsZT1cIiIrbGZ0KyJcIiB0YWJpbmRleD1cIjBcIj4iKTsNCiAgICAgICAgICB3cnAuYXBwZW5kKCI8c3BhbiBjbGFzcz1cInVpLXRhYnMtc2Nyb2xsLXJpZ2h0IGdseXBoaWNvbiBnbHlwaGljb24tY2hldnJvbi1yaWdodFwiIHJvbGU9XCJidXR0b25cIiB0aXRsZT1cIiIrcmd0KyJcIiB0YWJpbmRleD1cIjBcIj4iKTsNCiAgICAgICAgfQ0KICAgICAgICBuYXYud2lkdGgodG90KTsgLy9lbnN1cmUgYWxsIHRhYnMgZml0IG9uIG9uZSBsaW5lDQogICAgICAgIGludyAtPSBzaXRzX2dldF9pbnRlZ2VyKHdycC5jc3MoIm1hcmdpbi1yaWdodCIpKTsNCiAgICAgICAgaW53IC09IHNpdHNfZ2V0X2ludGVnZXIod3JwLmNzcygibWFyZ2luLWxlZnQiKSk7DQogICAgICAgIHdycC53aWR0aChpbncpOyAvL2ZpeCBmb3IgRmlyZWZveCBub3Qgd29ya2luZyB3aXRoIHRhYnMgaW4gZGlhbG9ncw0KICAgICAgICB2YXIgc2NyID0gMDsNCiAgICAgICAgaWYoYWN0Lmxlbmd0aD09MSkgew0KICAgICAgICAgIHNjciA9IE1hdGgubWF4KGFjdC5vZmZzZXQoKS5sZWZ0LWxpcy5maWx0ZXIoIjpmaXJzdCIpLm9mZnNldCgpLmxlZnQsMCk7IC8vbWFrZSBhY3RpdmUgdGFiIHZpc2libGUNCiAgICAgICAgfQ0KICAgICAgICB3cnAuYW5pbWF0ZSh7InNjcm9sbExlZnQiOnNjcisicHgifSxzaXRzX2FuaW1fc3BlZWQsInN3aW5nIixmdW5jdGlvbigpIHsgLy9zY3JvbGwgdG8gZmFyIGxlZnQgb3IgYWN0aXZlIHRhYg0KICAgICAgICAgIHNpdHNfZG9fdGFic19zY3JvbGwod3JwKTsgLy9jaGVjayBzY3JvbGwgYXJyb3dzDQogICAgICAgIH0pOw0KICAgICAgICBpZighc2l0c19ldmVudHMudGFic1Njcm9sbENsaWNrKSB7DQogICAgICAgICAgJChkb2N1bWVudCkub24oIm1vdXNlZG93biBrZXlkb3duIiwiLnVpLXRhYnMtc2Nyb2xsLWxlZnQsLnVpLXRhYnMtc2Nyb2xsLXJpZ2h0IixmdW5jdGlvbihldnQpIHsgLy9oYW5kbGUgc2Nyb2xsaW5nDQogICAgICAgICAgICBpZihldnQudHlwZT09ImtleWRvd24iICYmIGV2dC53aGljaCE9MTMgJiYgZXZ0LndoaWNoIT0zMikgeyAvL2NoZWNrIGZvciByZXR1cm4gb3Igc3BhY2Uga2V5DQogICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgaWYoZXZ0LnR5cGU9PSJtb3VzZWRvd24iICYmIGV2dC53aGljaCE9MSkgeyAvL2NoZWNrIGZvciBsZWZ0IGNsaWNrDQogICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgc2l0c19kb190YWJzX3Njcm9sbChldnQudGFyZ2V0KTsgLy9zY3JvbGwgdGFicw0KICAgICAgICAgICAgaWYoZXZ0LnR5cGU9PSJrZXlkb3duIikgew0KICAgICAgICAgICAgICByZXR1cm4gc2l0c19jYW5jZWxfZXZlbnQoZXZ0KTsgLy9jYW5jZWwgZXZlbnQNCiAgICAgICAgICAgIH0NCiAgICAgICAgICB9KTsNCiAgICAgICAgICBzaXRzX2V2ZW50cy50YWJzU2Nyb2xsQ2xpY2sgPSB0cnVlOw0KICAgICAgICB9DQogICAgICB9DQogICAgfQ0KICAgIGVsc2UgeyAvL3JlbW92ZSBzY3JvbGxpbmcNCiAgICAgIGlmKHdycC5sZW5ndGg9PTEpIHsNCiAgICAgICAgd3JwLnNjcm9sbExlZnQoMCkuY2hpbGRyZW4oIi51aS10YWJzLXNjcm9sbC1sZWZ0LC51aS10YWJzLXNjcm9sbC1yaWdodCIpLnJlbW92ZSgpOyAvL3JlbW92ZSBjaGV2cm9ucw0KICAgICAgICB2YXIgdG1wID0gbmF2LmNzcygid2lkdGgiLCIiKS51bndyYXAoKS51bndyYXAoKTsgLy9yZW1vdmUgd3JhcHBlcg0KICAgICAgfQ0KICAgIH0NCiAgfSk7DQogIHJldHVybiB0cnVlOw0KfQ0KDQovL0ludGVybmFsIGZ1bmN0aW9uIHRvIHNjcm9sbCB0YWJzIGxlZnQvcmlnaHQNCi8vIGVsZW1lbnQgIG9iaiA6IGluIDtlbGVtZW50IHdoaWNoIHdhcyBjbGlja2VkICgudWktdGFicy1zY3JvbGwtbGVmdCBvciAtcmlnaHQpDQpmdW5jdGlvbiBzaXRzX2RvX3RhYnNfc2Nyb2xsKG9iaikgew0KICB2YXIgc3BuID0gJChvYmopOw0KICBpZihzcG4ubGVuZ3RoIT0xKSB7DQogICAgcmV0dXJuIGZhbHNlOw0KICB9DQogIHZhciB0YWIgPSBzcG4uY2xvc2VzdCgiLnVpLXRhYnMiKTsgLy9nZXQgdGFiIGVsZW1lbnQNCiAgdmFyIHdycCA9IHRhYi5jaGlsZHJlbigiZGl2LnVpLXRhYnMtc2Nyb2xsLXRhYnMiKS5jaGlsZHJlbigiZGl2LnVpLXRhYnMtc2Nyb2xsLXdyYXAiKTsgLy9vbmx5IGNoaWxkcmVuIGluIGNhc2Ugb2YgbmVzdGVkIHRhYnMNCiAgdmFyIG5hdiA9IHdycC5jaGlsZHJlbigidWwudWktdGFicy1uYXYiKTsNCiAgdmFyIHdkdCA9IHdycC53aWR0aCgpOw0KICB2YXIgZ2FwID0gc2l0c19nZXRfaW50ZWdlcih3ZHQvNCk7IC8vMjUlIG9mIHRoZSB3aWR0aA0KICB2YXIgZW5kID0gbmF2LndpZHRoKCktd2R0OyAvL2Z1cnRoZXN0IHBvc2l0aW9uDQogIHZhciBsZnQgPSBzaXRzX2dldF9pbnRlZ2VyKHdycC5zY3JvbGxMZWZ0KCkgfHwgMCk7IC8vZ2V0IGN1cnJlbnQgc2Nyb2xsIHBvc2l0aW9uDQogIHZhciBvcmcgPSBsZnQ7DQogIGlmKHNwbi5oYXNDbGFzcygidWktdGFicy1zY3JvbGwtbGVmdCIpKSB7DQogICAgbGZ0ID0gTWF0aC5tYXgobGZ0LWdhcCwwKTsgLy9zY3JvbGwgbGVmdCAoYnV0IG5vdCBiZXlvbmQgc3RhcnQgcG9zaXRpb24pDQogIH0NCiAgaWYoc3BuLmhhc0NsYXNzKCJ1aS10YWJzLXNjcm9sbC1yaWdodCIpKSB7DQogICAgbGZ0ID0gTWF0aC5taW4obGZ0K2dhcCxlbmQpOyAvL3Njcm9sbCByaWdodCAoYnV0IG5vdCBiZXlvbmQgZW5kIHBvc2l0aW9uKQ0KICB9DQogIGlmKGxmdCE9b3JnKSB7DQogICAgd3JwLmFuaW1hdGUoeyJzY3JvbGxMZWZ0IjpsZnQrInB4In0sc2l0c19hbmltX3NwZWVkKTsgLy9tb3ZlIHRvIG5ldyBzY3JvbGwgcG9zaXRpb24NCiAgfQ0KICBpZihsZnQ9PTApIHsNCiAgICB3cnAuY2hpbGRyZW4oIi51aS10YWJzLXNjcm9sbC1sZWZ0IikuYWRkQ2xhc3MoInN2LWRpc2FibGVkIikuYXR0cigiYXJpYS1kaXNhYmxlZCIsdHJ1ZSk7DQogIH0NCiAgZWxzZSB7DQogICAgd3JwLmNoaWxkcmVuKCIudWktdGFicy1zY3JvbGwtbGVmdCIpLnJlbW92ZUNsYXNzKCJzdi1kaXNhYmxlZCIpLnJlbW92ZUF0dHIoImFyaWEtZGlzYWJsZWQiKTsNCiAgfQ0KICBpZihsZnQ9PWVuZCkgew0KICAgIHdycC5jaGlsZHJlbigiLnVpLXRhYnMtc2Nyb2xsLXJpZ2h0IikuYWRkQ2xhc3MoInN2LWRpc2FibGVkIikuYXR0cigiYXJpYS1kaXNhYmxlZCIsdHJ1ZSk7DQogIH0NCiAgZWxzZSB7DQogICAgd3JwLmNoaWxkcmVuKCIudWktdGFicy1zY3JvbGwtcmlnaHQiKS5yZW1vdmVDbGFzcygic3YtZGlzYWJsZWQiKS5yZW1vdmVBdHRyKCJhcmlhLWRpc2FibGVkIik7DQogIH0NCiAgcmV0dXJuIHRydWU7DQp9DQoNCi8vUmVmcmVzaCB0aGUgdGFicyBmcm9tIHRoZSBzb3VyY2UNCi8vIHN0cmluZyAgIHNlbCA6IGluIDtqUXVlcnkgc2VsZWN0b3IgdG8gcmVmcmVzaCB0aGUgdGFicyBvZiAob3IgZWxlbWVudCkNCmZ1bmN0aW9uIHNpdHNfdGFic19yZWZyZXNoKHNlbCkgew0KICB2YXIgb2JqID0gJChzZWwpLmZpbHRlcigiLnVpLXRhYnMiKTsNCiAgaWYob2JqLmxlbmd0aDwxKSB7DQogICAgcmV0dXJuIGZhbHNlOyAvL25vIG9iamVjdHMgZm91bmQNCiAgfQ0KICB2YXIgcnN6ID0gZmFsc2U7DQogIG9iai5lYWNoKGZ1bmN0aW9uKGkpIHsNCiAgICB2YXIgdGFiID0gJCh0aGlzKS50YWJzKCJyZWZyZXNoIik7IC8vcmVmcmVzaCB0aGUgdGFiIHNldA0KICAgIHZhciBuYXYgPSB0YWIuY2hpbGRyZW4oInVsLnVpLXRhYnMtbmF2Iik7DQogICAgaWYobmF2Lmxlbmd0aDwxKSB7DQogICAgICBuYXYgPSB0YWIuY2hpbGRyZW4oImRpdi51aS10YWJzLXNjcm9sbC10YWJzIikuY2hpbGRyZW4oImRpdi51aS10YWJzLXNjcm9sbC13cmFwIikuY2hpbGRyZW4oInVsLnVpLXRhYnMtbmF2Iik7DQogICAgfQ0KICAgIHZhciBhbmMgPSBuYXYuY2hpbGRyZW4oImxpIikuY2hpbGRyZW4oImEudWktdGFicy1hbmNob3IiKTsgLy9vbmx5IGNoaWxkcmVuIGluIGNhc2Ugb2YgbmVzdGVkIHRhYnMNCiAgICBhbmMuZWFjaChmdW5jdGlvbigpIHsNCiAgICAgIHZhciBvbGkgPSAkKHRoaXMpLnBhcmVudCgpOw0KICAgICAgaWYoIW9saS5hdHRyKCJ0aXRsZSIpIHx8IG9saS5hdHRyKCJ0aXRsZSIpPT0iIikgew0KICAgICAgICBvbGkuYXR0cigidGl0bGUiLCQodGhpcykudGV4dCgpKTsgLy9zZXQgYW5jaG9yIHRpdGxlIGlmIGJsYW5rDQogICAgICB9DQogICAgfSk7DQogICAgaWYodGFiLmhhc0NsYXNzKCJ1aS10YWJzLWNhbmNsb3NlIikgJiYgYW5jLmxlbmd0aD4xKSB7IC8vYWxsb3cgdGFicyB0byBiZSBjbG9zZWQNCiAgICAgIHZhciB0eHQgPSBzaXRzX3dpZGdldF9icC51aSAmJiBzaXRzX3dpZGdldF9icC51aS50YWJzQ2xvc2UgfHwgIkNsb3NlIjsgLy9idWlsZCBjbG9zZSBpY29uDQogICAgICB2YXIgaHRtID0gIjxzcGFuIGNsYXNzPVwidWktaWNvbiB1aS1pY29uLWNsb3NlXCIgcm9sZT1cInByZXNlbnRhdGlvblwiIHRhYmluZGV4PVwiMFwiPiIrdHh0KyI8L3NwYW4+IjsNCiAgICAgIGFuYy5hZGRDbGFzcygidWktdGFicy1jYW5jbG9zZSIpLmFwcGVuZChodG0pOyAvL2FkZCBjbG9zZSBpY29ucw0KICAgIH0NCiAgICBpZih0YWIuaGFzQ2xhc3MoInVpLXRhYnMtYXV0b3NpemUiKSkgeyAvL2F1dG8tcmVzaXplDQogICAgICBhbmMuYWRkQ2xhc3MoInVpLXRhYnMtYXV0b3NpemUiKTsNCiAgICAgIHJzeiA9IHRydWU7DQogICAgfQ0KICB9KTsNCiAgaWYocnN6KSB7DQogICAgc2V0VGltZW91dCgic2l0c190YWJzX3Jlc2l6ZSgpIiwyNTApOyAvL3Jlc2l6ZSBhZnRlciBjcm9zc2VzIGRyYXduDQogIH0NCiAgcmV0dXJuIHRydWU7DQp9DQoNCi8vQ3JlYXRlcyBhbiBhY2NvcmRpb24NCi8vIHN0cmluZyAgIHNlbCA6IGluIDtqUXVlcnkgc2VsZWN0b3IgdG8gYXBwbHkgdGhlIHRhYnMgdG8NCi8vIG9iamVjdCAgIG9wdCA6IGluIDtvYmplY3QgY29udGFpbmluZyBvcHRpb25zIGZvciBhY2NvcmRpb24NCmZ1bmN0aW9uIHNpdHNfYWNjb3JkaW9uKHNlbCxvcHQpIHsNCiAgdmFyIG9iaiA9ICQoc2VsKTsNCiAgaWYob2JqLmxlbmd0aDwxKSB7DQogICAgcmV0dXJuIGZhbHNlOyAvL25vIG9iamVjdHMgZm91bmQNCiAgfQ0KICBpZighb3B0KSB7DQogICAgb3B0ID0ge307DQogIH0NCiAgaWYoIW9wdC5hY3RpdmUpIHsNCiAgICBvcHQuYWN0aXZlID0gMDsgLy9sb2FkIGZpcnN0IHNlY3Rpb24gZmlyc3QNCiAgfQ0KICBpZighb3B0LmFuaW1hdGUpIHsNCiAgICBvcHQuYW5pbWF0ZSA9IHNpdHNfYW5pbV9zcGVlZDsgLy9hbmltYXRlIGF0IHN0YW5kYXJkIHNwZWVkDQogIH0NCiAgdmFyIGFjYyA9IG9iai5hY2NvcmRpb24ob3B0KTsgLy9jb252ZXJ0IHRvIGFjY29yZGlvbg0KICByZXR1cm4gdHJ1ZTsNCn0NCg0KLy9NYWtlcyBhIHBhbmVsIGNvbGxhcHNpYmxlDQovLyBzdHJpbmcgICBzZWwgOiBpbiA7alF1ZXJ5IHNlbGVjdG9yIHRvIGFwcGx5IHRoZSBjb2xsYXBzaWJsZSBmdW5jdGlvbmFsaXR5IHRvDQovLyBib29sZWFuICBleHAgOiBpbiA7ZXhwYW5kIHBhbmVsIGluaXRpYWxseT8oZGVmYXVsdCBpcyB0cnVlKQ0KLy8gZnVuY3Rpb24gZm5jIDogaW4gO2NhbGxiYWNrIGZ1bmN0aW9uIC0gY2FsbGVkIHdoZW4gcGFuZWwgaXMgZXhwYW5kZWQgb3IgY29sbGFwc2VkDQpmdW5jdGlvbiBzaXRzX2NvbGxhcHNpYmxlX3BhbmVsKHNlbCxleHAsZm5jKSB7DQogIHZhciBvYmogPSAkKHNlbCkuZmlsdGVyKCIuc3YtcGFuZWw6bm90KC5zdi1wYW5lbC1jb2xsYXBzaWJsZSkiKTsgLy9jaGVjayBmb3IgcGFuZWwobm90IGFscmVhZHkgY29sbGFwc2libGUpDQogIGlmKG9iai5sZW5ndGg8MSkgew0KICAgIHJldHVybiBmYWxzZTsgLy9ubyBwYW5lbCBmb3VuZA0KICB9DQogIGlmKHR5cGVvZihleHApIT0iYm9vbGVhbiIpIHsNCiAgICBleHAgPSB0cnVlOyAvL2V4cGFuZGVkIGJ5IGRlZmF1bHQNCiAgfQ0KICBvYmouZWFjaChmdW5jdGlvbihpKSB7DQogICAgdmFyIHBhbiA9ICQodGhpcykuYWRkQ2xhc3MoInN2LXBhbmVsLWNvbGxhcHNpYmxlIik7IC8vZ2V0IHBhbmVsIG9iamVjdA0KICAgIHZhciBoZHIgPSBwYW4uY2hpbGRyZW4oIi5zdi1wYW5lbC1oZWFkaW5nIikuYXR0cigicm9sZSIsImhlYWRpbmciKS5hdHRyKCJ0YWJpbmRleCIsIjAiKSAvL2dldCBwYW5lbCBoZWFkZXIgYW5kIG1ha2UgdGFiYmFibGUNCiAgICB2YXIgdHRsID0gaGRyLmZpbmQoIi5zdi1wYW5lbC10aXRsZSIpOyAvL2dldCBwYW5lbCB0aXRsZSBvYmplY3QgLy8gY2hhbmdlZCB0byAuZmluZCAgd2FzIC5jaGlsZHJlbg0KICAgIHZhciBhY3QgPSB0dGwuY2hpbGRyZW4oIi5zdi1wYW5lbC1hY3Rpb24tY29udGFpbmVyIik7DQogICAgaWYoYWN0Lmxlbmd0aD09MCl7DQogICAgCXR0bC5hcHBlbmQoIjxzcGFuIGNsYXNzPVwidWktaWNvbiBzdi1wYW5lbC1pY29uXCI+Iik7IC8vaWYgbm8gYWN0aW9uIGNvbnRhaW5lciB0aGVuIGFwcGVuZCB0byB0aGUgZW5kIG9mIHRoZSBoZWFkZXINCiAgICB9DQogICAgZWxzZXsNCiAgICAJYWN0LmJlZm9yZSgiPHNwYW4gY2xhc3M9XCJ1aS1pY29uIHN2LXBhbmVsLWljb25cIj4iKTsgLy9vdGhlcndpc2UgYXBwZW5kIGJlZm9yZSB0aGUgY29udGFpbmVyIChzbyBpdCBmbG9hdHMgaW4gdGhlIHJpZ2h0IG9yZGVyKQ0KICAgIH0NCiAgICB2YXIgYmR5ID0gaGRyLm5leHQoKTsgLy9nZXQgcGFuZWwgYm9keQ0KICAgIHZhciBoaWQgPSBoZHIuYXR0cigiaWQiKSB8fCAic3YtcGgtIitzaXRzX3V1aWQoKTsgLy9nZXQgb3IgY3JlYXRlIGhlYWRlciBpZA0KICAgIHZhciBiaWQgPSBiZHkuYXR0cigiaWQiKSB8fCAic3YtcGItIitzaXRzX3V1aWQoKTsgLy9nZXQgb3IgY3JlYXRlIGJvZHkgaWQNCiAgICBoZHIuYXR0cigiaWQiLGhpZCkuYXR0cigiYXJpYS1jb250cm9scyIsYmlkKTsgLy9saW5rIGhlYWRlciB0byBib2R5DQogICAgYmR5LmF0dHIoImlkIixiaWQpLmF0dHIoImFyaWEtbGFiZWxsZWRieSIsaGlkKTsgLy9saW5rIGJvZHkgdG8gaGVhZGVyDQogICAgaWYodHlwZW9mKGZuYyk9PSJmdW5jdGlvbiIpIHsNCiAgICAgIHBhbi5kYXRhKCJjYWxsYmFjayIsZm5jKTsgLy9zdG9yZSBjYWxsYmFjayBmdW5jdGlvbg0KICAgIH0NCiAgICBzaXRzX2RvX2NvbGxhcHNpYmxlX3BhbmVsKGhkcixleHAsdHJ1ZSk7IC8vZXhwYW5kIG9yIGNvbGxhcHNlIHBhbmVsDQogIH0pOw0KICBpZighc2l0c19ldmVudHMucGFuZWxIZWFkaW5nQ2xpY2spIHsNCiAgICAkKGRvY3VtZW50KS5vbigiY2xpY2siLCIuc3YtcGFuZWwtY29sbGFwc2libGUgLnN2LXBhbmVsLWhlYWRpbmciLGZ1bmN0aW9uKGV2dCkgew0KICAgICAgaWYoZXZ0LndoaWNoPT0xIHx8IGV2dC53aGljaD09MCkgeyAvL2NoZWNrIGZvciBsZWZ0IGNsaWNrICggIFBZUEIxIC0gMCBpbiBJRTgpDQogICAgCSAgaWYoJChldnQudGFyZ2V0KS5wYXJlbnRzKCIuc3YtcGFuZWwtYWN0aW9uLWNvbnRhaW5lciIpLmxlbmd0aD09MCl7DQogICAgCQkgIHNpdHNfZG9fY29sbGFwc2libGVfcGFuZWwodGhpcyxudWxsLHRydWUpOyAvL3RvZ2dsZSBwYW5lbA0KICAgIAkgIH0NCiAgICAgIH0NCiAgICB9KTsNCiAgICAkKGRvY3VtZW50KS5vbigia2V5ZG93biIsIi5zdi1wYW5lbC1jb2xsYXBzaWJsZSAuc3YtcGFuZWwtaGVhZGluZyIsZnVuY3Rpb24oZXZ0KSB7DQogICAgICBpZihldnQud2hpY2g9PTEzIHx8IGV2dC53aGljaD09MzIpIHsgLy9jaGVjayBmb3IgcmV0dXJuIG9yIHNwYWNlIGtleQ0KICAgICAgCWlmKCQoZXZ0LnRhcmdldCkucGFyZW50cygiLnN2LXBhbmVsLWFjdGlvbi1jb250YWluZXIiKS5sZW5ndGg9PTApew0KICAgICAgCQlzaXRzX2RvX2NvbGxhcHNpYmxlX3BhbmVsKHRoaXMsbnVsbCx0cnVlKTsgLy90b2dnbGUgcGFuZWwNCiAgICAgICAgICByZXR1cm4gc2l0c19jYW5jZWxfZXZlbnQoZXZ0KTsgLy9jYW5jZWwgZXZlbnQNCiAgICAgIAl9DQogICAgICB9DQogICAgfSk7DQogICAgc2l0c19ldmVudHMucGFuZWxIZWFkaW5nQ2xpY2sgPSB0cnVlOw0KICB9DQogIHJldHVybiB0cnVlOw0KfQ0KDQovL0ludGVybmFsIGZ1bmN0aW9uIHRvIGV4cGFuZC9jb2xsYXBzZSBhIHBhbmVsDQovLyBlbGVtZW50ICBlbGUgOiBpbiA7ZWxlbWVudCAtIG11c3QgYmUgY29sbGFwc2libGUgcGFuZWwgaGVhZGVyDQovLyBib29sZWFuICBleHAgOiBpbiA7ZXhwYW5kIHBhbmVsIGluaXRpYWxseT8gKG9wdGlvbmFsIC0gdW5kZWZpbmVkIHdpbGwgdG9nZ2xlKQ0KLy8gYm9vbGVhbiBjYWxsYmFjayA6aW47cnVuIHRoZSBjYWxsYmFjayBmdW5jdGlvbj8gKG9wdGlvbmFsKQ0KZnVuY3Rpb24gc2l0c19kb19jb2xsYXBzaWJsZV9wYW5lbChlbGUsZXhwLGNhbGxiYWNrKSB7DQogIHZhciBoZHIgPSAkKGVsZSk7IC8vb2JqZWN0IHNob3VsZCBiZSBwYW5lbCBoZWFkZXINCiAgdmFyIHBhbiA9IGhkci5wYXJlbnQoIi5zdi1wYW5lbC1jb2xsYXBzaWJsZSIpOyAvL2NoZWNrIGZvciBjb2xsYXBzaWJsZSBwYW5lbA0KICBpZihwYW4ubGVuZ3RoIT0xKSB7DQogICAgcmV0dXJuIGZhbHNlOyAvL25vIHBhbmVsIGZvdW5kDQogIH0NCiAgaWYocGFuLmhhc0NsYXNzKCJzdi1kaXNhYmxlZCIpKSB7DQogICAgcmV0dXJuIGZhbHNlOyAvL3BhbmVsIGRpc2FibGVkDQogIH0NCiAgdmFyIGljbyA9IGhkci5maW5kKCIuc3YtcGFuZWwtaWNvbiIpOyAvL2dldCBpY29uIG9iamVjdA0KICB2YXIga2lkID0gcGFuLmNoaWxkcmVuKCI6bm90KC5zdi1wYW5lbC1oZWFkaW5nKSIpOyAvL2dldCBwYW5lbCBjb250ZW50cyBhbmQgZm9vdGVyDQogIHZhciBib28gPSAodHlwZW9mKGV4cCk9PSJib29sZWFuIiA/IGV4cCA6IHBhbi5oYXNDbGFzcygic3YtcGFuZWwtY29sbGFwc2VkIikpOyAvL2V4cGFuZCBvciBjb2xsYXBzZT8NCiAgaWYoYm9vKSB7IC8vZXhwYW5kIHBhbmVsDQogICAgaWNvLnJlbW92ZUNsYXNzKCJ1aS1pY29uLXRyaWFuZ2xlLTEtbiIpLmFkZENsYXNzKCJ1aS1pY29uLXRyaWFuZ2xlLTEtcyIpOyAvL3N3YXAgYXJyb3dzDQogICAgcGFuLnJlbW92ZUNsYXNzKCJzdi1wYW5lbC1jb2xsYXBzZWQiKS5hZGRDbGFzcygic3YtcGFuZWwtZXhwYW5kZWQiKTsgLy9zd2FwIGNsYXNzZXMNCiAgICBzaXRzX3Nob3coa2lkKTsgLy9zaG93IHBhbmVsIChleGNlcHQgaGVhZGluZykNCiAgICBraWQuYXR0cigiYXJpYS1oaWRkZW4iLCJmYWxzZSIpOw0KICAgIGhkci5hdHRyKCJhcmlhLWV4cGFuZGVkIiwidHJ1ZSIpOw0KICB9DQogIGVsc2UgeyAvL2NvbGxhcHNlIHBhbmVsDQogICAgaWNvLnJlbW92ZUNsYXNzKCJ1aS1pY29uLXRyaWFuZ2xlLTEtcyIpLmFkZENsYXNzKCJ1aS1pY29uLXRyaWFuZ2xlLTEtbiIpOyAvL3N3YXAgYXJyb3dzDQogICAgcGFuLnJlbW92ZUNsYXNzKCJzdi1wYW5lbC1leHBhbmRlZCIpLmFkZENsYXNzKCJzdi1wYW5lbC1jb2xsYXBzZWQiKTsgLy9zd2FwIGNsYXNzZXMNCiAgICBzaXRzX2hpZGUoa2lkKTsgLy9oaWRlIHBhbmVsIChleGNlcHQgaGVhZGluZykNCiAgICBraWQuYXR0cigiYXJpYS1oaWRkZW4iLCJ0cnVlIik7DQogICAgaGRyLmF0dHIoImFyaWEtZXhwYW5kZWQiLCJmYWxzZSIpOw0KICB9DQogIGlmKHR5cGVvZiBjYWxsYmFjayAhPT0gImJvb2xlYW4iIHx8IGNhbGxiYWNrICE9PSBmYWxzZSkgY2FsbGJhY2sgPSB0cnVlOyAvL0hFUEQxIDI4ODUyNQ0KICBpZihjYWxsYmFjaykgew0KICAgIHZhciBmbmMgPSBwYW4uZGF0YSgiY2FsbGJhY2siKTsgLy9nZXQgY2FsbGJhY2sgZnVuY3Rpb24NCiAgICBpZih0eXBlb2YoZm5jKT09ImZ1bmN0aW9uIikgew0KICAgICAgZm5jKHBhbixib28pOyAvL3RyaWdnZXIgY2FsbGJhY2sNCiAgICB9DQogIH0NCiAgcmV0dXJuIHRydWU7DQp9DQoNCi8vRnVuY3Rpb24gdG8gdG9nZ2xlIHRoZSBjb2xsYXBzaWJsZSBwYW5lbA0KLy8gZWxlbWVudCAgZWxlIDogaW4gO2VsZW1lbnQgLSBtdXN0IGJlIGNvbGxhcHNpYmxlIHBhbmVsDQovLyBib29sZWFuICBleHAgOiBpbiA7ZXhwYW5kL2NvbGxhcHNlIHRoZSBwYW5lbA0KLy8gYm9vbGVhbiAgY2FsbGJhY2sgOiBpbiA7d2hldGhlciB0aGUgY2FsbGJhY2sgc2hvdWxkIGJlIHJ1biBvciBub3QNCmZ1bmN0aW9uIHNpdHNfdG9nZ2xlX2NvbGxhcHNpYmxlX3BhbmVsKGVsZSxleHAsY2FsbGJhY2spIHsNCgl2YXIgaGRyID0gJChlbGUpLmNoaWxkcmVuKCIuc3YtcGFuZWwtaGVhZGluZyIpOw0KCXNpdHNfZG9fY29sbGFwc2libGVfcGFuZWwoaGRyLGV4cCxjYWxsYmFjayk7DQoJcmV0dXJuIHRydWU7DQp9DQoNCi8vRnVuY3Rpb24gdG8gZW5hYmxlIG9yIGRpc2FibGUgdGhlIGNvbGxhcHNpYmxlIHBhbmVsDQovLyBlbGVtZW50ICBlbGUgOiBpbiA7ZWxlbWVudCAtIG11c3QgYmUgY29sbGFwc2libGUgcGFuZWwNCi8vIGJvb2xlYW4gIGVuYiA6IGluIDtlbmFibGUvZGlzYWJsZSB0aGUgcGFuZWwNCmZ1bmN0aW9uIHNpdHNfZW5hYmxlX2NvbGxhcHNpYmxlX3BhbmVsKGVsZSxlbmIpIHsNCiAgdmFyIHBhbiA9ICQoZWxlKS5maWx0ZXIoIi5zdi1wYW5lbC1jb2xsYXBzaWJsZSIpOyAvL2NoZWNrIGZvciBjb2xsYXBzaWJsZSBwYW5lbA0KICBpZihwYW4ubGVuZ3RoIT0xKSB7DQogICAgcmV0dXJuIGZhbHNlOyAvL25vIHBhbmVsIGZvdW5kDQogIH0NCiAgaWYodHlwZW9mKGVuYikhPSJib29sZWFuIiB8fCBlbmIpIHsgLy9lbmFibGVkIGJ5IGRlZmF1bHQNCiAgICBwYW4ucmVtb3ZlQ2xhc3MoInN2LWRpc2FibGVkIikucmVtb3ZlQXR0cigiYXJpYS1kaXNhYmxlZCIpOw0KICB9DQogIGVsc2Ugew0KICAgIHBhbi5hZGRDbGFzcygic3YtZGlzYWJsZWQiKS5hdHRyKCJhcmlhLWRpc2FibGVkIix0cnVlKTsNCiAgfQ0KICByZXR1cm4gdHJ1ZTsNCn0NCg0KLy8gZnVuY3Rpb24gdG8gYnVpbGQgYW4gaW5saW5lIG1lc3NhZ2UgYmFzZWQgb24gZTpWaXNpb24gV2ViIFVJIHN0YW5kYXJkcw0KLy8gYXBwbGllcyBhcmlhIHRhZ3MgYW5kIGNsYXNzZXMgdG8gZmllbGQgYW5kIGVycg0KLy8gc3RhdDogLTEgPSBlcnJvciwgMCA9IG5ldXRyYWwsIDEgPSBwb3NpdGl2ZS92YWxpZA0KLy8gbWVzc2FnZSBvbmx5IHZhbGlkIGZvciBlcnJvcitwb3NpdGl2ZSBzdGF0ZQ0KLy8gZmllbGQgaWQNCi8vIEV4dHJhIG9wdGlvbnMgLSBleHRyYSBzd2l0Y2hlcyBmb3IgbWVzc2FnaW5nDQovLyAgICAgICAgc2hvd0Vycm9yIC0gc2hvdyBlcnJvciBpbiBmb3JtIG1vZGUgYm9vbGVhbiBkZWZhdWx0IGlzIHRydWUsIGlmIHRoaXMgaXMgZmFsc2Ugd2lsbCB1c2UgYSB0b29sdGlwIGluc3RlYWQuDQovLyBtZXNzYWdlIHNwYW4gaWQgbm90IHVzZWQgaW4gdGFibGUgbW9kZSwgaW4gZm9ybSBtb2RlIHRyeSBhbmQgd29yayBvdXQgaWYgbm90IHBhc3NlZCBpbi4NCmZ1bmN0aW9uIHNpdHNfaW5saW5lX3ZhbGlkYXRpb25fbWVzc2FnZShzdGF0LG1zZyxmbGRJZCxtc2dJZCxleHRyYU9wdGlvbnMpIHsNCg0KICAvL3NpdHNfcHV0bWVzcygiaW4gdmFsaWRhdGlvbiBmbGRpZCA9ICIrZmxkSWQpOw0KICBpZihmbGRJZD09IiIgfHwgdHlwZW9mKGZsZElkKT09InVuZGVmaW5lZCIpIHsNCiAgICByZXR1cm47DQogIH0NCiAgdmFyIGVycm9yaWNvbiA9ICIiOw0KICB2YXIgb2tpY29uID0gIiI7DQogIHZhciB3YXJuaWNvbiA9ICIiOw0KICB2YXIgZXJyb3JzcGFuID0gIiI7DQogIHZhciB0YWJsZW1vZGUgPSAiTiI7DQogIHZhciB0aGVtc2dzcGFuID0gIiI7DQogIHZhciBmZWVkYmFjayA9ICIiOw0KICB2YXIgdGhlZGl2ID0gIiI7DQogIHZhciBpY29uID0gIiI7DQogIHZhciBzaG93ZXJyb3IgPSB0cnVlOw0KDQogIGlmKHR5cGVvZihleHRyYU9wdGlvbnMpPT0ib2JqZWN0IiAmJiB0eXBlb2YoZXh0cmFPcHRpb25zLnNob3dFcnJvcik9PSJib29sZWFuIikgew0KICAgIHNob3dlcnJvciA9IGV4dHJhT3B0aW9ucy5zaG93RXJyb3I7DQogIH0NCg0KICB2YXIgdGhlZmxkID0gJCgpOyAvL2dldCBmbGQgb2JqZWN0DQogIGlmKHR5cGVvZihmbGRJZCk9PSJvYmplY3QiKSB7DQogICAgdGhlZmxkID0gJChmbGRJZCk7DQogIH0NCiAgZWxzZSBpZih0eXBlb2YoZmxkSWQpPT0ic3RyaW5nIikgew0KICAgIHRoZWZsZCA9ICQoIiMiK3NpdHNfZG9fZ2V0X29iamVjdChmbGRJZCkpOyAvL3RyeSAiaWQiDQogICAgaWYodGhlZmxkLmxlbmd0aCE9MSkgew0KICAgICAgdGhlZmxkID0gJCgiW25hbWU9IitzaXRzX2RvX2dldF9vYmplY3QoZmxkSWQpKyJdIik7IC8vdHJ5ICJuYW1lIg0KICAgICAgaWYodGhlZmxkLmxlbmd0aCE9MSkgew0KICAgICAgICB0aGVmbGQgPSAkKCJpbnB1dFtpZF49IitzaXRzX2RvX2dldF9vYmplY3QoZmxkSWQpKyJdOmZpcnN0Iik7IC8vZm9yIHJhZGlvIGdyb3VwDQogICAgICAgIGlmKHRoZWZsZC5sZW5ndGghPTEpIHsNCiAgICAgICAgICB0aGVmbGQgPSAkKCJpbnB1dFtuYW1lPSIrc2l0c19kb19nZXRfb2JqZWN0KGZsZElkKSsiXSIpOyAvL2ZvciByZWNvcmQgcGlja2VyDQogICAgICAgIH0NCiAgICAgIH0NCiAgICB9DQogIH0NCiAgaWYodGhlZmxkLmxlbmd0aD09MSkgew0KICAgIGZsZElkID0gdGhlZmxkLmF0dHIoImlkIik7DQogIH0NCg0KDQogIC8vIGNoZWNrIHRoZSBpbnB1dCByZWFsbHkgaXMgYSBmaWVsZCBzbyB3ZSBkb250IHdyYXAgdHJzIGV0Yw0KICBpZiggIXRoZWZsZC5pcygiaW5wdXQsdGV4dGFyZWEsc2VsZWN0IikgJiYgdGhlZmxkLmdldCgwKS50YWdOYW1lIT0iRklFTERTRVQiKXsNCiAgICByZXR1cm47DQogIH0NCg0KDQogIGlmKHRoZWZsZC5jbG9zZXN0KCJ0YWJsZSIpLmhhc0NsYXNzKCJzdi10YWJsZSIpKSB7IC8vaW4gdGFibGUgbW9kZQ0KICAgIHRhYmxlbW9kZSA9ICJZIjsNCiAgfQ0KICB2YXIgaXNpbmZvY3VzID0gKHRoZWZsZC5nZXQoMCk9PWRvY3VtZW50LmFjdGl2ZUVsZW1lbnQpOyAvL2NoZWNrIGlmIGZpZWxkIGlzIGZvY3VzZWQNCiAgdmFyIGNsb3Nlc3RkaXYgPSB0aGVmbGQuY2xvc2VzdCgiZGl2Iik7DQoNCg0KICBpZih0YWJsZW1vZGU9PSJZIikgeyAvLyBhZGQgYSBmb250IGljb24gbmV4dCB0byBmaWVsZCBmb3IgdGFibGUgbW9kZQ0KICAgIHRoZWRpdiA9IHRoZWZsZC5jbG9zZXN0KCJ0ZCIpLnJlbW92ZUNsYXNzKCJzdi1oYXMtZXJyb3Igc3YtaGFzLWZlZWRiYWNrIHN2LXRhYmxlLWhhcy1mZWVkYmFjayBzdi1oYXMtc3VjY2VzcyBzdi1oYXMtd2FybmluZyIpOw0KICAgIHRoZWRpdi5maW5kKCIuc3YtaW5saW5lLWVycm9yIikucmVtb3ZlKCk7DQogICAgaWYoY2xvc2VzdGRpdi5oYXNDbGFzcygic3YtaW5wdXQtZ3JvdXAtd3JhcHBlciIpKSB7DQogICAgICBjbG9zZXN0ZGl2LnJlbW92ZUNsYXNzKCJzdi1oYXMtZmVlZGJhY2staW4taW5wdXQtZ3JvdXAgc3YtZm9ybS1ncm91cCIpOw0KICAgIH0NCiAgfQ0KDQogIGlmKHRhYmxlbW9kZT09Ik4iICYmIHNob3dlcnJvcj09dHJ1ZSkgew0KICAgIGlmKG1zZ0lkIT0iIiAmJiBtc2dJZCE9InVuZGVmaW5lZCIgJiYgdHlwZW9mKG1zZ0lkKSE9InVuZGVmaW5lZCIpIHsgLy8gZmluZCB0aGUgbWVzc2FnZSBzcGFuIHVzaW5nIElEIG9yIERPTQ0KICAgIAlpZih0eXBlb2YobXNnSWQpPT0ib2JqZWN0Iikgew0KICAgIAkJdGhlbXNnc3BhbiA9ICQobXNnSWQpOw0KICAgIAl9DQogICAgCWVsc2Ugew0KICAgICAgCXRoZW1zZ3NwYW4gPSAkKCIjIitzaXRzX2RvX2dldF9vYmplY3QobXNnSWQpKTsNCiAgICAgIH0NCiAgICB9DQogICAgZWxzZSB7DQogICAgICB0aGVtc2dzcGFuID0gdGhlZmxkLmNsb3Nlc3QoImRpdi5zdi1mb3JtLWdyb3VwIikuZmluZCgic3Bhbi5zdi1lcnJvci1ibG9jayIpOw0KICAgICAgbXNnSWQgPSB0aGVtc2dzcGFuLmF0dHIoImlkIik7DQogICAgICBpZih0eXBlb2YobXNnSWQpIT0ic3RyaW5nIikgew0KICAgICAgICBtc2dJZCA9ICJTViIrc2l0c191dWlkKCk7DQogICAgICAgIHRoZW1zZ3NwYW4uYXR0cigiaWQiLG1zZ0lkKTsNCiAgICAgIH0NCiAgICB9DQogICAgdGhlbXNnc3Bhbi5odG1sKCIiKTsNCiAgfQ0KDQogIC8vZG9uJ3Qgc2hvdyBlcnJvciBpY29uIGZvciBhIGZldyBpbnB1dCB0eXBlcw0KICBpZih0aGVmbGQubGVuZ3RoPjAgJiYgIXRoZWZsZC5pcygic2VsZWN0LDpidXR0b24sOnN1Ym1pdCw6ZmlsZSw6cmFkaW8sOmNoZWNrYm94LGlucHV0W3R5cGU9J2hpZGRlbiddIikgJiYgdGhlZmxkLmdldCgwKS50YWdOYW1lIT0iRklFTERTRVQiKSB7DQogICAgdmFyIGlubGluZSA9ICh0YWJsZW1vZGU9PSJZIiA/ICJzdi1pbmxpbmUtZXJyb3IgIiA6ICIiKTsNCiAgICBlcnJvcmljb24gPSAiPHNwYW4gY2xhc3M9XCIiK2lubGluZSsiZ2x5cGhpY29uIGdseXBoaWNvbi1yZW1vdmUgc3YtZm9ybS1jb250cm9sLWZlZWRiYWNrXCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+PC9zcGFuPiI7DQogICAgb2tpY29uID0gIjxzcGFuIGNsYXNzPVwiIitpbmxpbmUrImdseXBoaWNvbiBnbHlwaGljb24tb2sgc3YtZm9ybS1jb250cm9sLWZlZWRiYWNrXCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+PC9zcGFuPiI7DQogICAgd2Fybmljb24gPSAiPHNwYW4gY2xhc3M9XCIiK2lubGluZSsiZ2x5cGhpY29uIGdseXBoaWNvbi13YXJuaW5nLXNpZ24gc3YtZm9ybS1jb250cm9sLWZlZWRiYWNrXCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+PC9zcGFuPiI7DQogIH0NCiAgLy9hZGQgd3JhcHBlciBpZiByZXF1aXJlZA0KICBpZih0YWJsZW1vZGU9PSJOIikgew0KDQogICAgdGhlZGl2ID0gdGhlZmxkLmNsb3Nlc3QoImRpdi5zdi1mb3JtLWdyb3VwIik7DQogICAgaWYoY2xvc2VzdGRpdi5oYXNDbGFzcygic3YtaW5wdXQtZ3JvdXAtd3JhcHBlciIpKSB7DQogICAgICBjbG9zZXN0ZGl2LmFkZENsYXNzKCJzdi1oYXMtZmVlZGJhY2staW4taW5wdXQtZ3JvdXAiKTsNCiAgICB9DQogICAgZWxzZSBpZihjbG9zZXN0ZGl2Lmhhc0NsYXNzKCJzdi1pbnB1dC1ncm91cCIpKSB7DQogICAgICB0aGVmbGQud3JhcCgiPGRpdiBjbGFzcz1cInN2LWhhcy1mZWVkYmFjay1pbi1pbnB1dC1ncm91cCBzdi1pbnB1dC1ncm91cC13cmFwcGVyXCI+PC9kaXY+Iik7Ly8vLy8vLy8vLy8vDQogICAgfQ0KICB9DQogIGVsc2Ugew0KICAgIGlmKCFjbG9zZXN0ZGl2Lmhhc0NsYXNzKCJzdi1yYWRpbyIpKSB7DQogICAgICBpZihjbG9zZXN0ZGl2Lmhhc0NsYXNzKCJzdi1pbnB1dC1ncm91cC13cmFwcGVyIikpIHsNCiAgICAgICAgY2xvc2VzdGRpdi5hZGRDbGFzcygic3YtaGFzLWZlZWRiYWNrLWluLWlucHV0LWdyb3VwIHN2LWZvcm0tZ3JvdXAiKTsNCiAgICAgIH0NCiAgICAgIGVsc2Ugew0KICAgICAgICB0aGVmbGQud3JhcCgiPGRpdiBjbGFzcz1cInN2LWhhcy1mZWVkYmFjay1pbi1pbnB1dC1ncm91cCBzdi1pbnB1dC1ncm91cC13cmFwcGVyIHN2LWZvcm0tZ3JvdXBcIj48L2Rpdj4iKTsNCiAgICAgICAgY2xvc2VzdGRpdiA9IHRoZWZsZC5jbG9zZXN0KCJkaXYiKTsNCiAgICAgIH0NCiAgICB9DQogIH0NCg0KDQogIC8vcmVtb3ZlIG1lc3NhZ2Ugc3R5bGluZyBhbmQgaWNvbg0KICB0aGVkaXYucmVtb3ZlQ2xhc3MoInN2LWhhcy1lcnJvciBzdi1oYXMtZmVlZGJhY2sgc3YtaGFzLXN1Y2Nlc3Mgc3YtaGFzLXdhcm5pbmciKS5maW5kKCJzcGFuLnN2LWZvcm0tY29udHJvbC1mZWVkYmFjayIpLnJlbW92ZSgpOw0KICBpZighdGhlZmxkLmlzKCJzZWxlY3QsOmJ1dHRvbiw6c3VibWl0LDpmaWxlLDpyYWRpbyw6Y2hlY2tib3gsaW5wdXRbdHlwZT0naGlkZGVuJ10iKSkgew0KICAgIGlmKHRhYmxlbW9kZT09IlkiKSB7DQogICAgICBmZWVkYmFjayA9ICJzdi1oYXMtZmVlZGJhY2sgc3YtdGFibGUtaGFzLWZlZWRiYWNrIjsNCiAgICB9DQogICAgZWxzZSB7DQogICAgICBmZWVkYmFjayA9ICJzdi1oYXMtZmVlZGJhY2siOw0KICAgIH0NCiAgfQ0KICBlbHNlIHsNCiAgICBlcnJvcmljb24gPSAiIjsNCiAgICBva2ljb24gPSAiIjsNCiAgICB3YXJuaWNvbiA9ICIiOw0KICB9DQoNCiAgaWYoc3RhdCE9IiIpIHsNCiAgICBzdGF0ID0gc3RhdCoxOw0KICB9DQogIHN3aXRjaChzdGF0KSB7DQogIGNhc2UgLTE6DQogICAgaWNvbiA9IGVycm9yaWNvbjsNCiAgICB0aGVmbGQuYXR0cigiYXJpYS1pbnZhbGlkIiwidHJ1ZSIpOw0KICAgIHRoZWRpdi5hZGRDbGFzcygic3YtaGFzLWVycm9yICIrZmVlZGJhY2spOw0KICAgIGJyZWFrOw0KICBjYXNlIDE6DQogICAgaWNvbiA9IG9raWNvbjsNCiAgICB0aGVkaXYuYWRkQ2xhc3MoInN2LWhhcy1zdWNjZXNzICIrZmVlZGJhY2spOw0KICAgIHRoZWZsZC5hdHRyKCJhcmlhLWludmFsaWQiLCJmYWxzZSIpOw0KICAgIGJyZWFrOw0KICBjYXNlIDI6DQogICAgaWNvbiA9IHdhcm5pY29uOw0KICAgIHRoZWZsZC5hdHRyKCJhcmlhLWludmFsaWQiLCJ0cnVlIik7DQogICAgdGhlZGl2LmFkZENsYXNzKCJzdi1oYXMtd2FybmluZyAiK2ZlZWRiYWNrKTsNCiAgICBicmVhazsNCiAgZGVmYXVsdDoNCiAgICBpZihzdGF0IT09MCkgew0KICAgICAgbXNnID0gIiI7DQogICAgfQ0KICAgIGlmKGNsb3Nlc3RkaXYuaGFzQ2xhc3MoInN2LWlucHV0LWdyb3VwLXdyYXBwZXIiKSkgew0KICAgICAgY2xvc2VzdGRpdi5yZW1vdmVDbGFzcygic3YtaGFzLWZlZWRiYWNrLWluLWlucHV0LWdyb3VwIHN2LWZvcm0tZ3JvdXAiKTsNCiAgICB9DQogICAgdGhlZmxkLmF0dHIoImFyaWEtaW52YWxpZCIsImZhbHNlIikucmVtb3ZlQXR0cigiYXJpYS1kZXNjcmliZWRieSIpOw0KICAgIGJyZWFrOw0KICB9DQogIGlmKGljb24hPSIiKSB7DQogICAgdGhlZmxkLmFmdGVyKGljb24pOw0KICB9DQogIGlmKHRhYmxlbW9kZT09Ik4iICYmIG1zZyE9IiIgJiYgc2hvd2Vycm9yPT10cnVlKSB7DQogICAgaWYoc3RhdCE9PTApIHsNCiAgICAgIHRoZW1zZ3NwYW4uYXR0cigicm9sZSIsImFsZXJ0IikuaHRtbChtc2cpOw0KICAgIH0NCiAgICBlbHNlIHsNCiAgICAgIHRoZW1zZ3NwYW4uaHRtbChtc2cpOw0KICAgIH0NCiAgICB0aGVmbGQuYXR0cigiYXJpYS1kZXNjcmliZWRieSIsbXNnSWQpOw0KICB9DQoNCiAgLy8gYWRkIHRvb2x0aXBzIGluIHRhYmxlIG1vZGUgYXMgY2FuJ3Qgc2VlIG1lc3NhZ2UNCiAgaWYodGFibGVtb2RlPT0iWSIgfHwgc2hvd2Vycm9yPT1mYWxzZSkgew0KICAgIHZhciB0ZW1wZmxkaWRhcnJheSA9IFtdOw0KICAgIGlmKHR5cGVvZihmbGRJZCkhPSJ1bmRlZmluZWQiICYmIGZsZElkLmluZGV4T2YoIlNQTElUREFURSIpPi0xKSB7DQogICAgICB2YXIgc3JjID0gZmxkSWQuc3Vic3RyaW5nKDExKQ0KICAgICAgdGVtcGZsZGlkYXJyYXkgPSBbJCgiIyIrc2l0c19kb19nZXRfb2JqZWN0KCJTUExJVERBVEVfWSIrc3JjKSksJCgiIyIrc2l0c19kb19nZXRfb2JqZWN0KCJTUExJVERBVEVfTSIrc3JjKSksJCgiIyIrc2l0c19kb19nZXRfb2JqZWN0KCJTUExJVERBVEVfRCIrc3JjKSldOw0KICAgIH0NCiAgICBlbHNlIHsNCiAgICAgIHRlbXBmbGRpZGFycmF5ID0gW3RoZWZsZF07DQogICAgfQ0KICAgICQuZWFjaCh0ZW1wZmxkaWRhcnJheSxmdW5jdGlvbihpLHRlbXBmbGRpZCkgew0KICAgICAgdmFyIHRlbXBmbGQgPSB7fTsNCiAgICAgIHRlbXBmbGQgPSB0ZW1wZmxkaWQ7DQogICAgICB2YXIgbXNnMSA9ICIiDQogICAgICBpZihtc2chPSIiKSBtc2cxPW1zZzsNCiAgICAgIHZhciBoYXN0dGlwID0gdGhlZmxkLmRhdGEoImhhc3R0aXAiKSB8fCAiIjsNCiAgICAgIGlmKGhhc3R0aXA9PSIiKSB7DQogICAgICAgIGlmKHRlbXBmbGQuaGFzQ2xhc3MoInVpLXNpdHMtdG9vbHRpcCIpIHx8IHRlbXBmbGQuaGFzQ2xhc3MoInN2LXRvb2x0aXAtZmlsdGVyIikpIHsNCiAgICAgICAgICB0ZW1wZmxkLmRhdGEoImhhc3R0aXAiLCJZIik7DQogICAgICAgICAgdmFyIHR0aXAxID0gdGVtcGZsZC50b29sdGlwKCJvcHRpb24iLCAiY29udGVudCIpOw0KICAgICAgICAgIHRlbXBmbGQuZGF0YSgidHRpcCIsdHRpcDEpOw0KICAgICAgICAgIC8vY29uY2F0IHRvb2x0aXAgYW5kIG1lc3NhZ2UgPz8NCiAgICAgICAgfWVsc2V7DQogICAgICAgICAgdGVtcGZsZC5kYXRhKCJoYXN0dGlwIiwiTiIpOw0KICAgICAgICAgIGlmICggdGhlZmxkLmF0dHIoInRpdGxlIikhPSAiIiAmIG1zZyAhPSAiIiApew0KICAgICAgICAgICAgbXNnMSA9ICAiPHNwYW4gY2xhc3M9XCJzdi1zci1vbmx5XCI+Iit0aGVmbGQuYXR0cigidGl0bGUiKSsiPC9zcGFuPiAiK21zZzsgLy9jb25jYXQgdGl0bGUgYW5kIG1lc3NhZ2UNCiAgICAgICAgICB9DQogICAgICAgIH0NCiAgICAgIH1lbHNlew0KICAgICAgICBpZiAoIHRoZWZsZC5hdHRyKCJ0aXRsZSIpIT0gIiIgJiBtc2cgIT0gIiIgKXsNCiAgICAgICAgICBtc2cxID0gICI8c3BhbiBjbGFzcz1cInN2LXNyLW9ubHlcIj4iK3RoZWZsZC5hdHRyKCJ0aXRsZSIpKyI8L3NwYW4+ICIrbXNnOyAvL2NvbmNhdCB0aXRsZSBhbmQgbWVzc2FnZQ0KICAgICAgICB9DQogICAgICB9DQogICAgICBpZihtc2c9PSIiKSB7IC8vIHNldCB0b29sdGlwIGJhY2sNCiAgICAgICAgaWYodGVtcGZsZC5kYXRhKCJoYXN0dGlwIik9PSJZIikgew0KICAgICAgICAgIG1zZyA9IHRlbXBmbGQuZGF0YSgidHRpcCIpIHx8ICIiOw0KICAgICAgICAgIG1zZzEgPSBtc2cNCiAgICAgICAgfQ0KICAgICAgfQ0KICAgICAgaWYodGVtcGZsZC5oYXNDbGFzcygidWktc2l0cy10b29sdGlwIikgfHwgdGVtcGZsZC5oYXNDbGFzcygic3YtdG9vbHRpcC1maWx0ZXIiKSkgew0KICAgICAgICBzaXRzX3Rvb2x0aXAodGVtcGZsZCwiIik7DQogICAgICAgIHRlbXBmbGQucmVtb3ZlQ2xhc3MoInVpLXNpdHMtdG9vbHRpcCIpOw0KICAgICAgICB0ZW1wZmxkLnJlbW92ZUNsYXNzKCJzdi10b29sdGlwLWZpbHRlciIpOw0KICAgICAgfQ0KICAgICAgaWYobXNnMSE9IiIpIHsNCiAgICAgICAgc2l0c190b29sdGlwKHRlbXBmbGQsbXNnMSk7DQogICAgICB9DQogICAgfSk7DQogIH0NCiAgaWYoaXNpbmZvY3VzICYmIHRoZWZsZC5nZXQoMCkhPWRvY3VtZW50LmFjdGl2ZUVsZW1lbnQpIHsNCiAgICB0aGVmbGQuZm9jdXMoKTsgLy9yZS1mb2N1cyBmaWVsZCBpZiBpdCBoYXMgbG9zdCBmb2N1cyAoY2F1c2VkIGJ5IC53cmFwKQ0KICB9DQoNCn0NCg0KLy8gRnVuY3Rpb24gdG8gcHJvY2VzcyBlcnJvcm9iamVjdA0KZnVuY3Rpb24gc2l0c19wcm9jZXNzX2lubGluZV9lcnJvcnMocFBhZ2VFcnJvcnMpIHsNCiAgLy9zaW5nbGUgcmVjb3JkIG1vZGUgZXJyb3JzDQogIGlmKHR5cGVvZihwUGFnZUVycm9ycyk9PSJvYmplY3QiKSB7DQogICAgJC5lYWNoKHBQYWdlRXJyb3JzLGZ1bmN0aW9uKGksZXJyb3IpIHsNCiAgICAgIGlmKGVycm9yLk1TR0lEPT0iTk9ORSIpIHsNCiAgICAgICAgc2l0c19pbmxpbmVfdmFsaWRhdGlvbl9tZXNzYWdlKGVycm9yLlNUQVQsZXJyb3IuRVJST1IsZXJyb3IuRkxESUQsIiIseyJzaG93RXJyb3IiOmZhbHNlfSk7DQogICAgICB9DQogICAgICBlbHNlIHsNCiAgICAgICAgc2l0c19pbmxpbmVfdmFsaWRhdGlvbl9tZXNzYWdlKGVycm9yLlNUQVQsZXJyb3IuRVJST1IsZXJyb3IuRkxESUQsZXJyb3IuTVNHSUQpOw0KICAgICAgfQ0KICAgIH0pOw0KICB9DQp9DQoNCi8vSW50ZXJuYWwgZnVuY3Rpb24gdG8gYWRkIGRlYnVnIG1lc3NhZ2luZyBmb3IgZXZlbnRzDQpmdW5jdGlvbiBzaXRzX2RlYnVnX2V2ZW50cyhzZWwsbW91c2UsdG91Y2gpIHsNCiAgdmFyIHN0ciA9ICJibHVyIGNoYW5nZSBjbGljayBkYmxjbGljayBlcnJvciBmb2N1cyBrZXlkb3duIGtleXByZXNzIGtleXVwIGxvYWQgcmVzaXplIHNjcm9sbCBzZWxlY3Qgc3VibWl0IHVubG9hZCI7DQogIGlmKHR5cGVvZihtb3VzZSkhPSJib29sZWFuIiB8fCBtb3VzZSkgew0KICAgIHN0ciArPSAiIG1vdXNlZG93biBtb3VzZWVudGVyIG1vdXNlbGVhdmUgbW91c2Vtb3ZlIG1vdXNlb3V0IG1vdXNlb3ZlciBtb3VzZXVwIjsNCiAgfQ0KICBpZih0eXBlb2YodG91Y2gpIT0iYm9vbGVhbiIgfHwgdG91Y2gpIHsNCiAgICBzdHIgKz0gIiB0b3VjaHN0YXJ0IHRvdWNoZW5kIHRvdWNoY2FuY2VsIHRvdWNobW92ZSI7DQogIH0NCiAgcmV0dXJuICgkKHNlbCkub24oc3RyLGZ1bmN0aW9uKGV2dCkgew0KICAgIHNpdHNfcHV0bWVzcyhzaXRzX3RvX3N0cmluZyhldnQpKTsNCiAgfSkubGVuZ3RoPjApOw0KfQ0KDQovLyBmdW5jdGlvbiB0byBidWlsZCBhIHNlbGVjdCBhbGwgYnV0dG9uDQovLyBzdHJpbmcvZWxlbWVudCAtIGVsZW1lbnQgb3Igc2VsZWN0b3IgIC0gdGFyZ2V0IGZvciB0aGUgSFRNTA0KLy8gc3RyaW5nIC0gY2FsbGJhY2sgZnVuY3Rpb24gZm9yIHdoZW4gYSB2YWx1ZSBpcyBzZWxlY3RlZA0KLy8gc3RyaW5nIC0gYnV0dG9uIHRleHQob3B0aW9uYWwpIHdpbGwgdXNlIGRlZmF1bHRzIGlmIG5vdCBzcGVjaWZpZWQNCi8vIG9wdGlvbnMgIGFycmF5IC0gbGlzdCBvZiBvcHRpb24gdGV4dHMob3B0aW9uYWwpIHdpbGwgdXNlIGRlZmF1bHRzIGlmIG5vdCBzcGVjaWZpZWQNCi8vIHJldHVybnMgbnVtZXJpYyAtIHNlbGVjdGlvbiBvZiBhIHZhbHVlIGNhbGxzIGNhbGxiYWNrIGZ1bmN0aW9uIHBhc3NpbmcgaW4gYXJyYXkgaW5kZXggMCwxLDIgZXRjLi4uLg0KZnVuY3Rpb24gc2l0c19hZGRfc2VsZWN0X2FsbChzZWwsY2FsbGJhY2ssYnRudGV4dCxvcHRpb25zLGV4dHJhT3B0aW9ucykgew0KICB2YXIgcHVsbHJpZ2h0ID0gdHJ1ZTsNCiAgaWYodHlwZW9mKGV4dHJhT3B0aW9ucyk9PSJvYmplY3QiICYmIHR5cGVvZihleHRyYU9wdGlvbnMucHVsbFJpZ2h0KT09ImJvb2xlYW4iKSB7DQogICAgcHVsbHJpZ2h0ID0gZXh0cmFPcHRpb25zLnB1bGxSaWdodDsNCiAgfQ0KICBlbHNlIHsNCiAgICBwdWxscmlnaHQgPSB0cnVlOw0KICB9DQogIGlmKGJ0bnRleHQ9PSIiIHx8IHR5cGVvZihidG50ZXh0KT09InVuZGVmaW5lZCIpIHsNCiAgICBidG50ZXh0ID0gc2l0c193aWRnZXRfYnAudWkuc2VsZWN0QWxsVGl0bGU7DQogIH0NCiAgaWYob3B0aW9ucz09IiIgfHwgdHlwZW9mKG9wdGlvbnMpPT0idW5kZWZpbmVkIikgeyAvLyB1c2UgZGVmYXVsdDtzZWxlY3QgYWxsLCBzZWxlY3Qgbm9uZSwgaW52ZXJ0DQogICAgb3B0aW9ucyA9IFtzaXRzX3dpZGdldF9icC51aS5zZWxlY3RBbGwsc2l0c193aWRnZXRfYnAudWkuc2VsZWN0Tm9uZSwgc2l0c193aWRnZXRfYnAudWkuaW52ZXJ0QWxsXTsNCiAgfQ0KICB2YXIgdGhlbGlzdCA9ICIiOw0KICB2YXIgZGl2aWQgPSAic3YtIitzaXRzX3V1aWQoKTsNCg0KICAkLmVhY2gob3B0aW9ucyxmdW5jdGlvbihpLG4pIHsNCiAgICB0aGVsaXN0ICs9ICI8bGk+PGEgaHJlZj1cImphdmFzY3JpcHQ6XCIgb25jbGljaz1cImphdmFzY3JpcHQ6IitjYWxsYmFjaysiKCIraSsiLCciK2RpdmlkKyInKVwiID4iK24rIjwvYT48L2xpPiI7DQogIH0pOw0KICB2YXIgaHRtbCA9ICIiOw0KICBpZihwdWxscmlnaHQpIHsNCiAgICBodG1sID0gICI8ZGl2IHJvbGU9XCJncm91cFwiIGNsYXNzPVwic3YtZHJvcGRvd24gc3YtcHVsbC1yaWdodFwiPiI7DQogIH0NCiAgZWxzZSB7DQogICAgaHRtbCA9ICAiPGRpdiByb2xlPVwiZ3JvdXBcIiBjbGFzcz1cInN2LWRyb3Bkb3duXCI+IjsNCiAgfQ0KICBodG1sICs9ICI8YnV0dG9uIGlkPVwiIitkaXZpZCsiXCIgYXJpYS1oYXNwb3B1cD1cInRydWVcIiBhcmlhLWV4cGFuZGVkPVwiZmFsc2VcIiB0eXBlPVwiYnV0dG9uXCIgY2xhc3M9XCJzdi1idG4gc3YtYnRuLWRlZmF1bHRcIiBkYXRhLXN2LXRvZ2dsZT1cInN2LWRyb3Bkb3duXCIgY2xhc3M9XCJzdi1idG4gc3YtZHJvcGRvd24tdG9nZ2xlXCI+IitidG50ZXh0KyIgPHNwYW4gY2xhc3M9XCJzdi1jYXJldFwiPjwvYnV0dG9uPiI7DQogIGh0bWwgKz0gIjx1bCBjbGFzcz1cInN2LWRyb3Bkb3duLW1lbnVcIiBhcmlhLWxhYmVsbGVkYnk9XCIiK2RpdmlkKyJcIj4iK3RoZWxpc3Q7DQogIGh0bWwgKz0gIjwvdWw+PC9kaXY+IjsNCiAgJChzZWwpLmh0bWwoaHRtbCk7DQp9DQoNCi8vIEVuYWJsZS9kaXNhYmxlIGEgc3R5bGVzaGVldCh0aGVyZWJ5IHR1cm5pbmcgb24vb2ZmIHRob3NlIHN0eWxlcykNCi8vIHN0cmluZyBmaWxlIDppbjtzdHlsZXNoZWV0IGZpbGVuYW1lIHRvIGVuYWJsZS9kaXNhYmxlKG5vdCBpbmNsdWRpbmcgdGhlIHBhdGgpDQovLyBib29sZWFuIGVuYWJsZSA6aW47dHJ1ZSB0byBlbmFibGUgdGhlIHN0eWxlc2hlZXQsIGZhbHNlIHRvIGRpc2FibGUNCmZ1bmN0aW9uIHNpdHNfc3R5bGVzaGVldF9lbmFibGUoZmlsZSxlbmFibGUpIHsNCglpZih0eXBlb2YoZmlsZSkhPT0ic3RyaW5nInx8ZmlsZT09PSIiKSByZXR1cm4gZmFsc2U7IAkvL2ZpbGVuYW1lIG11c3QgYmUgc3BlY2lmaWVkDQoJaWYodHlwZW9mKGVuYWJsZSkhPT0iYm9vbGVhbiIpIGVuYWJsZSA9IHRydWU7IC8vZW5hYmxlIGJ5IGRlZmF1bHQNCg0KCS8vc3RyaXAgYW55IHZlcnNpb25pbmcgZnJvbSB0aGUgZmlsZW5hbWUNCglpZihmaWxlLmluZGV4T2YoIj8iKT4tMSkgZmlsZSA9IGZpbGUuc3Vic3RyaW5nKDAsZmlsZS5sYXN0SW5kZXhPZigiPyIpKTsNCg0KCS8vbG9vcCB0aHJvdWdoIHRoZSBzdHlsZXNoZWV0cyBvYmplY3QgbG9va2luZyBmb3IgYSBtYXRjaA0KICB2YXIgc3R5bGVzaGVldHMgPSBkb2N1bWVudC5zdHlsZVNoZWV0cywgc2hlZXQsIGRpc2FibGVkLCBocmVmOw0KCWZvcih2YXIgaT0wO2k8c3R5bGVzaGVldHMubGVuZ3RoO2krKykgew0KCQlzaGVldCA9IHN0eWxlc2hlZXRzW2ldOw0KDQoJCS8vc2VlIGlmIHRoZSBmaWxlbmFtZSBtYXRjaGVzDQoJCWhyZWYgPSBzaGVldC5ocmVmIHx8ICIiOw0KCQlpZihocmVmLmluZGV4T2YoIi8iKT4tMSkgaHJlZiA9IGhyZWYuc3Vic3RyaW5nKGhyZWYubGFzdEluZGV4T2YoIi8iKSArIDEpOyAvL3N0cmlwIHRoZSBwYXRoDQoJCWlmKGhyZWYuaW5kZXhPZigiPyIpPi0xKSBocmVmID0gaHJlZi5zdWJzdHJpbmcoMCxocmVmLmxhc3RJbmRleE9mKCI/IikpOyAvL3N0cmlwIHRoZSB2ZXJzaW9uaW5nDQoNCgkJaWYoaHJlZi5pbmRleE9mKGZpbGUpPT09MCkgew0KCQkJLy9tYXRjaCBmb3VuZCwgc28gc2VlIGlmIHdlIG5lZWQgdG8gZW5hYmxlL2Rpc2FibGUNCgkJCWRpc2FibGVkID0gc2hlZXQuZGlzYWJsZWQ7DQoNCgkJCWlmKChkaXNhYmxlZCYmZW5hYmxlKXx8KCFkaXNhYmxlZCYmIWVuYWJsZSkpIHsgLy9pZiB3ZSdyZSBjaGFuZ2luZyBzdGF0ZSwgdGhlbiBkbyBzbw0KCQkJCXNoZWV0LmRpc2FibGVkID0gIWVuYWJsZTsNCgkJCX0NCg0KCQkJcmV0dXJuIHRydWU7IC8vc3R5bGVzaGVldCBmb3VuZA0KCQl9DQoJfQ0KDQoJcmV0dXJuIGZhbHNlOyAvL2lmIHdlJ3ZlIG1hZGUgaXQgaGVyZSB0aGVuIG5vIG1hdGNoIGZvdW5kDQp9DQoNCi8vYnVpbGQgYSByZWNvcmQgYmFyDQovLyBzZWwgLSBzZWxlY3RvciB0byBjb252ZXJ0IGluIHRvIGEgcmVjb3JkIGJhcg0KLy8gY3VyIC0gY3VycmVudCBwYWdlIHRvIHVzZQ0KLy8gdG90IC0gdG90YWwgcGFnZXMNCi8vIHJlY3MgLSBudW1iZXIgb2YgcmVjb3JkcyBwZXIgcGFnZSAob25seSB1c2VkIGluIGRpc3BsYXkgLSBvcHRpb25hbGx5LCBsZWF2ZSBibGFuayB0byBza2lwKQ0KLy8gZm5jIC0gY2FsbGJhY2sgZnVuY3Rpb24gKGNhbGxlZCB3aGVuIHRoZSBwYWdlIGNoYW5nZXMgLSB3aXRoIHRoZSBuZXcgcGFnZSBwYXNzZWQgaW4gYXMgYSBwYXJhbWV0ZXIpDQpmdW5jdGlvbiBzaXRzX3JlY29yZF9iYXIoc2VsLGN1cix0b3QscmVjcyxmbmMpew0KCS8vY2hlY2sgc2VsZWN0b3IgaXMgc3BlY2lmaWVkDQoJaWYoKHR5cGVvZihzZWwpIT09InN0cmluZyJ8fHNlbC5sZW5ndGg9PT0wKSAmJiB0eXBlb2Yoc2VsKSE9PSJvYmplY3QiKSByZXR1cm4gZmFsc2U7DQoJaWYodHlwZW9mKHRvdCkhPT0ibnVtYmVyIikgcmV0dXJuIGZhbHNlOyAvL25vIHRvdGFsIHBhZ2VzLCBzbyBubyBpZGVhIHdoYXQgdG8gYnVpbGQNCg0KCWlmKHR5cGVvZihjdXIpIT09Im51bWJlciIpIGN1ciA9IDE7IC8vYXNzdW1lIGZpcnN0IHBhZ2UgYnkgZGVmYXVsdA0KDQoJLy9idWlsZCB0aGUgbWFpbiBzdHJ1Y3R1cmUNCgl2YXIgaHRtbCA9ICI8bmF2IGNsYXNzPVwic3YtZm9ybS1wYWdpbmF0aW9uLWJ0blwiPiI7DQoJaHRtbCArPSAiPHAgY2xhc3M9XCJzdi1mb3JtLXBhZ2luYXRpb24tcmVjLWNvdW50XCI+PC9wPiI7DQoNCglodG1sICs9ICI8dWwgY2xhc3M9XCJzdi1wYWdpbmF0aW9uXCI+IjsNCglodG1sICs9ICI8bGkgZGF0YS1hY3Rpb249XCJGSVJTVFwiPjxpbnB1dCB0eXBlPVwic3VibWl0XCIgYXJpYS1sYWJlbD1cIiIrc2l0c19lc2NhcGVfYXR0cihzaXRzX2RvX3JlY29yZF9iYXJfYnAoImZpcnN0QnRuQXJpYVRleHQiKSkrIlwiIHZhbHVlPVwiIitzaXRzX2VzY2FwZV9hdHRyKHNpdHNfZG9fcmVjb3JkX2Jhcl9icCgiZmlyc3RCdG5UZXh0IikpKyJcIj4iOw0KCWh0bWwgKz0gIjxsaSBkYXRhLWFjdGlvbj1cIlBSRVZcIj48aW5wdXQgdHlwZT1cInN1Ym1pdFwiIGFyaWEtbGFiZWw9XCIiK3NpdHNfZXNjYXBlX2F0dHIoc2l0c19kb19yZWNvcmRfYmFyX2JwKCJwcmV2QnRuQXJpYVRleHQiKSkrIlwiIHZhbHVlPVwiIitzaXRzX2VzY2FwZV9hdHRyKHNpdHNfZG9fcmVjb3JkX2Jhcl9icCgicHJldkJ0blRleHQiKSkrIlwiPiI7DQoJaHRtbCArPSAiPGxpIGRhdGEtYWN0aW9uPVwiTkVYVFwiPjxpbnB1dCB0eXBlPVwic3VibWl0XCIgYXJpYS1sYWJlbD1cIiIrc2l0c19lc2NhcGVfYXR0cihzaXRzX2RvX3JlY29yZF9iYXJfYnAoIm5leHRCdG5BcmlhVGV4dCIpKSsiXCIgdmFsdWU9XCIiK3NpdHNfZXNjYXBlX2F0dHIoc2l0c19kb19yZWNvcmRfYmFyX2JwKCJuZXh0QnRuVGV4dCIpKSsiXCI+IjsNCglodG1sICs9ICI8bGkgZGF0YS1hY3Rpb249XCJMQVNUXCI+PGlucHV0IHR5cGU9XCJzdWJtaXRcIiBhcmlhLWxhYmVsPVwiIitzaXRzX2VzY2FwZV9hdHRyKHNpdHNfZG9fcmVjb3JkX2Jhcl9icCgibGFzdEJ0bkFyaWFUZXh0IikpKyJcIiB2YWx1ZT1cIiIrc2l0c19lc2NhcGVfYXR0cihzaXRzX2RvX3JlY29yZF9iYXJfYnAoImxhc3RCdG5UZXh0IikpKyJcIj4iOw0KCWh0bWwgKz0gIjwvdWw+IjsNCg0KCWh0bWwgKz0gIjwvbmF2PiI7DQoNCgkvL2luc2VydCBpbiB0byB0aGUgRE9NDQoJJChzZWwpLmh0bWwoaHRtbCk7DQoNCgkvL2ZpbmQgdGhlIGVsZW1lbnQgd2UganVzdCBidWlsdA0KCXZhciBuYXYgPSAkKHNlbCkuZmluZCgibmF2Iik7DQoNCgkvL2Vuc3VyZSBjYWxsYmFjayBmdW5jdGlvbiBhbmQgb3RoZXIgZGF0YSBpcyBhdmFpbGFibGUgZm9yIHVzZSBsYXRlcg0KCW5hdi5kYXRhKCJyZWMtYmFyLWNhbGxiYWNrIixmbmMpOyAvL2NhbGxiYWNrIGZ1bmN0aW9uDQoJbmF2LmRhdGEoInJlYy1iYXItY3VyIixjdXIpOyAvL2N1cnJlbnQgcGFnZQ0KCW5hdi5kYXRhKCJyZWMtYmFyLXRvdCIsdG90KTsgLy90b3RhbCBwYWdlcw0KCW5hdi5kYXRhKCJyZWMtYmFyLXJlY3MiLHJlY3MpOyAvL3JlY29yZHMgcGVyIHBhZ2UNCg0KCS8vYXR0YWNoIGV2ZW50cw0KCW5hdi5vbigiY2xpY2siLCI6c3VibWl0IixmdW5jdGlvbihldmVudCl7DQoJCXNpdHNfZG9fcmVjb3JkX2Jhcl9jbGljayhldmVudCk7DQoJfSk7DQoNCgkvL2J1aWxkIHBhZ2VzIGFuZCB1cGRhdGUgYnV0dG9ucw0KCXNpdHNfZG9fcmVjb3JkX2Jhcl9idWlsZChuYXYsIkdPVE8iLGN1cik7DQoNCgkvL3RyaWdnZXIgdGhlIGNhbGxiYWNrIGZ1bmN0aW9uIChpZiBzcGVjaWZpZWQpDQoJaWYodHlwZW9mKGZuYyk9PT0iZnVuY3Rpb24iKXsNCgkJZm5jKG5hdi5kYXRhKCJyZWMtYmFyLWN1ciIpKTsgLy9jYWxsIGZ1bmN0aW9uLCBwYXNzaW5nIGluIGN1cnJlbnQgcGFnZSBhcyB0aGUgb25seSBwYXJhbWV0ZXINCgl9DQoNCglyZXR1cm4gdHJ1ZTsNCn0NCg0KLy91cGRhdGUgYW4gZXhpc3RpbmcgcmVjb3JkIGJhciBwcm9ncmFtbWF0aWNhbGx5DQpmdW5jdGlvbiBzaXRzX3JlY29yZF9iYXJfdXBkYXRlKHNlbCxjdXIsdG90LHJlY3MscnVuZm5jKXsNCgkvL2NoZWNrIHNlbGVjdG9yIGlzIHNwZWNpZmllZA0KCWlmKCh0eXBlb2Yoc2VsKSE9PSJzdHJpbmcifHxzZWwubGVuZ3RoPT09MCkgJiYgdHlwZW9mKHNlbCkhPT0ib2JqZWN0IikgcmV0dXJuIGZhbHNlOw0KDQoJLy9kbyB3ZSBuZWVkIHRvIHRyaWdnZXIgdGhlIGNhbGxiYWNrIGZ1bmN0aW9uIGFmdGVyIHVwZGF0aW5nDQoJaWYodHlwZW9mIHJ1bmZuYyE9PSJib29sZWFuIil7DQoJCXJ1bmZuYyA9IHRydWU7DQoJfQ0KDQoJLy9maW5kIHRoZSByZWNvcmQgYmFyIGVsZW1lbnQNCgl2YXIgbmF2ID0gJChzZWwpLmZpbmQoIm5hdiIpOw0KCWlmKG5hdi5sZW5ndGg9PT0wKSByZXR1cm4gZmFsc2U7DQoNCgkvL3VwZGF0ZSB0aGUgaW5mb3JtYXRpb24gd2UgbmVlZCB0byAtIGlmIGN1ciwgdG90LCByZWNzLCBldGMgYXJlIG5vdCBudW1iZXJzIHRoZW4gd2UgdXNlIHRoZSBleGlzdGluZyB2YWx1ZSBpbnN0ZWFkIChzbyB3ZSBjYW4gcGFydGlhbGx5IHVwZGF0ZSkNCglpZih0eXBlb2YgY3VyPT09Im51bWJlciIpew0KCQluYXYuZGF0YSgicmVjLWJhci1jdXIiLGN1cik7IC8vY3VycmVudCBwYWdlDQoJfQ0KCWlmKHR5cGVvZiB0b3Q9PT0ibnVtYmVyIil7DQoJCW5hdi5kYXRhKCJyZWMtYmFyLXRvdCIsdG90KTsgLy90b3RhbCBwYWdlcw0KCX0NCglpZih0eXBlb2YgcmVjcz09PSJudW1iZXIiKXsNCgkJbmF2LmRhdGEoInJlYy1iYXItcmVjcyIscmVjcyk7IC8vcmVjb3JkcyBwZXIgcGFnZQ0KCX0NCg0KCS8vYnVpbGQgcGFnZXMgYW5kIHVwZGF0ZSBidXR0b25zDQoJc2l0c19kb19yZWNvcmRfYmFyX2J1aWxkKG5hdiwiR09UTyIsbmF2LmRhdGEoInJlYy1iYXItY3VyIikpOw0KDQoJLy90cmlnZ2VyIHRoZSBjYWxsYmFjayBmdW5jdGlvbg0KCWlmKHJ1bmZuYyl7DQoJCXZhciBmbmMgPSBuYXYuZGF0YSgicmVjLWJhci1jYWxsYmFjayIpOw0KCQlpZih0eXBlb2YgZm5jPT09ImZ1bmN0aW9uIil7DQoJCQlmbmMobmF2LmRhdGEoInJlYy1iYXItY3VyIikpOyAvL2NhbGwgZnVuY3Rpb24sIHBhc3NpbmcgaW4gY3VycmVudCBwYWdlIGFzIHRoZSBvbmx5IHBhcmFtZXRlcg0KCQl9DQoJfQ0KDQoJcmV0dXJuIHRydWU7DQp9DQoNCi8vSW50ZXJuYWwgZnVuY3Rpb24gdG8gYnVpbGQgYSBtZXNzYWdlIGZvciB0aGUgcmVjb3JkIGJhcg0KZnVuY3Rpb24gc2l0c19kb19yZWNvcmRfYmFyX2JwKGJwaWQsYnBwYXJhbXMpew0KCXZhciBicGxpc3QgPSBzaXRzX3dpZGdldF9icC5wZzsNCglpZih0eXBlb2YoYnBsaXN0KSE9PSJvYmplY3QiKSByZXR1cm4gIiI7DQoNCgl2YXIgYnAgPSBicGxpc3RbYnBpZF07DQoJaWYodHlwZW9mKGJwKSE9PSJzdHJpbmciKSByZXR1cm4gIiI7DQoNCgkvL2J1aWxkIHVwIHRoZSBtZXNzYWdlIHN0cmluZyBieSByZXBsYWNpbmcgezB9LCB7MX0sIGV0YyB3aXRoIGNvcnJlc3BvbmRpbmcgcGFyYW1zDQoJaWYodHlwZW9mKGJwcGFyYW1zKT09PSJvYmplY3QiKXsNCgkJZm9yKHZhciBpPTA7aTxicHBhcmFtcy5sZW5ndGg7aSsrKXsNCgkJCWJwID0gc2l0c19yZXBsYWNlX2FsbChicCwieyIraSsifSIsYnBwYXJhbXNbaV0pOw0KCQl9DQoJfQ0KCXJldHVybiBicDsNCn0NCg0KLy9JbnRlcm5hbCBmdW5jdGlvbiB0byB1cGRhdGUgdGhlIHJlY29yZCBiYXIgKHBhZ2UgY2hhbmdlcyBmb3IgZXhhbXBsZSkNCmZ1bmN0aW9uIHNpdHNfZG9fcmVjb3JkX2Jhcl9idWlsZChuYXYsbW9kZSxwYWdlKXsNCgkvL2dldCB0aGUgdG90YWwgcGFnZXMgYW5kIHJlY29yZHMgcGVyIHBhZ2UNCgl2YXIgY3VyID0gbmF2LmRhdGEoInJlYy1iYXItY3VyIik7DQoJdmFyIHRvdCA9IG5hdi5kYXRhKCJyZWMtYmFyLXRvdCIpOw0KCXZhciByZWNzID0gbmF2LmRhdGEoInJlYy1iYXItcmVjcyIpOw0KDQoJdmFyIG5ld3BhZ2UgPSBjdXI7DQoNCgkvL3dvcmsgb3V0IHdoYXQgdGhlIG5leHQgcGFnZSBpcyB0byBzaG93IChiYXNlZCBvbiB0aGUgbW9kZSkNCglzd2l0Y2gobW9kZSl7DQoJY2FzZSAiRklSU1QiOg0KCQluZXdwYWdlID0gMTsNCgkJYnJlYWs7DQoJY2FzZSAiUFJFViI6DQoJCW5ld3BhZ2UgPSBjdXIgLSAxOw0KCQlicmVhazsNCgljYXNlICJORVhUIjoNCgkJbmV3cGFnZSA9IGN1ciArIDE7DQoJCWJyZWFrOw0KCWNhc2UgIkxBU1QiOg0KCQluZXdwYWdlID0gdG90Ow0KCQlicmVhazsNCgljYXNlICJHT1RPIjoNCgkJaWYodHlwZW9mKHBhZ2UpPT09Im51bWJlciIpew0KCQkJbmV3cGFnZSA9IHBhZ2UNCgkJfQ0KCQlicmVhazsNCgl9DQoNCgkvL2lmIHRoZXJlIGlzIG9ubHkgb25lIHBhZ2UgdGhlbiB3ZSBhZGQgYSBjbGFzcyB0byB0aGUgTkFWIGZvciBzdHlsaW5nIChzbyBpdCBjYW4gYmUgaGlkZGVuKQ0KCWlmKHRvdDw9MSl7DQoJCW5hdi5hZGRDbGFzcygic3YtZm9ybS1wYWdpbmF0aW9uLXNpbmdsZS1wYWdlIik7DQoJfQ0KCWVsc2V7DQoJCW5hdi5yZW1vdmVDbGFzcygic3YtZm9ybS1wYWdpbmF0aW9uLXNpbmdsZS1wYWdlIik7DQoJfQ0KDQoJLy9jaGVjayB0aGUgcGFnZSBpcyBhY3R1YWxseSB2YWxpZA0KCWlmKG5ld3BhZ2UgPCAxKXsNCgkJbmV3cGFnZSA9IDE7DQoJfQ0KCWVsc2V7DQoJCWlmKG5ld3BhZ2UgPiB0b3Qpew0KCQkJbmV3cGFnZSA9IHRvdDsNCgkJfQ0KCX0NCg0KCS8vdXBkYXRlIHRoZSByZWNvcmQgYmFyIHN0cnVjdHVyZQ0KCXZhciBhY3Rpb24sIGxpLCBidG4sIHByZXZsaTsNCgluYXYuZmluZCgidWwuc3YtcGFnaW5hdGlvbiA+IGxpIikuZWFjaChmdW5jdGlvbigpew0KCQlsaSA9ICQodGhpcyk7DQoJCWJ0biA9IGxpLmZpbmQoIjpzdWJtaXQiKTsNCgkJYWN0aW9uID0gbGkuZGF0YSgiYWN0aW9uIik7IC8vd2hhdCBkb2VzIHRoZSBjdXJyZW50IGxpL2J1dHRvbiBkbw0KDQoJCXN3aXRjaChhY3Rpb24pew0KCQljYXNlICJQUkVWIjoNCgkJCXByZXZsaSA9ICQodGhpcyk7IC8va2VlcCBhIHJlZmVyZW5jZSB0byB0aGUgUHJldmlvdXMgTEkgYXMgd2UgYXR0YWNoIHBhZ2UgbnVtYmVycyBhZnRlciB0aGlzIC8vTm90ZTogdGhlcmUgaXMgbm8gImJyZWFrIiBoZXJlIG9uIHB1cnBvc2UNCgkJY2FzZSAiRklSU1QiOg0KCQkJaWYobmV3cGFnZT09PTEpew0KCQkJCWxpLmFkZENsYXNzKCJzdi1kaXNhYmxlZCIpOw0KCQkJCWJ0bi5hZGRDbGFzcygic3YtZGlzYWJsZWQiKS5hdHRyKCJhcmlhLWRpc2FibGVkIix0cnVlKTsNCgkJCX0NCgkJCWVsc2V7DQoJCQkJbGkucmVtb3ZlQ2xhc3MoInN2LWRpc2FibGVkIik7DQoJCQkJYnRuLnJlbW92ZUNsYXNzKCJzdi1kaXNhYmxlZCIpLmF0dHIoImFyaWEtZGlzYWJsZWQiLGZhbHNlKTsNCgkJCX0NCgkJCWJyZWFrOw0KCQljYXNlICJORVhUIjoNCgkJY2FzZSAiTEFTVCI6DQoJCQlpZihuZXdwYWdlPT09dG90KXsNCgkJCQlsaS5hZGRDbGFzcygic3YtZGlzYWJsZWQiKTsNCgkJCQlidG4uYWRkQ2xhc3MoInN2LWRpc2FibGVkIikuYXR0cigiYXJpYS1kaXNhYmxlZCIsdHJ1ZSk7DQoJCQl9DQoJCQllbHNlew0KCQkJCWxpLnJlbW92ZUNsYXNzKCJzdi1kaXNhYmxlZCIpOw0KCQkJCWJ0bi5yZW1vdmVDbGFzcygic3YtZGlzYWJsZWQiKS5hdHRyKCJhcmlhLWRpc2FibGVkIixmYWxzZSk7DQoJCQl9DQoJCQlicmVhazsNCgkJY2FzZSAiR09UTyI6DQoJCQlsaS5yZW1vdmUoKTsgLy9yZW1vdmUgYW55IHBhZ2UgbnVtYmVycyAtIHdlIHJlYnVpbGQgYmVsb3cNCgkJCWJyZWFrOw0KCQl9DQoJfSk7DQoNCgkvL3dvcmsgb3V0IHdoYXQgcGFnZXMgd2UgbmVlZCB0byBzaG93DQoJdmFyIHBhZ2VzID0gc2l0c19kb19yZWNvcmRfYmFyX3BhZ2VzKG5ld3BhZ2UsdG90KTsNCg0KCS8vbm93IGluY2x1ZGUgdGhlIG5ldyBwYWdlcw0KCWlmKHByZXZsaS5sZW5ndGg+MCl7DQoJCXZhciBwYWdlLCBodG1sLCBhY3RpdmU7DQoJCWZvcih2YXIgaT1wYWdlcy5sZW5ndGgtMTtpPj0wO2ktLSl7IC8vd2UgbG9vcCBiYWNrd2FyZHMgc28gd2UgYWx3YXlzIGFkZCB0byB0aGUgcmlnaHQgcGxhY2UNCgkJCXBhZ2UgPSBwYWdlc1tpXTsNCg0KCQkJaWYocGFnZT09PW5ld3BhZ2UpeyAvL2N1cnJlbnQgYnV0dG9uDQoJCQkJYWN0aXZlID0gdHJ1ZTsNCgkJCX0NCgkJCWVsc2V7DQoJCQkJYWN0aXZlID0gZmFsc2U7DQoJCQl9DQoJCQlodG1sID0gIjxsaSBkYXRhLWFjdGlvbj1cIkdPVE9cIiBkYXRhLXBhZ2UtbnVtPVwiIitwYWdlKyJcIiBjbGFzcz1cInN2LXBhZ2luYXRpb24tcGFnZSIrKGFjdGl2ZT8iIHN2LWFjdGl2ZSI6IiIpKyJcIj48aW5wdXQgdHlwZT1cInN1Ym1pdFwiIisoYWN0aXZlPyIgYXJpYS1kaXNhYmxlZD1cInRydWVcIiI6IiIpKyIgYXJpYS1sYWJlbD1cIiIrc2l0c19lc2NhcGVfYXR0cihzaXRzX2RvX3JlY29yZF9iYXJfYnAoInBhZ2VCdG5BcmlhVGV4dCIsW3BhZ2VdKSkrIlwiIHZhbHVlPVwiIitzaXRzX2VzY2FwZV9hdHRyKCIiK3BhZ2UpKyJcIj4iOw0KDQoJCQlwcmV2bGkuYWZ0ZXIoaHRtbCk7DQoJCX0NCgl9DQoNCgkvL3VwZGF0ZSB0aGUgcmVjb3JkIGRpc3BsYXkNCglpZih0eXBlb2YocmVjcyk9PT0ibnVtYmVyIil7DQoJCW5hdi5maW5kKCIuc3YtZm9ybS1wYWdpbmF0aW9uLXJlYy1jb3VudCIpLmh0bWwoc2l0c19kb19yZWNvcmRfYmFyX2JwKCJpbmZvV2l0aFJlY3NUZXh0IixbbmV3cGFnZSx0b3QscmVjc10pKTsNCgl9DQoJZWxzZXsNCgkJbmF2LmZpbmQoIi5zdi1mb3JtLXBhZ2luYXRpb24tcmVjLWNvdW50IikuaHRtbChzaXRzX2RvX3JlY29yZF9iYXJfYnAoImluZm9UZXh0IixbbmV3cGFnZSx0b3RdKSk7DQoJfQ0KDQoJLy91cGRhdGUgdGhlIGN1cnJlbnQgcGFnZQ0KCW5hdi5kYXRhKCJyZWMtYmFyLWN1ciIsbmV3cGFnZSk7DQp9DQoNCi8vSW50ZXJuYWwgZnVuY3Rpb24gdG8gYnVpbGQgYSBsaXN0IG9mIHBhZ2VzIHRvIHNob3cgaW4gdGhlIHJlY29yZCBiYXINCmZ1bmN0aW9uIHNpdHNfZG9fcmVjb3JkX2Jhcl9wYWdlcyhjdXIsdG90KXsNCgl2YXIgYnRucyA9IDU7IC8vd2UgYWltIHRvIHNob3cgNSBidXR0b25zIG1heGltdW0NCgl2YXIgaGFsZiA9IE1hdGguZmxvb3IoYnRucy8yKTsNCg0KCXZhciBwYWdlcyA9IFtdLCBzdGFydCwgZW5kOw0KDQoJaWYodG90IDw9IGJ0bnMpeyAvL2xlc3MgcGFnZXMgdGhhbiByZXF1aXJlZCwgc28gc2hvdyB3aGF0J3MgYXZhaWxhYmxlDQoJCXN0YXJ0ID0gMTsNCgkJZW5kID0gdG90Ow0KCX0NCgllbHNlew0KCQlpZihjdXIgPj0gKHRvdCAtIGhhbGYpKXsgLy90b3dhcmRzIHRoZSBlbmQgb2YgdGhlIGxpc3QsIHNvIGRpc3BsYXkgdGhlIGxhc3Qgc2V0IG9mIGJ1dHRvbnMNCgkJCXN0YXJ0ID0gdG90IC0gYnRucyArIDE7DQoJCQllbmQgPSB0b3Q7DQoJCX0NCgkJZWxzZXsgLy9lbnN1cmUgdGhlIHNlbGVjdGVkIGJ1dHRvbiBpcyBjZW50cmVkIGluIHRoZSBkaXNwbGF5ZWQgcGFnZSBudW1iZXJzICh3aGVyZSBwb3NzaWJsZSkNCgkJCXN0YXJ0ID0gY3VyIC0gMjsNCgkJCWVuZCA9IGN1ciArIDI7DQoNCgkJCS8vaWYgdGhlIHN0YXJ0IG9yIGVuZCBpcyBvdXRzaWRlIG9mIHRoZSBhdmFpbGFibGUgcmFuZ2UgdGhlbiBhZGp1c3QgKHdoaWxzdCB0cnlpbmcgdG8gc2hvdyB0aGUgcmVxdWlyZWQgbnVtYmVyIG9mIGJ1dHRvbnMpDQoJCQlpZihzdGFydCA8IDEpew0KCQkJCXN0YXJ0ID0gMTsNCgkJCQllbmQgPSBzdGFydCArIGJ0bnMgLSAxOw0KCQkJfQ0KCQkJaWYoZW5kID4gdG90KXsNCgkJCQllbmQgPSB0b3Q7DQoJCQl9DQoJCX0NCgl9DQoNCglpZiAoc3RhcnQgPiBlbmQpew0KCQllbmQgPSBzdGFydDsgLy9hdm9pZCBpbmZpbml0ZSBsb29wIGlmIHNvbWV0aGluZyB3ZW50IHdyb25nDQoJfQ0KDQoJLy9idWlsZCB0aGUgcGFnZSBsaXN0DQoJd2hpbGUoc3RhcnQgPD0gZW5kKXsNCgkJcGFnZXMucHVzaChzdGFydCk7DQoJCXN0YXJ0Kys7DQoJfQ0KDQoJcmV0dXJuIHBhZ2VzOw0KfQ0KDQovL0ludGVybmFsIGZ1bmN0aW9uIGNhbGxlZCB3aGVuIHRoZSByZWNvcmQgYmFyIGlzIGNsaWNrZWQNCmZ1bmN0aW9uIHNpdHNfZG9fcmVjb3JkX2Jhcl9jbGljayhldmVudCl7DQoJLy93b3JrIG91dCB3aGF0IGFjdGlvbiB3YXMgY2xpY2tlZCAtIGl0J3MgYXR0YWNoZWQgdG8gdGhlIExJDQoJdmFyIGVsZSA9ICQoc2l0c19nZXRfdGFyZ2V0KGV2ZW50KSkuY2xvc2VzdCgibGkiKTsNCg0KCXZhciBhY3Rpb24gPSBlbGUuZGF0YSgiYWN0aW9uIiksIHBhZ2U7DQoJaWYoIWVsZS5pcygiLnN2LWRpc2FibGVkLC5zdi1hY3RpdmUiKSAmJiB0eXBlb2YoYWN0aW9uKSE9PSJ1bmRlZmluZWQiKXsNCgkJLy9maW5kIHRoZSByZWNvcmQgYmFyIGVsZW1lbnQgYXNzb2NpYXRlZCB3aXRoIGl0DQoJCXZhciBuYXYgPSBlbGUuY2xvc2VzdCgibmF2Iik7DQoNCgkJLy9pZiB0aGUgdXNlciBjbGlja2VkIG9uIGEgc3BlY2lmaWMgcGFnZSBudW1iZXIgdGhlbiB3ZSBuZWVkIHRvIHRyYWNrIHdoaWNoIHBhZ2UgKGFzIHdlIG1heSBuZWVkIHRvIHJlc2V0IGZvY3VzIGxhdGVyIGFmdGVyIHJlYnVpbGRpbmcpDQoJCWlmKGFjdGlvbj09PSJHT1RPIil7DQoJCQlwYWdlID0gZWxlLmRhdGEoInBhZ2UtbnVtIik7DQoJCX0NCgkJZWxzZXsNCgkJCXBhZ2UgPSAiIjsNCgkJfQ0KDQoJCS8vdXBkYXRlIHRoZSByZWNvcmQgYmFyDQoJCXNpdHNfZG9fcmVjb3JkX2Jhcl9idWlsZChuYXYsYWN0aW9uLHBhZ2UpOw0KDQoJCS8vcmVzZXQgZm9jdXMgKGlmIHdlIG5lZWQgdG8pDQoJCXZhciBsaTsNCgkJbmF2LmZpbmQoInVsLnN2LXBhZ2luYXRpb24gPiBsaSIpLmVhY2goZnVuY3Rpb24oKXsNCgkJCWxpID0gJCh0aGlzKTsNCg0KCQkJaWYobGkuZGF0YSgiYWN0aW9uIik9PT1hY3Rpb24pew0KCQkJCWlmKGFjdGlvbiE9PSJHT1RPInx8bGkuZGF0YSgicGFnZS1udW0iKT09PXBhZ2Upew0KCQkJCQlsaS5maW5kKCI6c3VibWl0IikuZm9jdXMoKTsgLy9mb2N1cyBvbiB0aGUgYXNzb2NpYXRlZCBidXR0b24gZWxlbWVudCwgYXMgaXQgd2FzIGZvY3Vzc2VkIG9uIGJlZm9yZQ0KCQkJCQlyZXR1cm4gZmFsc2U7DQoJCQkJfQ0KCQkJfQ0KCQl9KTsNCg0KCQkvL3J1biB0aGUgY2FsbGJhY2sgZnVuY3Rpb24gKGlmIHRoZXJlIGlzIG9uZSkNCgkJdmFyIGZuYyA9IG5hdi5kYXRhKCJyZWMtYmFyLWNhbGxiYWNrIik7DQoJCWlmKHR5cGVvZihmbmMpPT09ImZ1bmN0aW9uIil7DQoJCQlmbmMobmF2LmRhdGEoInJlYy1iYXItY3VyIikpOyAvL2NhbGwgZnVuY3Rpb24sIHBhc3NpbmcgaW4gY3VycmVudCBwYWdlIGFzIHRoZSBvbmx5IHBhcmFtZXRlcg0KCQl9DQoJfQ0KDQoJcmV0dXJuIHNpdHNfY2FuY2VsX2V2ZW50KGV2ZW50KTsNCn0NCg0KLy9Bbm5vdW5jZSBpbmZvcm1hdGlvbiB0byBhIHNjcmVlbnJlYWRlciAtIHVzZWQgb25seSB3aGVuIHNjcmVlbiBjaGFuZ2VzIGFyZSBub3QgYXV0b21hdGljYWxseSBhbm5vdW5jZWQNCi8vIHN0cmluZyBtZXMgOmluIDt0aGUgbWVzc2FnZSB0byBhbm5vdW5jZQ0KZnVuY3Rpb24gc2l0c19hbm5vdW5jZShtZXMpew0KCWlmKHR5cGVvZihtZXMpIT09InN0cmluZyIpew0KCQlyZXR1cm4gZmFsc2U7DQoJfQ0KDQoJLy9zZWUgaWYgdGhlIHJlcXVpcmVkIGVsZW1lbnQgaXMgYXZhaWxhYmxlLCBhbmQgY3JlYXRlIGlmIG5vdA0KCXZhciBlbGUgPSAkKCIjc2l0c19hbm5vdW5jZV9lbGVtZW50Iik7DQoJaWYoZWxlLmxlbmd0aD09PTApew0KCQkvL2NyZWF0ZSB0aGUgZWxlbWVudA0KCQllbGUgPSAkKCI8c3BhbiBpZD1cInNpdHNfYW5ub3VuY2VfZWxlbWVudFwiIGFyaWEtbGl2ZT1cInBvbGl0ZVwiIGNsYXNzPVwic3Ytc3Itb25seVwiPjwvc3Bhbj4iKTsNCg0KCQkvL2luc2VydCBpdCBpbiB0byB0aGUgZG9jdW1lbnQNCgkJJCgiYm9keSIpLmFwcGVuZChlbGUpOw0KCX0NCg0KCS8vdXBkYXRlIHRoZSBlbGVtZW50IChzaG91bGQgYmUgcmVhZCBvdXQgYnkgdGhlIHNjcmVlbnJlYWRlcikgLSBuZWVkcyB0byBiZSBpbiBhIHRpbWVvdXQgb3IgdGhlIHNjcmVlbnJlYWRlciBjYW4gaWdub3JlIHRoZSBpbml0aWFsIGNhbGwNCglzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7DQoJCWVsZS5odG1sKG1lcyk7DQoJfSwwKTsNCg0KCXJldHVybiB0cnVlOw0KfQ0KDQovL3Nob3cgb25lIG9yIG1vcmUgZWxlbWVudHMgKHJlYWR5IGZvciBqUXVlcnkgMykNCi8vc3RyaW5nIHNlbCA6IGluIDtqUXVlcnkgc2VsZWN0b3IgdG8gYXBwbHkgdGhlIHRhYnMgdG8gKG9yIGVsZW1lbnQpDQovL2Z1bmN0aW9uIGZuYyA6IGluIDtjYWxsYmFjayBmdW5jdGlvbiAtIG9wdGlvbmFsDQovL3N0cmluZy9udW1iZXIgZHVyIDogaW4gO2R1cmF0aW9uIGluIG1zIChvciAiZmFzdCIgb3IgInNsb3ciIGV0YykgLSBvcHRpb25hbA0KLy9zdHJpbmcgZWFzIDogaW4gO2Vhc2luZyBmdW5jdGlvbiB0byB1c2UgZm9yIHRoZSB0cmFuc2l0aW9uIChlLmcuICJzd2luZyIpIC0gb3B0aW9uYWwNCmZ1bmN0aW9uIHNpdHNfc2hvdyhzZWwsZm5jLGR1cixlYXMpew0KICB2YXIgb2JqID0gJChzZWwpOw0KICBpZihvYmoubGVuZ3RoPDEpIHsNCiAgICByZXR1cm4gZmFsc2U7IC8vbm8gb2JqZWN0cyBmb3VuZA0KICB9DQogIG9iai5yZW1vdmVDbGFzcygic3YtaGlkZSIpOw0KICBpZih0eXBlb2YoZm5jKSA9PSAiZnVuY3Rpb24iKXsNCiAgICBvYmouZWFjaChmdW5jdGlvbihpKXsNCiAgICAgIGZuYy5jYWxsKHRoaXMpOyAvL2NhbGwgY2FsbGJhY2sgZnVuYw0KICAgIH0pOw0KICB9DQogIHJldHVybiB0cnVlOw0KfQ0KDQovL2hpZGUgb25lIG9yIG1vcmUgZWxlbWVudHMgKHJlYWR5IGZvciBqUXVlcnkgMykNCi8vc3RyaW5nIHNlbCA6IGluIDtqUXVlcnkgc2VsZWN0b3IgdG8gYXBwbHkgdGhlIHRhYnMgdG8gKG9yIGVsZW1lbnQpDQovL2Z1bmN0aW9uIGZuYyA6IGluIDtjYWxsYmFjayBmdW5jdGlvbiAtIG9wdGlvbmFsDQovL3N0cmluZy9udW1iZXIgZHVyIDogaW4gO2R1cmF0aW9uIGluIG1zIChvciAiZmFzdCIgb3IgInNsb3ciIGV0YykgLSBvcHRpb25hbA0KLy9zdHJpbmcgZWFzIDogaW4gO2Vhc2luZyBmdW5jdGlvbiB0byB1c2UgZm9yIHRoZSB0cmFuc2l0aW9uIChlLmcuICJzd2luZyIpIC0gb3B0aW9uYWwNCmZ1bmN0aW9uIHNpdHNfaGlkZShzZWwsZm5jLGR1cixlYXMpew0KICB2YXIgb2JqID0gJChzZWwpOw0KICBpZihvYmoubGVuZ3RoPDEpIHsNCiAgICByZXR1cm4gZmFsc2U7IC8vbm8gb2JqZWN0cyBmb3VuZA0KICB9DQogIG9iai5hZGRDbGFzcygic3YtaGlkZSIpOw0KICBpZih0eXBlb2YoZm5jKSA9PSAiZnVuY3Rpb24iKXsNCiAgICBvYmouZWFjaChmdW5jdGlvbihpKXsNCiAgICAgIGZuYy5jYWxsKHRoaXMpOyAvL2NhbGwgY2FsbGJhY2sgZnVuYw0KICAgIH0pOw0KICB9DQogIHJldHVybiB0cnVlOw0KfQ0KDQovL2NhbGxlZCB3aGVuIGdvb2dsZSBhcGkgaXMgbG9hZGVkICggdGhpcyBzaG91bGQgYmUgdGhlIGNhbGxiYWNrIGZ1bmN0aW9uIGZvciBzaXRzX2F0dGFjaF9maWxlICkNCmZ1bmN0aW9uIHNpdHNfZ2FwaV9sb2FkZWRfZm5jKCl7DQogIGlmICh0eXBlb2YoZ2FwaSkgIT0gIm9iamVjdCIpew0KICAgIHNldFRpbWVvdXQoc2l0c19nYXBpX2xvYWRlZF9mbmMsMTAwKTsNCiAgICByZXR1cm4gZmFsc2U7DQogIH0NCiAgZ2FwaS5sb2FkKCdhdXRoJywgIHsnY2FsbGJhY2snOiBzaXRzX2dhcGlfYXV0aF9sb2FkZWRfZm5jfSk7DQogIGdhcGkubG9hZCgncGlja2VyJyx7J2NhbGxiYWNrJzogc2l0c19nYXBpX3BpY2tlcl9sb2FkZWRfZm5jfSk7DQp9DQpmdW5jdGlvbiBzaXRzX2dhcGlfYXV0aF9sb2FkZWRfZm5jKCl7DQogIHNpdHNfZ2FwaV9hdXRoX2xvYWRlZCA9IHRydWU7DQp9DQpmdW5jdGlvbiBzaXRzX2dhcGlfcGlja2VyX2xvYWRlZF9mbmMoKXsNCiAgc2l0c19nYXBpX3BpY2tlcl9sb2FkZWQgPSB0cnVlOw0KfQ0KDQovL1Nob3cgb3IgaGlkZSBhIGxvYWRpbmcvcHJvY2Vzc2luZy9zYXZpbmcgZGlhbG9nDQovL2Jvb2xlYW4gb3BuIDppbiA7b3BlbiAodHJ1ZSkgb3IgY2xvc2UgKGZhbHNlKSB0aGUgZGlhbG9nDQovL3N0cmluZyBtb2QgOmluIDtpcyB0aGlzIGEgTE9BRCwgUFJPQ0VTUywgb3IgU0FWRSBkaWFsb2cNCi8vc3RyaW5nIHRpZCA6aW4gO2lkIGZvciB0aGUgZGlhbG9nIChpZiBub3Qgc3BlY2lmaWVkLCBzaXRzX2xvYWRpbmdfZGlhbG9nIHdpbGwgYmUgdXNlZCkNCmZ1bmN0aW9uIHNpdHNfZGlhbG9nX2xvYWRpbmcob3BuLG1vZCx0aWQpew0KCWlmKHR5cGVvZiBvcG4hPT0iYm9vbGVhbiIpIG9wbiA9IHRydWU7IC8vb3BlbmluZyBhIGRpYWxvZyBieSBkZWZhdWx0DQoJaWYodHlwZW9mIG1vZCE9PSJzdHJpbmcifHxtb2Q9PT0iIikgbW9kID0gIkxPQUQiOyAvL2xvYWRpbmcgZGlhbG9nIGlzIHRoZSBkZWZhdWx0DQoJaWYodHlwZW9mIHRpZCE9PSJzdHJpbmcifHx0aWQ9PT0iIikgdGlkID0gInNpdHNfbG9hZGluZ19kaWFsb2ciOw0KDQoJLy9hbHdheXMgdHJ5IGFuZCBjbG9zZSB0aGUgZGlhbG9nIGZpcnN0IChpbiBjYXNlIGl0J3MgYWxyZWFkeSBvcGVuKQ0KCXNpdHNfZGlhbG9nX2Nsb3NlKHRydWUsdGlkKTsNCg0KCS8vaWYgd2UncmUganVzdCBjbG9zaW5nIHRoZSBkaWFsb2cgdGhlbiB3ZSdyZSBkb25lDQoJaWYoIW9wbil7DQoJCXJldHVybiB0cnVlOw0KCX0NCg0KCS8vaW5pdGlhbGlzZSB0aGUgbG9hZGluZyBvZiB0aGUgaW1hZ2UNCgl2YXIgaW1nID0gbmV3IEltYWdlKCk7DQoJaW1nLnNyYyA9ICIuLi9pbWFnZXMvd29ya2luZy5naWYiOyAvL3RoaXMgc2hvdWxkIHN0YXJ0IGxvYWRpbmcgdGhlIGltYWdlIGluIG1vc3QgYnJvd3NlcnMNCg0KCS8vZ2V0IHRoZSBib2lsZXJwbGF0ZSBvYmplY3QNCgl2YXIgYnAgPSB7fTsNCglpZih0eXBlb2Ygc2l0c193aWRnZXRfYnA9PT0ib2JqZWN0IiYmdHlwZW9mIHNpdHNfd2lkZ2V0X2JwLmxkPT09Im9iamVjdCIpew0KCQlicCA9IHNpdHNfd2lkZ2V0X2JwLmxkOw0KCX0NCg0KCS8vZGV0ZXJtaW5lIHdoYXQgdGV4dCB0byB1c2UgZm9yIHRoaXMgZGlhbG9nIChiYXNlZCBvbiB0aGUgbW9kZSkNCgl2YXIgdHRsID0gIiIsIGNvbnQgPSAiIjsNCglzd2l0Y2gobW9kKXsNCgljYXNlICJMT0FEIjoNCgkJdHRsID0gKHR5cGVvZiBicC5sb2FkVGl0bGU9PT0ic3RyaW5nIik/YnAubG9hZFRpdGxlOiJMb2FkaW5nIjsNCgkJY29udCA9ICh0eXBlb2YgYnAubG9hZENvbnRlbnQ9PT0ic3RyaW5nIik/YnAubG9hZENvbnRlbnQ6IkxvYWRpbmcsIHBsZWFzZSB3YWl0Li4uIjsNCgkJYnJlYWs7DQoJY2FzZSAiUFJPQ0VTUyI6DQoJCXR0bCA9ICh0eXBlb2YgYnAucHJvY2Vzc1RpdGxlPT09InN0cmluZyIpP2JwLnByb2Nlc3NUaXRsZToiUHJvY2Vzc2luZyI7DQoJCWNvbnQgPSAodHlwZW9mIGJwLnByb2Nlc3NDb250ZW50PT09InN0cmluZyIpP2JwLnByb2Nlc3NDb250ZW50OiJQcm9jZXNzaW5nLCBwbGVhc2Ugd2FpdC4uLiI7DQoJCWJyZWFrOw0KCWNhc2UgIlNBVkUiOg0KCQl0dGwgPSAodHlwZW9mIGJwLnNhdmVUaXRsZT09PSJzdHJpbmciKT9icC5zYXZlVGl0bGU6IlNhdmluZyI7DQoJCWNvbnQgPSAodHlwZW9mIGJwLnNhdmVDb250ZW50PT09InN0cmluZyIpP2JwLnNhdmVDb250ZW50OiJTYXZpbmcsIHBsZWFzZSB3YWl0Li4uIjsNCgkJYnJlYWs7DQoJZGVmYXVsdDoNCgkJcmV0dXJuIGZhbHNlOyAvL2ludmFsaWQgbW9kZQ0KCX0NCg0KCS8vcHJlZml4IHRoZSBjb250ZW50IHdpdGggdGhlIGltYWdlDQoJY29udCA9ICI8aW1nIHNyYz1cIi4uL2ltYWdlcy93b3JraW5nLmdpZlwiIGFsdD1cIiIrc2l0c19lc2NhcGVfYXR0cih0dGwpKyJcIiB0aXRsZT1cIiIrc2l0c19lc2NhcGVfYXR0cihjb250KSsiXCI+ICIgKyBjb250Ow0KDQoJLy9zaG93IHRoZSBkaWFsb2cNCglzaXRzX2RpYWxvZyh0dGwsY29udCx7fSxmYWxzZSx0cnVlLGZhbHNlLDk5OTksdGlkLHRydWUsMzUpOw0KCXJldHVybiB0cnVlOw0KfQ0KDQovL1VzZWQgdG8ga2VlcCBmaW5hbmNpYWwgdG90YWxzIGlubGluZSB3aXRoIGRhdGEgdmFsdWVzDQpmdW5jdGlvbiBzaXRzX2ZpbmFuY2lhbF90b3RhbHMoKSB7DQogIHZhciB0b3QgPSAkKCIuc3YtZmluYW5jaWFsLXRvdGFsIik7DQogIGlmKHRvdC5sZW5ndGg8MSkgew0KICAgIHJldHVybiB0cnVlOyAvL25vIHRvdGFscyB2aXNpYmxlDQogIH0NCiAgaWYoIXNpdHNfZXZlbnRzLmZpbmFuY2lhbFRvdGFsc1Jlc2l6ZSkgew0KICAgICQod2luZG93KS5vbigicmVzaXplIixzaXRzX2RlYm91bmNlX2V2ZW50KHNpdHNfZmluYW5jaWFsX3RvdGFscywyNTApKTsgLy9yZWdpc3RlciByZXNpemUgZXZlbnQNCiAgICBzaXRzX2V2ZW50cy5maW5hbmNpYWxUb3RhbHNSZXNpemUgPSB0cnVlOw0KICB9DQogIGlmKCFzaXRzX2V2ZW50cy5maW5hbmNpYWxUb3RhbHNDb2xDaGFuZ2UpIHsNCiAgICAkKGRvY3VtZW50KS5vbigidGFibGVzYXdjb2xjaGFuZ2UiLCIudGFibGVzYXctc3dpcGUsLnRhYmxlc2F3LWNvbHVtbnRvZ2dsZSIsc2l0c19maW5hbmNpYWxfdG90YWxzKTsgLy9yZWdpc3RlciBldmVudCBmb3IgdGFibGVzYXcgY29sdW1uIGNoYW5nZSAoZS5nLiBzd2lwZSkNCiAgICBzaXRzX2V2ZW50cy5maW5hbmNpYWxUb3RhbHNDb2xDaGFuZ2UgPSB0cnVlOw0KICB9DQoNCiAgLy9pZiB0aGUgZmluYW5jaWFsIHRvdGFscyBzZWN0aW9uIGlzIGFmZmVjdGVkIGJ5IHN2LXBvcnRhbC5jc3MgdGhlbiB3ZSBuZWVkIHRvIGNhbGN1bGF0ZSB0aGUgY3VycmVudCBicmVha3BvaW50IGRpZmZlcmVudGx5DQogIHZhciBicCwgY2FsY2JwID0gZmFsc2U7DQogIGlmKHNpdHNfcG9ydGFsX29iamVjdC5oYXNBZmZlY3RlZCYmIXNpdHNfcG9ydGFsX29iamVjdC5pc0Rpc2FibGVkKSB7DQoJCWNhbGNicCA9IHRydWU7IC8vY2FsY3VsYXRlIHRoZSBicmVha3BvaW50IGluZGl2aWR1YWxseSBmb3IgZWFjaCB0b3RhbHMgYmxvY2sNCiAgfQ0KICBlbHNlew0KICAJYnAgPSBzaXRzX2dldF9icmVha3BvaW50KCk7IC8vdXNlIHRoZSBvdmVyYWxsIHBhZ2UgYnJlYWtwb2ludA0KICB9DQoNCiAgdG90LmVhY2goZnVuY3Rpb24gKCkgeyAvL2xvb3AgdGhyb3VnaCB0b3RhbHMgYW5kIHJlLXBvc2l0aW9uDQogICAgdmFyIGVsZSA9ICQodGhpcyk7DQoNCgkJLy9pZiB0aGUgdG90YWxzIGFyZSBpbiB0aGUgeHMgYnJlYWtwb2ludCB0aGVuIHdlIHJlc2V0IHNvIHRoYXQgdG90YWxzIGFyZSBzaG93biBub3JtYWxseQ0KCQlpZihjYWxjYnApew0KCQkJYnAgPSBzaXRzX2RvX2dldF9wb3J0YWxfYnJlYWtwb2ludChlbGUpOw0KCQl9DQoNCgkJaWYoYnA9PT0ieHMiKXsgLy9yZXNldCBvbiBtb2JpbGVzDQoJCQllbGUucmVtb3ZlQXR0cigic3R5bGUiKS5yZW1vdmVDbGFzcygic3YtaGlkZSIpLmNoaWxkcmVuKCIuc3YtZmluYW5jaWFsLWxhYmVsIikucmVtb3ZlQ2xhc3MoInN2LXNyLW9ubHkiKTsNCgkJfQ0KCQllbHNleyAvL2xpbmUgdXAgdG90YWxzIHdpdGggY29sdW1ucw0KICAgIAllbGUuY2hpbGRyZW4oIi5zdi1maW5hbmNpYWwtbGFiZWwiKS5hZGRDbGFzcygic3Ytc3Itb25seSIpOyAvL2hpZGUgbGFiZWxzDQoNCiAgICAJdmFyIGhlYWRPYmogPSAkKCJ0aFtkYXRhLWZpbmFuY2lhbC1oZWFkaW5nPSciK2VsZS5hdHRyKCJkYXRhLWZpbmFuY2lhbC10b3RhbCIpKyInXSIpOw0KICAgIAlpZihoZWFkT2JqLmxlbmd0aD09MSkgew0KCSAgICAgIGlmKGhlYWRPYmouaXMoIjp2aXNpYmxlIikpIHsNCiAgCSAgICAgIGVsZS5yZW1vdmVDbGFzcygic3YtaGlkZSIpLnBvc2l0aW9uKHsgLy9zaG93IHRvdGFsDQogICAgCSAgICAgIG15OiAicmlnaHQgdG9wIiwNCiAgICAgIAkgICAgYXQ6ICJyaWdodCBib3R0b20iLA0KICAgICAgICAJICBvZjogaGVhZE9iaiwNCiAgICAgICAgICAJd2l0aGluOiAiLnN2LWZpbmFuY2lhbC1jb250YWluZXIiLA0KICAgICAgICAgIAljb2xsaXNpb246ICJub25lIg0KICAgICAgICAJfSkuY3NzKCJ0b3AiLCIwIik7DQogICAgICAJfQ0KICAgICAgCWVsc2Ugew0KCSAgICAgICAgZWxlLmFkZENsYXNzKCJzdi1oaWRlIik7IC8vaGlkZSB0b3RhbA0KICAJICAgIH0NCiAgICAJfQ0KICAgIH0NCiAgfSk7DQogIHJldHVybiB0cnVlOw0KfQ0KDQovL1Njcm9sbCBhIHBhcnRpY3VsYXIgZWxlbWVudCBpbiB0byB2aWV3DQovL1N0cmluZy9FbGVtZW50IC0galF1ZXJ5IHNlbGVjdG9yL29iamVjdCB0byBzY3JvbGwgaW4gdG8gdmlldw0KLy9GdW5jdGlvbiAtIGNhbGxiYWNrIGZ1bmN0aW9uLCBydW4gb24gY29tcGxldGlvbg0KZnVuY3Rpb24gc2l0c19zY3JvbGxfdG8oc2VsLGZuYyl7DQogIHZhciBvYmogPSAkKHNlbCk7DQogIGlmKG9iai5sZW5ndGg8MSkgew0KICAgIHJldHVybiBmYWxzZTsgLy9ubyBvYmplY3RzIGZvdW5kDQogIH0NCg0KCS8vc2Nyb2xsIHRoZSB0b3Agb2YgdGhlIGVsZW1lbnQgaW4gdG8gdmlldyBhbmQgcnVuIHRoZSBjYWxsYmFjayBmdW5jdGlvbiAoaWYgZGVmaW5lZCkNCgkkKCJodG1sLGJvZHkiKS5hbmltYXRlKHsNCgkJc2Nyb2xsVG9wOiAkKG9iaikub2Zmc2V0KCkudG9wDQoJfSwic2xvdyIsInN3aW5nIixmbmMpOw0KDQoJcmV0dXJuIHRydWU7DQp9DQoNCi8vQ2hlY2sgdG8gc2VlIGlmIHRoZSB1c2VyIGhhcyBwYWdlIG9yIHNlc3Npb24gdGltZW91dHMNCmZ1bmN0aW9uIHNpdHNfdXNlcl90aW1lb3V0cygpIHsNCiAgaWYodHlwZW9mKHNpdHNfdXNlcl90aW1lb3V0KT09InN0cmluZyIgJiYgc2l0c191c2VyX3RpbWVvdXQpIHsgLy9jaGVjayBmb3Iga2V5DQogICAgc2V0VGltZW91dChmdW5jdGlvbigpIHsNCiAgICAgIGlmKHR5cGVvZihzaXRzX3VzZXJfdGltZW91dCk9PSJzdHJpbmciICYmIHNpdHNfdXNlcl90aW1lb3V0KSB7DQogICAgICAgIHZhciBwYXIgPSAiTU9EPUlOSVQmS0VZPSIrc2l0c191c2VyX3RpbWVvdXQ7IC8vYnVpbGQgcGFyYW1ldGVycw0KICAgICAgICBzaXRzX3NlbmRfcXVlcnkoIlBPU1QiLCJzaXdfZG11LnRpbWVvdXQiLHBhcixmYWxzZSwic2l0c19kb191c2VyX3RpbWVvdXRzIik7IC8vY2hlY2sgZm9yIHRpbWVvdXQNCiAgICAgIH0NCiAgICB9LDMwMDAwKTsgLy93YWl0IGZvciAzMCBzZWNvbmRzIG9mIGluYWN0aXZpdHkgKi8NCiAgfQ0KICByZXR1cm4gdHJ1ZTsNCn0NCg0KLy9JbnRlcm5hbCBmdW5jdGlvbiB0byBzZWUgaWYgdGhlIHVzZXIgaGFzIHBhZ2Ugb3Igc2Vzc2lvbiB0aW1lb3V0cw0KZnVuY3Rpb24gc2l0c19kb191c2VyX3RpbWVvdXRzKHJlcykgew0KICBpZihyZXM9PSI8T0s+Iikgew0KICAgIHJldHVybiB0cnVlOyAvL25vIHRpbWVvdXRzDQogIH0NCiAgaWYocmVzLnN1YnN0cigwLDQpIT0iPE9LPiIpIHsNCiAgICByZXR1cm4gZmFsc2U7IC8vZXJyb3INCiAgfQ0KICB2YXIgb2JqID0gc2l0c19wYXJzZV9qc29uKHJlcy5zdWJzdHIoNCkpOyAvL2NyZWF0ZSBkYXRhIG9iamVjdA0KICBpZighb2JqIHx8ICFvYmouTU9ERSkgew0KICAgIHJldHVybiBmYWxzZTsgLy9pbnZhbGlkIGRhdGEgb2JqZWN0DQogIH0NCiAgdmFyIHdybiA9IHNpdHNfdG9fZGF0ZXRpbWUob2JqLldBUk4pOyAvL2dldCBkYXRlL3RpbWVzDQogIHZhciBleHAgPSBzaXRzX3RvX2RhdGV0aW1lKG9iai5FWFBSKTsNCiAgdmFyIG5vdyA9IHNpdHNfdG9fZGF0ZXRpbWUob2JqLkRUSU0pOw0KICBpZihleHAtbm93PDEpIHsgLy9leHBpcmVkIGFscmVhZHkNCiAgICBpZih0eXBlb2Yoc2l0c191c2VyX3RpbWVvdXQpPT0ic3RyaW5nIiAmJiBzaXRzX3VzZXJfdGltZW91dCkgew0KICAgICAgc2l0c19uYXZpZ2F0ZSgiU0lXX0xHTl9MT0dPVVQuYXV0b2xvZ291dD8iK3NpdHNfdXNlcl90aW1lb3V0KTsgLy9hdXRvLWxvZ291dA0KICAgIH0NCiAgICByZXR1cm4gdHJ1ZTsNCiAgfQ0KICBpZihvYmouTU9ERT09IkNIQ0siICYmIHdybi1ub3c8MSkgeyAvL25lZWQgdG8gc2hvdyB3YXJuaW5nIGRpYWxvZw0KICAgIHZhciB0dGwgPSAiIjsNCiAgICB2YXIgY29uID0gIiI7DQogICAgdmFyIGJ0MSA9IHNpdHNfd2lkZ2V0X2JwLnRvICYmIHNpdHNfd2lkZ2V0X2JwLnRvLmJ1dHRvbkNvbnRpbnVlIHx8ICJDb250aW51ZSI7DQogICAgdmFyIGJ0MiA9IHNpdHNfd2lkZ2V0X2JwLnVpICYmIHNpdHNfd2lkZ2V0X2JwLnVpLmRpYWxvZ0Nsb3NlIHx8ICJDbG9zZSI7DQogICAgdmFyIGJ0biA9IHt9Ow0KICAgIGJ0bltidDJdID0gZnVuY3Rpb24oKSB7IC8vYWRkICJjbG9zZSIgYnV0dG9uDQogICAgICBzaXRzX2RpYWxvZ19jbG9zZSh0cnVlLCJzaXRzX3RpbWVvdXRfZGlhIik7DQogICAgfTsNCiAgICBidG5bYnQxXSA9IGZ1bmN0aW9uICgpIHsgLy9hZGQgImNvbnRpbnVlIiBidXR0b24NCiAgICAgIGlmKHR5cGVvZihzaXRzX3VzZXJfdGltZW91dCk9PSJzdHJpbmciICYmIHNpdHNfdXNlcl90aW1lb3V0KSB7DQogICAgICAgIHZhciBwYXIgPSAiTU9EPUNPTlQmUE9TPSIrb2JqLlBPUlMrIiZLRVk9IitzaXRzX3VzZXJfdGltZW91dDsgLy9idWlsZCBwYXJhbWV0ZXJzDQogICAgICAgIHNpdHNfc2VuZF9xdWVyeSgiUE9TVCIsInNpd19kbXUudGltZW91dCIscGFyLGZhbHNlLCJzaXRzX2RvX3VzZXJfdGltZW91dHMiKTsgLy9jaGVjayBmb3IgdGltZW91dA0KICAgICAgfQ0KICAgICAgc2l0c19kaWFsb2dfY2xvc2UodHJ1ZSwic2l0c190aW1lb3V0X2RpYSIpOw0KICAgIH07DQogICAgaWYob2JqLlBPUlM9PSJQIikgew0KICAgICAgdHRsID0gc2l0c193aWRnZXRfYnAudG8gJiYgc2l0c193aWRnZXRfYnAudG8ucGFnZVRpdGxlIHx8ICJQYWdlIEV4cGlyeSI7DQogICAgICBjb24gPSBzaXRzX3dpZGdldF9icC50byAmJiBzaXRzX3dpZGdldF9icC50by5wYWdlQ29udGVudCB8fCAiVGhpcyBwYWdlIGlzIGR1ZSB0byBleHBpcmUgaW4gYXBwcm94aW1hdGVseSB7MH0gbWludXRlKHMpLiBJZiB5b3Ugd291bGQgbGlrZSB0byBjb250aW51ZSB1c2luZyB0aGlzIHBhZ2UsIHBsZWFzZSBjbGljayBcIkNvbnRpbnVlXCIuIjsNCiAgICB9DQogICAgZWxzZSB7DQogICAgICB0dGwgPSBzaXRzX3dpZGdldF9icC50byAmJiBzaXRzX3dpZGdldF9icC50by5zZXNzaW9uVGl0bGUgfHwgIlNlc3Npb24gRXhwaXJ5IjsNCiAgICAgIGNvbiA9IHNpdHNfd2lkZ2V0X2JwLnRvICYmIHNpdHNfd2lkZ2V0X2JwLnRvLnNlc3Npb25Db250ZW50IHx8ICJZb3VyIHNlc3Npb24gaXMgZHVlIHRvIGV4cGlyZSBpbiBhcHByb3hpbWF0ZWx5IHswfSBtaW51dGUocykuIElmIHlvdSB3b3VsZCBsaWtlIHRvIGNvbnRpbnVlIHVzaW5nIHRoaXMgc2Vzc2lvbiwgcGxlYXNlIGNsaWNrIFwiQ29udGludWVcIi4iOw0KICAgIH0NCiAgICBjb24gPSBzaXRzX3JlcGxhY2UoY29uLCJ7MH0iLFN0cmluZygoZXhwLXdybikvNjAwMDApKTsgLy9taW51dGVzIGZyb20gd2FybmluZyB0byBleHBpcnkNCiAgICBzaXRzX2RpYWxvZyh0dGwsY29uLGJ0bix0cnVlLHRydWUsZmFsc2UsbnVsbCwic2l0c190aW1lb3V0X2RpYSIpOyAvL3Nob3cgZGlhbG9nIChyZXR1cm4gb3V0ISkNCiAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsNCiAgICAgIGlmKHR5cGVvZihzaXRzX3VzZXJfdGltZW91dCk9PSJzdHJpbmciICYmIHNpdHNfdXNlcl90aW1lb3V0KSB7DQogICAgICAgIHZhciBwYXIgPSAiTU9EPUNIQ0smS0VZPSIrc2l0c191c2VyX3RpbWVvdXQ7IC8vYnVpbGQgcGFyYW1ldGVycw0KICAgICAgICBzaXRzX3NlbmRfcXVlcnkoIlBPU1QiLCJzaXdfZG11LnRpbWVvdXQiLHBhcixmYWxzZSwic2l0c19kb191c2VyX3RpbWVvdXRzIik7IC8vY2hlY2sgZm9yIHRpbWVvdXQNCiAgICAgIH0NCiAgICB9LGV4cC1ub3cpOyAvL3dhaXQgdGlsbCBleHBpcmF0aW9uDQogICAgcmV0dXJuIHRydWU7DQogIH0NCiAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7DQogICAgaWYodHlwZW9mKHNpdHNfdXNlcl90aW1lb3V0KT09InN0cmluZyIgJiYgc2l0c191c2VyX3RpbWVvdXQpIHsNCiAgICAgIHZhciBwYXIgPSAiTU9EPUNIQ0smS0VZPSIrc2l0c191c2VyX3RpbWVvdXQ7IC8vYnVpbGQgcGFyYW1ldGVycw0KICAgICAgc2l0c19zZW5kX3F1ZXJ5KCJQT1NUIiwic2l3X2RtdS50aW1lb3V0IixwYXIsZmFsc2UsInNpdHNfZG9fdXNlcl90aW1lb3V0cyIpOyAvL2NoZWNrIGZvciB0aW1lb3V0DQogICAgfQ0KICB9LHdybi1ub3cpOyAvL3dhaXQgdGlsbCB3YXJuaW5nDQogIHJldHVybiB0cnVlOw0KfQ0KLy8gaWYgcG9zdGNvZGUgYnV0dG9uIGhpZGRlbiBzdG9wIGZpZWxkIGJlaW5nIGFuIGlucHV0IGdyb3VwDQpmdW5jdGlvbiBzaXRzX3Bvc3Rjb2RlX2hpZGUocG9zdGNvZGVpZCl7DQogIHZhciBwY29kID0gJCgiIyIrc2l0c19kb19nZXRfb2JqZWN0KHBvc3Rjb2RlaWQpKTsNCiAgaWYgKCBwY29kLnBhcmVudCgpLmlzKCJkaXYuc3YtaW5wdXQtZ3JvdXAiKSl7DQogICAgcGNvZC51bndyYXAoKTsNCiAgICBwY29kLm5leHQoIi5zdi1pbnB1dC1ncm91cC1idG4iKS5yZW1vdmUoKTsNCiAgfQ0KDQp9DQoNCg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPBody>
        <TcpPackets>
          <PacketInfo time="1085862656" offset="0" length="333" />
          <PacketInfo time="1085862656" offset="333" length="91957" />
        </TcpPackets>
      </HTTPResponse>
    </HTTPTask>
    <HTTPTask id="6122" hostname="graduate-studies-apply-uat.ualberta.ca" path="https://graduate-studies-apply-uat.ualberta.ca/urd/sits.urd/images/newupdated/newcop.gif" url="https://graduate-studies-apply-uat.ualberta.ca/urd/sits.urd/images/newupdated/newcop.gif" ip="129.128.12.49" port="443" connectionId="56" origin="HTML" frame="1" startDateTime="2019-01-02T11:43:29.457-05:00" startTime="1085862906" endTime="1085862906">
      <HTTPRequest method="GET">
        <HTTPHeaders>
          <HTTPHeaderEntity name="User-Agent" index="0">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>TW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV09XNjQ7IHJ2OjY0LjApIEdlY2tvLzIwMTAwMTAxIEZpcmVmb3gvNjQuMA==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Accept" index="1">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>Ki8q</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Accept-Language" index="2">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>ZW4tR0IsZW47cT0wLjU=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Accept-Encoding" index="3">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>Z3ppcCwgZGVmbGF0ZQ==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Referer" index="4">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>aHR0cHM6Ly9ncmFkdWF0ZS1zdHVkaWVzLWFwcGx5LXVhdC51YWxiZXJ0YS5jYS91cmQvc2l0cy51cmQvcnVuL3Npd19wb3J0YWwudXJsPzI5REM2MkUzREExQjQ4NDR3UTJLcXpWeGZoNVFfaXZBd1czczhnUmVMbmxrc1ZCRmo4ZThROG9NUlFqMENXQ1NhRlQ1SDFodDctX1I1MjQzTW9iVGRXUFdrb2lxOHN6Q1hBT0xpa3d0Nk50ZTQyTlQyVDZFbUZkOWs5WQ==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="DNT" index="5">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>MQ==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Cookie" index="6">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>SlNFU1NJT05JRD0xRDdCNDYzNTkyMDU1RTU3ODhEQTAwMjcxNzk2OEJGRDsgQklHaXBTZXJ2ZXJTSVRTQVBQLVVBVC1IVFRQLmFwcH5TSVRTQVBQLVVBVC1IVFRQX3Bvb2w9MTA5Mjc1NDA5Mi4zNjg5NS4wMDAwOyBCSUdpcFNlcnZlclNoYXJlZElJUy1VQVQ9NzU3MjA5NzcyLjIwNDgwLjAwMDA=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Host" index="7">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>Z3JhZHVhdGUtc3R1ZGllcy1hcHBseS11YXQudWFsYmVydGEuY2E=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPAllHeaders>
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>R0VUIGh0dHBzOi8vZ3JhZHVhdGUtc3R1ZGllcy1hcHBseS11YXQudWFsYmVydGEuY2EvdXJkL3NpdHMudXJkL2ltYWdlcy9uZXd1cGRhdGVkL25ld2NvcC5naWYgSFRUUC8xLjENClVzZXItQWdlbnQ6IE1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdPVzY0OyBydjo2NC4wKSBHZWNrby8yMDEwMDEwMSBGaXJlZm94LzY0LjANCkFjY2VwdDogKi8qDQpBY2NlcHQtTGFuZ3VhZ2U6IGVuLUdCLGVuO3E9MC41DQpBY2NlcHQtRW5jb2Rpbmc6IGd6aXAsIGRlZmxhdGUNClJlZmVyZXI6IGh0dHBzOi8vZ3JhZHVhdGUtc3R1ZGllcy1hcHBseS11YXQudWFsYmVydGEuY2EvdXJkL3NpdHMudXJkL3J1bi9zaXdfcG9ydGFsLnVybD8yOURDNjJFM0RBMUI0ODQ0d1EyS3F6VnhmaDVRX2l2QXdXM3M4Z1JlTG5sa3NWQkZqOGU4UThvTVJRajBDV0NTYUZUNUgxaHQ3LV9SNTI0M01vYlRkV1BXa29pcThzekNYQU9MaWt3dDZOdGU0Mk5UMlQ2RW1GZDlrOVkNCkROVDogMQ0KQ29va2llOiBKU0VTU0lPTklEPTFEN0I0NjM1OTIwNTVFNTc4OERBMDAyNzE3OTY4QkZEOyBCSUdpcFNlcnZlclNJVFNBUFAtVUFULUhUVFAuYXBwflNJVFNBUFAtVUFULUhUVFBfcG9vbD0xMDkyNzU0MDkyLjM2ODk1LjAwMDA7IEJJR2lwU2VydmVyU2hhcmVkSUlTLVVBVD03NTcyMDk3NzIuMjA0ODAuMDAwMA0KSG9zdDogZ3JhZHVhdGUtc3R1ZGllcy1hcHBseS11YXQudWFsYmVydGEuY2ENCg0K</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPAllHeaders>
          <HTTPCookies>
            <HTTPHeaderEntity name="JSESSIONID" index="0">
              <HTTPDataSet>
                <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                  <ActualData>MUQ3QjQ2MzU5MjA1NUU1Nzg4REEwMDI3MTc5NjhCRkQ=</ActualData>
                </HTTPData>
              </HTTPDataSet>
              <IsExternalData>false</IsExternalData>
            </HTTPHeaderEntity>
            <HTTPHeaderEntity name="BIGipServerSITSAPP-UAT-HTTP.app~SITSAPP-UAT-HTTP_pool" index="1">
              <HTTPDataSet>
                <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                  <ActualData>MTA5Mjc1NDA5Mi4zNjg5NS4wMDAw</ActualData>
                </HTTPData>
              </HTTPDataSet>
              <IsExternalData>false</IsExternalData>
            </HTTPHeaderEntity>
            <HTTPHeaderEntity name="BIGipServerSharedIIS-UAT" index="2">
              <HTTPDataSet>
                <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                  <ActualData>NzU3MjA5NzcyLjIwNDgwLjAwMDA=</ActualData>
                </HTTPData>
              </HTTPDataSet>
              <IsExternalData>false</IsExternalData>
            </HTTPHeaderEntity>
          </HTTPCookies>
        </HTTPHeaders>
      </HTTPRequest>
      <HTTPResponse>
        <contentLenght>863</contentLenght>
        <HTTPHeaders>
          <HTTPHeaderEntity name="Content-Type" index="0">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>aW1hZ2UvZ2lm</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Last-Modified" index="1">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>VHVlLCAxMSBNYXIgMjAwMyAxMjoxNDoxMCBHTVQ=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Accept-Ranges" index="2">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>Ynl0ZXM=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="ETag" index="3">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>IjA5NTg0YjhjN2U3YzIxOjAi</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Server" index="4">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>TWljcm9zb2Z0LUlJUy84LjU=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="X-Powered-By" index="5">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>QVNQLk5FVA==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Date" index="6">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>V2VkLCAwMiBKYW4gMjAxOSAxNjo0MzowOCBHTVQ=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Content-Length" index="7">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>ODYz</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPAllHeaders>
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LVR5cGU6IGltYWdlL2dpZg0KTGFzdC1Nb2RpZmllZDogVHVlLCAxMSBNYXIgMjAwMyAxMjoxNDoxMCBHTVQNCkFjY2VwdC1SYW5nZXM6IGJ5dGVzDQpFVGFnOiAiMDk1ODRiOGM3ZTdjMjE6MCINClNlcnZlcjogTWljcm9zb2Z0LUlJUy84LjUNClgtUG93ZXJlZC1CeTogQVNQLk5FVA0KRGF0ZTogV2VkLCAwMiBKYW4gMjAxOSAxNjo0MzowOCBHTVQNCkNvbnRlbnQtTGVuZ3RoOiA4NjMNCg0K</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPAllHeaders>
        </HTTPHeaders>
        <HTTPBody>
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>R0lGODlhGQAKAPcAAP8AAP///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////yH5BAEAAAEALAAAAAAZAAoAAAg8AAMIHEiwoMGDCBMKBKCw4UCGDwFAXDix4kOCEDMu3MjQ4sUAGSVq7PhxI0iTGE8i1EjR4kSVDmPKbBgQADs=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPBody>
        <TcpPackets>
          <PacketInfo time="1085862906" offset="0" length="246" />
          <PacketInfo time="1085862921" offset="246" length="863" />
        </TcpPackets>
      </HTTPResponse>
    </HTTPTask>
    <HTTPTask id="6151" hostname="graduate-studies-apply-uat.ualberta.ca" path="https://graduate-studies-apply-uat.ualberta.ca/api/emergencymessage.json?_=1546447386898" url="https://graduate-studies-apply-uat.ualberta.ca/api/emergencymessage.json?_=1546447386898" ip="129.128.12.49" port="443" connectionId="62" origin="HTML" frame="1" startDateTime="2019-01-02T11:43:29.620-05:00" startTime="1085864703" endTime="1085864718">
      <QueryString>
        <HTTPDataSet>
          <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
            <ActualData>Xz0xNTQ2NDQ3Mzg2ODk4</ActualData>
          </HTTPData>
        </HTTPDataSet>
        <IsExternalData>false</IsExternalData>
      </QueryString>
      <HTTPSplittedQueryStrings>
        <HTTPHeaderEntity name="_" index="0">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>MTU0NjQ0NzM4Njg5OA==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
      </HTTPSplittedQueryStrings>
      <HTTPRequest method="GET">
        <HTTPHeaders>
          <HTTPHeaderEntity name="User-Agent" index="0">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>TW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV09XNjQ7IHJ2OjY0LjApIEdlY2tvLzIwMTAwMTAxIEZpcmVmb3gvNjQuMA==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Accept" index="1">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>YXBwbGljYXRpb24vanNvbiwgdGV4dC9qYXZhc2NyaXB0LCAqLyo7IHE9MC4wMQ==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Accept-Language" index="2">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>ZW4tR0IsZW47cT0wLjU=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Accept-Encoding" index="3">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>Z3ppcCwgZGVmbGF0ZQ==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Referer" index="4">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>aHR0cHM6Ly9ncmFkdWF0ZS1zdHVkaWVzLWFwcGx5LXVhdC51YWxiZXJ0YS5jYS91cmQvc2l0cy51cmQvcnVuL3Npd19wb3J0YWwudXJsPzI5REM2MkUzREExQjQ4NDR3UTJLcXpWeGZoNVFfaXZBd1czczhnUmVMbmxrc1ZCRmo4ZThROG9NUlFqMENXQ1NhRlQ1SDFodDctX1I1MjQzTW9iVGRXUFdrb2lxOHN6Q1hBT0xpa3d0Nk50ZTQyTlQyVDZFbUZkOWs5WQ==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Content-Type" index="5">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>YXBwbGljYXRpb24vanNvbg==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="X-Requested-With" index="6">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>WE1MSHR0cFJlcXVlc3Q=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="DNT" index="7">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>MQ==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Cookie" index="8">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>QklHaXBTZXJ2ZXJTSVRTQVBQLVVBVC1IVFRQLmFwcH5TSVRTQVBQLVVBVC1IVFRQX3Bvb2w9MTA5Mjc1NDA5Mi4zNjg5NS4wMDAwOyBCSUdpcFNlcnZlclNoYXJlZElJUy1VQVQ9NzU3MjA5NzcyLjIwNDgwLjAwMDA=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Host" index="9">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>Z3JhZHVhdGUtc3R1ZGllcy1hcHBseS11YXQudWFsYmVydGEuY2E=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPAllHeaders>
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>R0VUIGh0dHBzOi8vZ3JhZHVhdGUtc3R1ZGllcy1hcHBseS11YXQudWFsYmVydGEuY2EvYXBpL2VtZXJnZW5jeW1lc3NhZ2UuanNvbj9fPTE1NDY0NDczODY4OTggSFRUUC8xLjENClVzZXItQWdlbnQ6IE1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdPVzY0OyBydjo2NC4wKSBHZWNrby8yMDEwMDEwMSBGaXJlZm94LzY0LjANCkFjY2VwdDogYXBwbGljYXRpb24vanNvbiwgdGV4dC9qYXZhc2NyaXB0LCAqLyo7IHE9MC4wMQ0KQWNjZXB0LUxhbmd1YWdlOiBlbi1HQixlbjtxPTAuNQ0KQWNjZXB0LUVuY29kaW5nOiBnemlwLCBkZWZsYXRlDQpSZWZlcmVyOiBodHRwczovL2dyYWR1YXRlLXN0dWRpZXMtYXBwbHktdWF0LnVhbGJlcnRhLmNhL3VyZC9zaXRzLnVyZC9ydW4vc2l3X3BvcnRhbC51cmw/MjlEQzYyRTNEQTFCNDg0NHdRMktxelZ4Zmg1UV9pdkF3VzNzOGdSZUxubGtzVkJGajhlOFE4b01SUWowQ1dDU2FGVDVIMWh0Ny1fUjUyNDNNb2JUZFdQV2tvaXE4c3pDWEFPTGlrd3Q2TnRlNDJOVDJUNkVtRmQ5azlZDQpDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2pzb24NClgtUmVxdWVzdGVkLVdpdGg6IFhNTEh0dHBSZXF1ZXN0DQpETlQ6IDENCkNvb2tpZTogQklHaXBTZXJ2ZXJTSVRTQVBQLVVBVC1IVFRQLmFwcH5TSVRTQVBQLVVBVC1IVFRQX3Bvb2w9MTA5Mjc1NDA5Mi4zNjg5NS4wMDAwOyBCSUdpcFNlcnZlclNoYXJlZElJUy1VQVQ9NzU3MjA5NzcyLjIwNDgwLjAwMDANCkhvc3Q6IGdyYWR1YXRlLXN0dWRpZXMtYXBwbHktdWF0LnVhbGJlcnRhLmNhDQoNCg==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPAllHeaders>
          <HTTPCookies>
            <HTTPHeaderEntity name="BIGipServerSITSAPP-UAT-HTTP.app~SITSAPP-UAT-HTTP_pool" index="0">
              <HTTPDataSet>
                <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                  <ActualData>MTA5Mjc1NDA5Mi4zNjg5NS4wMDAw</ActualData>
                </HTTPData>
              </HTTPDataSet>
              <IsExternalData>false</IsExternalData>
            </HTTPHeaderEntity>
            <HTTPHeaderEntity name="BIGipServerSharedIIS-UAT" index="1">
              <HTTPDataSet>
                <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                  <ActualData>NzU3MjA5NzcyLjIwNDgwLjAwMDA=</ActualData>
                </HTTPData>
              </HTTPDataSet>
              <IsExternalData>false</IsExternalData>
            </HTTPHeaderEntity>
          </HTTPCookies>
        </HTTPHeaders>
      </HTTPRequest>
      <HTTPResponse>
        <contentLenght>741</contentLenght>
        <HTTPHeaders>
          <HTTPHeaderEntity name="Content-Type" index="0">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>dGV4dC9odG1s</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Server" index="1">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>TWljcm9zb2Z0LUlJUy84LjU=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="X-Powered-By" index="2">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>QVNQLk5FVA==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Date" index="3">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>V2VkLCAwMiBKYW4gMjAxOSAxNjo0MzoxMCBHTVQ=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Content-Length" index="4">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>NzQx</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Vary" index="5">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>QWNjZXB0LUVuY29kaW5n</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Content-Encoding" index="6">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>Z3ppcA==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="Connection" index="7">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>S2VlcC1BbGl2ZQ==</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPAllHeaders>
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>SFRUUC8xLjEgNDA0IE5vdCBGb3VuZA0KQ29udGVudC1UeXBlOiB0ZXh0L2h0bWwNClNlcnZlcjogTWljcm9zb2Z0LUlJUy84LjUNClgtUG93ZXJlZC1CeTogQVNQLk5FVA0KRGF0ZTogV2VkLCAwMiBKYW4gMjAxOSAxNjo0MzoxMCBHTVQNCkNvbnRlbnQtTGVuZ3RoOiA3NDENClZhcnk6IEFjY2VwdC1FbmNvZGluZw0KQ29udGVudC1FbmNvZGluZzogZ3ppcA0KQ29ubmVjdGlvbjogS2VlcC1BbGl2ZQ0KDQo=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPAllHeaders>
        </HTTPHeaders>
        <HTTPBody>
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>PCFET0NUWVBFIGh0bWwgUFVCTElDICItLy9XM0MvL0RURCBYSFRNTCAxLjAgU3RyaWN0Ly9FTiIgImh0dHA6Ly93d3cudzMub3JnL1RSL3hodG1sMS9EVEQveGh0bWwxLXN0cmljdC5kdGQiPg0KPGh0bWwgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWwiPg0KPGhlYWQ+DQo8bWV0YSBodHRwLWVxdWl2PSJDb250ZW50LVR5cGUiIGNvbnRlbnQ9InRleHQvaHRtbDsgY2hhcnNldD1pc28tODg1OS0xIi8+DQo8dGl0bGU+NDA0IC0gRmlsZSBvciBkaXJlY3Rvcnkgbm90IGZvdW5kLjwvdGl0bGU+DQo8c3R5bGUgdHlwZT0idGV4dC9jc3MiPg0KPCEtLQ0KYm9keXttYXJnaW46MDtmb250LXNpemU6LjdlbTtmb250LWZhbWlseTpWZXJkYW5hLCBBcmlhbCwgSGVsdmV0aWNhLCBzYW5zLXNlcmlmO2JhY2tncm91bmQ6I0VFRUVFRTt9DQpmaWVsZHNldHtwYWRkaW5nOjAgMTVweCAxMHB4IDE1cHg7fSANCmgxe2ZvbnQtc2l6ZToyLjRlbTttYXJnaW46MDtjb2xvcjojRkZGO30NCmgye2ZvbnQtc2l6ZToxLjdlbTttYXJnaW46MDtjb2xvcjojQ0MwMDAwO30gDQpoM3tmb250LXNpemU6MS4yZW07bWFyZ2luOjEwcHggMCAwIDA7Y29sb3I6IzAwMDAwMDt9IA0KI2hlYWRlcnt3aWR0aDo5NiU7bWFyZ2luOjAgMCAwIDA7cGFkZGluZzo2cHggMiUgNnB4IDIlO2ZvbnQtZmFtaWx5OiJ0cmVidWNoZXQgTVMiLCBWZXJkYW5hLCBzYW5zLXNlcmlmO2NvbG9yOiNGRkY7DQpiYWNrZ3JvdW5kLWNvbG9yOiM1NTU1NTU7fQ0KI2NvbnRlbnR7bWFyZ2luOjAgMCAwIDIlO3Bvc2l0aW9uOnJlbGF0aXZlO30NCi5jb250ZW50LWNvbnRhaW5lcntiYWNrZ3JvdW5kOiNGRkY7d2lkdGg6OTYlO21hcmdpbi10b3A6OHB4O3BhZGRpbmc6MTBweDtwb3NpdGlvbjpyZWxhdGl2ZTt9DQotLT4NCjwvc3R5bGU+DQo8L2hlYWQ+DQo8Ym9keT4NCjxkaXYgaWQ9ImhlYWRlciI+PGgxPlNlcnZlciBFcnJvcjwvaDE+PC9kaXY+DQo8ZGl2IGlkPSJjb250ZW50Ij4NCiA8ZGl2IGNsYXNzPSJjb250ZW50LWNvbnRhaW5lciI+PGZpZWxkc2V0Pg0KICA8aDI+NDA0IC0gRmlsZSBvciBkaXJlY3Rvcnkgbm90IGZvdW5kLjwvaDI+DQogIDxoMz5UaGUgcmVzb3VyY2UgeW91IGFyZSBsb29raW5nIGZvciBtaWdodCBoYXZlIGJlZW4gcmVtb3ZlZCwgaGFkIGl0cyBuYW1lIGNoYW5nZWQsIG9yIGlzIHRlbXBvcmFyaWx5IHVuYXZhaWxhYmxlLjwvaDM+DQogPC9maWVsZHNldD48L2Rpdj4NCjwvZGl2Pg0KPC9ib2R5Pg0KPC9odG1sPg0K</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPBody>
        <TcpPackets>
          <PacketInfo time="1085864718" offset="0" length="230" />
          <PacketInfo time="1085864718" offset="230" length="741" />
        </TcpPackets>
      </HTTPResponse>
    </HTTPTask>
  </HTTPTask>
  <HTTPTask id="6142" hostname="graduate-studies-apply-uat.ualberta.ca" path="https://graduate-studies-apply-uat.ualberta.ca/urd/sits.urd/css/uoa_files/index_files/all.js?v=930.1" url="https://graduate-studies-apply-uat.ualberta.ca/urd/sits.urd/css/uoa_files/index_files/all.js?v=930.1" ip="129.128.12.49" port="443" connectionId="60" origin="ExtraRes" frame="1" startDateTime="2019-01-02T11:43:29.517-05:00" startTime="1085863625" endTime="1085863625">
    <QueryString>
      <HTTPDataSet>
        <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
          <ActualData>dj05MzAuMQ==</ActualData>
        </HTTPData>
      </HTTPDataSet>
      <IsExternalData>false</IsExternalData>
    </QueryString>
    <HTTPSplittedQueryStrings>
      <HTTPHeaderEntity name="v" index="0">
        <HTTPDataSet>
          <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
            <ActualData>OTMwLjE=</ActualData>
          </HTTPData>
        </HTTPDataSet>
        <IsExternalData>false</IsExternalData>
      </HTTPHeaderEntity>
    </HTTPSplittedQueryStrings>
    <HTTPRequest method="GET">
      <HTTPHeaders>
        <HTTPHeaderEntity name="User-Agent" index="0">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>TW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV09XNjQ7IHJ2OjY0LjApIEdlY2tvLzIwMTAwMTAxIEZpcmVmb3gvNjQuMA==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept" index="1">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Ki8q</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept-Language" index="2">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>ZW4tR0IsZW47cT0wLjU=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept-Encoding" index="3">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Z3ppcCwgZGVmbGF0ZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Referer" index="4">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>aHR0cHM6Ly9ncmFkdWF0ZS1zdHVkaWVzLWFwcGx5LXVhdC51YWxiZXJ0YS5jYS91cmQvc2l0cy51cmQvcnVuL3Npd19wb3J0YWwudXJsPzI5REM2MkUzREExQjQ4NDR3UTJLcXpWeGZoNVFfaXZBd1czczhnUmVMbmxrc1ZCRmo4ZThROG9NUlFqMENXQ1NhRlQ1SDFodDctX1I1MjQzTW9iVGRXUFdrb2lxOHN6Q1hBT0xpa3d0Nk50ZTQyTlQyVDZFbUZkOWs5WQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="DNT" index="5">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>MQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Cookie" index="6">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>SlNFU1NJT05JRD0xRDdCNDYzNTkyMDU1RTU3ODhEQTAwMjcxNzk2OEJGRDsgQklHaXBTZXJ2ZXJTSVRTQVBQLVVBVC1IVFRQLmFwcH5TSVRTQVBQLVVBVC1IVFRQX3Bvb2w9MTA5Mjc1NDA5Mi4zNjg5NS4wMDAwOyBCSUdpcFNlcnZlclNoYXJlZElJUy1VQVQ9NzU3MjA5NzcyLjIwNDgwLjAwMDA=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Host" index="7">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Z3JhZHVhdGUtc3R1ZGllcy1hcHBseS11YXQudWFsYmVydGEuY2E=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPAllHeaders>
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>R0VUIGh0dHBzOi8vZ3JhZHVhdGUtc3R1ZGllcy1hcHBseS11YXQudWFsYmVydGEuY2EvdXJkL3NpdHMudXJkL2Nzcy91b2FfZmlsZXMvaW5kZXhfZmlsZXMvYWxsLmpzP3Y9OTMwLjEgSFRUUC8xLjENClVzZXItQWdlbnQ6IE1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdPVzY0OyBydjo2NC4wKSBHZWNrby8yMDEwMDEwMSBGaXJlZm94LzY0LjANCkFjY2VwdDogKi8qDQpBY2NlcHQtTGFuZ3VhZ2U6IGVuLUdCLGVuO3E9MC41DQpBY2NlcHQtRW5jb2Rpbmc6IGd6aXAsIGRlZmxhdGUNClJlZmVyZXI6IGh0dHBzOi8vZ3JhZHVhdGUtc3R1ZGllcy1hcHBseS11YXQudWFsYmVydGEuY2EvdXJkL3NpdHMudXJkL3J1bi9zaXdfcG9ydGFsLnVybD8yOURDNjJFM0RBMUI0ODQ0d1EyS3F6VnhmaDVRX2l2QXdXM3M4Z1JlTG5sa3NWQkZqOGU4UThvTVJRajBDV0NTYUZUNUgxaHQ3LV9SNTI0M01vYlRkV1BXa29pcThzekNYQU9MaWt3dDZOdGU0Mk5UMlQ2RW1GZDlrOVkNCkROVDogMQ0KQ29va2llOiBKU0VTU0lPTklEPTFEN0I0NjM1OTIwNTVFNTc4OERBMDAyNzE3OTY4QkZEOyBCSUdpcFNlcnZlclNJVFNBUFAtVUFULUhUVFAuYXBwflNJVFNBUFAtVUFULUhUVFBfcG9vbD0xMDkyNzU0MDkyLjM2ODk1LjAwMDA7IEJJR2lwU2VydmVyU2hhcmVkSUlTLVVBVD03NTcyMDk3NzIuMjA0ODAuMDAwMA0KSG9zdDogZ3JhZHVhdGUtc3R1ZGllcy1hcHBseS11YXQudWFsYmVydGEuY2ENCg0K</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPAllHeaders>
        <HTTPCookies>
          <HTTPHeaderEntity name="JSESSIONID" index="0">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>MUQ3QjQ2MzU5MjA1NUU1Nzg4REEwMDI3MTc5NjhCRkQ=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="BIGipServerSITSAPP-UAT-HTTP.app~SITSAPP-UAT-HTTP_pool" index="1">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>MTA5Mjc1NDA5Mi4zNjg5NS4wMDAw</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="BIGipServerSharedIIS-UAT" index="2">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>NzU3MjA5NzcyLjIwNDgwLjAwMDA=</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
        </HTTPCookies>
      </HTTPHeaders>
    </HTTPRequest>
    <HTTPResponse>
      <contentLenght>85830</contentLenght>
      <HTTPHeaders>
        <HTTPHeaderEntity name="Content-Type" index="0">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>YXBwbGljYXRpb24vamF2YXNjcmlwdA==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Last-Modified" index="1">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>VHVlLCAyNCBGZWIgMjAxNSAxNzoyNDozNCBHTVQ=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept-Ranges" index="2">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Ynl0ZXM=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="ETag" index="3">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>IjA3NWE1YzE1NjUwZDAxOjAi</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Server" index="4">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>TWljcm9zb2Z0LUlJUy84LjU=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="X-Powered-By" index="5">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>QVNQLk5FVA==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Date" index="6">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>V2VkLCAwMiBKYW4gMjAxOSAxNjo0MzowOCBHTVQ=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Content-Length" index="7">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>ODU4MzA=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Vary" index="8">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>QWNjZXB0LUVuY29kaW5n</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Content-Encoding" index="9">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Z3ppcA==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Connection" index="10">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>S2VlcC1BbGl2ZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPAllHeaders>
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LVR5cGU6IGFwcGxpY2F0aW9uL2phdmFzY3JpcHQNCkxhc3QtTW9kaWZpZWQ6IFR1ZSwgMjQgRmViIDIwMTUgMTc6MjQ6MzQgR01UDQpBY2NlcHQtUmFuZ2VzOiBieXRlcw0KRVRhZzogIjA3NWE1YzE1NjUwZDAxOjAiDQpTZXJ2ZXI6IE1pY3Jvc29mdC1JSVMvOC41DQpYLVBvd2VyZWQtQnk6IEFTUC5ORVQNCkRhdGU6IFdlZCwgMDIgSmFuIDIwMTkgMTY6NDM6MDggR01UDQpDb250ZW50LUxlbmd0aDogODU4MzANClZhcnk6IEFjY2VwdC1FbmNvZGluZw0KQ29udGVudC1FbmNvZGluZzogZ3ppcA0KQ29ubmVjdGlvbjogS2VlcC1BbGl2ZQ0KDQo=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPAllHeaders>
      </HTTPHeaders>
      <HTTPBody>
        <HTTPDataSet>
          <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
            <ActualData>LyogTWluaWZpY2F0aW9uIGZhaWxlZC4gUmV0dXJuaW5nIHVubWluaWZpZWQgY29udGVudHMuDQooNjY2MSwxNS0xNik6IHJ1bi10aW1lIGVycm9yIEpTMTMwMDogU3RyaWN0LW1vZGUgZG9lcyBub3QgYWxsb3cgYXNzaWdubWVudCB0byB1bmRlZmluZWQgdmFyaWFibGVzOiBqDQooNjY2MSw0My00NCk6IHJ1bi10aW1lIGVycm9yIEpTMTI5NDogU3RyaWN0LW1vZGUgZG9lcyBub3QgYWxsb3cgKysgb3IgLS0gb24gY2VydGFpbiBvYmplY3RzOiBqDQogKi8NCg0KKGZ1bmN0aW9uKCQpe3ZhciBlc2NhcGVhYmxlPS9bIlxcXHgwMC1ceDFmXHg3Zi1ceDlmXS9nLG1ldGE9eydcYic6J1xcYicsJ1x0JzonXFx0JywnXG4nOidcXG4nLCdcZic6J1xcZicsJ1xyJzonXFxyJywnIic6J1xcIicsJ1xcJzonXFxcXCd9OyQudG9KU09OPXR5cGVvZiBKU09OPT09J29iamVjdCcmJkpTT04uc3RyaW5naWZ5P0pTT04uc3RyaW5naWZ5OmZ1bmN0aW9uKG8pe2lmKG89PT1udWxsKXtyZXR1cm4nbnVsbCc7fQ0KdmFyIHR5cGU9dHlwZW9mIG87aWYodHlwZT09PSd1bmRlZmluZWQnKXtyZXR1cm4gdW5kZWZpbmVkO30NCmlmKHR5cGU9PT0nbnVtYmVyJ3x8dHlwZT09PSdib29sZWFuJyl7cmV0dXJuJycrbzt9DQppZih0eXBlPT09J3N0cmluZycpe3JldHVybiAkLnF1b3RlU3RyaW5nKG8pO30NCmlmKHR5cGU9PT0nb2JqZWN0Jyl7aWYodHlwZW9mIG8udG9KU09OPT09J2Z1bmN0aW9uJyl7cmV0dXJuICQudG9KU09OKG8udG9KU09OKCkpO30NCmlmKG8uY29uc3RydWN0b3I9PT1EYXRlKXt2YXIgbW9udGg9by5nZXRVVENNb250aCgpKzEsZGF5PW8uZ2V0VVRDRGF0ZSgpLHllYXI9by5nZXRVVENGdWxsWWVhcigpLGhvdXJzPW8uZ2V0VVRDSG91cnMoKSxtaW51dGVzPW8uZ2V0VVRDTWludXRlcygpLHNlY29uZHM9by5nZXRVVENTZWNvbmRzKCksbWlsbGk9by5nZXRVVENNaWxsaXNlY29uZHMoKTtpZihtb250aDwxMCl7bW9udGg9JzAnK21vbnRoO30NCmlmKGRheTwxMCl7ZGF5PScwJytkYXk7fQ0KaWYoaG91cnM8MTApe2hvdXJzPScwJytob3Vyczt9DQppZihtaW51dGVzPDEwKXttaW51dGVzPScwJyttaW51dGVzO30NCmlmKHNlY29uZHM8MTApe3NlY29uZHM9JzAnK3NlY29uZHM7fQ0KaWYobWlsbGk8MTAwKXttaWxsaT0nMCcrbWlsbGk7fQ0KaWYobWlsbGk8MTApe21pbGxpPScwJyttaWxsaTt9DQpyZXR1cm4nIicreWVhcisnLScrbW9udGgrJy0nK2RheSsnVCcrDQpob3VycysnOicrbWludXRlcysnOicrc2Vjb25kcysnLicrbWlsbGkrJ1oiJzt9DQppZihvLmNvbnN0cnVjdG9yPT09QXJyYXkpe3ZhciByZXQ9W107Zm9yKHZhciBpPTA7aTxvLmxlbmd0aDtpKyspe3JldC5wdXNoKCQudG9KU09OKG9baV0pfHwnbnVsbCcpO30NCnJldHVybidbJytyZXQuam9pbignLCcpKyddJzt9DQp2YXIgbmFtZSx2YWwscGFpcnM9W107Zm9yKHZhciBrIGluIG8pe3R5cGU9dHlwZW9mIGs7aWYodHlwZT09PSdudW1iZXInKXtuYW1lPSciJytrKyciJzt9ZWxzZSBpZih0eXBlPT09J3N0cmluZycpe25hbWU9JC5xdW90ZVN0cmluZyhrKTt9ZWxzZXtjb250aW51ZTt9DQp0eXBlPXR5cGVvZiBvW2tdO2lmKHR5cGU9PT0nZnVuY3Rpb24nfHx0eXBlPT09J3VuZGVmaW5lZCcpe2NvbnRpbnVlO30NCnZhbD0kLnRvSlNPTihvW2tdKTtwYWlycy5wdXNoKG5hbWUrJzonK3ZhbCk7fQ0KcmV0dXJuJ3snK3BhaXJzLmpvaW4oJywnKSsnfSc7fX07JC5ldmFsSlNPTj10eXBlb2YgSlNPTj09PSdvYmplY3QnJiZKU09OLnBhcnNlP0pTT04ucGFyc2U6ZnVuY3Rpb24oc3JjKXtyZXR1cm4gZXZhbCgnKCcrc3JjKycpJyk7fTskLnNlY3VyZUV2YWxKU09OPXR5cGVvZiBKU09OPT09J29iamVjdCcmJkpTT04ucGFyc2U/SlNPTi5wYXJzZTpmdW5jdGlvbihzcmMpe3ZhciBmaWx0ZXJlZD1zcmMucmVwbGFjZSgvXFxbIlxcXC9iZm5ydHVdL2csJ0AnKS5yZXBsYWNlKC8iW14iXFxcblxyXSoifHRydWV8ZmFsc2V8bnVsbHwtP1xkKyg/OlwuXGQqKT8oPzpbZUVdWytcLV0/XGQrKT8vZywnXScpLnJlcGxhY2UoLyg/Ol58OnwsKSg/OlxzKlxbKSsvZywnJyk7aWYoL15bXF0sOnt9XHNdKiQvLnRlc3QoZmlsdGVyZWQpKXtyZXR1cm4gZXZhbCgnKCcrc3JjKycpJyk7fWVsc2V7dGhyb3cgbmV3IFN5bnRheEVycm9yKCdFcnJvciBwYXJzaW5nIEpTT04sIHNvdXJjZSBpcyBub3QgdmFsaWQuJyk7fX07JC5xdW90ZVN0cmluZz1mdW5jdGlvbihzdHJpbmcpe2lmKHN0cmluZy5tYXRjaChlc2NhcGVhYmxlKSl7cmV0dXJuJyInK3N0cmluZy5yZXBsYWNlKGVzY2FwZWFibGUsZnVuY3Rpb24oYSl7dmFyIGM9bWV0YVthXTtpZih0eXBlb2YgYz09PSdzdHJpbmcnKXtyZXR1cm4gYzt9DQpjPWEuY2hhckNvZGVBdCgpO3JldHVybidcXHUwMCcrTWF0aC5mbG9vcihjLzE2KS50b1N0cmluZygxNikrKGMlMTYpLnRvU3RyaW5nKDE2KTt9KSsnIic7fQ0KcmV0dXJuJyInK3N0cmluZysnIic7fTt9KShqUXVlcnkpOzsNCi8qDQogKiBqUXVlcnkgRmxleFNsaWRlciB2Mi4xDQogKiBDb3B5cmlnaHQgMjAxMiBXb29UaGVtZXMNCiAqIENvbnRyaWJ1dGluZyBBdXRob3I6IFR5bGVyIFNtaXRoDQogKiBNb2RpZmllZCBCeTogS3lsZSBTY2htaWR0IChreWxlLnNjaG1pZHRAdWFsYmVydGEuY2EpDQogKiAgICAgUmVhc29uOiBBZGRlZCAidmFycyIgcHJvcGVydHkgdG8gdGhlICJzbGlkZXIiIG9iamVjdCBpbiBvcmRlciB0byBhY2Nlc3MgdGhlIHNsaWRlciBwcm9wZXJ0aWVzIGV4dGVybmFsbHkNCiAqLw0KKGZ1bmN0aW9uIChlKSB7IGUuZmxleHNsaWRlciA9IGZ1bmN0aW9uICh0LCBuKSB7IHZhciByID0gZSh0KTsgci52YXJzID0gZS5leHRlbmQoe30sIGUuZmxleHNsaWRlci5kZWZhdWx0cywgbik7IHZhciBpID0gci52YXJzLm5hbWVzcGFjZSwgcyA9IHdpbmRvdy5uYXZpZ2F0b3IgJiYgd2luZG93Lm5hdmlnYXRvci5tc1BvaW50ZXJFbmFibGVkICYmIHdpbmRvdy5NU0dlc3R1cmUsIG8gPSAoIm9udG91Y2hzdGFydCIgaW4gd2luZG93IHx8IHMgfHwgd2luZG93LkRvY3VtZW50VG91Y2ggJiYgZG9jdW1lbnQgaW5zdGFuY2VvZiBEb2N1bWVudFRvdWNoKSAmJiByLnZhcnMudG91Y2gsIHUgPSAiIiwgYSwgZiA9ICJ2ZXJ0aWNhbCIgPT09IHIudmFycy5kaXJlY3Rpb24sIGwgPSByLnZhcnMucmV2ZXJzZSwgYyA9IDAgPCByLnZhcnMuaXRlbVdpZHRoLCBoID0gImZhZGUiID09PSByLnZhcnMuYW5pbWF0aW9uLCBwID0gIiIgIT09IHIudmFycy5hc05hdkZvciwgdiA9IHt9OyBlLmRhdGEodCwgImZsZXhzbGlkZXIiLCByKTsgdiA9IHsgaW5pdDogZnVuY3Rpb24gKCkgeyByLmFuaW1hdGluZyA9ICExOyByLmN1cnJlbnRTbGlkZSA9IHBhcnNlSW50KHIudmFycy5zdGFydEF0ID8gci52YXJzLnN0YXJ0QXQgOiAwLCAxMCk7IGlzTmFOKHIuY3VycmVudFNsaWRlKSAmJiAoci5jdXJyZW50U2xpZGUgPSAwKTsgci5hbmltYXRpbmdUbyA9IHIuY3VycmVudFNsaWRlOyByLmF0RW5kID0gMCA9PT0gci5jdXJyZW50U2xpZGUgfHwgci5jdXJyZW50U2xpZGUgPT09IHIubGFzdDsgci5jb250YWluZXJTZWxlY3RvciA9IHIudmFycy5zZWxlY3Rvci5zdWJzdHIoMCwgci52YXJzLnNlbGVjdG9yLnNlYXJjaCgiICIpKTsgci5zbGlkZXMgPSBlKHIudmFycy5zZWxlY3Rvciwgcik7IHIuY29udGFpbmVyID0gZShyLmNvbnRhaW5lclNlbGVjdG9yLCByKTsgci5jb3VudCA9IHIuc2xpZGVzLmxlbmd0aDsgci5zeW5jRXhpc3RzID0gMCA8IGUoci52YXJzLnN5bmMpLmxlbmd0aDsgInNsaWRlIiA9PT0gci52YXJzLmFuaW1hdGlvbiAmJiAoci52YXJzLmFuaW1hdGlvbiA9ICJzd2luZyIpOyByLnByb3AgPSBmID8gInRvcCIgOiAibWFyZ2luTGVmdCI7IHIuYXJncyA9IHt9OyByLm1hbnVhbFBhdXNlID0gITE7IHIuc3RvcHBlZCA9ICExOyByLnN0YXJ0ZWQgPSAhMTsgci5zdGFydFRpbWVvdXQgPSBudWxsOyByLnRyYW5zaXRpb25zID0gIXIudmFycy52aWRlbyAmJiAhaCAmJiByLnZhcnMudXNlQ1NTICYmIGZ1bmN0aW9uICgpIHsgdmFyIGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCJkaXYiKSwgdCA9IFsicGVyc3BlY3RpdmVQcm9wZXJ0eSIsICJXZWJraXRQZXJzcGVjdGl2ZSIsICJNb3pQZXJzcGVjdGl2ZSIsICJPUGVyc3BlY3RpdmUiLCAibXNQZXJzcGVjdGl2ZSJdLCBuOyBmb3IgKG4gaW4gdCkgaWYgKHZvaWQgMCAhPT0gZS5zdHlsZVt0W25dXSkgcmV0dXJuIHIucGZ4ID0gdFtuXS5yZXBsYWNlKCJQZXJzcGVjdGl2ZSIsICIiKS50b0xvd2VyQ2FzZSgpLCByLnByb3AgPSAiLSIgKyByLnBmeCArICItdHJhbnNmb3JtIiwgITA7IHJldHVybiAhMSB9ICgpOyAiIiAhPT0gci52YXJzLmNvbnRyb2xzQ29udGFpbmVyICYmIChyLmNvbnRyb2xzQ29udGFpbmVyID0gMCA8IGUoci52YXJzLmNvbnRyb2xzQ29udGFpbmVyKS5sZW5ndGggJiYgZShyLnZhcnMuY29udHJvbHNDb250YWluZXIpKTsgIiIgIT09IHIudmFycy5tYW51YWxDb250cm9scyAmJiAoci5tYW51YWxDb250cm9scyA9IDAgPCBlKHIudmFycy5tYW51YWxDb250cm9scykubGVuZ3RoICYmIGUoci52YXJzLm1hbnVhbENvbnRyb2xzKSk7IHIudmFycy5yYW5kb21pemUgJiYgKHIuc2xpZGVzLnNvcnQoZnVuY3Rpb24gKCkgeyByZXR1cm4gTWF0aC5yb3VuZChNYXRoLnJhbmRvbSgpKSAtIC41IH0pLCByLmNvbnRhaW5lci5lbXB0eSgpLmFwcGVuZChyLnNsaWRlcykpOyByLmRvTWF0aCgpOyByLnNldHVwKCJpbml0Iik7IHIudmFycy5jb250cm9sTmF2ICYmIHYuY29udHJvbE5hdi5zZXR1cCgpOyByLnZhcnMuZGlyZWN0aW9uTmF2ICYmIHYuZGlyZWN0aW9uTmF2LnNldHVwKCk7IHIudmFycy5rZXlib2FyZCAmJiAoMSA9PT0gZShyLmNvbnRhaW5lclNlbGVjdG9yKS5sZW5ndGggfHwgci52YXJzLm11bHRpcGxlS2V5Ym9hcmQpICYmIGUoZG9jdW1lbnQpLmJpbmQoImtleXVwIiwgZnVuY3Rpb24gKGUpIHsgZSA9IGUua2V5Q29kZTsgci5hbmltYXRpbmcgfHwgMzkgIT09IGUgJiYgMzcgIT09IGUgfHwgKGUgPSAzOSA9PT0gZSA/IHIuZ2V0VGFyZ2V0KCJuZXh0IikgOiAzNyA9PT0gZSA/IHIuZ2V0VGFyZ2V0KCJwcmV2IikgOiAhMSwgci5mbGV4QW5pbWF0ZShlLCByLnZhcnMucGF1c2VPbkFjdGlvbikpIH0pOyByLnZhcnMubW91c2V3aGVlbCAmJiByLmJpbmQoIm1vdXNld2hlZWwiLCBmdW5jdGlvbiAoZSwgdCwgbiwgaSkgeyBlLnByZXZlbnREZWZhdWx0KCk7IGUgPSAwID4gdCA/IHIuZ2V0VGFyZ2V0KCJuZXh0IikgOiByLmdldFRhcmdldCgicHJldiIpOyByLmZsZXhBbmltYXRlKGUsIHIudmFycy5wYXVzZU9uQWN0aW9uKSB9KTsgci52YXJzLnBhdXNlUGxheSAmJiB2LnBhdXNlUGxheS5zZXR1cCgpOyByLnZhcnMuc2xpZGVzaG93ICYmIHIudmFycy5wYXVzZUludmlzaWJsZSAmJiB2LnBhdXNlSW52aXNpYmxlLmluaXQoKTsgci52YXJzLnNsaWRlc2hvdyAmJiAoci52YXJzLnBhdXNlT25Ib3ZlciAmJiByLmhvdmVyKGZ1bmN0aW9uICgpIHsgci5tYW51YWxQbGF5IHx8IHIubWFudWFsUGF1c2UgfHwgci5wYXVzZSgpIH0sIGZ1bmN0aW9uICgpIHsgci5tYW51YWxQYXVzZSB8fCByLm1hbnVhbFBsYXkgfHwgci5zdG9wcGVkIHx8IHIucGxheSgpIH0pLCByLnZhcnMucGF1c2VJbnZpc2libGUgJiYgdi5wYXVzZUludmlzaWJsZS5pc0hpZGRlbigpIHx8ICgwIDwgci52YXJzLmluaXREZWxheSA/IHIuc3RhcnRUaW1lb3V0ID0gc2V0VGltZW91dChyLnBsYXksIHIudmFycy5pbml0RGVsYXkpIDogci5wbGF5KCkpKTsgcCAmJiB2LmFzTmF2LnNldHVwKCk7IG8gJiYgci52YXJzLnRvdWNoICYmIHYudG91Y2goKTsgKCFoIHx8IGggJiYgci52YXJzLnNtb290aEhlaWdodCkgJiYgZSh3aW5kb3cpLmJpbmQoInJlc2l6ZSBvcmllbnRhdGlvbmNoYW5nZSBmb2N1cyIsIHYucmVzaXplKTsgci5maW5kKCJpbWciKS5hdHRyKCJkcmFnZ2FibGUiLCAiZmFsc2UiKTsgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7IHIudmFycy5zdGFydChyKSB9LCAyMDApIH0sIGFzTmF2OiB7IHNldHVwOiBmdW5jdGlvbiAoKSB7IHIuYXNOYXYgPSAhMDsgci5hbmltYXRpbmdUbyA9IE1hdGguZmxvb3Ioci5jdXJyZW50U2xpZGUgLyByLm1vdmUpOyByLmN1cnJlbnRJdGVtID0gci5jdXJyZW50U2xpZGU7IHIuc2xpZGVzLnJlbW92ZUNsYXNzKGkgKyAiYWN0aXZlLXNsaWRlIikuZXEoci5jdXJyZW50SXRlbSkuYWRkQ2xhc3MoaSArICJhY3RpdmUtc2xpZGUiKTsgaWYgKHMpIHQuX3NsaWRlciA9IHIsIHIuc2xpZGVzLmVhY2goZnVuY3Rpb24gKCkgeyB0aGlzLl9nZXN0dXJlID0gbmV3IE1TR2VzdHVyZTsgdGhpcy5fZ2VzdHVyZS50YXJnZXQgPSB0aGlzOyB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoIk1TUG9pbnRlckRvd24iLCBmdW5jdGlvbiAoZSkgeyBlLnByZXZlbnREZWZhdWx0KCk7IGUuY3VycmVudFRhcmdldC5fZ2VzdHVyZSAmJiBlLmN1cnJlbnRUYXJnZXQuX2dlc3R1cmUuYWRkUG9pbnRlcihlLnBvaW50ZXJJZCkgfSwgITEpOyB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoIk1TR2VzdHVyZVRhcCIsIGZ1bmN0aW9uICh0KSB7IHQucHJldmVudERlZmF1bHQoKTsgdCA9IGUodGhpcyk7IHZhciBuID0gdC5pbmRleCgpOyBlKHIudmFycy5hc05hdkZvcikuZGF0YSgiZmxleHNsaWRlciIpLmFuaW1hdGluZyB8fCB0Lmhhc0NsYXNzKCJhY3RpdmUiKSB8fCAoci5kaXJlY3Rpb24gPSByLmN1cnJlbnRJdGVtIDwgbiA/ICJuZXh0IiA6ICJwcmV2Iiwgci5mbGV4QW5pbWF0ZShuLCByLnZhcnMucGF1c2VPbkFjdGlvbiwgITEsICEwLCAhMCkpIH0pIH0pOyBlbHNlIHIuc2xpZGVzLm9uKCJjbGljayB0b3VjaGVuZCBNU1BvaW50ZXJVcCIsIGZ1bmN0aW9uICh0KSB7IHQucHJldmVudERlZmF1bHQoKTsgdCA9IGUodGhpcyk7IHZhciBuID0gdC5pbmRleCgpOyAwID49IHQub2Zmc2V0KCkubGVmdCAtIGUocikuc2Nyb2xsTGVmdCgpICYmIHQuaGFzQ2xhc3MoaSArICJhY3RpdmUtc2xpZGUiKSA/IHIuZmxleEFuaW1hdGUoci5nZXRUYXJnZXQoInByZXYiKSwgITApIDogZShyLnZhcnMuYXNOYXZGb3IpLmRhdGEoImZsZXhzbGlkZXIiKS5hbmltYXRpbmcgfHwgdC5oYXNDbGFzcyhpICsgImFjdGl2ZS1zbGlkZSIpIHx8IChyLmRpcmVjdGlvbiA9IHIuY3VycmVudEl0ZW0gPCBuID8gIm5leHQiIDogInByZXYiLCByLmZsZXhBbmltYXRlKG4sIHIudmFycy5wYXVzZU9uQWN0aW9uLCAhMSwgITAsICEwKSkgfSkgfSB9LCBjb250cm9sTmF2OiB7IHNldHVwOiBmdW5jdGlvbiAoKSB7IHIubWFudWFsQ29udHJvbHMgPyB2LmNvbnRyb2xOYXYuc2V0dXBNYW51YWwoKSA6IHYuY29udHJvbE5hdi5zZXR1cFBhZ2luZygpIH0sIHNldHVwUGFnaW5nOiBmdW5jdGlvbiAoKSB7IHZhciB0ID0gMSwgbiwgczsgci5jb250cm9sTmF2U2NhZmZvbGQgPSBlKCc8b2wgY2xhc3M9IicgKyBpICsgImNvbnRyb2wtbmF2ICIgKyBpICsgKCJ0aHVtYm5haWxzIiA9PT0gci52YXJzLmNvbnRyb2xOYXYgPyAiY29udHJvbC10aHVtYnMiIDogImNvbnRyb2wtcGFnaW5nIikgKyAnIj48L29sPicpOyBpZiAoMSA8IHIucGFnaW5nQ291bnQpIGZvciAodmFyIG8gPSAwOyBvIDwgci5wYWdpbmdDb3VudDsgbysrKSBzID0gci5zbGlkZXMuZXEobyksIG4gPSAidGh1bWJuYWlscyIgPT09IHIudmFycy5jb250cm9sTmF2ID8gJzxpbWcgc3JjPSInICsgcy5hdHRyKCJkYXRhLXRodW1iIikgKyAnIi8+JyA6ICI8YT4iICsgdCArICI8L2E+IiwgInRodW1ibmFpbHMiID09PSByLnZhcnMuY29udHJvbE5hdiAmJiAhMCA9PT0gci52YXJzLnRodW1iQ2FwdGlvbnMgJiYgKHMgPSBzLmF0dHIoImRhdGEtdGh1bWJjYXB0aW9uIiksICIiICE9IHMgJiYgdm9pZCAwICE9IHMgJiYgKG4gKz0gJzxzcGFuIGNsYXNzPSInICsgaSArICdjYXB0aW9uIj4nICsgcyArICI8L3NwYW4+IikpLCByLmNvbnRyb2xOYXZTY2FmZm9sZC5hcHBlbmQoIjxsaT4iICsgbiArICI8L2xpPiIpLCB0Kys7IHIuY29udHJvbHNDb250YWluZXIgPyBlKHIuY29udHJvbHNDb250YWluZXIpLmFwcGVuZChyLmNvbnRyb2xOYXZTY2FmZm9sZCkgOiByLmFwcGVuZChyLmNvbnRyb2xOYXZTY2FmZm9sZCk7IHYuY29udHJvbE5hdi5zZXQoKTsgdi5jb250cm9sTmF2LmFjdGl2ZSgpOyByLmNvbnRyb2xOYXZTY2FmZm9sZC5kZWxlZ2F0ZSgiYSwgaW1nIiwgImNsaWNrIHRvdWNoZW5kIE1TUG9pbnRlclVwIiwgZnVuY3Rpb24gKHQpIHsgdC5wcmV2ZW50RGVmYXVsdCgpOyBpZiAoIiIgPT09IHUgfHwgdSA9PT0gdC50eXBlKSB7IHZhciBuID0gZSh0aGlzKSwgcyA9IHIuY29udHJvbE5hdi5pbmRleChuKTsgbi5oYXNDbGFzcyhpICsgImFjdGl2ZSIpIHx8IChyLmRpcmVjdGlvbiA9IHMgPiByLmN1cnJlbnRTbGlkZSA/ICJuZXh0IiA6ICJwcmV2Iiwgci5mbGV4QW5pbWF0ZShzLCByLnZhcnMucGF1c2VPbkFjdGlvbikpIH0gIiIgPT09IHUgJiYgKHUgPSB0LnR5cGUpOyB2LnNldFRvQ2xlYXJXYXRjaGVkRXZlbnQoKSB9KSB9LCBzZXR1cE1hbnVhbDogZnVuY3Rpb24gKCkgeyByLmNvbnRyb2xOYXYgPSByLm1hbnVhbENvbnRyb2xzOyB2LmNvbnRyb2xOYXYuYWN0aXZlKCk7IHIuY29udHJvbE5hdi5iaW5kKCJjbGljayB0b3VjaGVuZCBNU1BvaW50ZXJVcCIsIGZ1bmN0aW9uICh0KSB7IHQucHJldmVudERlZmF1bHQoKTsgaWYgKCIiID09PSB1IHx8IHUgPT09IHQudHlwZSkgeyB2YXIgbiA9IGUodGhpcyksIHMgPSByLmNvbnRyb2xOYXYuaW5kZXgobik7IG4uaGFzQ2xhc3MoaSArICJhY3RpdmUiKSB8fCAocyA+IHIuY3VycmVudFNsaWRlID8gci5kaXJlY3Rpb24gPSAibmV4dCIgOiByLmRpcmVjdGlvbiA9ICJwcmV2Iiwgci5mbGV4QW5pbWF0ZShzLCByLnZhcnMucGF1c2VPbkFjdGlvbikpIH0gIiIgPT09IHUgJiYgKHUgPSB0LnR5cGUpOyB2LnNldFRvQ2xlYXJXYXRjaGVkRXZlbnQoKSB9KSB9LCBzZXQ6IGZ1bmN0aW9uICgpIHsgci5jb250cm9sTmF2ID0gZSgiLiIgKyBpICsgImNvbnRyb2wtbmF2IGxpICIgKyAoInRodW1ibmFpbHMiID09PSByLnZhcnMuY29udHJvbE5hdiA/ICJpbWciIDogImEiKSwgci5jb250cm9sc0NvbnRhaW5lciA/IHIuY29udHJvbHNDb250YWluZXIgOiByKSB9LCBhY3RpdmU6IGZ1bmN0aW9uICgpIHsgci5jb250cm9sTmF2LnJlbW92ZUNsYXNzKGkgKyAiYWN0aXZlIikuZXEoci5hbmltYXRpbmdUbykuYWRkQ2xhc3MoaSArICJhY3RpdmUiKSB9LCB1cGRhdGU6IGZ1bmN0aW9uICh0LCBuKSB7IDEgPCByLnBhZ2luZ0NvdW50ICYmICJhZGQiID09PSB0ID8gci5jb250cm9sTmF2U2NhZmZvbGQuYXBwZW5kKGUoIjxsaT48YT4iICsgci5jb3VudCArICI8L2E+PC9saT4iKSkgOiAxID09PSByLnBhZ2luZ0NvdW50ID8gci5jb250cm9sTmF2U2NhZmZvbGQuZmluZCgibGkiKS5yZW1vdmUoKSA6IHIuY29udHJvbE5hdi5lcShuKS5jbG9zZXN0KCJsaSIpLnJlbW92ZSgpOyB2LmNvbnRyb2xOYXYuc2V0KCk7IDEgPCByLnBhZ2luZ0NvdW50ICYmIHIucGFnaW5nQ291bnQgIT09IHIuY29udHJvbE5hdi5sZW5ndGggPyByLnVwZGF0ZShuLCB0KSA6IHYuY29udHJvbE5hdi5hY3RpdmUoKSB9IH0sIGRpcmVjdGlvbk5hdjogeyBzZXR1cDogZnVuY3Rpb24gKCkgeyB2YXIgdCA9IGUoJzx1bCBjbGFzcz0iJyArIGkgKyAnZGlyZWN0aW9uLW5hdiI+PGxpPjxhIGNsYXNzPSInICsgaSArICdwcmV2IiBocmVmPSIjIj4nICsgci52YXJzLnByZXZUZXh0ICsgJzwvYT48L2xpPjxsaT48YSBjbGFzcz0iJyArIGkgKyAnbmV4dCIgaHJlZj0iIyI+JyArIHIudmFycy5uZXh0VGV4dCArICI8L2E+PC9saT48L3VsPiIpOyByLmNvbnRyb2xzQ29udGFpbmVyID8gKGUoci5jb250cm9sc0NvbnRhaW5lcikuYXBwZW5kKHQpLCByLmRpcmVjdGlvbk5hdiA9IGUoIi4iICsgaSArICJkaXJlY3Rpb24tbmF2IGxpIGEiLCByLmNvbnRyb2xzQ29udGFpbmVyKSkgOiAoci5hcHBlbmQodCksIHIuZGlyZWN0aW9uTmF2ID0gZSgiLiIgKyBpICsgImRpcmVjdGlvbi1uYXYgbGkgYSIsIHIpKTsgdi5kaXJlY3Rpb25OYXYudXBkYXRlKCk7IHIuZGlyZWN0aW9uTmF2LmJpbmQoImNsaWNrIHRvdWNoZW5kIE1TUG9pbnRlclVwIiwgZnVuY3Rpb24gKHQpIHsgdC5wcmV2ZW50RGVmYXVsdCgpOyB2YXIgbjsgaWYgKCIiID09PSB1IHx8IHUgPT09IHQudHlwZSkgbiA9IGUodGhpcykuaGFzQ2xhc3MoaSArICJuZXh0IikgPyByLmdldFRhcmdldCgibmV4dCIpIDogci5nZXRUYXJnZXQoInByZXYiKSwgci5mbGV4QW5pbWF0ZShuLCByLnZhcnMucGF1c2VPbkFjdGlvbik7ICIiID09PSB1ICYmICh1ID0gdC50eXBlKTsgdi5zZXRUb0NsZWFyV2F0Y2hlZEV2ZW50KCkgfSkgfSwgdXBkYXRlOiBmdW5jdGlvbiAoKSB7IHZhciBlID0gaSArICJkaXNhYmxlZCI7IDEgPT09IHIucGFnaW5nQ291bnQgPyByLmRpcmVjdGlvbk5hdi5hZGRDbGFzcyhlKS5hdHRyKCJ0YWJpbmRleCIsICItMSIpIDogci52YXJzLmFuaW1hdGlvbkxvb3AgPyByLmRpcmVjdGlvbk5hdi5yZW1vdmVDbGFzcyhlKS5yZW1vdmVBdHRyKCJ0YWJpbmRleCIpIDogMCA9PT0gci5hbmltYXRpbmdUbyA/IHIuZGlyZWN0aW9uTmF2LnJlbW92ZUNsYXNzKGUpLmZpbHRlcigiLiIgKyBpICsgInByZXYiKS5hZGRDbGFzcyhlKS5hdHRyKCJ0YWJpbmRleCIsICItMSIpIDogci5hbmltYXRpbmdUbyA9PT0gci5sYXN0ID8gci5kaXJlY3Rpb25OYXYucmVtb3ZlQ2xhc3MoZSkuZmlsdGVyKCIuIiArIGkgKyAibmV4dCIpLmFkZENsYXNzKGUpLmF0dHIoInRhYmluZGV4IiwgIi0xIikgOiByLmRpcmVjdGlvbk5hdi5yZW1vdmVDbGFzcyhlKS5yZW1vdmVBdHRyKCJ0YWJpbmRleCIpIH0gfSwgcGF1c2VQbGF5OiB7IHNldHVwOiBmdW5jdGlvbiAoKSB7IHZhciB0ID0gZSgnPGRpdiBjbGFzcz0iJyArIGkgKyAncGF1c2VwbGF5Ij48YT48L2E+PC9kaXY+Jyk7IHIuY29udHJvbHNDb250YWluZXIgPyAoci5jb250cm9sc0NvbnRhaW5lci5hcHBlbmQodCksIHIucGF1c2VQbGF5ID0gZSgiLiIgKyBpICsgInBhdXNlcGxheSBhIiwgci5jb250cm9sc0NvbnRhaW5lcikpIDogKHIuYXBwZW5kKHQpLCByLnBhdXNlUGxheSA9IGUoIi4iICsgaSArICJwYXVzZXBsYXkgYSIsIHIpKTsgdi5wYXVzZVBsYXkudXBkYXRlKHIudmFycy5zbGlkZXNob3cgPyBpICsgInBhdXNlIiA6IGkgKyAicGxheSIpOyByLnBhdXNlUGxheS5iaW5kKCJjbGljayB0b3VjaGVuZCBNU1BvaW50ZXJVcCIsIGZ1bmN0aW9uICh0KSB7IHQucHJldmVudERlZmF1bHQoKTsgaWYgKCIiID09PSB1IHx8IHUgPT09IHQudHlwZSkgZSh0aGlzKS5oYXNDbGFzcyhpICsgInBhdXNlIikgPyAoci5tYW51YWxQYXVzZSA9ICEwLCByLm1hbnVhbFBsYXkgPSAhMSwgci5wYXVzZSgpKSA6IChyLm1hbnVhbFBhdXNlID0gITEsIHIubWFudWFsUGxheSA9ICEwLCByLnBsYXkoKSk7ICIiID09PSB1ICYmICh1ID0gdC50eXBlKTsgdi5zZXRUb0NsZWFyV2F0Y2hlZEV2ZW50KCkgfSkgfSwgdXBkYXRlOiBmdW5jdGlvbiAoZSkgeyAicGxheSIgPT09IGUgPyByLnBhdXNlUGxheS5yZW1vdmVDbGFzcyhpICsgInBhdXNlIikuYWRkQ2xhc3MoaSArICJwbGF5IikuaHRtbChyLnZhcnMucGxheVRleHQpIDogci5wYXVzZVBsYXkucmVtb3ZlQ2xhc3MoaSArICJwbGF5IikuYWRkQ2xhc3MoaSArICJwYXVzZSIpLmh0bWwoci52YXJzLnBhdXNlVGV4dCkgfSB9LCB0b3VjaDogZnVuY3Rpb24gKCkgeyB2YXIgZSwgbiwgaSwgbywgdSwgYSwgcCA9ICExLCBkID0gMCwgdiA9IDAsIG0gPSAwOyBpZiAocykgeyB0LnN0eWxlLm1zVG91Y2hBY3Rpb24gPSAibm9uZSI7IHQuX2dlc3R1cmUgPSBuZXcgTVNHZXN0dXJlOyB0Ll9nZXN0dXJlLnRhcmdldCA9IHQ7IHQuYWRkRXZlbnRMaXN0ZW5lcigiTVNQb2ludGVyRG93biIsIHksICExKTsgdC5fc2xpZGVyID0gcjsgdC5hZGRFdmVudExpc3RlbmVyKCJNU0dlc3R1cmVDaGFuZ2UiLCBiLCAhMSk7IHQuYWRkRXZlbnRMaXN0ZW5lcigiTVNHZXN0dXJlRW5kIiwgdywgITEpOyB2YXIgeSA9IGZ1bmN0aW9uIChlKSB7IGUuc3RvcFByb3BhZ2F0aW9uKCk7IHIuYW5pbWF0aW5nID8gZS5wcmV2ZW50RGVmYXVsdCgpIDogKHIucGF1c2UoKSwgdC5fZ2VzdHVyZS5hZGRQb2ludGVyKGUucG9pbnRlcklkKSwgbSA9IDAsIG8gPSBmID8gci5oIDogci53LCBhID0gTnVtYmVyKG5ldyBEYXRlKSwgaSA9IGMgJiYgbCAmJiByLmFuaW1hdGluZ1RvID09PSByLmxhc3QgPyAwIDogYyAmJiBsID8gci5saW1pdCAtIChyLml0ZW1XICsgci52YXJzLml0ZW1NYXJnaW4pICogci5tb3ZlICogci5hbmltYXRpbmdUbyA6IGMgJiYgci5jdXJyZW50U2xpZGUgPT09IHIubGFzdCA/IHIubGltaXQgOiBjID8gKHIuaXRlbVcgKyByLnZhcnMuaXRlbU1hcmdpbikgKiByLm1vdmUgKiByLmN1cnJlbnRTbGlkZSA6IGwgPyAoci5sYXN0IC0gci5jdXJyZW50U2xpZGUgKyByLmNsb25lT2Zmc2V0KSAqIG8gOiAoci5jdXJyZW50U2xpZGUgKyByLmNsb25lT2Zmc2V0KSAqIG8pIH0sIGIgPSBmdW5jdGlvbiAoZSkgeyBlLnN0b3BQcm9wYWdhdGlvbigpOyB2YXIgbiA9IGUudGFyZ2V0Ll9zbGlkZXI7IGlmIChuKSB7IHZhciByID0gLWUudHJhbnNsYXRpb25YLCBzID0gLWUudHJhbnNsYXRpb25ZOyB1ID0gbSArPSBmID8gcyA6IHI7IHAgPSBmID8gTWF0aC5hYnMobSkgPCBNYXRoLmFicygtcikgOiBNYXRoLmFicyhtKSA8IE1hdGguYWJzKC1zKTsgaWYgKGUuZGV0YWlsID09PSBlLk1TR0VTVFVSRV9GTEFHX0lORVJUSUEpIHNldEltbWVkaWF0ZShmdW5jdGlvbiAoKSB7IHQuX2dlc3R1cmUuc3RvcCgpIH0pOyBlbHNlIGlmICghcCB8fCA1MDAgPCBOdW1iZXIobmV3IERhdGUpIC0gYSkgZS5wcmV2ZW50RGVmYXVsdCgpLCAhaCAmJiBuLnRyYW5zaXRpb25zICYmIChuLnZhcnMuYW5pbWF0aW9uTG9vcCB8fCAodSA9IG0gLyAoMCA9PT0gbi5jdXJyZW50U2xpZGUgJiYgMCA+IG0gfHwgbi5jdXJyZW50U2xpZGUgPT09IG4ubGFzdCAmJiAwIDwgbSA/IE1hdGguYWJzKG0pIC8gbyArIDIgOiAxKSksIG4uc2V0UHJvcHMoaSArIHUsICJzZXRUb3VjaCIpKSB9IH0sIHcgPSBmdW5jdGlvbiAodCkgeyB0LnN0b3BQcm9wYWdhdGlvbigpOyBpZiAodCA9IHQudGFyZ2V0Ll9zbGlkZXIpIHsgaWYgKHQuYW5pbWF0aW5nVG8gPT09IHQuY3VycmVudFNsaWRlICYmICFwICYmIG51bGwgIT09IHUpIHsgdmFyIHIgPSBsID8gLXUgOiB1LCBzID0gMCA8IHIgPyB0LmdldFRhcmdldCgibmV4dCIpIDogdC5nZXRUYXJnZXQoInByZXYiKTsgdC5jYW5BZHZhbmNlKHMpICYmICg1NTAgPiBOdW1iZXIobmV3IERhdGUpIC0gYSAmJiA1MCA8IE1hdGguYWJzKHIpIHx8IE1hdGguYWJzKHIpID4gbyAvIDIpID8gdC5mbGV4QW5pbWF0ZShzLCB0LnZhcnMucGF1c2VPbkFjdGlvbikgOiBoIHx8IHQuZmxleEFuaW1hdGUodC5jdXJyZW50U2xpZGUsIHQudmFycy5wYXVzZU9uQWN0aW9uLCAhMCkgfSBpID0gdSA9IG4gPSBlID0gbnVsbDsgbSA9IDAgfSB9IH0gZWxzZSB7IHQuYWRkRXZlbnRMaXN0ZW5lcigidG91Y2hzdGFydCIsIEUsICExKTsgdmFyIEUgPSBmdW5jdGlvbiAocykgeyBpZiAoci5hbmltYXRpbmcpIHMucHJldmVudERlZmF1bHQoKTsgZWxzZSBpZiAod2luZG93Lm5hdmlnYXRvci5tc1BvaW50ZXJFbmFibGVkIHx8IDEgPT09IHMudG91Y2hlcy5sZW5ndGgpIHIucGF1c2UoKSwgbyA9IGYgPyByLmggOiByLncsIGEgPSBOdW1iZXIobmV3IERhdGUpLCBkID0gcy50b3VjaGVzWzBdLnBhZ2VYLCB2ID0gcy50b3VjaGVzWzBdLnBhZ2VZLCBpID0gYyAmJiBsICYmIHIuYW5pbWF0aW5nVG8gPT09IHIubGFzdCA/IDAgOiBjICYmIGwgPyByLmxpbWl0IC0gKHIuaXRlbVcgKyByLnZhcnMuaXRlbU1hcmdpbikgKiByLm1vdmUgKiByLmFuaW1hdGluZ1RvIDogYyAmJiByLmN1cnJlbnRTbGlkZSA9PT0gci5sYXN0ID8gci5saW1pdCA6IGMgPyAoci5pdGVtVyArIHIudmFycy5pdGVtTWFyZ2luKSAqIHIubW92ZSAqIHIuY3VycmVudFNsaWRlIDogbCA/IChyLmxhc3QgLSByLmN1cnJlbnRTbGlkZSArIHIuY2xvbmVPZmZzZXQpICogbyA6IChyLmN1cnJlbnRTbGlkZSArIHIuY2xvbmVPZmZzZXQpICogbywgZSA9IGYgPyB2IDogZCwgbiA9IGYgPyBkIDogdiwgdC5hZGRFdmVudExpc3RlbmVyKCJ0b3VjaG1vdmUiLCBTLCAhMSksIHQuYWRkRXZlbnRMaXN0ZW5lcigidG91Y2hlbmQiLCB4LCAhMSkgfSwgUyA9IGZ1bmN0aW9uICh0KSB7IGQgPSB0LnRvdWNoZXNbMF0ucGFnZVg7IHYgPSB0LnRvdWNoZXNbMF0ucGFnZVk7IHUgPSBmID8gZSAtIHYgOiBlIC0gZDsgcCA9IGYgPyBNYXRoLmFicyh1KSA8IE1hdGguYWJzKGQgLSBuKSA6IE1hdGguYWJzKHUpIDwgTWF0aC5hYnModiAtIG4pOyBpZiAoIXAgfHwgNTAwIDwgTnVtYmVyKG5ldyBEYXRlKSAtIGEpIHQucHJldmVudERlZmF1bHQoKSwgIWggJiYgci50cmFuc2l0aW9ucyAmJiAoci52YXJzLmFuaW1hdGlvbkxvb3AgfHwgKHUgLz0gMCA9PT0gci5jdXJyZW50U2xpZGUgJiYgMCA+IHUgfHwgci5jdXJyZW50U2xpZGUgPT09IHIubGFzdCAmJiAwIDwgdSA/IE1hdGguYWJzKHUpIC8gbyArIDIgOiAxKSwgci5zZXRQcm9wcyhpICsgdSwgInNldFRvdWNoIikpIH0sIHggPSBmdW5jdGlvbiAocykgeyB0LnJlbW92ZUV2ZW50TGlzdGVuZXIoInRvdWNobW92ZSIsIFMsICExKTsgaWYgKHIuYW5pbWF0aW5nVG8gPT09IHIuY3VycmVudFNsaWRlICYmICFwICYmIG51bGwgIT09IHUpIHsgcyA9IGwgPyAtdSA6IHU7IHZhciBmID0gMCA8IHMgPyByLmdldFRhcmdldCgibmV4dCIpIDogci5nZXRUYXJnZXQoInByZXYiKTsgci5jYW5BZHZhbmNlKGYpICYmICg1NTAgPiBOdW1iZXIobmV3IERhdGUpIC0gYSAmJiA1MCA8IE1hdGguYWJzKHMpIHx8IE1hdGguYWJzKHMpID4gbyAvIDIpID8gci5mbGV4QW5pbWF0ZShmLCByLnZhcnMucGF1c2VPbkFjdGlvbikgOiBoIHx8IHIuZmxleEFuaW1hdGUoci5jdXJyZW50U2xpZGUsIHIudmFycy5wYXVzZU9uQWN0aW9uLCAhMCkgfSB0LnJlbW92ZUV2ZW50TGlzdGVuZXIoInRvdWNoZW5kIiwgeCwgITEpOyBpID0gdSA9IG4gPSBlID0gbnVsbCB9IH0gfSwgcmVzaXplOiBmdW5jdGlvbiAoKSB7ICFyLmFuaW1hdGluZyAmJiByLmlzKCI6dmlzaWJsZSIpICYmIChjIHx8IHIuZG9NYXRoKCksIGggPyB2LnNtb290aEhlaWdodCgpIDogYyA/IChyLnNsaWRlcy53aWR0aChyLmNvbXB1dGVkVyksIHIudXBkYXRlKHIucGFnaW5nQ291bnQpLCByLnNldFByb3BzKCkpIDogZiA/IChyLnZpZXdwb3J0LmhlaWdodChyLmgpLCByLnNldFByb3BzKHIuaCwgInNldFRvdGFsIikpIDogKHIudmFycy5zbW9vdGhIZWlnaHQgJiYgdi5zbW9vdGhIZWlnaHQoKSwgci5uZXdTbGlkZXMud2lkdGgoci5jb21wdXRlZFcpLCByLnNldFByb3BzKHIuY29tcHV0ZWRXLCAic2V0VG90YWwiKSkpIH0sIHNtb290aEhlaWdodDogZnVuY3Rpb24gKGUpIHsgaWYgKCFmIHx8IGgpIHsgdmFyIHQgPSBoID8gciA6IHIudmlld3BvcnQ7IGUgPyB0LmFuaW1hdGUoeyBoZWlnaHQ6IHIuc2xpZGVzLmVxKHIuYW5pbWF0aW5nVG8pLmhlaWdodCgpIH0sIGUpIDogdC5oZWlnaHQoci5zbGlkZXMuZXEoci5hbmltYXRpbmdUbykuaGVpZ2h0KCkpIH0gfSwgc3luYzogZnVuY3Rpb24gKHQpIHsgdmFyIG4gPSBlKHIudmFycy5zeW5jKS5kYXRhKCJmbGV4c2xpZGVyIiksIGkgPSByLmFuaW1hdGluZ1RvOyBzd2l0Y2ggKHQpIHsgY2FzZSAiYW5pbWF0ZSI6IG4uZmxleEFuaW1hdGUoaSwgci52YXJzLnBhdXNlT25BY3Rpb24sICExLCAhMCk7IGJyZWFrOyBjYXNlICJwbGF5Ijogbi5wbGF5aW5nIHx8IG4uYXNOYXYgfHwgbi5wbGF5KCk7IGJyZWFrOyBjYXNlICJwYXVzZSI6IG4ucGF1c2UoKSB9IH0sIHVuaXF1ZUlEOiBmdW5jdGlvbiAodCkgeyB0LmZpbmQoIltpZF0iKS5lYWNoKGZ1bmN0aW9uICgpIHsgdmFyIHQgPSBlKHRoaXMpOyB0LmF0dHIoImlkIiwgdC5hdHRyKCJpZCIpICsgIl9jbG9uZSIpIH0pOyByZXR1cm4gdCB9LCBwYXVzZUludmlzaWJsZTogeyB2aXNQcm9wOiBudWxsLCBpbml0OiBmdW5jdGlvbiAoKSB7IHZhciBlID0gWyJ3ZWJraXQiLCAibW96IiwgIm1zIiwgIm8iXTsgaWYgKCJoaWRkZW4iIGluIGRvY3VtZW50KSByZXR1cm4gImhpZGRlbiI7IGZvciAodmFyIHQgPSAwOyB0IDwgZS5sZW5ndGg7IHQrKykgZVt0XSArICJIaWRkZW4iIGluIGRvY3VtZW50ICYmICh2LnBhdXNlSW52aXNpYmxlLnZpc1Byb3AgPSBlW3RdICsgIkhpZGRlbiIpOyB2LnBhdXNlSW52aXNpYmxlLnZpc1Byb3AgJiYgKGUgPSB2LnBhdXNlSW52aXNpYmxlLnZpc1Byb3AucmVwbGFjZSgvW0h8aF1pZGRlbi8sICIiKSArICJ2aXNpYmlsaXR5Y2hhbmdlIiwgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihlLCBmdW5jdGlvbiAoKSB7IHYucGF1c2VJbnZpc2libGUuaXNIaWRkZW4oKSA/IHIuc3RhcnRUaW1lb3V0ID8gY2xlYXJUaW1lb3V0KHIuc3RhcnRUaW1lb3V0KSA6IHIucGF1c2UoKSA6IHIuc3RhcnRlZCA/IHIucGxheSgpIDogMCA8IHIudmFycy5pbml0RGVsYXkgPyBzZXRUaW1lb3V0KHIucGxheSwgci52YXJzLmluaXREZWxheSkgOiByLnBsYXkoKSB9KSkgfSwgaXNIaWRkZW46IGZ1bmN0aW9uICgpIHsgcmV0dXJuIGRvY3VtZW50W3YucGF1c2VJbnZpc2libGUudmlzUHJvcF0gfHwgITEgfSB9LCBzZXRUb0NsZWFyV2F0Y2hlZEV2ZW50OiBmdW5jdGlvbiAoKSB7IGNsZWFyVGltZW91dChhKTsgYSA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgeyB1ID0gIiIgfSwgM2UzKSB9IH07IHIuZmxleEFuaW1hdGUgPSBmdW5jdGlvbiAodCwgbiwgcywgdSwgYSkgeyByLnZhcnMuYW5pbWF0aW9uTG9vcCB8fCB0ID09PSByLmN1cnJlbnRTbGlkZSB8fCAoci5kaXJlY3Rpb24gPSB0ID4gci5jdXJyZW50U2xpZGUgPyAibmV4dCIgOiAicHJldiIpOyBwICYmIDEgPT09IHIucGFnaW5nQ291bnQgJiYgKHIuZGlyZWN0aW9uID0gci5jdXJyZW50SXRlbSA8IHQgPyAibmV4dCIgOiAicHJldiIpOyBpZiAoIXIuYW5pbWF0aW5nICYmIChyLmNhbkFkdmFuY2UodCwgYSkgfHwgcykgJiYgci5pcygiOnZpc2libGUiKSkgeyBpZiAocCAmJiB1KSBpZiAocyA9IGUoci52YXJzLmFzTmF2Rm9yKS5kYXRhKCJmbGV4c2xpZGVyIiksIHIuYXRFbmQgPSAwID09PSB0IHx8IHQgPT09IHIuY291bnQgLSAxLCBzLmZsZXhBbmltYXRlKHQsICEwLCAhMSwgITAsIGEpLCByLmRpcmVjdGlvbiA9IHIuY3VycmVudEl0ZW0gPCB0ID8gIm5leHQiIDogInByZXYiLCBzLmRpcmVjdGlvbiA9IHIuZGlyZWN0aW9uLCBNYXRoLmNlaWwoKHQgKyAxKSAvIHIudmlzaWJsZSkgLSAxICE9PSByLmN1cnJlbnRTbGlkZSAmJiAwICE9PSB0KSByLmN1cnJlbnRJdGVtID0gdCwgci5zbGlkZXMucmVtb3ZlQ2xhc3MoaSArICJhY3RpdmUtc2xpZGUiKS5lcSh0KS5hZGRDbGFzcyhpICsgImFjdGl2ZS1zbGlkZSIpLCB0ID0gTWF0aC5mbG9vcih0IC8gci52aXNpYmxlKTsgZWxzZSByZXR1cm4gci5jdXJyZW50SXRlbSA9IHQsIHIuc2xpZGVzLnJlbW92ZUNsYXNzKGkgKyAiYWN0aXZlLXNsaWRlIikuZXEodCkuYWRkQ2xhc3MoaSArICJhY3RpdmUtc2xpZGUiKSwgITE7IHIuYW5pbWF0aW5nID0gITA7IHIuYW5pbWF0aW5nVG8gPSB0OyBuICYmIHIucGF1c2UoKTsgci52YXJzLmJlZm9yZShyKTsgci5zeW5jRXhpc3RzICYmICFhICYmIHYuc3luYygiYW5pbWF0ZSIpOyByLnZhcnMuY29udHJvbE5hdiAmJiB2LmNvbnRyb2xOYXYuYWN0aXZlKCk7IGMgfHwgci5zbGlkZXMucmVtb3ZlQ2xhc3MoaSArICJhY3RpdmUtc2xpZGUiKS5lcSh0KS5hZGRDbGFzcyhpICsgImFjdGl2ZS1zbGlkZSIpOyByLmF0RW5kID0gMCA9PT0gdCB8fCB0ID09PSByLmxhc3Q7IHIudmFycy5kaXJlY3Rpb25OYXYgJiYgdi5kaXJlY3Rpb25OYXYudXBkYXRlKCk7IHQgPT09IHIubGFzdCAmJiAoci52YXJzLmVuZChyKSwgci52YXJzLmFuaW1hdGlvbkxvb3AgfHwgci5wYXVzZSgpKTsgaWYgKGgpIG8gPyAoci5zbGlkZXMuZXEoci5jdXJyZW50U2xpZGUpLmNzcyh7IG9wYWNpdHk6IDAsIHpJbmRleDogMSB9KSwgci5zbGlkZXMuZXEodCkuY3NzKHsgb3BhY2l0eTogMSwgekluZGV4OiAyIH0pLCByLndyYXB1cChtKSkgOiAoci5zbGlkZXMuZXEoci5jdXJyZW50U2xpZGUpLmNzcyh7IHpJbmRleDogMSB9KS5hbmltYXRlKHsgb3BhY2l0eTogMCB9LCByLnZhcnMuYW5pbWF0aW9uU3BlZWQsIHIudmFycy5lYXNpbmcpLCByLnNsaWRlcy5lcSh0KS5jc3MoeyB6SW5kZXg6IDIgfSkuYW5pbWF0ZSh7IG9wYWNpdHk6IDEgfSwgci52YXJzLmFuaW1hdGlvblNwZWVkLCByLnZhcnMuZWFzaW5nLCByLndyYXB1cCkpOyBlbHNlIHsgdmFyIG0gPSBmID8gci5zbGlkZXMuZmlsdGVyKCI6Zmlyc3QiKS5oZWlnaHQoKSA6IHIuY29tcHV0ZWRXOyBjID8gKHQgPSByLnZhcnMuaXRlbU1hcmdpbiwgdCA9IChyLml0ZW1XICsgdCkgKiByLm1vdmUgKiByLmFuaW1hdGluZ1RvLCB0ID0gdCA+IHIubGltaXQgJiYgMSAhPT0gci52aXNpYmxlID8gci5saW1pdCA6IHQpIDogdCA9IDAgPT09IHIuY3VycmVudFNsaWRlICYmIHQgPT09IHIuY291bnQgLSAxICYmIHIudmFycy5hbmltYXRpb25Mb29wICYmICJuZXh0IiAhPT0gci5kaXJlY3Rpb24gPyBsID8gKHIuY291bnQgKyByLmNsb25lT2Zmc2V0KSAqIG0gOiAwIDogci5jdXJyZW50U2xpZGUgPT09IHIubGFzdCAmJiAwID09PSB0ICYmIHIudmFycy5hbmltYXRpb25Mb29wICYmICJwcmV2IiAhPT0gci5kaXJlY3Rpb24gPyBsID8gMCA6IChyLmNvdW50ICsgMSkgKiBtIDogbCA/IChyLmNvdW50IC0gMSAtIHQgKyByLmNsb25lT2Zmc2V0KSAqIG0gOiAodCArIHIuY2xvbmVPZmZzZXQpICogbTsgci5zZXRQcm9wcyh0LCAiIiwgci52YXJzLmFuaW1hdGlvblNwZWVkKTsgci50cmFuc2l0aW9ucyA/IChyLnZhcnMuYW5pbWF0aW9uTG9vcCAmJiByLmF0RW5kIHx8IChyLmFuaW1hdGluZyA9ICExLCByLmN1cnJlbnRTbGlkZSA9IHIuYW5pbWF0aW5nVG8pLCB0ID0gZnVuY3Rpb24gKCkgeyB2YXIgZSA9ICExOyByZXR1cm4gZnVuY3Rpb24gKCkgeyBlIHx8IHIud3JhcHVwKG0pOyBlID0gITAgfSB9ICgpLCByLmNvbnRhaW5lci51bmJpbmQoIndlYmtpdFRyYW5zaXRpb25FbmQgdHJhbnNpdGlvbmVuZCIpLCByLmNvbnRhaW5lci5iaW5kKCJ3ZWJraXRUcmFuc2l0aW9uRW5kIHRyYW5zaXRpb25lbmQiLCB0KSwgc2V0VGltZW91dCh0LCByLnZhcnMuYW5pbWF0aW9uU3BlZWQgKyAyMDApKSA6IHIuY29udGFpbmVyLmFuaW1hdGUoci5hcmdzLCByLnZhcnMuYW5pbWF0aW9uU3BlZWQsIHIudmFycy5lYXNpbmcsIGZ1bmN0aW9uICgpIHsgci53cmFwdXAobSkgfSkgfSByLnZhcnMuc21vb3RoSGVpZ2h0ICYmIHYuc21vb3RoSGVpZ2h0KHIudmFycy5hbmltYXRpb25TcGVlZCkgfSB9OyByLndyYXB1cCA9IGZ1bmN0aW9uIChlKSB7IGggfHwgYyB8fCAoMCA9PT0gci5jdXJyZW50U2xpZGUgJiYgci5hbmltYXRpbmdUbyA9PT0gci5sYXN0ICYmIHIudmFycy5hbmltYXRpb25Mb29wID8gci5zZXRQcm9wcyhlLCAianVtcEVuZCIpIDogci5jdXJyZW50U2xpZGUgPT09IHIubGFzdCAmJiAwID09PSByLmFuaW1hdGluZ1RvICYmIHIudmFycy5hbmltYXRpb25Mb29wICYmIHIuc2V0UHJvcHMoZSwgImp1bXBTdGFydCIpKTsgci5hbmltYXRpbmcgPSAhMTsgci5jdXJyZW50U2xpZGUgPSByLmFuaW1hdGluZ1RvOyByLnZhcnMuYWZ0ZXIocikgfTsgci5hbmltYXRlU2xpZGVzID0gZnVuY3Rpb24gKCkgeyByLmFuaW1hdGluZyB8fCByLmZsZXhBbmltYXRlKHIuZ2V0VGFyZ2V0KCJuZXh0IikpIH07IHIucGF1c2UgPSBmdW5jdGlvbiAoKSB7IGNsZWFySW50ZXJ2YWwoci5hbmltYXRlZFNsaWRlcyk7IHIuYW5pbWF0ZWRTbGlkZXMgPSBudWxsOyByLnBsYXlpbmcgPSAhMTsgci52YXJzLnBhdXNlUGxheSAmJiB2LnBhdXNlUGxheS51cGRhdGUoInBsYXkiKTsgci5zeW5jRXhpc3RzICYmIHYuc3luYygicGF1c2UiKSB9OyByLnBsYXkgPSBmdW5jdGlvbiAoKSB7IHIucGxheWluZyAmJiBjbGVhckludGVydmFsKHIuYW5pbWF0ZWRTbGlkZXMpOyByLmFuaW1hdGVkU2xpZGVzID0gci5hbmltYXRlZFNsaWRlcyB8fCBzZXRJbnRlcnZhbChyLmFuaW1hdGVTbGlkZXMsIHIudmFycy5zbGlkZXNob3dTcGVlZCk7IHIuc3RhcnRlZCA9IHIucGxheWluZyA9ICEwOyByLnZhcnMucGF1c2VQbGF5ICYmIHYucGF1c2VQbGF5LnVwZGF0ZSgicGF1c2UiKTsgci5zeW5jRXhpc3RzICYmIHYuc3luYygicGxheSIpIH07IHIuc3RvcCA9IGZ1bmN0aW9uICgpIHsgci5wYXVzZSgpOyByLnN0b3BwZWQgPSAhMCB9OyByLmNhbkFkdmFuY2UgPSBmdW5jdGlvbiAoZSwgdCkgeyB2YXIgbiA9IHAgPyByLnBhZ2luZ0NvdW50IC0gMSA6IHIubGFzdDsgcmV0dXJuIHQgPyAhMCA6IHAgJiYgci5jdXJyZW50SXRlbSA9PT0gci5jb3VudCAtIDEgJiYgMCA9PT0gZSAmJiAicHJldiIgPT09IHIuZGlyZWN0aW9uID8gITAgOiBwICYmIDAgPT09IHIuY3VycmVudEl0ZW0gJiYgZSA9PT0gci5wYWdpbmdDb3VudCAtIDEgJiYgIm5leHQiICE9PSByLmRpcmVjdGlvbiA/ICExIDogZSAhPT0gci5jdXJyZW50U2xpZGUgfHwgcCA/IHIudmFycy5hbmltYXRpb25Mb29wID8gITAgOiByLmF0RW5kICYmIDAgPT09IHIuY3VycmVudFNsaWRlICYmIGUgPT09IG4gJiYgIm5leHQiICE9PSByLmRpcmVjdGlvbiA/ICExIDogci5hdEVuZCAmJiByLmN1cnJlbnRTbGlkZSA9PT0gbiAmJiAwID09PSBlICYmICJuZXh0IiA9PT0gci5kaXJlY3Rpb24gPyAhMSA6ICEwIDogITEgfTsgci5nZXRUYXJnZXQgPSBmdW5jdGlvbiAoZSkgeyByLmRpcmVjdGlvbiA9IGU7IHJldHVybiAibmV4dCIgPT09IGUgPyByLmN1cnJlbnRTbGlkZSA9PT0gci5sYXN0ID8gMCA6IHIuY3VycmVudFNsaWRlICsgMSA6IDAgPT09IHIuY3VycmVudFNsaWRlID8gci5sYXN0IDogci5jdXJyZW50U2xpZGUgLSAxIH07IHIuc2V0UHJvcHMgPSBmdW5jdGlvbiAoZSwgdCwgbikgeyB2YXIgaSA9IGZ1bmN0aW9uICgpIHsgdmFyIG4gPSBlID8gZSA6IChyLml0ZW1XICsgci52YXJzLml0ZW1NYXJnaW4pICogci5tb3ZlICogci5hbmltYXRpbmdUbzsgcmV0dXJuIC0xICogZnVuY3Rpb24gKCkgeyBpZiAoYykgcmV0dXJuICJzZXRUb3VjaCIgPT09IHQgPyBlIDogbCAmJiByLmFuaW1hdGluZ1RvID09PSByLmxhc3QgPyAwIDogbCA/IHIubGltaXQgLSAoci5pdGVtVyArIHIudmFycy5pdGVtTWFyZ2luKSAqIHIubW92ZSAqIHIuYW5pbWF0aW5nVG8gOiByLmFuaW1hdGluZ1RvID09PSByLmxhc3QgPyByLmxpbWl0IDogbjsgc3dpdGNoICh0KSB7IGNhc2UgInNldFRvdGFsIjogcmV0dXJuIGwgPyAoci5jb3VudCAtIDEgLSByLmN1cnJlbnRTbGlkZSArIHIuY2xvbmVPZmZzZXQpICogZSA6IChyLmN1cnJlbnRTbGlkZSArIHIuY2xvbmVPZmZzZXQpICogZTsgY2FzZSAic2V0VG91Y2giOiByZXR1cm4gZTsgY2FzZSAianVtcEVuZCI6IHJldHVybiBsID8gZSA6IHIuY291bnQgKiBlOyBjYXNlICJqdW1wU3RhcnQiOiByZXR1cm4gbCA/IHIuY291bnQgKiBlIDogZTsgZGVmYXVsdDogcmV0dXJuIGUgfSB9ICgpICsgInB4IiB9ICgpOyByLnRyYW5zaXRpb25zICYmIChpID0gZiA/ICJ0cmFuc2xhdGUzZCgwLCIgKyBpICsgIiwwKSIgOiAidHJhbnNsYXRlM2QoIiArIGkgKyAiLDAsMCkiLCBuID0gdm9pZCAwICE9PSBuID8gbiAvIDFlMyArICJzIiA6ICIwcyIsIHIuY29udGFpbmVyLmNzcygiLSIgKyByLnBmeCArICItdHJhbnNpdGlvbi1kdXJhdGlvbiIsIG4pLCByLmNvbnRhaW5lci5jc3MoInRyYW5zaXRpb24tZHVyYXRpb24iLCBuKSk7IHIuYXJnc1tyLnByb3BdID0gaTsgKHIudHJhbnNpdGlvbnMgfHwgdm9pZCAwID09PSBuKSAmJiByLmNvbnRhaW5lci5jc3Moci5hcmdzKTsgci5jb250YWluZXIuY3NzKCJ0cmFuc2Zvcm0iLCBpKSB9OyByLnNldHVwID0gZnVuY3Rpb24gKHQpIHsgaWYgKGgpIHIuc2xpZGVzLmNzcyh7IHdpZHRoOiAiMTAwJSIsICJmbG9hdCI6ICJsZWZ0IiwgbWFyZ2luUmlnaHQ6ICItMTAwJSIsIHBvc2l0aW9uOiAicmVsYXRpdmUiIH0pLCAiaW5pdCIgPT09IHQgJiYgKG8gPyByLnNsaWRlcy5jc3MoeyBvcGFjaXR5OiAwLCBkaXNwbGF5OiAiYmxvY2siLCB3ZWJraXRUcmFuc2l0aW9uOiAib3BhY2l0eSAiICsgci52YXJzLmFuaW1hdGlvblNwZWVkIC8gMWUzICsgInMgZWFzZSIsIHpJbmRleDogMSB9KS5lcShyLmN1cnJlbnRTbGlkZSkuY3NzKHsgb3BhY2l0eTogMSwgekluZGV4OiAyIH0pIDogci5zbGlkZXMuY3NzKHsgb3BhY2l0eTogMCwgZGlzcGxheTogImJsb2NrIiwgekluZGV4OiAxIH0pLmVxKHIuY3VycmVudFNsaWRlKS5jc3MoeyB6SW5kZXg6IDIgfSkuYW5pbWF0ZSh7IG9wYWNpdHk6IDEgfSwgci52YXJzLmFuaW1hdGlvblNwZWVkLCByLnZhcnMuZWFzaW5nKSksIHIudmFycy5zbW9vdGhIZWlnaHQgJiYgdi5zbW9vdGhIZWlnaHQoKTsgZWxzZSB7IHZhciBuLCBzOyAiaW5pdCIgPT09IHQgJiYgKHIudmlld3BvcnQgPSBlKCc8ZGl2IGNsYXNzPSInICsgaSArICd2aWV3cG9ydCI+PC9kaXY+JykuY3NzKHsgb3ZlcmZsb3c6ICJoaWRkZW4iLCBwb3NpdGlvbjogInJlbGF0aXZlIiB9KS5hcHBlbmRUbyhyKS5hcHBlbmQoci5jb250YWluZXIpLCByLmNsb25lQ291bnQgPSAwLCByLmNsb25lT2Zmc2V0ID0gMCwgbCAmJiAocyA9IGUubWFrZUFycmF5KHIuc2xpZGVzKS5yZXZlcnNlKCksIHIuc2xpZGVzID0gZShzKSwgci5jb250YWluZXIuZW1wdHkoKS5hcHBlbmQoci5zbGlkZXMpKSk7IHIudmFycy5hbmltYXRpb25Mb29wICYmICFjICYmIChyLmNsb25lQ291bnQgPSAyLCByLmNsb25lT2Zmc2V0ID0gMSwgImluaXQiICE9PSB0ICYmIHIuY29udGFpbmVyLmZpbmQoIi5jbG9uZSIpLnJlbW92ZSgpLCB2LnVuaXF1ZUlEKHIuc2xpZGVzLmZpcnN0KCkuY2xvbmUoKS5hZGRDbGFzcygiY2xvbmUiKS5hdHRyKCJhcmlhLWhpZGRlbiIsICJ0cnVlIikpLmFwcGVuZFRvKHIuY29udGFpbmVyKSwgdi51bmlxdWVJRChyLnNsaWRlcy5sYXN0KCkuY2xvbmUoKS5hZGRDbGFzcygiY2xvbmUiKS5hdHRyKCJhcmlhLWhpZGRlbiIsICJ0cnVlIikpLnByZXBlbmRUbyhyLmNvbnRhaW5lcikpOyByLm5ld1NsaWRlcyA9IGUoci52YXJzLnNlbGVjdG9yLCByKTsgbiA9IGwgPyByLmNvdW50IC0gMSAtIHIuY3VycmVudFNsaWRlICsgci5jbG9uZU9mZnNldCA6IHIuY3VycmVudFNsaWRlICsgci5jbG9uZU9mZnNldDsgZiAmJiAhYyA/IChyLmNvbnRhaW5lci5oZWlnaHQoMjAwICogKHIuY291bnQgKyByLmNsb25lQ291bnQpICsgIiUiKS5jc3MoInBvc2l0aW9uIiwgImFic29sdXRlIikud2lkdGgoIjEwMCUiKSwgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7IHIubmV3U2xpZGVzLmNzcyh7IGRpc3BsYXk6ICJibG9jayIgfSk7IHIuZG9NYXRoKCk7IHIudmlld3BvcnQuaGVpZ2h0KHIuaCk7IHIuc2V0UHJvcHMobiAqIHIuaCwgImluaXQiKSB9LCAiaW5pdCIgPT09IHQgPyAxMDAgOiAwKSkgOiAoci5jb250YWluZXIud2lkdGgoMjAwICogKHIuY291bnQgKyByLmNsb25lQ291bnQpICsgIiUiKSwgci5zZXRQcm9wcyhuICogci5jb21wdXRlZFcsICJpbml0IiksIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgeyByLmRvTWF0aCgpOyByLm5ld1NsaWRlcy5jc3MoeyB3aWR0aDogci5jb21wdXRlZFcsICJmbG9hdCI6ICJsZWZ0IiwgZGlzcGxheTogImJsb2NrIiB9KTsgci52YXJzLnNtb290aEhlaWdodCAmJiB2LnNtb290aEhlaWdodCgpIH0sICJpbml0IiA9PT0gdCA/IDEwMCA6IDApKSB9IGMgfHwgci5zbGlkZXMucmVtb3ZlQ2xhc3MoaSArICJhY3RpdmUtc2xpZGUiKS5lcShyLmN1cnJlbnRTbGlkZSkuYWRkQ2xhc3MoaSArICJhY3RpdmUtc2xpZGUiKTsgci52YXJzLmluaXQocikgfTsgci5kb01hdGggPSBmdW5jdGlvbiAoKSB7IHZhciBlID0gci5zbGlkZXMuZmlyc3QoKSwgdCA9IHIudmFycy5pdGVtTWFyZ2luLCBuID0gci52YXJzLm1pbkl0ZW1zLCBpID0gci52YXJzLm1heEl0ZW1zOyByLncgPSB2b2lkIDAgPT09IHIudmlld3BvcnQgPyByLndpZHRoKCkgOiByLnZpZXdwb3J0LndpZHRoKCk7IHIuaCA9IGUuaGVpZ2h0KCk7IHIuYm94UGFkZGluZyA9IGUub3V0ZXJXaWR0aCgpIC0gZS53aWR0aCgpOyBjID8gKHIuaXRlbVQgPSByLnZhcnMuaXRlbVdpZHRoICsgdCwgci5taW5XID0gbiA/IG4gKiByLml0ZW1UIDogci53LCByLm1heFcgPSBpID8gaSAqIHIuaXRlbVQgLSB0IDogci53LCByLml0ZW1XID0gci5taW5XID4gci53ID8gKHIudyAtIHQgKiAobiAtIDEpKSAvIG4gOiByLm1heFcgPCByLncgPyAoci53IC0gdCAqIChpIC0gMSkpIC8gaSA6IHIudmFycy5pdGVtV2lkdGggPiByLncgPyByLncgOiByLnZhcnMuaXRlbVdpZHRoLCByLnZpc2libGUgPSBNYXRoLmZsb29yKHIudyAvIHIuaXRlbVcpLCByLm1vdmUgPSAwIDwgci52YXJzLm1vdmUgJiYgci52YXJzLm1vdmUgPCByLnZpc2libGUgPyByLnZhcnMubW92ZSA6IHIudmlzaWJsZSwgci5wYWdpbmdDb3VudCA9IE1hdGguY2VpbCgoci5jb3VudCAtIHIudmlzaWJsZSkgLyByLm1vdmUgKyAxKSwgci5sYXN0ID0gci5wYWdpbmdDb3VudCAtIDEsIHIubGltaXQgPSAxID09PSByLnBhZ2luZ0NvdW50ID8gMCA6IHIudmFycy5pdGVtV2lkdGggPiByLncgPyByLml0ZW1XICogKHIuY291bnQgLSAxKSArIHQgKiAoci5jb3VudCAtIDEpIDogKHIuaXRlbVcgKyB0KSAqIHIuY291bnQgLSByLncgLSB0KSA6IChyLml0ZW1XID0gci53LCByLnBhZ2luZ0NvdW50ID0gci5jb3VudCwgci5sYXN0ID0gci5jb3VudCAtIDEpOyByLmNvbXB1dGVkVyA9IHIuaXRlbVcgLSByLmJveFBhZGRpbmcgfTsgci51cGRhdGUgPSBmdW5jdGlvbiAoZSwgdCkgeyByLmRvTWF0aCgpOyBjIHx8IChlIDwgci5jdXJyZW50U2xpZGUgPyByLmN1cnJlbnRTbGlkZSArPSAxIDogZSA8PSByLmN1cnJlbnRTbGlkZSAmJiAwICE9PSBlICYmIChyLmN1cnJlbnRTbGlkZSAtPSAxKSwgci5hbmltYXRpbmdUbyA9IHIuY3VycmVudFNsaWRlKTsgaWYgKHIudmFycy5jb250cm9sTmF2ICYmICFyLm1hbnVhbENvbnRyb2xzKSBpZiAoImFkZCIgPT09IHQgJiYgIWMgfHwgci5wYWdpbmdDb3VudCA+IHIuY29udHJvbE5hdi5sZW5ndGgpIHYuY29udHJvbE5hdi51cGRhdGUoImFkZCIpOyBlbHNlIGlmICgicmVtb3ZlIiA9PT0gdCAmJiAhYyB8fCByLnBhZ2luZ0NvdW50IDwgci5jb250cm9sTmF2Lmxlbmd0aCkgYyAmJiByLmN1cnJlbnRTbGlkZSA+IHIubGFzdCAmJiAoci5jdXJyZW50U2xpZGUgLT0gMSwgci5hbmltYXRpbmdUbyAtPSAxKSwgdi5jb250cm9sTmF2LnVwZGF0ZSgicmVtb3ZlIiwgci5sYXN0KTsgci52YXJzLmRpcmVjdGlvbk5hdiAmJiB2LmRpcmVjdGlvbk5hdi51cGRhdGUoKSB9OyByLmFkZFNsaWRlID0gZnVuY3Rpb24gKHQsIG4pIHsgdmFyIGkgPSBlKHQpOyByLmNvdW50ICs9IDE7IHIubGFzdCA9IHIuY291bnQgLSAxOyBmICYmIGwgPyB2b2lkIDAgIT09IG4gPyByLnNsaWRlcy5lcShyLmNvdW50IC0gbikuYWZ0ZXIoaSkgOiByLmNvbnRhaW5lci5wcmVwZW5kKGkpIDogdm9pZCAwICE9PSBuID8gci5zbGlkZXMuZXEobikuYmVmb3JlKGkpIDogci5jb250YWluZXIuYXBwZW5kKGkpOyByLnVwZGF0ZShuLCAiYWRkIik7IHIuc2xpZGVzID0gZShyLnZhcnMuc2VsZWN0b3IgKyAiOm5vdCguY2xvbmUpIiwgcik7IHIuc2V0dXAoKTsgci52YXJzLmFkZGVkKHIpIH07IHIucmVtb3ZlU2xpZGUgPSBmdW5jdGlvbiAodCkgeyB2YXIgbiA9IGlzTmFOKHQpID8gci5zbGlkZXMuaW5kZXgoZSh0KSkgOiB0OyByLmNvdW50IC09IDE7IHIubGFzdCA9IHIuY291bnQgLSAxOyBpc05hTih0KSA/IGUodCwgci5zbGlkZXMpLnJlbW92ZSgpIDogZiAmJiBsID8gci5zbGlkZXMuZXEoci5sYXN0KS5yZW1vdmUoKSA6IHIuc2xpZGVzLmVxKHQpLnJlbW92ZSgpOyByLmRvTWF0aCgpOyByLnVwZGF0ZShuLCAicmVtb3ZlIik7IHIuc2xpZGVzID0gZShyLnZhcnMuc2VsZWN0b3IgKyAiOm5vdCguY2xvbmUpIiwgcik7IHIuc2V0dXAoKTsgci52YXJzLnJlbW92ZWQocikgfTsgdi5pbml0KCkgfTsgZSh3aW5kb3cpLmJsdXIoZnVuY3Rpb24gKGUpIHsgZm9jdXNlZCA9ICExIH0pLmZvY3VzKGZ1bmN0aW9uIChlKSB7IGZvY3VzZWQgPSAhMCB9KTsgZS5mbGV4c2xpZGVyLmRlZmF1bHRzID0geyBuYW1lc3BhY2U6ICJmbGV4LSIsIHNlbGVjdG9yOiAiLnNsaWRlcyA+IGxpIiwgYW5pbWF0aW9uOiAiZmFkZSIsIGVhc2luZzogInN3aW5nIiwgZGlyZWN0aW9uOiAiaG9yaXpvbnRhbCIsIHJldmVyc2U6ICExLCBhbmltYXRpb25Mb29wOiAhMCwgc21vb3RoSGVpZ2h0OiAhMSwgc3RhcnRBdDogMCwgc2xpZGVzaG93OiAhMCwgc2xpZGVzaG93U3BlZWQ6IDdlMywgYW5pbWF0aW9uU3BlZWQ6IDYwMCwgaW5pdERlbGF5OiAwLCByYW5kb21pemU6ICExLCB0aHVtYkNhcHRpb25zOiAhMSwgcGF1c2VPbkFjdGlvbjogITAsIHBhdXNlT25Ib3ZlcjogITEsIHBhdXNlSW52aXNpYmxlOiAhMCwgdXNlQ1NTOiAhMCwgdG91Y2g6ICEwLCB2aWRlbzogITEsIGNvbnRyb2xOYXY6ICEwLCBkaXJlY3Rpb25OYXY6ICEwLCBwcmV2VGV4dDogIlByZXZpb3VzIiwgbmV4dFRleHQ6ICJOZXh0Iiwga2V5Ym9hcmQ6ICEwLCBtdWx0aXBsZUtleWJvYXJkOiAhMSwgbW91c2V3aGVlbDogITEsIHBhdXNlUGxheTogITEsIHBhdXNlVGV4dDogIlBhdXNlIiwgcGxheVRleHQ6ICJQbGF5IiwgY29udHJvbHNDb250YWluZXI6ICIiLCBtYW51YWxDb250cm9sczogIiIsIHN5bmM6ICIiLCBhc05hdkZvcjogIiIsIGl0ZW1XaWR0aDogMCwgaXRlbU1hcmdpbjogMCwgbWluSXRlbXM6IDEsIG1heEl0ZW1zOiAwLCBtb3ZlOiAwLCBhbGxvd09uZVNsaWRlOiAhMCwgc3RhcnQ6IGZ1bmN0aW9uICgpIHsgfSwgYmVmb3JlOiBmdW5jdGlvbiAoKSB7IH0sIGFmdGVyOiBmdW5jdGlvbiAoKSB7IH0sIGVuZDogZnVuY3Rpb24gKCkgeyB9LCBhZGRlZDogZnVuY3Rpb24gKCkgeyB9LCByZW1vdmVkOiBmdW5jdGlvbiAoKSB7IH0sIGluaXQ6IGZ1bmN0aW9uICgpIHsgfSB9OyBlLmZuLmZsZXhzbGlkZXIgPSBmdW5jdGlvbiAodCkgeyB2b2lkIDAgPT09IHQgJiYgKHQgPSB7fSk7IGlmICgib2JqZWN0IiA9PT0gdHlwZW9mIHQpIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkgeyB2YXIgbiA9IGUodGhpcyksIHIgPSBuLmZpbmQodC5zZWxlY3RvciA/IHQuc2VsZWN0b3IgOiAiLnNsaWRlcyA+IGxpIik7IDEgPT09IHIubGVuZ3RoICYmICEwID09PSB0LmFsbG93T25lU2xpZGUgfHwgMCA9PT0gci5sZW5ndGggPyAoci5mYWRlSW4oNDAwKSwgdC5zdGFydCAmJiB0LnN0YXJ0KG4pKSA6IHZvaWQgMCA9PT0gbi5kYXRhKCJmbGV4c2xpZGVyIikgJiYgbmV3IGUuZmxleHNsaWRlcih0aGlzLCB0KSB9KTsgdmFyIG4gPSBlKHRoaXMpLmRhdGEoImZsZXhzbGlkZXIiKTsgc3dpdGNoICh0KSB7IGNhc2UgInBsYXkiOiBuLnBsYXkoKTsgYnJlYWs7IGNhc2UgInBhdXNlIjogbi5wYXVzZSgpOyBicmVhazsgY2FzZSAic3RvcCI6IG4uc3RvcCgpOyBicmVhazsgY2FzZSAibmV4dCI6IG4uZmxleEFuaW1hdGUobi5nZXRUYXJnZXQoIm5leHQiKSwgITApOyBicmVhazsgY2FzZSAicHJldiI6IGNhc2UgInByZXZpb3VzIjogbi5mbGV4QW5pbWF0ZShuLmdldFRhcmdldCgicHJldiIpLCAhMCk7IGJyZWFrOyBkZWZhdWx0OiAibnVtYmVyIiA9PT0gdHlwZW9mIHQgJiYgbi5mbGV4QW5pbWF0ZSh0LCAhMCkgfSB9IH0pKGpRdWVyeSk7DQovKg0KKiBKcXVlcnkgTGl2ZVNlYXJjaCBwbHVnaW4NCioNCiogT3JpZ2luYWwgQ3JlYXRlZCBieSBuYWthamltYSAtIGh0dHBzOi8vZ2l0aHViLmNvbS9uYWthamltYS9qcXVlcnktbGl2ZXNlYXJjaA0KKg0KKiBNb2RpZmllZCB0byBzdXBwb3J0IHNwZWNpYWwgY2hhcmFjdGVyIHNlYXJjaGVzIGJ5IERlYW4gVmlnb3JlbiAtIHZpZ29yZW5AdWFsYmVydGEuY2ENCioNCiovDQooZnVuY3Rpb24oYil7ZnVuY3Rpb24gZihhKXt0cnl7aWYodmFsPXRoaXMudmFsKCkpcmV0dXJuIGIoYSkuZmlsdGVyKGZ1bmN0aW9uKGEsZCl7cmV0dXJuISFiKGQpLnRleHQoKS5tYXRjaChSZWdFeHAodmFsLnJlcGxhY2UoL1tcLVxbXF1cL1x7XH1cKFwpXCpcK1w/XC5cXFxeXCRcfF0vZywiXFwkJiIpLCJnaSIpKX0pfWNhdGNoKGMpe2FsZXJ0KGMpfXJldHVybiExfWIuZXh0ZW5kKGIuZXhwclsiOiJdLHtjb250YWluc2k6ZnVuY3Rpb24oYSxjLGUpe3JldHVybiAwPD1iKGEpLnRleHQoKS50b0xvd2VyQ2FzZSgpLmluZGV4T2YoKGVbM118fCIiKS50b0xvd2VyQ2FzZSgpKX19KTt2YXIgYz1mdW5jdGlvbihhKXt0aGlzLmNhbGxiYWNrcz17fTthKHRoaXMpfTtjLnByb3RvdHlwZS5hbGw9ZnVuY3Rpb24oYSl7dGhpcy5jYWxsYmFja3MuYWxsPWF9O2MucHJvdG90eXBlLnJlc2V0PWZ1bmN0aW9uKGEpe3RoaXMuY2FsbGJhY2tzLnJlc2V0PWF9O2MucHJvdG90eXBlLmVtcHR5PWZ1bmN0aW9uKGEpe3RoaXMuY2FsbGJhY2tzLmVtcHR5PWF9O2MucHJvdG90eXBlLnJlc3VsdHM9ZnVuY3Rpb24oYSl7dGhpcy5jYWxsYmFja3MucmVzdWx0cz1hfTtiLmZuLnNlYXJjaD1mdW5jdGlvbihhLGcpe2Z1bmN0aW9uIGUoKXtpZihyZXN1bHQ9Zi5jYWxsKGIodGhpcyksYSkpe2QuYWxsJiZkLmFsbC5jYWxsKHRoaXMscmVzdWx0KTt2YXIgYz0wPHJlc3VsdC5zaXplKCk/InJlc3VsdHMiOiJlbXB0eSI7cmV0dXJuIGRbY10mJmRbY10uY2FsbCh0aGlzLHJlc3VsdCl9ZC5hbGwmJmQuYWxsLmNhbGwodGhpcyxiKGEpKTtyZXR1cm4gZC5yZXNldCYmZC5yZXNldC5jYWxsKHRoaXMpfXZhciBkPShuZXcgYyhnKSkuY2FsbGJhY2tzO2IodGhpcykubGl2ZSgia2V5cHJlc3MiLGUpO2IodGhpcykubGl2ZSgia2V5ZG93biIsZSk7Yih0aGlzKS5saXZlKCJrZXl1cCIsZSk7Yih0aGlzKS5iaW5kKCJibHVyIixlKX19KShqUXVlcnkpOzsNCi8vIGpxdWVyeS50d2VldC5qcyAtIFNlZSBodHRwOi8vdHdlZXQuc2Vhb2ZjbG91ZHMuY29tLyBvciBodHRwczovL2dpdGh1Yi5jb20vc2Vhb2ZjbG91ZHMvdHdlZXQgZm9yIG1vcmUgaW5mbw0KLy8gQ29weXJpZ2h0IChjKSAyMDA4LTIwMTIgVG9kZCBNYXR0aGV3cyAmIFN0ZXZlIFB1cmNlbGwNCihmdW5jdGlvbiAoZmFjdG9yeSkgew0KICBpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKQ0KICAgIGRlZmluZShbJ2pxdWVyeSddLCBmYWN0b3J5KTsgLy8gQU1EIHN1cHBvcnQgZm9yIFJlcXVpcmVKUyBldGMuDQogIGVsc2UNCiAgICBmYWN0b3J5KGpRdWVyeSk7DQp9KGZ1bmN0aW9uICgkKSB7DQogICQuZm4udHdlZXQgPSBmdW5jdGlvbihvKXsNCiAgICB2YXIgcyA9ICQuZXh0ZW5kKHsNCiAgICAgIHVzZXJuYW1lOiBudWxsLCAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFtzdHJpbmcgb3IgYXJyYXldIHJlcXVpcmVkIHVubGVzcyB1c2luZyB0aGUgJ3F1ZXJ5JyBvcHRpb247IG9uZSBvciBtb3JlIHR3aXR0ZXIgc2NyZWVuIG5hbWVzICh1c2UgJ2xpc3QnIG9wdGlvbiBmb3IgbXVsdGlwbGUgbmFtZXMsIHdoZXJlIHBvc3NpYmxlKQ0KICAgICAgbGlzdDogbnVsbCwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gW3N0cmluZ10gICBvcHRpb25hbCBuYW1lIG9mIGxpc3QgYmVsb25naW5nIHRvIHVzZXJuYW1lDQogICAgICBmYXZvcml0ZXM6IGZhbHNlLCAgICAgICAgICAgICAgICAgICAgICAgICAvLyBbYm9vbGVhbl0gIGRpc3BsYXkgdGhlIHVzZXIncyBmYXZvcml0ZXMgaW5zdGVhZCBvZiBoaXMgdHdlZXRzDQogICAgICBxdWVyeTogbnVsbCwgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBbc3RyaW5nXSAgIG9wdGlvbmFsIHNlYXJjaCBxdWVyeSAoc2VlIGFsc286IGh0dHA6Ly9zZWFyY2gudHdpdHRlci5jb20vb3BlcmF0b3JzKQ0KICAgICAgYXZhdGFyX3NpemU6IG51bGwsICAgICAgICAgICAgICAgICAgICAgICAgLy8gW2ludGVnZXJdICBoZWlnaHQgYW5kIHdpZHRoIG9mIGF2YXRhciBpZiBkaXNwbGF5ZWQgKDQ4cHggbWF4KQ0KICAgICAgY291bnQ6IDMsICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gW2ludGVnZXJdICBob3cgbWFueSB0d2VldHMgdG8gZGlzcGxheT8NCiAgICAgIGZldGNoOiBudWxsLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIFtpbnRlZ2VyXSAgaG93IG1hbnkgdHdlZXRzIHRvIGZldGNoIHZpYSB0aGUgQVBJIChzZXQgdGhpcyBoaWdoZXIgdGhhbiAnY291bnQnIGlmIHVzaW5nIHRoZSAnZmlsdGVyJyBvcHRpb24pDQogICAgICBwYWdlOiAxLCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBbaW50ZWdlcl0gIHdoaWNoIHBhZ2Ugb2YgcmVzdWx0cyB0byBmZXRjaCAoaWYgY291bnQgIT0gZmV0Y2gsIHlvdSdsbCBnZXQgdW5leHBlY3RlZCByZXN1bHRzKQ0KICAgICAgcmV0d2VldHM6IHRydWUsICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gW2Jvb2xlYW5dICB3aGV0aGVyIHRvIGZldGNoIChvZmZpY2lhbCkgcmV0d2VldHMgKG5vdCBzdXBwb3J0ZWQgaW4gYWxsIGRpc3BsYXkgbW9kZXMpDQogICAgICBpbnRyb190ZXh0OiBudWxsLCAgICAgICAgICAgICAgICAgICAgICAgICAvLyBbc3RyaW5nXSAgIGRvIHlvdSB3YW50IHRleHQgQkVGT1JFIHlvdXIgeW91ciB0d2VldHM/DQogICAgICBvdXRyb190ZXh0OiBudWxsLCAgICAgICAgICAgICAgICAgICAgICAgICAvLyBbc3RyaW5nXSAgIGRvIHlvdSB3YW50IHRleHQgQUZURVIgeW91ciB0d2VldHM/DQogICAgICBqb2luX3RleHQ6ICBudWxsLCAgICAgICAgICAgICAgICAgICAgICAgICAvLyBbc3RyaW5nXSAgIG9wdGlvbmFsIHRleHQgaW4gYmV0d2VlbiBkYXRlIGFuZCB0d2VldCwgdHJ5IHNldHRpbmcgdG8gImF1dG8iDQogICAgICBhdXRvX2pvaW5fdGV4dF9kZWZhdWx0OiAiIEkgc2FpZCwgIiwgICAgICAvLyBbc3RyaW5nXSAgIGF1dG8gdGV4dCBmb3Igbm9uIHZlcmI6ICJJIHNhaWQiIGJ1bGxvY2tzDQogICAgICBhdXRvX2pvaW5fdGV4dF9lZDogIiBJICIsICAgICAgICAgICAgICAgICAvLyBbc3RyaW5nXSAgIGF1dG8gdGV4dCBmb3IgcGFzdCB0ZW5zZTogIkkiIHN1cmZlZA0KICAgICAgYXV0b19qb2luX3RleHRfaW5nOiAiIEkgYW0gIiwgICAgICAgICAgICAgLy8gW3N0cmluZ10gICBhdXRvIHRlbnNlIGZvciBwcmVzZW50IHRlbnNlOiAiSSB3YXMiIHN1cmZpbmcNCiAgICAgIGF1dG9fam9pbl90ZXh0X3JlcGx5OiAiIEkgcmVwbGllZCB0byAiLCAgIC8vIFtzdHJpbmddICAgYXV0byB0ZW5zZSBmb3IgcmVwbGllczogIkkgcmVwbGllZCB0byIgQHNvbWVvbmUgIndpdGgiDQogICAgICBhdXRvX2pvaW5fdGV4dF91cmw6ICIgSSB3YXMgbG9va2luZyBhdCAiLCAvLyBbc3RyaW5nXSAgIGF1dG8gdGVuc2UgZm9yIHVybHM6ICJJIHdhcyBsb29raW5nIGF0IiBodHRwOi4uLg0KICAgICAgbG9hZGluZ190ZXh0OiBudWxsLCAgICAgICAgICAgICAgICAgICAgICAgLy8gW3N0cmluZ10gICBvcHRpb25hbCBsb2FkaW5nIHRleHQsIGRpc3BsYXllZCB3aGlsZSB0d2VldHMgbG9hZA0KICAgICAgcmVmcmVzaF9pbnRlcnZhbDogbnVsbCwgICAgICAgICAgICAgICAgICAgLy8gW2ludGVnZXJdICBvcHRpb25hbCBudW1iZXIgb2Ygc2Vjb25kcyBhZnRlciB3aGljaCB0byByZWxvYWQgdHdlZXRzDQogICAgICB0d2l0dGVyX3VybDogInR3aXR0ZXIuY29tIiwgICAgICAgICAgICAgICAvLyBbc3RyaW5nXSAgIGN1c3RvbSB0d2l0dGVyIHVybCwgaWYgYW55IChhcGlnZWUsIGV0Yy4pDQogICAgICB0d2l0dGVyX2FwaV91cmw6ICJhcGkudHdpdHRlci5jb20iLCAgICAgICAvLyBbc3RyaW5nXSAgIGN1c3RvbSB0d2l0dGVyIGFwaSB1cmwsIGlmIGFueSAoYXBpZ2VlLCBldGMuKQ0KICAgICAgdHdpdHRlcl9zZWFyY2hfdXJsOiAic2VhcmNoLnR3aXR0ZXIuY29tIiwgLy8gW3N0cmluZ10gICBjdXN0b20gdHdpdHRlciBzZWFyY2ggdXJsLCBpZiBhbnkgKGFwaWdlZSwgZXRjLikNCiAgICAgIHRlbXBsYXRlOiAie2F2YXRhcn17dGltZX17am9pbn0ge3RleHR9IiwgIC8vIFtzdHJpbmcgb3IgZnVuY3Rpb25dIHRlbXBsYXRlIHVzZWQgdG8gY29uc3RydWN0IGVhY2ggdHdlZXQgPGxpPiAtIHNlZSBjb2RlIGZvciBhdmFpbGFibGUgdmFycw0KICAgICAgY29tcGFyYXRvcjogZnVuY3Rpb24odHdlZXQxLCB0d2VldDIpIHsgICAgLy8gW2Z1bmN0aW9uXSBjb21wYXJhdG9yIHVzZWQgdG8gc29ydCB0d2VldHMgKHNlZSBBcnJheS5zb3J0KQ0KICAgICAgICByZXR1cm4gdHdlZXQyWyJ0d2VldF90aW1lIl0gLSB0d2VldDFbInR3ZWV0X3RpbWUiXTsNCiAgICAgIH0sDQogICAgICBmaWx0ZXI6IGZ1bmN0aW9uKHR3ZWV0KSB7ICAgICAgICAgICAgICAgICAvLyBbZnVuY3Rpb25dIHdoZXRoZXIgb3Igbm90IHRvIGluY2x1ZGUgYSBwYXJ0aWN1bGFyIHR3ZWV0IChiZSBzdXJlIHRvIGFsc28gc2V0ICdmZXRjaCcpDQogICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgfQ0KICAgICAgLy8gWW91IGNhbiBhdHRhY2ggY2FsbGJhY2tzIHRvIHRoZSBmb2xsb3dpbmcgZXZlbnRzIHVzaW5nIGpRdWVyeSdzIHN0YW5kYXJkIC5iaW5kKCkgbWVjaGFuaXNtOg0KICAgICAgLy8gICAibG9hZGVkIiAtLSB0cmlnZ2VyZWQgd2hlbiB0d2VldHMgaGF2ZSBiZWVuIGZldGNoZWQgYW5kIHJlbmRlcmVkDQogICAgfSwgbyk7DQoNCiAgICAvLyBTZWUgaHR0cDovL2RhcmluZ2ZpcmViYWxsLm5ldC8yMDEwLzA3L2ltcHJvdmVkX3JlZ2V4X2Zvcl9tYXRjaGluZ191cmxzDQogICAgdmFyIHVybF9yZWdleHAgPSAvXGIoKD86aHR0cHM/OlwvXC98d3d3XGR7MCwzfVsuXXxbYS16MC05LlwtXStbLl1bYS16XXsyLDR9XC8pKD86W15ccygpPD5dK3xcKChbXlxzKCk8Pl0rfChcKFteXHMoKTw+XStcKSkpKlwpKSsoPzpcKChbXlxzKCk8Pl0rfChcKFteXHMoKTw+XStcKSkpKlwpfFteXHNgISgpXFtcXXt9OzonIi4sPD4/wqvCu+KAnOKAneKAmOKAmV0pKS9naTsNCg0KICAgIC8vIEV4cGFuZCB2YWx1ZXMgaW5zaWRlIHNpbXBsZSBzdHJpbmcgdGVtcGxhdGVzIHdpdGgge3BsYWNlaG9sZGVyc30NCiAgICBmdW5jdGlvbiB0KHRlbXBsYXRlLCBpbmZvKSB7DQogICAgICBpZiAodHlwZW9mIHRlbXBsYXRlID09PSAic3RyaW5nIikgew0KICAgICAgICB2YXIgcmVzdWx0ID0gdGVtcGxhdGU7DQogICAgICAgIGZvcih2YXIga2V5IGluIGluZm8pIHsNCiAgICAgICAgICB2YXIgdmFsID0gaW5mb1trZXldOw0KICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdC5zcGxpdCgneycra2V5Kyd9Jykuam9pbih2YWwgPT09IG51bGwgPyAnJyA6IHZhbCk7DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIHJlc3VsdDsNCiAgICAgIH0gZWxzZSByZXR1cm4gdGVtcGxhdGUoaW5mbyk7DQogICAgfQ0KICAgIC8vIEV4cG9ydCB0aGUgdCBmdW5jdGlvbiBmb3IgdXNlIHdoZW4gcGFzc2luZyBhIGZ1bmN0aW9uIGFzIHRoZSAndGVtcGxhdGUnIG9wdGlvbg0KICAgICQuZXh0ZW5kKHt0d2VldDoge3Q6IHR9fSk7DQoNCiAgICBmdW5jdGlvbiByZXBsYWNlciAocmVnZXgsIHJlcGxhY2VtZW50KSB7DQogICAgICByZXR1cm4gZnVuY3Rpb24oKSB7DQogICAgICAgIHZhciByZXR1cm5pbmcgPSBbXTsNCiAgICAgICAgdGhpcy5lYWNoKGZ1bmN0aW9uKCkgew0KICAgICAgICAgIHJldHVybmluZy5wdXNoKHRoaXMucmVwbGFjZShyZWdleCwgcmVwbGFjZW1lbnQpKTsNCiAgICAgICAgfSk7DQogICAgICAgIHJldHVybiAkKHJldHVybmluZyk7DQogICAgICB9Ow0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGVzY2FwZUhUTUwocykgew0KICAgICAgcmV0dXJuIHMucmVwbGFjZSgvPC9nLCImbHQ7IikucmVwbGFjZSgvPi9nLCJeJmd0OyIpOw0KICAgIH0NCg0KICAgICQuZm4uZXh0ZW5kKHsNCiAgICAgIGxpbmtVc2VyOiByZXBsYWNlcigvKF58W1xXXSlAKFx3KykvZ2ksICIkMTxzcGFuIGNsYXNzPVwiYXRcIj5APC9zcGFuPjxhIGhyZWY9XCJodHRwOi8vIitzLnR3aXR0ZXJfdXJsKyIvJDJcIj4kMjwvYT4iKSwNCiAgICAgIC8vIFN1cHBvcnQgdmFyaW91cyBsYXRpbjEgKFx1MDAqKikgYW5kIGFyYWJpYyAoXHUwNioqKSBhbHBoYW51bWVyaWMgY2hhcnMNCiAgICAgIGxpbmtIYXNoOiByZXBsYWNlcigvKD86XnwgKVtcI10rKFtcd1x1MDBjMC1cdTAwZDZcdTAwZDgtXHUwMGY2XHUwMGY4LVx1MDBmZlx1MDYwMC1cdTA2ZmZdKykvZ2ksDQogICAgICAgICAgICAgICAgICAgICAgICAgJyA8YSBocmVmPSJodHRwOi8vJytzLnR3aXR0ZXJfc2VhcmNoX3VybCsnL3NlYXJjaD9xPSZ0YWc9JDEmbGFuZz1hbGwnKw0KICAgICAgICAgICAgICAgICAgICAgICAgICgocy51c2VybmFtZSAmJiBzLnVzZXJuYW1lLmxlbmd0aCA9PSAxICYmICFzLmxpc3QpID8gJyZmcm9tPScrcy51c2VybmFtZS5qb2luKCIlMkJPUiUyQiIpIDogJycpKw0KICAgICAgICAgICAgICAgICAgICAgICAgICciIGNsYXNzPSJ0d2VldF9oYXNodGFnIj4jJDE8L2E+JyksDQogICAgICBtYWtlSGVhcnQ6IHJlcGxhY2VyKC8oJmx0OykrWzNdL2dpLCAiPHR0IGNsYXNzPSdoZWFydCc+JiN4MjY2NTs8L3R0PiIpDQogICAgfSk7DQoNCiAgICBmdW5jdGlvbiBsaW5rVVJMcyh0ZXh0LCBlbnRpdGllcykgew0KICAgICAgcmV0dXJuIHRleHQucmVwbGFjZSh1cmxfcmVnZXhwLCBmdW5jdGlvbihtYXRjaCkgew0KICAgICAgICB2YXIgdXJsID0gKC9eW2Etel0rOi9pKS50ZXN0KG1hdGNoKSA/IG1hdGNoIDogImh0dHA6Ly8iK21hdGNoOw0KICAgICAgICB2YXIgdGV4dCA9IG1hdGNoOw0KICAgICAgICBmb3IodmFyIGkgPSAwOyBpIDwgZW50aXRpZXMubGVuZ3RoOyArK2kpIHsNCiAgICAgICAgICB2YXIgZW50aXR5ID0gZW50aXRpZXNbaV07DQogICAgICAgICAgaWYgKGVudGl0eS51cmwgPT0gdXJsICYmIGVudGl0eS5leHBhbmRlZF91cmwpIHsNCiAgICAgICAgICAgIHVybCA9IGVudGl0eS5leHBhbmRlZF91cmw7DQogICAgICAgICAgICB0ZXh0ID0gZW50aXR5LmRpc3BsYXlfdXJsOw0KICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgfQ0KICAgICAgICB9DQogICAgICAgIHJldHVybiAiPGEgaHJlZj1cIiIrZXNjYXBlSFRNTCh1cmwpKyJcIj4iK2VzY2FwZUhUTUwodGV4dCkrIjwvYT4iOw0KICAgICAgfSk7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gcGFyc2VfZGF0ZShkYXRlX3N0cikgew0KICAgICAgLy8gVGhlIG5vbi1zZWFyY2ggdHdpdHRlciBBUElzIHJldHVybiBpbmNvbnNpc3RlbnRseS1mb3JtYXR0ZWQgZGF0ZXMsIHdoaWNoIERhdGUucGFyc2UNCiAgICAgIC8vIGNhbm5vdCBoYW5kbGUgaW4gSUUuIFdlIHRoZXJlZm9yZSBwZXJmb3JtIHRoZSBmb2xsb3dpbmcgdHJhbnNmb3JtYXRpb246DQogICAgICAvLyAiV2VkIEFwciAyOSAwODo1MzozMSArMDAwMCAyMDA5IiA9PiAiV2VkLCBBcHIgMjkgMjAwOSAwODo1MzozMSArMDAwMCINCiAgICAgIHJldHVybiBEYXRlLnBhcnNlKGRhdGVfc3RyLnJlcGxhY2UoL14oW2Etel17M30pKCBbYS16XXszfSBcZFxkPykoLiopKCBcZHs0fSkkL2ksICckMSwkMiQ0JDMnKSk7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gZXh0cmFjdF9yZWxhdGl2ZV90aW1lKGRhdGUpIHsNCiAgICAgIHZhciB0b0ludCA9IGZ1bmN0aW9uKHZhbCkgeyByZXR1cm4gcGFyc2VJbnQodmFsLCAxMCk7IH07DQogICAgICB2YXIgcmVsYXRpdmVfdG8gPSBuZXcgRGF0ZSgpOw0KICAgICAgdmFyIGRlbHRhID0gdG9JbnQoKHJlbGF0aXZlX3RvLmdldFRpbWUoKSAtIGRhdGUpIC8gMTAwMCk7DQogICAgICBpZiAoZGVsdGEgPCAxKSBkZWx0YSA9IDA7DQogICAgICByZXR1cm4gew0KICAgICAgICBkYXlzOiAgICB0b0ludChkZWx0YSAvIDg2NDAwKSwNCiAgICAgICAgaG91cnM6ICAgdG9JbnQoZGVsdGEgLyAzNjAwKSwNCiAgICAgICAgbWludXRlczogdG9JbnQoZGVsdGEgLyA2MCksDQogICAgICAgIHNlY29uZHM6IHRvSW50KGRlbHRhKQ0KICAgICAgfTsNCiAgICB9DQoNCiAgICBmdW5jdGlvbiBmb3JtYXRfcmVsYXRpdmVfdGltZSh0aW1lX2Fnbykgew0KICAgICAgaWYgKCB0aW1lX2Fnby5kYXlzID4gMiApICAgICByZXR1cm4gJ2Fib3V0ICcgKyB0aW1lX2Fnby5kYXlzICsgJyBkYXlzIGFnbyc7DQogICAgICBpZiAoIHRpbWVfYWdvLmhvdXJzID4gMjQgKSAgIHJldHVybiAnYWJvdXQgYSBkYXkgYWdvJzsNCiAgICAgIGlmICggdGltZV9hZ28uaG91cnMgPiAyICkgICAgcmV0dXJuICdhYm91dCAnICsgdGltZV9hZ28uaG91cnMgKyAnIGhvdXJzIGFnbyc7DQogICAgICBpZiAoIHRpbWVfYWdvLm1pbnV0ZXMgPiA0NSApIHJldHVybiAnYWJvdXQgYW4gaG91ciBhZ28nOw0KICAgICAgaWYgKCB0aW1lX2Fnby5taW51dGVzID4gMiApICByZXR1cm4gJ2Fib3V0ICcgKyB0aW1lX2Fnby5taW51dGVzICsgJyBtaW51dGVzIGFnbyc7DQogICAgICBpZiAoIHRpbWVfYWdvLnNlY29uZHMgPiAxICkgIHJldHVybiAnYWJvdXQgJyArIHRpbWVfYWdvLnNlY29uZHMgKyAnIHNlY29uZHMgYWdvJzsNCiAgICAgIHJldHVybiAnanVzdCBub3cnOw0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGJ1aWxkX2F1dG9fam9pbl90ZXh0KHRleHQpIHsNCiAgICAgIGlmICh0ZXh0Lm1hdGNoKC9eKEAoW0EtWmEtejAtOS1fXSspKSAuKi9pKSkgew0KICAgICAgICByZXR1cm4gcy5hdXRvX2pvaW5fdGV4dF9yZXBseTsNCiAgICAgIH0gZWxzZSBpZiAodGV4dC5tYXRjaCh1cmxfcmVnZXhwKSkgew0KICAgICAgICByZXR1cm4gcy5hdXRvX2pvaW5fdGV4dF91cmw7DQogICAgICB9IGVsc2UgaWYgKHRleHQubWF0Y2goL14oKFx3K2VkKXxqdXN0KSAuKi9pbSkpIHsNCiAgICAgICAgcmV0dXJuIHMuYXV0b19qb2luX3RleHRfZWQ7DQogICAgICB9IGVsc2UgaWYgKHRleHQubWF0Y2goL14oXHcqaW5nKSAuKi9pKSkgew0KICAgICAgICByZXR1cm4gcy5hdXRvX2pvaW5fdGV4dF9pbmc7DQogICAgICB9IGVsc2Ugew0KICAgICAgICByZXR1cm4gcy5hdXRvX2pvaW5fdGV4dF9kZWZhdWx0Ow0KICAgICAgfQ0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGJ1aWxkX2FwaV91cmwoKSB7DQogICAgICB2YXIgcHJvdG8gPSAoJ2h0dHBzOicgPT0gZG9jdW1lbnQubG9jYXRpb24ucHJvdG9jb2wgPyAnaHR0cHM6JyA6ICdodHRwOicpOw0KICAgICAgdmFyIGNvdW50ID0gKHMuZmV0Y2ggPT09IG51bGwpID8gcy5jb3VudCA6IHMuZmV0Y2g7DQogICAgICB2YXIgY29tbW9uX3BhcmFtcyA9ICcmY2FsbGJhY2s9Pyc7DQogICAgICBpZiAocy5saXN0KSB7DQogICAgICAgIHJldHVybiBwcm90bysiLy8iK3MudHdpdHRlcl9hcGlfdXJsKyIvMS8iK3MudXNlcm5hbWVbMF0rIi9saXN0cy8iK3MubGlzdCsiL3N0YXR1c2VzLmpzb24/cGFnZT0iK3MucGFnZSsiJnBlcl9wYWdlPSIrY291bnQrY29tbW9uX3BhcmFtczsNCiAgICAgIH0gZWxzZSBpZiAocy5mYXZvcml0ZXMpIHsNCiAgICAgICAgcmV0dXJuIHByb3RvKyIvLyIrcy50d2l0dGVyX2FwaV91cmwrIi8xL2Zhdm9yaXRlcy5qc29uP3NjcmVlbl9uYW1lPSIrcy51c2VybmFtZVswXSsiJnBhZ2U9IitzLnBhZ2UrIiZjb3VudD0iK2NvdW50K2NvbW1vbl9wYXJhbXM7DQogICAgICB9IGVsc2UgaWYgKHMucXVlcnkgPT09IG51bGwgJiYgcy51c2VybmFtZS5sZW5ndGggPT0gMSkgew0KICAgICAgICByZXR1cm4gcHJvdG8rJy8vJytzLnR3aXR0ZXJfYXBpX3VybCsnLzEvc3RhdHVzZXMvdXNlcl90aW1lbGluZS5qc29uP3NjcmVlbl9uYW1lPScrcy51c2VybmFtZVswXSsnJmNvdW50PScrY291bnQrKHMucmV0d2VldHMgPyAnJmluY2x1ZGVfcnRzPTEnIDogJycpKycmcGFnZT0nK3MucGFnZStjb21tb25fcGFyYW1zOw0KICAgICAgfSBlbHNlIHsNCiAgICAgICAgdmFyIHF1ZXJ5ID0gKHMucXVlcnkgfHwgJ2Zyb206JytzLnVzZXJuYW1lLmpvaW4oJyBPUiBmcm9tOicpKTsNCiAgICAgICAgcmV0dXJuIHByb3RvKycvLycrcy50d2l0dGVyX3NlYXJjaF91cmwrJy9zZWFyY2guanNvbj8mcT0nK2VuY29kZVVSSUNvbXBvbmVudChxdWVyeSkrJyZycHA9Jytjb3VudCsnJnBhZ2U9JytzLnBhZ2UrY29tbW9uX3BhcmFtczsNCiAgICAgIH0NCiAgICB9DQoNCiAgICBmdW5jdGlvbiBleHRyYWN0X2F2YXRhcl91cmwoaXRlbSwgc2VjdXJlKSB7DQogICAgICBpZiAoc2VjdXJlKSB7DQogICAgICAgIHJldHVybiAoJ3VzZXInIGluIGl0ZW0pID8NCiAgICAgICAgICBpdGVtLnVzZXIucHJvZmlsZV9pbWFnZV91cmxfaHR0cHMgOg0KICAgICAgICAgIGV4dHJhY3RfYXZhdGFyX3VybChpdGVtLCBmYWxzZSkuDQogICAgICAgICAgICByZXBsYWNlKC9eaHR0cDpcL1wvW2EtejAtOV17MSwzfVwudHdpbWdcLmNvbVwvLywgImh0dHBzOi8vczMuYW1hem9uYXdzLmNvbS90d2l0dGVyX3Byb2R1Y3Rpb24vIik7DQogICAgICB9IGVsc2Ugew0KICAgICAgICByZXR1cm4gaXRlbS5wcm9maWxlX2ltYWdlX3VybCB8fCBpdGVtLnVzZXIucHJvZmlsZV9pbWFnZV91cmw7DQogICAgICB9DQogICAgfQ0KDQogICAgLy8gQ29udmVydCB0d2l0dGVyIEFQSSBvYmplY3RzIGludG8gZGF0YSBhdmFpbGFibGUgZm9yDQogICAgLy8gY29uc3RydWN0aW5nIGVhY2ggdHdlZXQgPGxpPiB1c2luZyBhIHRlbXBsYXRlDQogICAgZnVuY3Rpb24gZXh0cmFjdF90ZW1wbGF0ZV9kYXRhKGl0ZW0pew0KICAgICAgdmFyIG8gPSB7fTsNCiAgICAgIG8uaXRlbSA9IGl0ZW07DQogICAgICBvLnNvdXJjZSA9IGl0ZW0uc291cmNlOw0KICAgICAgby5zY3JlZW5fbmFtZSA9IGl0ZW0uZnJvbV91c2VyIHx8IGl0ZW0udXNlci5zY3JlZW5fbmFtZTsNCiAgICAgIC8vIFRoZSBhY3R1YWwgdXNlciBuYW1lIGlzIG5vdCByZXR1cm5lZCBieSBhbGwgVHdpdHRlciBBUElzLCBzbyBwbGVhc2UgZG8gbm90DQogICAgICAvLyBmaWxlIGFuIGlzc3VlIGlmIGl0IGlzIGVtcHR5Og0KICAgICAgby5uYW1lID0gaXRlbS5mcm9tX3VzZXJfbmFtZSB8fCBpdGVtLnVzZXIubmFtZTsNCiAgICAgIG8ucmV0d2VldCA9IHR5cGVvZihpdGVtLnJldHdlZXRlZF9zdGF0dXMpICE9ICd1bmRlZmluZWQnOw0KDQogICAgICBvLnR3ZWV0X3RpbWUgPSBwYXJzZV9kYXRlKGl0ZW0uY3JlYXRlZF9hdCk7DQogICAgICBvLmpvaW5fdGV4dCA9IHMuam9pbl90ZXh0ID09ICJhdXRvIiA/IGJ1aWxkX2F1dG9fam9pbl90ZXh0KGl0ZW0udGV4dCkgOiBzLmpvaW5fdGV4dDsNCiAgICAgIG8udHdlZXRfaWQgPSBpdGVtLmlkX3N0cjsNCiAgICAgIG8udHdpdHRlcl9iYXNlID0gImh0dHA6Ly8iK3MudHdpdHRlcl91cmwrIi8iOw0KICAgICAgby51c2VyX3VybCA9IG8udHdpdHRlcl9iYXNlK28uc2NyZWVuX25hbWU7DQogICAgICBvLnR3ZWV0X3VybCA9IG8udXNlcl91cmwrIi9zdGF0dXMvIitvLnR3ZWV0X2lkOw0KICAgICAgby5yZXBseV91cmwgPSBvLnR3aXR0ZXJfYmFzZSsiaW50ZW50L3R3ZWV0P2luX3JlcGx5X3RvPSIrby50d2VldF9pZDsNCiAgICAgIG8ucmV0d2VldF91cmwgPSBvLnR3aXR0ZXJfYmFzZSsiaW50ZW50L3JldHdlZXQ/dHdlZXRfaWQ9IitvLnR3ZWV0X2lkOw0KICAgICAgby5mYXZvcml0ZV91cmwgPSBvLnR3aXR0ZXJfYmFzZSsiaW50ZW50L2Zhdm9yaXRlP3R3ZWV0X2lkPSIrby50d2VldF9pZDsNCiAgICAgIG8ucmV0d2VldGVkX3NjcmVlbl9uYW1lID0gby5yZXR3ZWV0ICYmIGl0ZW0ucmV0d2VldGVkX3N0YXR1cy51c2VyLnNjcmVlbl9uYW1lOw0KICAgICAgby50d2VldF9yZWxhdGl2ZV90aW1lID0gZm9ybWF0X3JlbGF0aXZlX3RpbWUoZXh0cmFjdF9yZWxhdGl2ZV90aW1lKG8udHdlZXRfdGltZSkpOw0KICAgICAgby5lbnRpdGllcyA9IGl0ZW0uZW50aXRpZXMgPyAoaXRlbS5lbnRpdGllcy51cmxzIHx8IFtdKS5jb25jYXQoaXRlbS5lbnRpdGllcy5tZWRpYSB8fCBbXSkgOiBbXTsNCiAgICAgIG8udHdlZXRfcmF3X3RleHQgPSBvLnJldHdlZXQgPyAoJ1JUIEAnK28ucmV0d2VldGVkX3NjcmVlbl9uYW1lKycgJytpdGVtLnJldHdlZXRlZF9zdGF0dXMudGV4dCkgOiBpdGVtLnRleHQ7IC8vIGF2b2lkICcuLi4nIGluIGxvbmcgcmV0d2VldHMNCiAgICAgIG8udHdlZXRfdGV4dCA9ICQoW2xpbmtVUkxzKG8udHdlZXRfcmF3X3RleHQsIG8uZW50aXRpZXMpXSkubGlua1VzZXIoKS5saW5rSGFzaCgpWzBdOw0KICAgICAgby5yZXR3ZWV0ZWRfdHdlZXRfdGV4dCA9ICQoW2xpbmtVUkxzKGl0ZW0udGV4dCwgby5lbnRpdGllcyldKS5saW5rVXNlcigpLmxpbmtIYXNoKClbMF07DQogICAgICBvLnR3ZWV0X3RleHRfZmFuY3kgPSAkKFtvLnR3ZWV0X3RleHRdKS5tYWtlSGVhcnQoKVswXTsNCg0KICAgICAgby5hdmF0YXJfc2l6ZSA9IHMuYXZhdGFyX3NpemU7DQogICAgICBvLmF2YXRhcl91cmwgPSBleHRyYWN0X2F2YXRhcl91cmwoby5yZXR3ZWV0ID8gaXRlbS5yZXR3ZWV0ZWRfc3RhdHVzIDogaXRlbSwgKGRvY3VtZW50LmxvY2F0aW9uLnByb3RvY29sID09PSAnaHR0cHM6JykpOw0KICAgICAgby5hdmF0YXJfc2NyZWVuX25hbWUgPSBvLnJldHdlZXQgPyBvLnJldHdlZXRlZF9zY3JlZW5fbmFtZSA6IG8uc2NyZWVuX25hbWU7DQogICAgICBvLmF2YXRhcl9wcm9maWxlX3VybCA9IG8udHdpdHRlcl9iYXNlK28uYXZhdGFyX3NjcmVlbl9uYW1lOw0KDQogICAgICAvLyBEZWZhdWx0IHNwYW5zLCBhbmQgcHJlLWZvcm1hdHRlZCBibG9ja3MgZm9yIGNvbW1vbiBsYXlvdXRzDQogICAgICBvLnVzZXIgPSB0KCc8YSBjbGFzcz0idHdlZXRfdXNlciIgaHJlZj0ie3VzZXJfdXJsfSI+e3NjcmVlbl9uYW1lfTwvYT4nLCBvKTsNCiAgICAgIG8uam9pbiA9IHMuam9pbl90ZXh0ID8gdCgnPHNwYW4gY2xhc3M9InR3ZWV0X2pvaW4iPntqb2luX3RleHR9PC9zcGFuPicsIG8pIDogJyc7DQogICAgICBvLmF2YXRhciA9IG8uYXZhdGFyX3NpemUgPw0KICAgICAgICB0KCc8YSBjbGFzcz0idHdlZXRfYXZhdGFyIiBocmVmPSJ7YXZhdGFyX3Byb2ZpbGVfdXJsfSI+PGltZyBzcmM9InthdmF0YXJfdXJsfSIgaGVpZ2h0PSJ7YXZhdGFyX3NpemV9IiB3aWR0aD0ie2F2YXRhcl9zaXplfSIgYWx0PSJ7YXZhdGFyX3NjcmVlbl9uYW1lfVwncyBhdmF0YXIiIHRpdGxlPSJ7YXZhdGFyX3NjcmVlbl9uYW1lfVwncyBhdmF0YXIiIGJvcmRlcj0iMCIvPjwvYT4nLCBvKSA6ICcnOw0KICAgICAgby50aW1lID0gdCgnPHNwYW4gY2xhc3M9InR3ZWV0X3RpbWUiPjxhIGhyZWY9Int0d2VldF91cmx9IiB0aXRsZT0idmlldyB0d2VldCBvbiB0d2l0dGVyIj57dHdlZXRfcmVsYXRpdmVfdGltZX08L2E+PC9zcGFuPicsIG8pOw0KICAgICAgby50ZXh0ID0gdCgnPHNwYW4gY2xhc3M9InR3ZWV0X3RleHQiPnt0d2VldF90ZXh0X2ZhbmN5fTwvc3Bhbj4nLCBvKTsNCiAgICAgIG8ucmV0d2VldGVkX3RleHQgPSB0KCc8c3BhbiBjbGFzcz0idHdlZXRfdGV4dCI+e3JldHdlZXRlZF90d2VldF90ZXh0fTwvc3Bhbj4nLCBvKTsNCiAgICAgIG8ucmVwbHlfYWN0aW9uID0gdCgnPGEgY2xhc3M9InR3ZWV0X2FjdGlvbiB0d2VldF9yZXBseSIgaHJlZj0ie3JlcGx5X3VybH0iPnJlcGx5PC9hPicsIG8pOw0KICAgICAgby5yZXR3ZWV0X2FjdGlvbiA9IHQoJzxhIGNsYXNzPSJ0d2VldF9hY3Rpb24gdHdlZXRfcmV0d2VldCIgaHJlZj0ie3JldHdlZXRfdXJsfSI+cmV0d2VldDwvYT4nLCBvKTsNCiAgICAgIG8uZmF2b3JpdGVfYWN0aW9uID0gdCgnPGEgY2xhc3M9InR3ZWV0X2FjdGlvbiB0d2VldF9mYXZvcml0ZSIgaHJlZj0ie2Zhdm9yaXRlX3VybH0iPmZhdm9yaXRlPC9hPicsIG8pOw0KICAgICAgcmV0dXJuIG87DQogICAgfQ0KDQogICAgZnVuY3Rpb24gcmVuZGVyX3R3ZWV0cyh3aWRnZXQsIHR3ZWV0cykgew0KICAgICAgdmFyIGxpc3QgPSAkKCc8dWwgY2xhc3M9InR3ZWV0X2xpc3QiPicpOw0KICAgICAgbGlzdC5hcHBlbmQoJC5tYXAodHdlZXRzLCBmdW5jdGlvbihvKSB7IHJldHVybiAiPGxpPiIgKyB0KHMudGVtcGxhdGUsIG8pICsgIjwvbGk+IjsgfSkuam9pbignJykpLg0KICAgICAgICBjaGlsZHJlbignbGk6Zmlyc3QnKS5hZGRDbGFzcygndHdlZXRfZmlyc3QnKS5lbmQoKS4NCiAgICAgICAgY2hpbGRyZW4oJ2xpOm9kZCcpLmFkZENsYXNzKCd0d2VldF9ldmVuJykuZW5kKCkuDQogICAgICAgIGNoaWxkcmVuKCdsaTpldmVuJykuYWRkQ2xhc3MoJ3R3ZWV0X29kZCcpOw0KDQogICAgICAkKHdpZGdldCkuZW1wdHkoKS5hcHBlbmQobGlzdCk7DQogICAgICBpZiAocy5pbnRyb190ZXh0KSBsaXN0LmJlZm9yZSgnPHAgY2xhc3M9InR3ZWV0X2ludHJvIj4nK3MuaW50cm9fdGV4dCsnPC9wPicpOw0KICAgICAgaWYgKHMub3V0cm9fdGV4dCkgbGlzdC5hZnRlcignPHAgY2xhc3M9InR3ZWV0X291dHJvIj4nK3Mub3V0cm9fdGV4dCsnPC9wPicpOw0KDQogICAgICAkKHdpZGdldCkudHJpZ2dlcigibG9hZGVkIikudHJpZ2dlcigodHdlZXRzLmxlbmd0aCA9PT0gMCA/ICJlbXB0eSIgOiAiZnVsbCIpKTsNCiAgICAgIGlmIChzLnJlZnJlc2hfaW50ZXJ2YWwpIHsNCiAgICAgICAgd2luZG93LnNldFRpbWVvdXQoZnVuY3Rpb24oKSB7ICQod2lkZ2V0KS50cmlnZ2VyKCJ0d2VldDpsb2FkIik7IH0sIDEwMDAgKiBzLnJlZnJlc2hfaW50ZXJ2YWwpOw0KICAgICAgfQ0KICAgIH0NCg0KICAgIGZ1bmN0aW9uIGxvYWQod2lkZ2V0KSB7DQogICAgICB2YXIgbG9hZGluZyA9ICQoJzxwIGNsYXNzPSJsb2FkaW5nIj4nK3MubG9hZGluZ190ZXh0Kyc8L3A+Jyk7DQogICAgICBpZiAocy5sb2FkaW5nX3RleHQpICQod2lkZ2V0KS5ub3QoIjpoYXMoLnR3ZWV0X2xpc3QpIikuZW1wdHkoKS5hcHBlbmQobG9hZGluZyk7DQogICAgICAkLmdldEpTT04oYnVpbGRfYXBpX3VybCgpLCBmdW5jdGlvbihkYXRhKXsNCiAgICAgICAgdmFyIHR3ZWV0cyA9ICQubWFwKGRhdGEucmVzdWx0cyB8fCBkYXRhLCBleHRyYWN0X3RlbXBsYXRlX2RhdGEpOw0KICAgICAgICB0d2VldHMgPSAkLmdyZXAodHdlZXRzLCBzLmZpbHRlcikuc29ydChzLmNvbXBhcmF0b3IpLnNsaWNlKDAsIHMuY291bnQpOw0KICAgICAgICAkKHdpZGdldCkudHJpZ2dlcigidHdlZXQ6cmV0cmlldmVkIiwgW3R3ZWV0c10pOw0KICAgICAgfSk7DQogICAgfQ0KDQogICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbihpLCB3aWRnZXQpew0KICAgICAgaWYocy51c2VybmFtZSAmJiB0eXBlb2Yocy51c2VybmFtZSkgPT0gInN0cmluZyIpew0KICAgICAgICBzLnVzZXJuYW1lID0gW3MudXNlcm5hbWVdOw0KICAgICAgfQ0KDQogICAgICAkKHdpZGdldCkudW5iaW5kKCJ0d2VldDpyZW5kZXIiKS51bmJpbmQoInR3ZWV0OnJldHJpZXZlZCIpLnVuYmluZCgidHdlZXQ6bG9hZCIpLg0KICAgICAgICBiaW5kKHsNCiAgICAgICAgICAidHdlZXQ6bG9hZCI6IGZ1bmN0aW9uKCkgeyBsb2FkKHdpZGdldCk7IH0sDQogICAgICAgICAgInR3ZWV0OnJldHJpZXZlZCI6IGZ1bmN0aW9uKGV2LCB0d2VldHMpIHsNCiAgICAgICAgICAgICQod2lkZ2V0KS50cmlnZ2VyKCJ0d2VldDpyZW5kZXIiLCBbdHdlZXRzXSkNCiAgICAgICAgICB9LA0KICAgICAgICAgICJ0d2VldDpyZW5kZXIiOiBmdW5jdGlvbihldiwgdHdlZXRzKSB7DQogICAgICAgICAgICByZW5kZXJfdHdlZXRzKCQod2lkZ2V0KSwgdHdlZXRzKTsNCiAgICAgICAgICB9DQogICAgICAgIH0pLnRyaWdnZXIoInR3ZWV0OmxvYWQiKTsNCiAgICB9KTsNCiAgfTsNCn0pKTsNCjsNCi8vVHdpdHRlcnMgZ2VuZXJhdGVkIEphdmFzY3JpcHQgZm9yIGFsbCBvZiB0aGVpciB3aWRnZXRzIChUd2VldCBidXR0b24sIGZvbGxvdyBidXR0b24pDQohZnVuY3Rpb24gKGQsIHMsIGlkKSB7IHZhciBqcywgZmpzID0gZC5nZXRFbGVtZW50c0J5VGFnTmFtZShzKVswXTsgaWYgKCFkLmdldEVsZW1lbnRCeUlkKGlkKSkgeyBqcyA9IGQuY3JlYXRlRWxlbWVudChzKTsganMuaWQgPSBpZDsganMuc3JjID0gIi8vcGxhdGZvcm0udHdpdHRlci5jb20vd2lkZ2V0cy5qcyI7IGZqcy5wYXJlbnROb2RlLmluc2VydEJlZm9yZShqcywgZmpzKTsgfSB9IChkb2N1bWVudCwgInNjcmlwdCIsICJ0d2l0dGVyLXdqcyIpOzsNCi8qDQogKiBqUXVlcnktZGF0ZUZvcm1hdA0KICogaHR0cDovL2dpdGh1Yi5jb20vcGhzdGMvanF1ZXJ5LWRhdGVGb3JtYXQNCiAqLw0KDQooZnVuY3Rpb24gKGEpIHsgdmFyIGIgPSBbIlN1bmRheSIsICJNb25kYXkiLCAiVHVlc2RheSIsICJXZWRuZXNkYXkiLCAiVGh1cnNkYXkiLCAiRnJpZGF5IiwgIlNhdHVyZGF5Il07IHZhciBjID0gWyJKYW4iLCAiRmViIiwgIk1hciIsICJBcHIiLCAiTWF5IiwgIkp1biIsICJKdWwiLCAiQXVnIiwgIlNlcCIsICJPY3QiLCAiTm92IiwgIkRlYyJdOyB2YXIgZCA9IFsiSmFudWFyeSIsICJGZWJydWFyeSIsICJNYXJjaCIsICJBcHJpbCIsICJNYXkiLCAiSnVuZSIsICJKdWx5IiwgIkF1Z3VzdCIsICJTZXB0ZW1iZXIiLCAiT2N0b2JlciIsICJOb3ZlbWJlciIsICJEZWNlbWJlciJdOyB2YXIgZSA9IFtdOyBlWyJKYW4iXSA9ICIwMSI7IGVbIkZlYiJdID0gIjAyIjsgZVsiTWFyIl0gPSAiMDMiOyBlWyJBcHIiXSA9ICIwNCI7IGVbIk1heSJdID0gIjA1IjsgZVsiSnVuIl0gPSAiMDYiOyBlWyJKdWwiXSA9ICIwNyI7IGVbIkF1ZyJdID0gIjA4IjsgZVsiU2VwIl0gPSAiMDkiOyBlWyJPY3QiXSA9ICIxMCI7IGVbIk5vdiJdID0gIjExIjsgZVsiRGVjIl0gPSAiMTIiOyBhLmZvcm1hdCA9IGZ1bmN0aW9uICgpIHsgZnVuY3Rpb24gYShhKSB7IHJldHVybiBiW3BhcnNlSW50KGEsIDEwKV0gfHwgYSB9IGZ1bmN0aW9uIGYoYSkgeyB2YXIgYiA9IHBhcnNlSW50KGEsIDEwKSAtIDE7IHJldHVybiBjW2JdIHx8IGEgfSBmdW5jdGlvbiBnKGEpIHsgdmFyIGIgPSBwYXJzZUludChhLCAxMCkgLSAxOyByZXR1cm4gZFtiXSB8fCBhIH0gdmFyIGggPSBmdW5jdGlvbiAoYSkgeyByZXR1cm4gZVthXSB8fCBhIH07IHZhciBpID0gZnVuY3Rpb24gKGEpIHsgdmFyIGIgPSBhOyB2YXIgYyA9ICIiOyBpZiAoYi5pbmRleE9mKCIuIikgIT09IC0xKSB7IHZhciBkID0gYi5zcGxpdCgiLiIpOyBiID0gZFswXTsgYyA9IGRbMV0gfSB2YXIgZSA9IGIuc3BsaXQoIjoiKTsgaWYgKGUubGVuZ3RoID09PSAzKSB7IGhvdXIgPSBlWzBdOyBtaW51dGUgPSBlWzFdOyBzZWNvbmQgPSBlWzJdOyByZXR1cm4geyB0aW1lOiBiLCBob3VyOiBob3VyLCBtaW51dGU6IG1pbnV0ZSwgc2Vjb25kOiBzZWNvbmQsIG1pbGxpczogY30gfSBlbHNlIHsgcmV0dXJuIHsgdGltZTogIiIsIGhvdXI6ICIiLCBtaW51dGU6ICIiLCBzZWNvbmQ6ICIiLCBtaWxsaXM6ICIifSB9IH07IHJldHVybiB7IGRhdGU6IGZ1bmN0aW9uIChiLCBjKSB7IHRyeSB7IHZhciBkID0gbnVsbDsgdmFyIGUgPSBudWxsOyB2YXIgaiA9IG51bGw7IHZhciBrID0gbnVsbDsgdmFyIGwgPSBudWxsOyB2YXIgbSA9IG51bGw7IGlmICh0eXBlb2YgYiA9PSAibnVtYmVyIikgeyByZXR1cm4gdGhpcy5kYXRlKG5ldyBEYXRlKGIpLCBjKSB9IGVsc2UgaWYgKHR5cGVvZiBiLmdldEZ1bGxZZWFyID09ICJmdW5jdGlvbiIpIHsgZSA9IGIuZ2V0RnVsbFllYXIoKTsgaiA9IGIuZ2V0TW9udGgoKSArIDE7IGsgPSBiLmdldERhdGUoKTsgbCA9IGIuZ2V0RGF5KCk7IG0gPSBpKGIudG9UaW1lU3RyaW5nKCkpIH0gZWxzZSBpZiAoYi5zZWFyY2goL1xkezR9LVxkezJ9LVxkezJ9VFxkezJ9OlxkezJ9OlxkezJ9XC4/XGR7MCwzfVstK10/XGR7Mn06P1xkezJ9LykgIT0gLTEpIHsgdmFyIG4gPSBiLnNwbGl0KC9bVFwrLV0vKTsgZSA9IG5bMF07IGogPSBuWzFdOyBrID0gblsyXTsgbSA9IGkoblszXS5zcGxpdCgiLiIpWzBdKTsgZCA9IG5ldyBEYXRlKGUsIGogLSAxLCBrKTsgbCA9IGQuZ2V0RGF5KCkgfSBlbHNlIHsgdmFyIG4gPSBiLnNwbGl0KCIgIik7IHN3aXRjaCAobi5sZW5ndGgpIHsgY2FzZSA2OiBlID0gbls1XTsgaiA9IGgoblsxXSk7IGsgPSBuWzJdOyBtID0gaShuWzNdKTsgZCA9IG5ldyBEYXRlKGUsIGogLSAxLCBrKTsgbCA9IGQuZ2V0RGF5KCk7IGJyZWFrOyBjYXNlIDI6IHZhciBvID0gblswXS5zcGxpdCgiLSIpOyBlID0gb1swXTsgaiA9IG9bMV07IGsgPSBvWzJdOyBtID0gaShuWzFdKTsgZCA9IG5ldyBEYXRlKGUsIGogLSAxLCBrKTsgbCA9IGQuZ2V0RGF5KCk7IGJyZWFrOyBjYXNlIDc6IGNhc2UgOTogY2FzZSAxMDogZSA9IG5bM107IGogPSBoKG5bMV0pOyBrID0gblsyXTsgbSA9IGkobls0XSk7IGQgPSBuZXcgRGF0ZShlLCBqIC0gMSwgayk7IGwgPSBkLmdldERheSgpOyBicmVhazsgY2FzZSAxOiB2YXIgbyA9IG5bMF0uc3BsaXQoIiIpOyBlID0gb1swXSArIG9bMV0gKyBvWzJdICsgb1szXTsgaiA9IG9bNV0gKyBvWzZdOyBrID0gb1s4XSArIG9bOV07IG0gPSBpKG9bMTNdICsgb1sxNF0gKyBvWzE1XSArIG9bMTZdICsgb1sxN10gKyBvWzE4XSArIG9bMTldICsgb1syMF0pOyBkID0gbmV3IERhdGUoZSwgaiAtIDEsIGspOyBsID0gZC5nZXREYXkoKTsgYnJlYWs7IGRlZmF1bHQ6IHJldHVybiBiIH0gfSB2YXIgcCA9ICIiOyB2YXIgcSA9ICIiOyB2YXIgciA9ICIiOyBmb3IgKHZhciBzID0gMDsgcyA8IGMubGVuZ3RoOyBzKyspIHsgdmFyIHQgPSBjLmNoYXJBdChzKTsgcCArPSB0OyByID0gIiI7IHN3aXRjaCAocCkgeyBjYXNlICJkZGQiOiBxICs9IGEobCk7IHAgPSAiIjsgYnJlYWs7IGNhc2UgImRkIjogaWYgKGMuY2hhckF0KHMgKyAxKSA9PSAiZCIpIHsgYnJlYWsgfSBpZiAoU3RyaW5nKGspLmxlbmd0aCA9PT0gMSkgeyBrID0gIjAiICsgayB9IHEgKz0gazsgcCA9ICIiOyBicmVhazsgY2FzZSAiZCI6IGlmIChjLmNoYXJBdChzICsgMSkgPT0gImQiKSB7IGJyZWFrIH0gcSArPSBwYXJzZUludChrLCAxMCk7IHAgPSAiIjsgYnJlYWs7IGNhc2UgIk1NTU0iOiBxICs9IGcoaik7IHAgPSAiIjsgYnJlYWs7IGNhc2UgIk1NTSI6IGlmIChjLmNoYXJBdChzICsgMSkgPT09ICJNIikgeyBicmVhayB9IHEgKz0gZihqKTsgcCA9ICIiOyBicmVhazsgY2FzZSAiTU0iOiBpZiAoYy5jaGFyQXQocyArIDEpID09ICJNIikgeyBicmVhayB9IGlmIChTdHJpbmcoaikubGVuZ3RoID09PSAxKSB7IGogPSAiMCIgKyBqIH0gcSArPSBqOyBwID0gIiI7IGJyZWFrOyBjYXNlICJNIjogaWYgKGMuY2hhckF0KHMgKyAxKSA9PSAiTSIpIHsgYnJlYWsgfSBxICs9IHBhcnNlSW50KGosIDEwKTsgcCA9ICIiOyBicmVhazsgY2FzZSAieXl5eSI6IHEgKz0gZTsgcCA9ICIiOyBicmVhazsgY2FzZSAieXkiOiBpZiAoYy5jaGFyQXQocyArIDEpID09ICJ5IiAmJiBjLmNoYXJBdChzICsgMikgPT0gInkiKSB7IGJyZWFrIH0gcSArPSBTdHJpbmcoZSkuc2xpY2UoLTIpOyBwID0gIiI7IGJyZWFrOyBjYXNlICJISCI6IHEgKz0gbS5ob3VyOyBwID0gIiI7IGJyZWFrOyBjYXNlICJoaCI6IHZhciB1ID0gbS5ob3VyID09IDAgPyAxMiA6IG0uaG91ciA8IDEzID8gbS5ob3VyIDogbS5ob3VyIC0gMTI7IHUgPSBTdHJpbmcodSkubGVuZ3RoID09IDEgPyAiMCIgKyB1IDogdTsgcSArPSB1OyBwID0gIiI7IGJyZWFrOyBjYXNlICJoIjogaWYgKGMuY2hhckF0KHMgKyAxKSA9PSAiaCIpIHsgYnJlYWsgfSB2YXIgdSA9IG0uaG91ciA9PSAwID8gMTIgOiBtLmhvdXIgPCAxMyA/IG0uaG91ciA6IG0uaG91ciAtIDEyOyBxICs9IHBhcnNlSW50KHUsIDEwKTsgcCA9ICIiOyBicmVhazsgY2FzZSAibW0iOiBxICs9IG0ubWludXRlOyBwID0gIiI7IGJyZWFrOyBjYXNlICJzcyI6IHEgKz0gbS5zZWNvbmQuc3Vic3RyaW5nKDAsIDIpOyBwID0gIiI7IGJyZWFrOyBjYXNlICJTU1MiOiBxICs9IG0ubWlsbGlzLnN1YnN0cmluZygwLCAzKTsgcCA9ICIiOyBicmVhazsgY2FzZSAiYSI6IHEgKz0gbS5ob3VyID49IDEyID8gIlBNIiA6ICJBTSI7IHAgPSAiIjsgYnJlYWs7IGNhc2UgIiAiOiBxICs9IHQ7IHAgPSAiIjsgYnJlYWs7IGNhc2UgIi8iOiBxICs9IHQ7IHAgPSAiIjsgYnJlYWs7IGNhc2UgIjoiOiBxICs9IHQ7IHAgPSAiIjsgYnJlYWs7IGRlZmF1bHQ6IGlmIChwLmxlbmd0aCA9PT0gMiAmJiBwLmluZGV4T2YoInkiKSAhPT0gMCAmJiBwICE9ICJTUyIpIHsgcSArPSBwLnN1YnN0cmluZygwLCAxKTsgcCA9IHAuc3Vic3RyaW5nKDEsIDIpIH0gZWxzZSBpZiAocC5sZW5ndGggPT09IDMgJiYgcC5pbmRleE9mKCJ5eXkiKSA9PT0gLTEpIHsgcCA9ICIiIH0gZWxzZSB7IHIgPSBwIH0gfSB9IHEgKz0gcjsgcmV0dXJuIHEgfSBjYXRjaCAodikgeyBjb25zb2xlLmxvZyh2KTsgcmV0dXJuIGIgfSB9IH0gfSAoKSB9KShqUXVlcnkpOyBqUXVlcnkuZm9ybWF0LmRhdGUuZGVmYXVsdFNob3J0RGF0ZUZvcm1hdCA9ICJkZC9NTS95eXl5IjsgalF1ZXJ5LmZvcm1hdC5kYXRlLmRlZmF1bHRMb25nRGF0ZUZvcm1hdCA9ICJkZC9NTS95eXl5IGhoOm1tOnNzIjsgalF1ZXJ5KGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7IGpRdWVyeSgiLnNob3J0RGF0ZUZvcm1hdCIpLmVhY2goZnVuY3Rpb24gKGEsIGIpIHsgaWYgKGpRdWVyeShiKS5pcygiOmlucHV0IikpIHsgalF1ZXJ5KGIpLnZhbChqUXVlcnkuZm9ybWF0LmRhdGUoalF1ZXJ5KGIpLnZhbCgpLCBqUXVlcnkuZm9ybWF0LmRhdGUuZGVmYXVsdFNob3J0RGF0ZUZvcm1hdCkpIH0gZWxzZSB7IGpRdWVyeShiKS50ZXh0KGpRdWVyeS5mb3JtYXQuZGF0ZShqUXVlcnkoYikudGV4dCgpLCBqUXVlcnkuZm9ybWF0LmRhdGUuZGVmYXVsdFNob3J0RGF0ZUZvcm1hdCkpIH0gfSk7IGpRdWVyeSgiLmxvbmdEYXRlRm9ybWF0IikuZWFjaChmdW5jdGlvbiAoYSwgYikgeyBpZiAoalF1ZXJ5KGIpLmlzKCI6aW5wdXQiKSkgeyBqUXVlcnkoYikudmFsKGpRdWVyeS5mb3JtYXQuZGF0ZShqUXVlcnkoYikudmFsKCksIGpRdWVyeS5mb3JtYXQuZGF0ZS5kZWZhdWx0TG9uZ0RhdGVGb3JtYXQpKSB9IGVsc2UgeyBqUXVlcnkoYikudGV4dChqUXVlcnkuZm9ybWF0LmRhdGUoalF1ZXJ5KGIpLnRleHQoKSwgalF1ZXJ5LmZvcm1hdC5kYXRlLmRlZmF1bHRMb25nRGF0ZUZvcm1hdCkpIH0gfSkgfSkNCjsNCi8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NCiAqIGJvb3RzdHJhcC1jb2xsYXBzZS5qcyB2Mi4xLjENCiAqIGh0dHA6Ly90d2l0dGVyLmdpdGh1Yi5jb20vYm9vdHN0cmFwL2phdmFzY3JpcHQuaHRtbCNjb2xsYXBzZQ0KICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQ0KICogQ29weXJpZ2h0IDIwMTIgVHdpdHRlciwgSW5jLg0KICoNCiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOw0KICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLg0KICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0DQogKg0KICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wDQogKg0KICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQ0KICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywNCiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLg0KICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZA0KICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuDQogKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi8NCg0KDQohZnVuY3Rpb24gKCQpIHsNCg0KICAidXNlIHN0cmljdCI7IC8vIGpzaGludCA7XzsNCg0KDQogLyogQ09MTEFQU0UgUFVCTElDIENMQVNTIERFRklOSVRJT04NCiAgKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqLw0KDQogIHZhciBDb2xsYXBzZSA9IGZ1bmN0aW9uIChlbGVtZW50LCBvcHRpb25zKSB7DQogICAgdGhpcy4kZWxlbWVudCA9ICQoZWxlbWVudCkNCiAgICB0aGlzLm9wdGlvbnMgPSAkLmV4dGVuZCh7fSwgJC5mbi5jb2xsYXBzZS5kZWZhdWx0cywgb3B0aW9ucykNCg0KICAgIGlmICh0aGlzLm9wdGlvbnMucGFyZW50KSB7DQogICAgICB0aGlzLiRwYXJlbnQgPSAkKHRoaXMub3B0aW9ucy5wYXJlbnQpDQogICAgfQ0KDQogICAgdGhpcy5vcHRpb25zLnRvZ2dsZSAmJiB0aGlzLnRvZ2dsZSgpDQogIH0NCg0KICBDb2xsYXBzZS5wcm90b3R5cGUgPSB7DQoNCiAgICBjb25zdHJ1Y3RvcjogQ29sbGFwc2UNCg0KICAsIGRpbWVuc2lvbjogZnVuY3Rpb24gKCkgew0KICAgICAgdmFyIGhhc1dpZHRoID0gdGhpcy4kZWxlbWVudC5oYXNDbGFzcygnd2lkdGgnKQ0KICAgICAgcmV0dXJuIGhhc1dpZHRoID8gJ3dpZHRoJyA6ICdoZWlnaHQnDQogICAgfQ0KDQogICwgc2hvdzogZnVuY3Rpb24gKCkgew0KICAgICAgdmFyIGRpbWVuc2lvbg0KICAgICAgICAsIHNjcm9sbA0KICAgICAgICAsIGFjdGl2ZXMNCiAgICAgICAgLCBoYXNEYXRhDQoNCiAgICAgIGlmICh0aGlzLnRyYW5zaXRpb25pbmcpIHJldHVybg0KDQogICAgICBkaW1lbnNpb24gPSB0aGlzLmRpbWVuc2lvbigpDQogICAgICBzY3JvbGwgPSAkLmNhbWVsQ2FzZShbJ3Njcm9sbCcsIGRpbWVuc2lvbl0uam9pbignLScpKQ0KICAgICAgYWN0aXZlcyA9IHRoaXMuJHBhcmVudCAmJiB0aGlzLiRwYXJlbnQuZmluZCgnPiAuYWNjb3JkaW9uLWdyb3VwID4gLmluJykNCg0KICAgICAgaWYgKGFjdGl2ZXMgJiYgYWN0aXZlcy5sZW5ndGgpIHsNCiAgICAgICAgaGFzRGF0YSA9IGFjdGl2ZXMuZGF0YSgnY29sbGFwc2UnKQ0KICAgICAgICBpZiAoaGFzRGF0YSAmJiBoYXNEYXRhLnRyYW5zaXRpb25pbmcpIHJldHVybg0KICAgICAgICBhY3RpdmVzLmNvbGxhcHNlKCdoaWRlJykNCiAgICAgICAgaGFzRGF0YSB8fCBhY3RpdmVzLmRhdGEoJ2NvbGxhcHNlJywgbnVsbCkNCiAgICAgIH0NCg0KICAgICAgdGhpcy4kZWxlbWVudFtkaW1lbnNpb25dKDApDQogICAgICB0aGlzLnRyYW5zaXRpb24oJ2FkZENsYXNzJywgJC5FdmVudCgnc2hvdycpLCAnc2hvd24nKQ0KICAgICAgJC5zdXBwb3J0LnRyYW5zaXRpb24gJiYgdGhpcy4kZWxlbWVudFtkaW1lbnNpb25dKHRoaXMuJGVsZW1lbnRbMF1bc2Nyb2xsXSkNCiAgICB9DQoNCiAgLCBoaWRlOiBmdW5jdGlvbiAoKSB7DQogICAgICB2YXIgZGltZW5zaW9uDQogICAgICBpZiAodGhpcy50cmFuc2l0aW9uaW5nKSByZXR1cm4NCiAgICAgIGRpbWVuc2lvbiA9IHRoaXMuZGltZW5zaW9uKCkNCiAgICAgIHRoaXMucmVzZXQodGhpcy4kZWxlbWVudFtkaW1lbnNpb25dKCkpDQogICAgICB0aGlzLnRyYW5zaXRpb24oJ3JlbW92ZUNsYXNzJywgJC5FdmVudCgnaGlkZScpLCAnaGlkZGVuJykNCiAgICAgIHRoaXMuJGVsZW1lbnRbZGltZW5zaW9uXSgwKQ0KICAgIH0NCg0KICAsIHJlc2V0OiBmdW5jdGlvbiAoc2l6ZSkgew0KICAgICAgdmFyIGRpbWVuc2lvbiA9IHRoaXMuZGltZW5zaW9uKCkNCg0KICAgICAgdGhpcy4kZWxlbWVudA0KICAgICAgICAucmVtb3ZlQ2xhc3MoJ2NvbGxhcHNlJykNCiAgICAgICAgW2RpbWVuc2lvbl0oc2l6ZSB8fCAnYXV0bycpDQogICAgICAgIFswXS5vZmZzZXRXaWR0aA0KDQogICAgICB0aGlzLiRlbGVtZW50W3NpemUgIT09IG51bGwgPyAnYWRkQ2xhc3MnIDogJ3JlbW92ZUNsYXNzJ10oJ2NvbGxhcHNlJykNCg0KICAgICAgcmV0dXJuIHRoaXMNCiAgICB9DQoNCiAgLCB0cmFuc2l0aW9uOiBmdW5jdGlvbiAobWV0aG9kLCBzdGFydEV2ZW50LCBjb21wbGV0ZUV2ZW50KSB7DQogICAgICB2YXIgdGhhdCA9IHRoaXMNCiAgICAgICAgLCBjb21wbGV0ZSA9IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIGlmIChzdGFydEV2ZW50LnR5cGUgPT0gJ3Nob3cnKSB0aGF0LnJlc2V0KCkNCiAgICAgICAgICAgIHRoYXQudHJhbnNpdGlvbmluZyA9IDANCiAgICAgICAgICAgIHRoYXQuJGVsZW1lbnQudHJpZ2dlcihjb21wbGV0ZUV2ZW50KQ0KICAgICAgICAgIH0NCg0KICAgICAgdGhpcy4kZWxlbWVudC50cmlnZ2VyKHN0YXJ0RXZlbnQpDQoNCiAgICAgIGlmIChzdGFydEV2ZW50LmlzRGVmYXVsdFByZXZlbnRlZCgpKSByZXR1cm4NCg0KICAgICAgdGhpcy50cmFuc2l0aW9uaW5nID0gMQ0KDQogICAgICB0aGlzLiRlbGVtZW50W21ldGhvZF0oJ2luJykNCg0KICAgICAgJC5zdXBwb3J0LnRyYW5zaXRpb24gJiYgdGhpcy4kZWxlbWVudC5oYXNDbGFzcygnY29sbGFwc2UnKSA/DQogICAgICAgIHRoaXMuJGVsZW1lbnQub25lKCQuc3VwcG9ydC50cmFuc2l0aW9uLmVuZCwgY29tcGxldGUpIDoNCiAgICAgICAgY29tcGxldGUoKQ0KICAgIH0NCg0KICAsIHRvZ2dsZTogZnVuY3Rpb24gKCkgew0KICAgICAgdGhpc1t0aGlzLiRlbGVtZW50Lmhhc0NsYXNzKCdpbicpID8gJ2hpZGUnIDogJ3Nob3cnXSgpDQogICAgfQ0KDQogIH0NCg0KDQogLyogQ09MTEFQU0lCTEUgUExVR0lOIERFRklOSVRJT04NCiAgKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi8NCg0KICAkLmZuLmNvbGxhcHNlID0gZnVuY3Rpb24gKG9wdGlvbikgew0KICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkgew0KICAgICAgdmFyICR0aGlzID0gJCh0aGlzKQ0KICAgICAgICAsIGRhdGEgPSAkdGhpcy5kYXRhKCdjb2xsYXBzZScpDQogICAgICAgICwgb3B0aW9ucyA9IHR5cGVvZiBvcHRpb24gPT0gJ29iamVjdCcgJiYgb3B0aW9uDQogICAgICBpZiAoIWRhdGEpICR0aGlzLmRhdGEoJ2NvbGxhcHNlJywgKGRhdGEgPSBuZXcgQ29sbGFwc2UodGhpcywgb3B0aW9ucykpKQ0KICAgICAgaWYgKHR5cGVvZiBvcHRpb24gPT0gJ3N0cmluZycpIGRhdGFbb3B0aW9uXSgpDQogICAgfSkNCiAgfQ0KDQogICQuZm4uY29sbGFwc2UuZGVmYXVsdHMgPSB7DQogICAgdG9nZ2xlOiB0cnVlDQogIH0NCg0KICAkLmZuLmNvbGxhcHNlLkNvbnN0cnVjdG9yID0gQ29sbGFwc2UNCg0KDQogLyogQ09MTEFQU0lCTEUgREFUQS1BUEkNCiAgKiA9PT09PT09PT09PT09PT09PT09PSAqLw0KDQogICQoZnVuY3Rpb24gKCkgew0KICAgICQoJ2JvZHknKS5vbignY2xpY2suY29sbGFwc2UuZGF0YS1hcGknLCAnW2RhdGEtdG9nZ2xlPWNvbGxhcHNlXScsIGZ1bmN0aW9uIChlKSB7DQogICAgICB2YXIgJHRoaXMgPSAkKHRoaXMpLCBocmVmDQogICAgICAgICwgdGFyZ2V0ID0gJHRoaXMuYXR0cignZGF0YS10YXJnZXQnKQ0KICAgICAgICAgIHx8IGUucHJldmVudERlZmF1bHQoKQ0KICAgICAgICAgIHx8IChocmVmID0gJHRoaXMuYXR0cignaHJlZicpKSAmJiBocmVmLnJlcGxhY2UoLy4qKD89I1teXHNdKyQpLywgJycpIC8vc3RyaXAgZm9yIGllNw0KICAgICAgICAsIG9wdGlvbiA9ICQodGFyZ2V0KS5kYXRhKCdjb2xsYXBzZScpID8gJ3RvZ2dsZScgOiAkdGhpcy5kYXRhKCkNCiAgICAgICR0aGlzWyQodGFyZ2V0KS5oYXNDbGFzcygnaW4nKSA/ICdhZGRDbGFzcycgOiAncmVtb3ZlQ2xhc3MnXSgnY29sbGFwc2VkJykNCiAgICAgICQodGFyZ2V0KS5jb2xsYXBzZShvcHRpb24pDQogICAgfSkNCiAgfSkNCg0KfSh3aW5kb3cualF1ZXJ5KTsvKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NCiAqIGJvb3RzdHJhcC1kcm9wZG93bi5qcyB2Mi4xLjENCiAqIGh0dHA6Ly90d2l0dGVyLmdpdGh1Yi5jb20vYm9vdHN0cmFwL2phdmFzY3JpcHQuaHRtbCNkcm9wZG93bnMNCiAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQ0KICogQ29weXJpZ2h0IDIwMTIgVHdpdHRlciwgSW5jLg0KICoNCiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOw0KICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLg0KICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0DQogKg0KICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wDQogKg0KICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQ0KICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywNCiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLg0KICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZA0KICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuDQogKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi8NCg0KDQohZnVuY3Rpb24gKCQpIHsNCg0KICAidXNlIHN0cmljdCI7IC8vIGpzaGludCA7XzsNCg0KDQogLyogRFJPUERPV04gQ0xBU1MgREVGSU5JVElPTg0KICAqID09PT09PT09PT09PT09PT09PT09PT09PT0gKi8NCg0KICB2YXIgdG9nZ2xlID0gJ1tkYXRhLXRvZ2dsZT1kcm9wZG93bl0nDQogICAgLCBEcm9wZG93biA9IGZ1bmN0aW9uIChlbGVtZW50KSB7DQogICAgICAgIHZhciAkZWwgPSAkKGVsZW1lbnQpLm9uKCdjbGljay5kcm9wZG93bi5kYXRhLWFwaScsIHRoaXMudG9nZ2xlKQ0KICAgICAgICAkKCdodG1sJykub24oJ2NsaWNrLmRyb3Bkb3duLmRhdGEtYXBpJywgZnVuY3Rpb24gKCkgew0KICAgICAgICAgICRlbC5wYXJlbnQoKS5yZW1vdmVDbGFzcygnb3BlbicpDQogICAgICAgIH0pDQogICAgICB9DQoNCiAgRHJvcGRvd24ucHJvdG90eXBlID0gew0KDQogICAgY29uc3RydWN0b3I6IERyb3Bkb3duDQoNCiAgLCB0b2dnbGU6IGZ1bmN0aW9uIChlKSB7DQogICAgICB2YXIgJHRoaXMgPSAkKHRoaXMpDQogICAgICAgICwgJHBhcmVudA0KICAgICAgICAsIGlzQWN0aXZlDQoNCiAgICAgIGlmICgkdGhpcy5pcygnLmRpc2FibGVkLCA6ZGlzYWJsZWQnKSkgcmV0dXJuDQoNCiAgICAgICRwYXJlbnQgPSBnZXRQYXJlbnQoJHRoaXMpDQoNCiAgICAgIGlzQWN0aXZlID0gJHBhcmVudC5oYXNDbGFzcygnb3BlbicpDQoNCiAgICAgIGNsZWFyTWVudXMoKQ0KDQogICAgICBpZiAoIWlzQWN0aXZlKSB7DQogICAgICAgICRwYXJlbnQudG9nZ2xlQ2xhc3MoJ29wZW4nKQ0KICAgICAgICAkdGhpcy5mb2N1cygpDQogICAgICB9DQoNCiAgICAgIHJldHVybiBmYWxzZQ0KICAgIH0NCg0KICAsIGtleWRvd246IGZ1bmN0aW9uIChlKSB7DQogICAgICB2YXIgJHRoaXMNCiAgICAgICAgLCAkaXRlbXMNCiAgICAgICAgLCAkYWN0aXZlDQogICAgICAgICwgJHBhcmVudA0KICAgICAgICAsIGlzQWN0aXZlDQogICAgICAgICwgaW5kZXgNCg0KICAgICAgaWYgKCEvKDM4fDQwfDI3KS8udGVzdChlLmtleUNvZGUpKSByZXR1cm4NCg0KICAgICAgJHRoaXMgPSAkKHRoaXMpDQoNCiAgICAgIGUucHJldmVudERlZmF1bHQoKQ0KICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKQ0KDQogICAgICBpZiAoJHRoaXMuaXMoJy5kaXNhYmxlZCwgOmRpc2FibGVkJykpIHJldHVybg0KDQogICAgICAkcGFyZW50ID0gZ2V0UGFyZW50KCR0aGlzKQ0KDQogICAgICBpc0FjdGl2ZSA9ICRwYXJlbnQuaGFzQ2xhc3MoJ29wZW4nKQ0KDQogICAgICBpZiAoIWlzQWN0aXZlIHx8IChpc0FjdGl2ZSAmJiBlLmtleUNvZGUgPT0gMjcpKSByZXR1cm4gJHRoaXMuY2xpY2soKQ0KDQogICAgICAkaXRlbXMgPSAkKCdbcm9sZT1tZW51XSBsaTpub3QoLmRpdmlkZXIpIGEnLCAkcGFyZW50KQ0KDQogICAgICBpZiAoISRpdGVtcy5sZW5ndGgpIHJldHVybg0KDQogICAgICBpbmRleCA9ICRpdGVtcy5pbmRleCgkaXRlbXMuZmlsdGVyKCc6Zm9jdXMnKSkNCg0KICAgICAgaWYgKGUua2V5Q29kZSA9PSAzOCAmJiBpbmRleCA+IDApIGluZGV4LS0gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdXANCiAgICAgIGlmIChlLmtleUNvZGUgPT0gNDAgJiYgaW5kZXggPCAkaXRlbXMubGVuZ3RoIC0gMSkgaW5kZXgrKyAgICAgICAgICAgICAgICAgICAgICAgIC8vIGRvd24NCiAgICAgIGlmICghfmluZGV4KSBpbmRleCA9IDANCg0KICAgICAgJGl0ZW1zDQogICAgICAgIC5lcShpbmRleCkNCiAgICAgICAgLmZvY3VzKCkNCiAgICB9DQoNCiAgfQ0KDQogIGZ1bmN0aW9uIGNsZWFyTWVudXMoKSB7DQogICAgZ2V0UGFyZW50KCQodG9nZ2xlKSkNCiAgICAgIC5yZW1vdmVDbGFzcygnb3BlbicpDQogIH0NCg0KICBmdW5jdGlvbiBnZXRQYXJlbnQoJHRoaXMpIHsNCiAgICB2YXIgc2VsZWN0b3IgPSAkdGhpcy5hdHRyKCdkYXRhLXRhcmdldCcpDQogICAgICAsICRwYXJlbnQNCg0KICAgIGlmICghc2VsZWN0b3IpIHsNCiAgICAgIHNlbGVjdG9yID0gJHRoaXMuYXR0cignaHJlZicpDQogICAgICBzZWxlY3RvciA9IHNlbGVjdG9yICYmIC8jLy50ZXN0KHNlbGVjdG9yKSAmJiBzZWxlY3Rvci5yZXBsYWNlKC8uKig/PSNbXlxzXSokKS8sICcnKSAvL3N0cmlwIGZvciBpZTcNCiAgICB9DQoNCiAgICAkcGFyZW50ID0gJChzZWxlY3RvcikNCiAgICAkcGFyZW50Lmxlbmd0aCB8fCAoJHBhcmVudCA9ICR0aGlzLnBhcmVudCgpKQ0KDQogICAgcmV0dXJuICRwYXJlbnQNCiAgfQ0KDQoNCiAgLyogRFJPUERPV04gUExVR0lOIERFRklOSVRJT04NCiAgICogPT09PT09PT09PT09PT09PT09PT09PT09PT0gKi8NCg0KICAkLmZuLmRyb3Bkb3duID0gZnVuY3Rpb24gKG9wdGlvbikgew0KICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkgew0KICAgICAgdmFyICR0aGlzID0gJCh0aGlzKQ0KICAgICAgICAsIGRhdGEgPSAkdGhpcy5kYXRhKCdkcm9wZG93bicpDQogICAgICBpZiAoIWRhdGEpICR0aGlzLmRhdGEoJ2Ryb3Bkb3duJywgKGRhdGEgPSBuZXcgRHJvcGRvd24odGhpcykpKQ0KICAgICAgaWYgKHR5cGVvZiBvcHRpb24gPT0gJ3N0cmluZycpIGRhdGFbb3B0aW9uXS5jYWxsKCR0aGlzKQ0KICAgIH0pDQogIH0NCg0KICAkLmZuLmRyb3Bkb3duLkNvbnN0cnVjdG9yID0gRHJvcGRvd24NCg0KDQogIC8qIEFQUExZIFRPIFNUQU5EQVJEIERST1BET1dOIEVMRU1FTlRTDQogICAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovDQoNCiAgJChmdW5jdGlvbiAoKSB7DQogICAgJCgnaHRtbCcpDQogICAgICAub24oJ2NsaWNrLmRyb3Bkb3duLmRhdGEtYXBpJywgY2xlYXJNZW51cykNCiAgICAkKCdib2R5JykNCiAgICAgIC5vbignY2xpY2suZHJvcGRvd24gdG91Y2hzdGFydC5kcm9wZG93bi5kYXRhLWFwaScsICcuZHJvcGRvd24gZm9ybScsIGZ1bmN0aW9uIChlKSB7IGUuc3RvcFByb3BhZ2F0aW9uKCkgfSkNCiAgICAgIC5vbignY2xpY2suZHJvcGRvd24uZGF0YS1hcGknICAsIHRvZ2dsZSwgRHJvcGRvd24ucHJvdG90eXBlLnRvZ2dsZSkNCiAgICAgIC5vbigna2V5ZG93bi5kcm9wZG93bi5kYXRhLWFwaSB0b3VjaHN0YXJ0LmRyb3Bkb3duLmRhdGEtYXBpJywgdG9nZ2xlICsgJywgW3JvbGU9bWVudV0nICwgRHJvcGRvd24ucHJvdG90eXBlLmtleWRvd24pDQogIH0pDQoNCn0od2luZG93LmpRdWVyeSk7LyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQogKiBib290c3RyYXAtbW9kYWwuanMgdjIuMy4yDQogKiBodHRwOi8vZ2V0Ym9vdHN0cmFwLmNvbS8yLjMuMi9qYXZhc2NyaXB0Lmh0bWwjbW9kYWxzDQogKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NCiAqIENvcHlyaWdodCAyMDEzIFR3aXR0ZXIsIEluYy4NCiAqDQogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsNCiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4NCiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdA0KICoNCiAqIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMA0KICoNCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUNCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsDQogKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4NCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQNCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLg0KICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovDQoNCg0KIWZ1bmN0aW9uICgkKSB7DQoNCiAgInVzZSBzdHJpY3QiOyAvLyBqc2hpbnQgO187DQoNCg0KIC8qIE1PREFMIENMQVNTIERFRklOSVRJT04NCiAgKiA9PT09PT09PT09PT09PT09PT09PT09ICovDQoNCiAgdmFyIE1vZGFsID0gZnVuY3Rpb24gKGVsZW1lbnQsIG9wdGlvbnMpIHsNCiAgICB0aGlzLm9wdGlvbnMgPSBvcHRpb25zDQogICAgdGhpcy4kZWxlbWVudCA9ICQoZWxlbWVudCkNCiAgICAgIC5kZWxlZ2F0ZSgnW2RhdGEtZGlzbWlzcz0ibW9kYWwiXScsICdjbGljay5kaXNtaXNzLm1vZGFsJywgJC5wcm94eSh0aGlzLmhpZGUsIHRoaXMpKQ0KICAgIHRoaXMub3B0aW9ucy5yZW1vdGUgJiYgdGhpcy4kZWxlbWVudC5maW5kKCcubW9kYWwtYm9keScpLmxvYWQodGhpcy5vcHRpb25zLnJlbW90ZSkNCiAgfQ0KDQogIE1vZGFsLnByb3RvdHlwZSA9IHsNCg0KICAgICAgY29uc3RydWN0b3I6IE1vZGFsDQoNCiAgICAsIHRvZ2dsZTogZnVuY3Rpb24gKCkgew0KICAgICAgICByZXR1cm4gdGhpc1shdGhpcy5pc1Nob3duID8gJ3Nob3cnIDogJ2hpZGUnXSgpDQogICAgICB9DQoNCiAgICAsIHNob3c6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgdmFyIHRoYXQgPSB0aGlzDQogICAgICAgICAgLCBlID0gJC5FdmVudCgnc2hvdycpDQoNCiAgICAgICAgdGhpcy4kZWxlbWVudC50cmlnZ2VyKGUpDQoNCiAgICAgICAgaWYgKHRoaXMuaXNTaG93biB8fCBlLmlzRGVmYXVsdFByZXZlbnRlZCgpKSByZXR1cm4NCg0KICAgICAgICB0aGlzLmlzU2hvd24gPSB0cnVlDQoNCiAgICAgICAgdGhpcy5lc2NhcGUoKQ0KDQogICAgICAgIHRoaXMuYmFja2Ryb3AoZnVuY3Rpb24gKCkgew0KICAgICAgICAgIHZhciB0cmFuc2l0aW9uID0gJC5zdXBwb3J0LnRyYW5zaXRpb24gJiYgdGhhdC4kZWxlbWVudC5oYXNDbGFzcygnZmFkZScpDQoNCiAgICAgICAgICBpZiAoIXRoYXQuJGVsZW1lbnQucGFyZW50KCkubGVuZ3RoKSB7DQogICAgICAgICAgICB0aGF0LiRlbGVtZW50LmFwcGVuZFRvKGRvY3VtZW50LmJvZHkpIC8vZG9uJ3QgbW92ZSBtb2RhbHMgZG9tIHBvc2l0aW9uDQogICAgICAgICAgfQ0KDQogICAgICAgICAgdGhhdC4kZWxlbWVudC5zaG93KCkNCg0KICAgICAgICAgIGlmICh0cmFuc2l0aW9uKSB7DQogICAgICAgICAgICB0aGF0LiRlbGVtZW50WzBdLm9mZnNldFdpZHRoIC8vIGZvcmNlIHJlZmxvdw0KICAgICAgICAgIH0NCg0KICAgICAgICAgIHRoYXQuJGVsZW1lbnQNCiAgICAgICAgICAgIC5hZGRDbGFzcygnaW4nKQ0KICAgICAgICAgICAgLmF0dHIoJ2FyaWEtaGlkZGVuJywgZmFsc2UpDQoNCiAgICAgICAgICB0aGF0LmVuZm9yY2VGb2N1cygpDQoNCiAgICAgICAgICB0cmFuc2l0aW9uID8NCiAgICAgICAgICAgIHRoYXQuJGVsZW1lbnQub25lKCQuc3VwcG9ydC50cmFuc2l0aW9uLmVuZCwgZnVuY3Rpb24gKCkgeyB0aGF0LiRlbGVtZW50LmZvY3VzKCkudHJpZ2dlcignc2hvd24nKSB9KSA6DQogICAgICAgICAgICB0aGF0LiRlbGVtZW50LmZvY3VzKCkudHJpZ2dlcignc2hvd24nKQ0KDQogICAgICAgIH0pDQogICAgICB9DQoNCiAgICAsIGhpZGU6IGZ1bmN0aW9uIChlKSB7DQogICAgICAgIGUgJiYgZS5wcmV2ZW50RGVmYXVsdCgpDQoNCiAgICAgICAgdmFyIHRoYXQgPSB0aGlzDQoNCiAgICAgICAgZSA9ICQuRXZlbnQoJ2hpZGUnKQ0KDQogICAgICAgIHRoaXMuJGVsZW1lbnQudHJpZ2dlcihlKQ0KDQogICAgICAgIGlmICghdGhpcy5pc1Nob3duIHx8IGUuaXNEZWZhdWx0UHJldmVudGVkKCkpIHJldHVybg0KDQogICAgICAgIHRoaXMuaXNTaG93biA9IGZhbHNlDQoNCiAgICAgICAgdGhpcy5lc2NhcGUoKQ0KDQogICAgICAgICQoZG9jdW1lbnQpLm9mZignZm9jdXNpbi5tb2RhbCcpDQoNCiAgICAgICAgdGhpcy4kZWxlbWVudA0KICAgICAgICAgIC5yZW1vdmVDbGFzcygnaW4nKQ0KICAgICAgICAgIC5hdHRyKCdhcmlhLWhpZGRlbicsIHRydWUpDQoNCiAgICAgICAgJC5zdXBwb3J0LnRyYW5zaXRpb24gJiYgdGhpcy4kZWxlbWVudC5oYXNDbGFzcygnZmFkZScpID8NCiAgICAgICAgICB0aGlzLmhpZGVXaXRoVHJhbnNpdGlvbigpIDoNCiAgICAgICAgICB0aGlzLmhpZGVNb2RhbCgpDQogICAgICB9DQoNCiAgICAsIGVuZm9yY2VGb2N1czogZnVuY3Rpb24gKCkgew0KICAgICAgICB2YXIgdGhhdCA9IHRoaXMNCiAgICAgICAgJChkb2N1bWVudCkub24oJ2ZvY3VzaW4ubW9kYWwnLCBmdW5jdGlvbiAoZSkgew0KICAgICAgICAgIGlmICh0aGF0LiRlbGVtZW50WzBdICE9PSBlLnRhcmdldCAmJiAhdGhhdC4kZWxlbWVudC5oYXMoZS50YXJnZXQpLmxlbmd0aCkgew0KICAgICAgICAgICAgdGhhdC4kZWxlbWVudC5mb2N1cygpDQogICAgICAgICAgfQ0KICAgICAgICB9KQ0KICAgICAgfQ0KDQogICAgLCBlc2NhcGU6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgdmFyIHRoYXQgPSB0aGlzDQogICAgICAgIGlmICh0aGlzLmlzU2hvd24gJiYgdGhpcy5vcHRpb25zLmtleWJvYXJkKSB7DQogICAgICAgICAgdGhpcy4kZWxlbWVudC5vbigna2V5dXAuZGlzbWlzcy5tb2RhbCcsIGZ1bmN0aW9uICggZSApIHsNCiAgICAgICAgICAgIGUud2hpY2ggPT0gMjcgJiYgdGhhdC5oaWRlKCkNCiAgICAgICAgICB9KQ0KICAgICAgICB9IGVsc2UgaWYgKCF0aGlzLmlzU2hvd24pIHsNCiAgICAgICAgICB0aGlzLiRlbGVtZW50Lm9mZigna2V5dXAuZGlzbWlzcy5tb2RhbCcpDQogICAgICAgIH0NCiAgICAgIH0NCg0KICAgICwgaGlkZVdpdGhUcmFuc2l0aW9uOiBmdW5jdGlvbiAoKSB7DQogICAgICAgIHZhciB0aGF0ID0gdGhpcw0KICAgICAgICAgICwgdGltZW91dCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICB0aGF0LiRlbGVtZW50Lm9mZigkLnN1cHBvcnQudHJhbnNpdGlvbi5lbmQpDQogICAgICAgICAgICAgIHRoYXQuaGlkZU1vZGFsKCkNCiAgICAgICAgICAgIH0sIDUwMCkNCg0KICAgICAgICB0aGlzLiRlbGVtZW50Lm9uZSgkLnN1cHBvcnQudHJhbnNpdGlvbi5lbmQsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dCkNCiAgICAgICAgICB0aGF0LmhpZGVNb2RhbCgpDQogICAgICAgIH0pDQogICAgICB9DQoNCiAgICAsIGhpZGVNb2RhbDogZnVuY3Rpb24gKCkgew0KICAgICAgICB2YXIgdGhhdCA9IHRoaXMNCiAgICAgICAgdGhpcy4kZWxlbWVudC5oaWRlKCkNCiAgICAgICAgdGhpcy5iYWNrZHJvcChmdW5jdGlvbiAoKSB7DQogICAgICAgICAgdGhhdC5yZW1vdmVCYWNrZHJvcCgpDQogICAgICAgICAgdGhhdC4kZWxlbWVudC50cmlnZ2VyKCdoaWRkZW4nKQ0KICAgICAgICB9KQ0KICAgICAgfQ0KDQogICAgLCByZW1vdmVCYWNrZHJvcDogZnVuY3Rpb24gKCkgew0KICAgICAgICB0aGlzLiRiYWNrZHJvcCAmJiB0aGlzLiRiYWNrZHJvcC5yZW1vdmUoKQ0KICAgICAgICB0aGlzLiRiYWNrZHJvcCA9IG51bGwNCiAgICAgIH0NCg0KICAgICwgYmFja2Ryb3A6IGZ1bmN0aW9uIChjYWxsYmFjaykgew0KICAgICAgICB2YXIgdGhhdCA9IHRoaXMNCiAgICAgICAgICAsIGFuaW1hdGUgPSB0aGlzLiRlbGVtZW50Lmhhc0NsYXNzKCdmYWRlJykgPyAnZmFkZScgOiAnJw0KDQogICAgICAgIGlmICh0aGlzLmlzU2hvd24gJiYgdGhpcy5vcHRpb25zLmJhY2tkcm9wKSB7DQogICAgICAgICAgdmFyIGRvQW5pbWF0ZSA9ICQuc3VwcG9ydC50cmFuc2l0aW9uICYmIGFuaW1hdGUNCg0KICAgICAgICAgIHRoaXMuJGJhY2tkcm9wID0gJCgnPGRpdiBjbGFzcz0ibW9kYWwtYmFja2Ryb3AgJyArIGFuaW1hdGUgKyAnIiAvPicpDQogICAgICAgICAgICAuYXBwZW5kVG8oZG9jdW1lbnQuYm9keSkNCg0KICAgICAgICAgIHRoaXMuJGJhY2tkcm9wLmNsaWNrKA0KICAgICAgICAgICAgdGhpcy5vcHRpb25zLmJhY2tkcm9wID09ICdzdGF0aWMnID8NCiAgICAgICAgICAgICAgJC5wcm94eSh0aGlzLiRlbGVtZW50WzBdLmZvY3VzLCB0aGlzLiRlbGVtZW50WzBdKQ0KICAgICAgICAgICAgOiAkLnByb3h5KHRoaXMuaGlkZSwgdGhpcykNCiAgICAgICAgICApDQoNCiAgICAgICAgICBpZiAoZG9BbmltYXRlKSB0aGlzLiRiYWNrZHJvcFswXS5vZmZzZXRXaWR0aCAvLyBmb3JjZSByZWZsb3cNCg0KICAgICAgICAgIHRoaXMuJGJhY2tkcm9wLmFkZENsYXNzKCdpbicpDQoNCiAgICAgICAgICBpZiAoIWNhbGxiYWNrKSByZXR1cm4NCg0KICAgICAgICAgIGRvQW5pbWF0ZSA/DQogICAgICAgICAgICB0aGlzLiRiYWNrZHJvcC5vbmUoJC5zdXBwb3J0LnRyYW5zaXRpb24uZW5kLCBjYWxsYmFjaykgOg0KICAgICAgICAgICAgY2FsbGJhY2soKQ0KDQogICAgICAgIH0gZWxzZSBpZiAoIXRoaXMuaXNTaG93biAmJiB0aGlzLiRiYWNrZHJvcCkgew0KICAgICAgICAgIHRoaXMuJGJhY2tkcm9wLnJlbW92ZUNsYXNzKCdpbicpDQoNCiAgICAgICAgICAkLnN1cHBvcnQudHJhbnNpdGlvbiAmJiB0aGlzLiRlbGVtZW50Lmhhc0NsYXNzKCdmYWRlJyk/DQogICAgICAgICAgICB0aGlzLiRiYWNrZHJvcC5vbmUoJC5zdXBwb3J0LnRyYW5zaXRpb24uZW5kLCBjYWxsYmFjaykgOg0KICAgICAgICAgICAgY2FsbGJhY2soKQ0KDQogICAgICAgIH0gZWxzZSBpZiAoY2FsbGJhY2spIHsNCiAgICAgICAgICBjYWxsYmFjaygpDQogICAgICAgIH0NCiAgICAgIH0NCiAgfQ0KDQoNCiAvKiBNT0RBTCBQTFVHSU4gREVGSU5JVElPTg0KICAqID09PT09PT09PT09PT09PT09PT09PT09ICovDQoNCiAgdmFyIG9sZCA9ICQuZm4ubW9kYWwNCg0KICAkLmZuLm1vZGFsID0gZnVuY3Rpb24gKG9wdGlvbikgew0KICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkgew0KICAgICAgdmFyICR0aGlzID0gJCh0aGlzKQ0KICAgICAgICAsIGRhdGEgPSAkdGhpcy5kYXRhKCdtb2RhbCcpDQogICAgICAgICwgb3B0aW9ucyA9ICQuZXh0ZW5kKHt9LCAkLmZuLm1vZGFsLmRlZmF1bHRzLCAkdGhpcy5kYXRhKCksIHR5cGVvZiBvcHRpb24gPT0gJ29iamVjdCcgJiYgb3B0aW9uKQ0KICAgICAgaWYgKCFkYXRhKSAkdGhpcy5kYXRhKCdtb2RhbCcsIChkYXRhID0gbmV3IE1vZGFsKHRoaXMsIG9wdGlvbnMpKSkNCiAgICAgIGlmICh0eXBlb2Ygb3B0aW9uID09ICdzdHJpbmcnKSBkYXRhW29wdGlvbl0oKQ0KICAgICAgZWxzZSBpZiAob3B0aW9ucy5zaG93KSBkYXRhLnNob3coKQ0KICAgIH0pDQogIH0NCg0KICAkLmZuLm1vZGFsLmRlZmF1bHRzID0gew0KICAgICAgYmFja2Ryb3A6IHRydWUNCiAgICAsIGtleWJvYXJkOiB0cnVlDQogICAgLCBzaG93OiB0cnVlDQogIH0NCg0KICAkLmZuLm1vZGFsLkNvbnN0cnVjdG9yID0gTW9kYWwNCg0KDQogLyogTU9EQUwgTk8gQ09ORkxJQ1QNCiAgKiA9PT09PT09PT09PT09PT09PSAqLw0KDQogICQuZm4ubW9kYWwubm9Db25mbGljdCA9IGZ1bmN0aW9uICgpIHsNCiAgICAkLmZuLm1vZGFsID0gb2xkDQogICAgcmV0dXJuIHRoaXMNCiAgfQ0KDQoNCiAvKiBNT0RBTCBEQVRBLUFQSQ0KICAqID09PT09PT09PT09PT09ICovDQoNCiAgJChkb2N1bWVudCkub24oJ2NsaWNrLm1vZGFsLmRhdGEtYXBpJywgJ1tkYXRhLXRvZ2dsZT0ibW9kYWwiXScsIGZ1bmN0aW9uIChlKSB7DQogICAgdmFyICR0aGlzID0gJCh0aGlzKQ0KICAgICAgLCBocmVmID0gJHRoaXMuYXR0cignaHJlZicpDQogICAgICAsICR0YXJnZXQgPSAkKCR0aGlzLmF0dHIoJ2RhdGEtdGFyZ2V0JykgfHwgKGhyZWYgJiYgaHJlZi5yZXBsYWNlKC8uKig/PSNbXlxzXSskKS8sICcnKSkpIC8vc3RyaXAgZm9yIGllNw0KICAgICAgLCBvcHRpb24gPSAkdGFyZ2V0LmRhdGEoJ21vZGFsJykgPyAndG9nZ2xlJyA6ICQuZXh0ZW5kKHsgcmVtb3RlOiEvIy8udGVzdChocmVmKSAmJiBocmVmIH0sICR0YXJnZXQuZGF0YSgpLCAkdGhpcy5kYXRhKCkpDQoNCiAgICBlLnByZXZlbnREZWZhdWx0KCkNCg0KICAgICR0YXJnZXQNCiAgICAgIC5tb2RhbChvcHRpb24pDQogICAgICAub25lKCdoaWRlJywgZnVuY3Rpb24gKCkgew0KICAgICAgICAkdGhpcy5mb2N1cygpDQogICAgICB9KQ0KICB9KQ0KDQp9KHdpbmRvdy5qUXVlcnkpOy8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQogKiBib290c3RyYXAtdG9vbHRpcC5qcyB2Mi4xLjENCiAqIGh0dHA6Ly90d2l0dGVyLmdpdGh1Yi5jb20vYm9vdHN0cmFwL2phdmFzY3JpcHQuaHRtbCN0b29sdGlwcw0KICogSW5zcGlyZWQgYnkgdGhlIG9yaWdpbmFsIGpRdWVyeS50aXBzeSBieSBKYXNvbiBGcmFtZQ0KICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NCiAqIENvcHlyaWdodCAyMDEyIFR3aXR0ZXIsIEluYy4NCiAqDQogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsNCiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4NCiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdA0KICoNCiAqIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMA0KICoNCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUNCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsDQogKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4NCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQNCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLg0KICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqLw0KDQoNCiFmdW5jdGlvbiAoJCkgew0KDQogICJ1c2Ugc3RyaWN0IjsgLy8ganNoaW50IDtfOw0KDQoNCiAvKiBUT09MVElQIFBVQkxJQyBDTEFTUyBERUZJTklUSU9ODQogICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqLw0KDQogIHZhciBUb29sdGlwID0gZnVuY3Rpb24gKGVsZW1lbnQsIG9wdGlvbnMpIHsNCiAgICB0aGlzLmluaXQoJ3Rvb2x0aXAnLCBlbGVtZW50LCBvcHRpb25zKQ0KICB9DQoNCiAgVG9vbHRpcC5wcm90b3R5cGUgPSB7DQoNCiAgICBjb25zdHJ1Y3RvcjogVG9vbHRpcA0KDQogICwgaW5pdDogZnVuY3Rpb24gKHR5cGUsIGVsZW1lbnQsIG9wdGlvbnMpIHsNCiAgICAgIHZhciBldmVudEluDQogICAgICAgICwgZXZlbnRPdXQNCg0KICAgICAgdGhpcy50eXBlID0gdHlwZQ0KICAgICAgdGhpcy4kZWxlbWVudCA9ICQoZWxlbWVudCkNCiAgICAgIHRoaXMub3B0aW9ucyA9IHRoaXMuZ2V0T3B0aW9ucyhvcHRpb25zKQ0KICAgICAgdGhpcy5lbmFibGVkID0gdHJ1ZQ0KDQogICAgICBpZiAodGhpcy5vcHRpb25zLnRyaWdnZXIgPT0gJ2NsaWNrJykgew0KICAgICAgICB0aGlzLiRlbGVtZW50Lm9uKCdjbGljay4nICsgdGhpcy50eXBlLCB0aGlzLm9wdGlvbnMuc2VsZWN0b3IsICQucHJveHkodGhpcy50b2dnbGUsIHRoaXMpKQ0KICAgICAgfSBlbHNlIGlmICh0aGlzLm9wdGlvbnMudHJpZ2dlciAhPSAnbWFudWFsJykgew0KICAgICAgICBldmVudEluID0gdGhpcy5vcHRpb25zLnRyaWdnZXIgPT0gJ2hvdmVyJyA/ICdtb3VzZWVudGVyJyA6ICdmb2N1cycNCiAgICAgICAgZXZlbnRPdXQgPSB0aGlzLm9wdGlvbnMudHJpZ2dlciA9PSAnaG92ZXInID8gJ21vdXNlbGVhdmUnIDogJ2JsdXInDQogICAgICAgIHRoaXMuJGVsZW1lbnQub24oZXZlbnRJbiArICcuJyArIHRoaXMudHlwZSwgdGhpcy5vcHRpb25zLnNlbGVjdG9yLCAkLnByb3h5KHRoaXMuZW50ZXIsIHRoaXMpKQ0KICAgICAgICB0aGlzLiRlbGVtZW50Lm9uKGV2ZW50T3V0ICsgJy4nICsgdGhpcy50eXBlLCB0aGlzLm9wdGlvbnMuc2VsZWN0b3IsICQucHJveHkodGhpcy5sZWF2ZSwgdGhpcykpDQogICAgICB9DQoNCiAgICAgIHRoaXMub3B0aW9ucy5zZWxlY3RvciA/DQogICAgICAgICh0aGlzLl9vcHRpb25zID0gJC5leHRlbmQoe30sIHRoaXMub3B0aW9ucywgeyB0cmlnZ2VyOiAnbWFudWFsJywgc2VsZWN0b3I6ICcnIH0pKSA6DQogICAgICAgIHRoaXMuZml4VGl0bGUoKQ0KICAgIH0NCg0KICAsIGdldE9wdGlvbnM6IGZ1bmN0aW9uIChvcHRpb25zKSB7DQogICAgICBvcHRpb25zID0gJC5leHRlbmQoe30sICQuZm5bdGhpcy50eXBlXS5kZWZhdWx0cywgb3B0aW9ucywgdGhpcy4kZWxlbWVudC5kYXRhKCkpDQoNCiAgICAgIGlmIChvcHRpb25zLmRlbGF5ICYmIHR5cGVvZiBvcHRpb25zLmRlbGF5ID09ICdudW1iZXInKSB7DQogICAgICAgIG9wdGlvbnMuZGVsYXkgPSB7DQogICAgICAgICAgc2hvdzogb3B0aW9ucy5kZWxheQ0KICAgICAgICAsIGhpZGU6IG9wdGlvbnMuZGVsYXkNCiAgICAgICAgfQ0KICAgICAgfQ0KDQogICAgICByZXR1cm4gb3B0aW9ucw0KICAgIH0NCg0KICAsIGVudGVyOiBmdW5jdGlvbiAoZSkgew0KICAgICAgdmFyIHNlbGYgPSAkKGUuY3VycmVudFRhcmdldClbdGhpcy50eXBlXSh0aGlzLl9vcHRpb25zKS5kYXRhKHRoaXMudHlwZSkNCg0KICAgICAgaWYgKCFzZWxmLm9wdGlvbnMuZGVsYXkgfHwgIXNlbGYub3B0aW9ucy5kZWxheS5zaG93KSByZXR1cm4gc2VsZi5zaG93KCkNCg0KICAgICAgY2xlYXJUaW1lb3V0KHRoaXMudGltZW91dCkNCiAgICAgIHNlbGYuaG92ZXJTdGF0ZSA9ICdpbicNCiAgICAgIHRoaXMudGltZW91dCA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7DQogICAgICAgIGlmIChzZWxmLmhvdmVyU3RhdGUgPT0gJ2luJykgc2VsZi5zaG93KCkNCiAgICAgIH0sIHNlbGYub3B0aW9ucy5kZWxheS5zaG93KQ0KICAgIH0NCg0KICAsIGxlYXZlOiBmdW5jdGlvbiAoZSkgew0KICAgICAgdmFyIHNlbGYgPSAkKGUuY3VycmVudFRhcmdldClbdGhpcy50eXBlXSh0aGlzLl9vcHRpb25zKS5kYXRhKHRoaXMudHlwZSkNCg0KICAgICAgaWYgKHRoaXMudGltZW91dCkgY2xlYXJUaW1lb3V0KHRoaXMudGltZW91dCkNCiAgICAgIGlmICghc2VsZi5vcHRpb25zLmRlbGF5IHx8ICFzZWxmLm9wdGlvbnMuZGVsYXkuaGlkZSkgcmV0dXJuIHNlbGYuaGlkZSgpDQoNCiAgICAgIHNlbGYuaG92ZXJTdGF0ZSA9ICdvdXQnDQogICAgICB0aGlzLnRpbWVvdXQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgew0KICAgICAgICBpZiAoc2VsZi5ob3ZlclN0YXRlID09ICdvdXQnKSBzZWxmLmhpZGUoKQ0KICAgICAgfSwgc2VsZi5vcHRpb25zLmRlbGF5LmhpZGUpDQogICAgfQ0KDQogICwgc2hvdzogZnVuY3Rpb24gKCkgew0KICAgICAgdmFyICR0aXANCiAgICAgICAgLCBpbnNpZGUNCiAgICAgICAgLCBwb3MNCiAgICAgICAgLCBhY3R1YWxXaWR0aA0KICAgICAgICAsIGFjdHVhbEhlaWdodA0KICAgICAgICAsIHBsYWNlbWVudA0KICAgICAgICAsIHRwDQoNCiAgICAgIGlmICh0aGlzLmhhc0NvbnRlbnQoKSAmJiB0aGlzLmVuYWJsZWQpIHsNCiAgICAgICAgJHRpcCA9IHRoaXMudGlwKCkNCiAgICAgICAgdGhpcy5zZXRDb250ZW50KCkNCg0KICAgICAgICBpZiAodGhpcy5vcHRpb25zLmFuaW1hdGlvbikgew0KICAgICAgICAgICR0aXAuYWRkQ2xhc3MoJ2ZhZGUnKQ0KICAgICAgICB9DQoNCiAgICAgICAgcGxhY2VtZW50ID0gdHlwZW9mIHRoaXMub3B0aW9ucy5wbGFjZW1lbnQgPT0gJ2Z1bmN0aW9uJyA/DQogICAgICAgICAgdGhpcy5vcHRpb25zLnBsYWNlbWVudC5jYWxsKHRoaXMsICR0aXBbMF0sIHRoaXMuJGVsZW1lbnRbMF0pIDoNCiAgICAgICAgICB0aGlzLm9wdGlvbnMucGxhY2VtZW50DQoNCiAgICAgICAgaW5zaWRlID0gL2luLy50ZXN0KHBsYWNlbWVudCkNCg0KICAgICAgICAkdGlwDQogICAgICAgICAgLnJlbW92ZSgpDQogICAgICAgICAgLmNzcyh7IHRvcDogMCwgbGVmdDogMCwgZGlzcGxheTogJ2Jsb2NrJyB9KQ0KICAgICAgICAgIC5hcHBlbmRUbyhpbnNpZGUgPyB0aGlzLiRlbGVtZW50IDogZG9jdW1lbnQuYm9keSkNCg0KICAgICAgICBwb3MgPSB0aGlzLmdldFBvc2l0aW9uKGluc2lkZSkNCg0KICAgICAgICBhY3R1YWxXaWR0aCA9ICR0aXBbMF0ub2Zmc2V0V2lkdGgNCiAgICAgICAgYWN0dWFsSGVpZ2h0ID0gJHRpcFswXS5vZmZzZXRIZWlnaHQNCg0KICAgICAgICBzd2l0Y2ggKGluc2lkZSA/IHBsYWNlbWVudC5zcGxpdCgnICcpWzFdIDogcGxhY2VtZW50KSB7DQogICAgICAgICAgY2FzZSAnYm90dG9tJzoNCiAgICAgICAgICAgIHRwID0ge3RvcDogcG9zLnRvcCArIHBvcy5oZWlnaHQsIGxlZnQ6IHBvcy5sZWZ0ICsgcG9zLndpZHRoIC8gMiAtIGFjdHVhbFdpZHRoIC8gMn0NCiAgICAgICAgICAgIGJyZWFrDQogICAgICAgICAgY2FzZSAndG9wJzoNCiAgICAgICAgICAgIHRwID0ge3RvcDogcG9zLnRvcCAtIGFjdHVhbEhlaWdodCwgbGVmdDogcG9zLmxlZnQgKyBwb3Mud2lkdGggLyAyIC0gYWN0dWFsV2lkdGggLyAyfQ0KICAgICAgICAgICAgYnJlYWsNCiAgICAgICAgICBjYXNlICdsZWZ0JzoNCiAgICAgICAgICAgIHRwID0ge3RvcDogcG9zLnRvcCArIHBvcy5oZWlnaHQgLyAyIC0gYWN0dWFsSGVpZ2h0IC8gMiwgbGVmdDogcG9zLmxlZnQgLSBhY3R1YWxXaWR0aH0NCiAgICAgICAgICAgIGJyZWFrDQogICAgICAgICAgY2FzZSAncmlnaHQnOg0KICAgICAgICAgICAgdHAgPSB7dG9wOiBwb3MudG9wICsgcG9zLmhlaWdodCAvIDIgLSBhY3R1YWxIZWlnaHQgLyAyLCBsZWZ0OiBwb3MubGVmdCArIHBvcy53aWR0aH0NCiAgICAgICAgICAgIGJyZWFrDQogICAgICAgIH0NCg0KICAgICAgICAkdGlwDQogICAgICAgICAgLmNzcyh0cCkNCiAgICAgICAgICAuYWRkQ2xhc3MocGxhY2VtZW50KQ0KICAgICAgICAgIC5hZGRDbGFzcygnaW4nKQ0KICAgICAgfQ0KICAgIH0NCg0KICAsIHNldENvbnRlbnQ6IGZ1bmN0aW9uICgpIHsNCiAgICAgIHZhciAkdGlwID0gdGhpcy50aXAoKQ0KICAgICAgICAsIHRpdGxlID0gdGhpcy5nZXRUaXRsZSgpDQoNCiAgICAgICR0aXAuZmluZCgnLnRvb2x0aXAtaW5uZXInKVt0aGlzLm9wdGlvbnMuaHRtbCA/ICdodG1sJyA6ICd0ZXh0J10odGl0bGUpDQogICAgICAkdGlwLnJlbW92ZUNsYXNzKCdmYWRlIGluIHRvcCBib3R0b20gbGVmdCByaWdodCcpDQogICAgfQ0KDQogICwgaGlkZTogZnVuY3Rpb24gKCkgew0KICAgICAgdmFyIHRoYXQgPSB0aGlzDQogICAgICAgICwgJHRpcCA9IHRoaXMudGlwKCkNCg0KICAgICAgJHRpcC5yZW1vdmVDbGFzcygnaW4nKQ0KDQogICAgICBmdW5jdGlvbiByZW1vdmVXaXRoQW5pbWF0aW9uKCkgew0KICAgICAgICB2YXIgdGltZW91dCA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgew0KICAgICAgICAgICR0aXAub2ZmKCQuc3VwcG9ydC50cmFuc2l0aW9uLmVuZCkucmVtb3ZlKCkNCiAgICAgICAgfSwgNTAwKQ0KDQogICAgICAgICR0aXAub25lKCQuc3VwcG9ydC50cmFuc2l0aW9uLmVuZCwgZnVuY3Rpb24gKCkgew0KICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lb3V0KQ0KICAgICAgICAgICR0aXAucmVtb3ZlKCkNCiAgICAgICAgfSkNCiAgICAgIH0NCg0KICAgICAgJC5zdXBwb3J0LnRyYW5zaXRpb24gJiYgdGhpcy4kdGlwLmhhc0NsYXNzKCdmYWRlJykgPw0KICAgICAgICByZW1vdmVXaXRoQW5pbWF0aW9uKCkgOg0KICAgICAgICAkdGlwLnJlbW92ZSgpDQoNCiAgICAgIHJldHVybiB0aGlzDQogICAgfQ0KDQogICwgZml4VGl0bGU6IGZ1bmN0aW9uICgpIHsNCiAgICAgIHZhciAkZSA9IHRoaXMuJGVsZW1lbnQNCiAgICAgIGlmICgkZS5hdHRyKCd0aXRsZScpIHx8IHR5cGVvZigkZS5hdHRyKCdkYXRhLW9yaWdpbmFsLXRpdGxlJykpICE9ICdzdHJpbmcnKSB7DQogICAgICAgICRlLmF0dHIoJ2RhdGEtb3JpZ2luYWwtdGl0bGUnLCAkZS5hdHRyKCd0aXRsZScpIHx8ICcnKS5yZW1vdmVBdHRyKCd0aXRsZScpDQogICAgICB9DQogICAgfQ0KDQogICwgaGFzQ29udGVudDogZnVuY3Rpb24gKCkgew0KICAgICAgcmV0dXJuIHRoaXMuZ2V0VGl0bGUoKQ0KICAgIH0NCg0KICAsIGdldFBvc2l0aW9uOiBmdW5jdGlvbiAoaW5zaWRlKSB7DQogICAgICByZXR1cm4gJC5leHRlbmQoe30sIChpbnNpZGUgPyB7dG9wOiAwLCBsZWZ0OiAwfSA6IHRoaXMuJGVsZW1lbnQub2Zmc2V0KCkpLCB7DQogICAgICAgIHdpZHRoOiB0aGlzLiRlbGVtZW50WzBdLm9mZnNldFdpZHRoDQogICAgICAsIGhlaWdodDogdGhpcy4kZWxlbWVudFswXS5vZmZzZXRIZWlnaHQNCiAgICAgIH0pDQogICAgfQ0KDQogICwgZ2V0VGl0bGU6IGZ1bmN0aW9uICgpIHsNCiAgICAgIHZhciB0aXRsZQ0KICAgICAgICAsICRlID0gdGhpcy4kZWxlbWVudA0KICAgICAgICAsIG8gPSB0aGlzLm9wdGlvbnMNCg0KICAgICAgdGl0bGUgPSAkZS5hdHRyKCdkYXRhLW9yaWdpbmFsLXRpdGxlJykNCiAgICAgICAgfHwgKHR5cGVvZiBvLnRpdGxlID09ICdmdW5jdGlvbicgPyBvLnRpdGxlLmNhbGwoJGVbMF0pIDogIG8udGl0bGUpDQoNCiAgICAgIHJldHVybiB0aXRsZQ0KICAgIH0NCg0KICAsIHRpcDogZnVuY3Rpb24gKCkgew0KICAgICAgcmV0dXJuIHRoaXMuJHRpcCA9IHRoaXMuJHRpcCB8fCAkKHRoaXMub3B0aW9ucy50ZW1wbGF0ZSkNCiAgICB9DQoNCiAgLCB2YWxpZGF0ZTogZnVuY3Rpb24gKCkgew0KICAgICAgaWYgKCF0aGlzLiRlbGVtZW50WzBdLnBhcmVudE5vZGUpIHsNCiAgICAgICAgdGhpcy5oaWRlKCkNCiAgICAgICAgdGhpcy4kZWxlbWVudCA9IG51bGwNCiAgICAgICAgdGhpcy5vcHRpb25zID0gbnVsbA0KICAgICAgfQ0KICAgIH0NCg0KICAsIGVuYWJsZTogZnVuY3Rpb24gKCkgew0KICAgICAgdGhpcy5lbmFibGVkID0gdHJ1ZQ0KICAgIH0NCg0KICAsIGRpc2FibGU6IGZ1bmN0aW9uICgpIHsNCiAgICAgIHRoaXMuZW5hYmxlZCA9IGZhbHNlDQogICAgfQ0KDQogICwgdG9nZ2xlRW5hYmxlZDogZnVuY3Rpb24gKCkgew0KICAgICAgdGhpcy5lbmFibGVkID0gIXRoaXMuZW5hYmxlZA0KICAgIH0NCg0KICAsIHRvZ2dsZTogZnVuY3Rpb24gKCkgew0KICAgICAgdGhpc1t0aGlzLnRpcCgpLmhhc0NsYXNzKCdpbicpID8gJ2hpZGUnIDogJ3Nob3cnXSgpDQogICAgfQ0KDQogICwgZGVzdHJveTogZnVuY3Rpb24gKCkgew0KICAgICAgdGhpcy5oaWRlKCkuJGVsZW1lbnQub2ZmKCcuJyArIHRoaXMudHlwZSkucmVtb3ZlRGF0YSh0aGlzLnR5cGUpDQogICAgfQ0KDQogIH0NCg0KDQogLyogVE9PTFRJUCBQTFVHSU4gREVGSU5JVElPTg0KICAqID09PT09PT09PT09PT09PT09PT09PT09PT0gKi8NCg0KICAkLmZuLnRvb2x0aXAgPSBmdW5jdGlvbiAoIG9wdGlvbiApIHsNCiAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHsNCiAgICAgIHZhciAkdGhpcyA9ICQodGhpcykNCiAgICAgICAgLCBkYXRhID0gJHRoaXMuZGF0YSgndG9vbHRpcCcpDQogICAgICAgICwgb3B0aW9ucyA9IHR5cGVvZiBvcHRpb24gPT0gJ29iamVjdCcgJiYgb3B0aW9uDQogICAgICBpZiAoIWRhdGEpICR0aGlzLmRhdGEoJ3Rvb2x0aXAnLCAoZGF0YSA9IG5ldyBUb29sdGlwKHRoaXMsIG9wdGlvbnMpKSkNCiAgICAgIGlmICh0eXBlb2Ygb3B0aW9uID09ICdzdHJpbmcnKSBkYXRhW29wdGlvbl0oKQ0KICAgIH0pDQogIH0NCg0KICAkLmZuLnRvb2x0aXAuQ29uc3RydWN0b3IgPSBUb29sdGlwDQoNCiAgJC5mbi50b29sdGlwLmRlZmF1bHRzID0gew0KICAgIGFuaW1hdGlvbjogdHJ1ZQ0KICAsIHBsYWNlbWVudDogJ3RvcCcNCiAgLCBzZWxlY3RvcjogZmFsc2UNCiAgLCB0ZW1wbGF0ZTogJzxkaXYgY2xhc3M9InRvb2x0aXAiPjxkaXYgY2xhc3M9InRvb2x0aXAtYXJyb3ciPjwvZGl2PjxkaXYgY2xhc3M9InRvb2x0aXAtaW5uZXIiPjwvZGl2PjwvZGl2PicNCiAgLCB0cmlnZ2VyOiAnaG92ZXInDQogICwgdGl0bGU6ICcnDQogICwgZGVsYXk6IDANCiAgLCBodG1sOiB0cnVlDQogIH0NCg0KfSh3aW5kb3cualF1ZXJ5KTsNCi8qID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQogKiBib290c3RyYXAtcG9wb3Zlci5qcyB2Mi4xLjENCiAqIGh0dHA6Ly90d2l0dGVyLmdpdGh1Yi5jb20vYm9vdHN0cmFwL2phdmFzY3JpcHQuaHRtbCNwb3BvdmVycw0KICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NCiAqIENvcHlyaWdodCAyMDEyIFR3aXR0ZXIsIEluYy4NCiAqDQogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsNCiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4NCiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdA0KICoNCiAqIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMA0KICoNCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUNCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsDQogKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4NCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQNCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLg0KICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi8NCg0KDQohZnVuY3Rpb24gKCQpIHsNCg0KICAidXNlIHN0cmljdCI7IC8vIGpzaGludCA7XzsNCg0KDQogLyogUE9QT1ZFUiBQVUJMSUMgQ0xBU1MgREVGSU5JVElPTg0KICAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi8NCg0KICB2YXIgUG9wb3ZlciA9IGZ1bmN0aW9uIChlbGVtZW50LCBvcHRpb25zKSB7DQogICAgdGhpcy5pbml0KCdwb3BvdmVyJywgZWxlbWVudCwgb3B0aW9ucykNCiAgfQ0KDQoNCiAgLyogTk9URTogUE9QT1ZFUiBFWFRFTkRTIEJPT1RTVFJBUC1UT09MVElQLmpzDQogICAgID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqLw0KDQogIFBvcG92ZXIucHJvdG90eXBlID0gJC5leHRlbmQoe30sICQuZm4udG9vbHRpcC5Db25zdHJ1Y3Rvci5wcm90b3R5cGUsIHsNCg0KICAgIGNvbnN0cnVjdG9yOiBQb3BvdmVyDQoNCiAgLCBzZXRDb250ZW50OiBmdW5jdGlvbiAoKSB7DQogICAgICB2YXIgJHRpcCA9IHRoaXMudGlwKCkNCiAgICAgICAgLCB0aXRsZSA9IHRoaXMuZ2V0VGl0bGUoKQ0KICAgICAgICAsIGNvbnRlbnQgPSB0aGlzLmdldENvbnRlbnQoKQ0KDQogICAgICAkdGlwLmZpbmQoJy5wb3BvdmVyLXRpdGxlJylbdGhpcy5vcHRpb25zLmh0bWwgPyAnaHRtbCcgOiAndGV4dCddKHRpdGxlKQ0KICAgICAgJHRpcC5maW5kKCcucG9wb3Zlci1jb250ZW50ID4gKicpW3RoaXMub3B0aW9ucy5odG1sID8gJ2h0bWwnIDogJ3RleHQnXShjb250ZW50KQ0KDQogICAgICAkdGlwLnJlbW92ZUNsYXNzKCdmYWRlIHRvcCBib3R0b20gbGVmdCByaWdodCBpbicpDQogICAgfQ0KDQogICwgaGFzQ29udGVudDogZnVuY3Rpb24gKCkgew0KICAgICAgcmV0dXJuIHRoaXMuZ2V0VGl0bGUoKSB8fCB0aGlzLmdldENvbnRlbnQoKQ0KICAgIH0NCg0KICAsIGdldENvbnRlbnQ6IGZ1bmN0aW9uICgpIHsNCiAgICAgIHZhciBjb250ZW50DQogICAgICAgICwgJGUgPSB0aGlzLiRlbGVtZW50DQogICAgICAgICwgbyA9IHRoaXMub3B0aW9ucw0KDQogICAgICBjb250ZW50ID0gJGUuYXR0cignZGF0YS1jb250ZW50JykNCiAgICAgICAgfHwgKHR5cGVvZiBvLmNvbnRlbnQgPT0gJ2Z1bmN0aW9uJyA/IG8uY29udGVudC5jYWxsKCRlWzBdKSA6ICBvLmNvbnRlbnQpDQoNCiAgICAgIHJldHVybiBjb250ZW50DQogICAgfQ0KDQogICwgdGlwOiBmdW5jdGlvbiAoKSB7DQogICAgICBpZiAoIXRoaXMuJHRpcCkgew0KICAgICAgICB0aGlzLiR0aXAgPSAkKHRoaXMub3B0aW9ucy50ZW1wbGF0ZSkNCiAgICAgIH0NCiAgICAgIHJldHVybiB0aGlzLiR0aXANCiAgICB9DQoNCiAgLCBkZXN0cm95OiBmdW5jdGlvbiAoKSB7DQogICAgICB0aGlzLmhpZGUoKS4kZWxlbWVudC5vZmYoJy4nICsgdGhpcy50eXBlKS5yZW1vdmVEYXRhKHRoaXMudHlwZSkNCiAgICB9DQoNCiAgfSkNCg0KDQogLyogUE9QT1ZFUiBQTFVHSU4gREVGSU5JVElPTg0KICAqID09PT09PT09PT09PT09PT09PT09PT09ICovDQoNCiAgJC5mbi5wb3BvdmVyID0gZnVuY3Rpb24gKG9wdGlvbikgew0KICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkgew0KICAgICAgdmFyICR0aGlzID0gJCh0aGlzKQ0KICAgICAgICAsIGRhdGEgPSAkdGhpcy5kYXRhKCdwb3BvdmVyJykNCiAgICAgICAgLCBvcHRpb25zID0gdHlwZW9mIG9wdGlvbiA9PSAnb2JqZWN0JyAmJiBvcHRpb24NCiAgICAgIGlmICghZGF0YSkgJHRoaXMuZGF0YSgncG9wb3ZlcicsIChkYXRhID0gbmV3IFBvcG92ZXIodGhpcywgb3B0aW9ucykpKQ0KICAgICAgaWYgKHR5cGVvZiBvcHRpb24gPT0gJ3N0cmluZycpIGRhdGFbb3B0aW9uXSgpDQogICAgfSkNCiAgfQ0KDQogICQuZm4ucG9wb3Zlci5Db25zdHJ1Y3RvciA9IFBvcG92ZXINCg0KICAkLmZuLnBvcG92ZXIuZGVmYXVsdHMgPSAkLmV4dGVuZCh7fSAsICQuZm4udG9vbHRpcC5kZWZhdWx0cywgew0KICAgIHBsYWNlbWVudDogJ3JpZ2h0Jw0KICAsIHRyaWdnZXI6ICdjbGljaycNCiAgLCBjb250ZW50OiAnJw0KICAsIHRlbXBsYXRlOiAnPGRpdiBjbGFzcz0icG9wb3ZlciI+PGRpdiBjbGFzcz0iYXJyb3ciPjwvZGl2PjxkaXYgY2xhc3M9InBvcG92ZXItaW5uZXIiPjxoMyBjbGFzcz0icG9wb3Zlci10aXRsZSI+PC9oMz48ZGl2IGNsYXNzPSJwb3BvdmVyLWNvbnRlbnQiPjxwPjwvcD48L2Rpdj48L2Rpdj48L2Rpdj4nDQogIH0pDQoNCn0od2luZG93LmpRdWVyeSk7LyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NCiAqIGJvb3RzdHJhcC10YWIuanMgdjIuMS4xDQogKiBodHRwOi8vdHdpdHRlci5naXRodWIuY29tL2Jvb3RzdHJhcC9qYXZhc2NyaXB0Lmh0bWwjdGFicw0KICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NCiAqIENvcHlyaWdodCAyMDEyIFR3aXR0ZXIsIEluYy4NCiAqDQogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsNCiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4NCiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdA0KICoNCiAqIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMA0KICoNCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUNCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsDQogKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4NCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQNCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLg0KICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0gKi8NCg0KDQohZnVuY3Rpb24gKCQpIHsNCg0KICAidXNlIHN0cmljdCI7IC8vIGpzaGludCA7XzsNCg0KDQogLyogVEFCIENMQVNTIERFRklOSVRJT04NCiAgKiA9PT09PT09PT09PT09PT09PT09PSAqLw0KDQogIHZhciBUYWIgPSBmdW5jdGlvbiAoZWxlbWVudCkgew0KICAgIHRoaXMuZWxlbWVudCA9ICQoZWxlbWVudCkNCiAgfQ0KDQogIFRhYi5wcm90b3R5cGUgPSB7DQoNCiAgICBjb25zdHJ1Y3RvcjogVGFiDQoNCiAgLCBzaG93OiBmdW5jdGlvbiAoKSB7DQogICAgICB2YXIgJHRoaXMgPSB0aGlzLmVsZW1lbnQNCiAgICAgICAgLCAkdWwgPSAkdGhpcy5jbG9zZXN0KCd1bDpub3QoLmRyb3Bkb3duLW1lbnUpJykNCiAgICAgICAgLCBzZWxlY3RvciA9ICR0aGlzLmF0dHIoJ2RhdGEtdGFyZ2V0JykNCiAgICAgICAgLCBwcmV2aW91cw0KICAgICAgICAsICR0YXJnZXQNCiAgICAgICAgLCBlDQoNCiAgICAgIGlmICghc2VsZWN0b3IpIHsNCiAgICAgICAgc2VsZWN0b3IgPSAkdGhpcy5hdHRyKCdocmVmJykNCiAgICAgICAgc2VsZWN0b3IgPSBzZWxlY3RvciAmJiBzZWxlY3Rvci5yZXBsYWNlKC8uKig/PSNbXlxzXSokKS8sICcnKSAvL3N0cmlwIGZvciBpZTcNCiAgICAgIH0NCg0KICAgICAgaWYgKCAkdGhpcy5wYXJlbnQoJ2xpJykuaGFzQ2xhc3MoJ2FjdGl2ZScpICkgcmV0dXJuDQoNCiAgICAgIHByZXZpb3VzID0gJHVsLmZpbmQoJy5hY3RpdmUgYScpLmxhc3QoKVswXQ0KDQogICAgICBlID0gJC5FdmVudCgnc2hvdycsIHsNCiAgICAgICAgcmVsYXRlZFRhcmdldDogcHJldmlvdXMNCiAgICAgIH0pDQoNCiAgICAgICR0aGlzLnRyaWdnZXIoZSkNCg0KICAgICAgaWYgKGUuaXNEZWZhdWx0UHJldmVudGVkKCkpIHJldHVybg0KDQogICAgICAkdGFyZ2V0ID0gJChzZWxlY3RvcikNCg0KICAgICAgdGhpcy5hY3RpdmF0ZSgkdGhpcy5wYXJlbnQoJ2xpJyksICR1bCkNCiAgICAgIHRoaXMuYWN0aXZhdGUoJHRhcmdldCwgJHRhcmdldC5wYXJlbnQoKSwgZnVuY3Rpb24gKCkgew0KICAgICAgICAkdGhpcy50cmlnZ2VyKHsNCiAgICAgICAgICB0eXBlOiAnc2hvd24nDQogICAgICAgICwgcmVsYXRlZFRhcmdldDogcHJldmlvdXMNCiAgICAgICAgfSkNCiAgICAgIH0pDQogICAgfQ0KDQogICwgYWN0aXZhdGU6IGZ1bmN0aW9uICggZWxlbWVudCwgY29udGFpbmVyLCBjYWxsYmFjaykgew0KICAgICAgdmFyICRhY3RpdmUgPSBjb250YWluZXIuZmluZCgnPiAuYWN0aXZlJykNCiAgICAgICAgLCB0cmFuc2l0aW9uID0gY2FsbGJhY2sNCiAgICAgICAgICAgICYmICQuc3VwcG9ydC50cmFuc2l0aW9uDQogICAgICAgICAgICAmJiAkYWN0aXZlLmhhc0NsYXNzKCdmYWRlJykNCg0KICAgICAgZnVuY3Rpb24gbmV4dCgpIHsNCiAgICAgICAgJGFjdGl2ZQ0KICAgICAgICAgIC5yZW1vdmVDbGFzcygnYWN0aXZlJykNCiAgICAgICAgICAuZmluZCgnPiAuZHJvcGRvd24tbWVudSA+IC5hY3RpdmUnKQ0KICAgICAgICAgIC5yZW1vdmVDbGFzcygnYWN0aXZlJykNCg0KICAgICAgICBlbGVtZW50LmFkZENsYXNzKCdhY3RpdmUnKQ0KDQogICAgICAgIGlmICh0cmFuc2l0aW9uKSB7DQogICAgICAgICAgZWxlbWVudFswXS5vZmZzZXRXaWR0aCAvLyByZWZsb3cgZm9yIHRyYW5zaXRpb24NCiAgICAgICAgICBlbGVtZW50LmFkZENsYXNzKCdpbicpDQogICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgZWxlbWVudC5yZW1vdmVDbGFzcygnZmFkZScpDQogICAgICAgIH0NCg0KICAgICAgICBpZiAoIGVsZW1lbnQucGFyZW50KCcuZHJvcGRvd24tbWVudScpICkgew0KICAgICAgICAgIGVsZW1lbnQuY2xvc2VzdCgnbGkuZHJvcGRvd24nKS5hZGRDbGFzcygnYWN0aXZlJykNCiAgICAgICAgfQ0KDQogICAgICAgIGNhbGxiYWNrICYmIGNhbGxiYWNrKCkNCiAgICAgIH0NCg0KICAgICAgdHJhbnNpdGlvbiA/DQogICAgICAgICRhY3RpdmUub25lKCQuc3VwcG9ydC50cmFuc2l0aW9uLmVuZCwgbmV4dCkgOg0KICAgICAgICBuZXh0KCkNCg0KICAgICAgJGFjdGl2ZS5yZW1vdmVDbGFzcygnaW4nKQ0KICAgIH0NCiAgfQ0KDQoNCiAvKiBUQUIgUExVR0lOIERFRklOSVRJT04NCiAgKiA9PT09PT09PT09PT09PT09PT09PT0gKi8NCg0KICAkLmZuLnRhYiA9IGZ1bmN0aW9uICggb3B0aW9uICkgew0KICAgIHJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkgew0KICAgICAgdmFyICR0aGlzID0gJCh0aGlzKQ0KICAgICAgICAsIGRhdGEgPSAkdGhpcy5kYXRhKCd0YWInKQ0KICAgICAgaWYgKCFkYXRhKSAkdGhpcy5kYXRhKCd0YWInLCAoZGF0YSA9IG5ldyBUYWIodGhpcykpKQ0KICAgICAgaWYgKHR5cGVvZiBvcHRpb24gPT0gJ3N0cmluZycpIGRhdGFbb3B0aW9uXSgpDQogICAgfSkNCiAgfQ0KDQogICQuZm4udGFiLkNvbnN0cnVjdG9yID0gVGFiDQoNCg0KIC8qIFRBQiBEQVRBLUFQSQ0KICAqID09PT09PT09PT09PSAqLw0KDQogICQoZnVuY3Rpb24gKCkgew0KICAgICQoJ2JvZHknKS5vbignY2xpY2sudGFiLmRhdGEtYXBpJywgJ1tkYXRhLXRvZ2dsZT0idGFiIl0sIFtkYXRhLXRvZ2dsZT0icGlsbCJdJywgZnVuY3Rpb24gKGUpIHsNCiAgICAgIGUucHJldmVudERlZmF1bHQoKQ0KICAgICAgJCh0aGlzKS50YWIoJ3Nob3cnKQ0KICAgIH0pDQogIH0pDQoNCn0od2luZG93LmpRdWVyeSk7Ow0KLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NCiAqIGJvb3RzdHJhcC1tb2RhbG1hbmFnZXIuanMgdjIuMi41DQogKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQ0KICogQ29weXJpZ2h0IDIwMTIgSm9yZGFuIFNjaHJvdGVyLg0KICoNCiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSAiTGljZW5zZSIpOw0KICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLg0KICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0DQogKg0KICogaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wDQogKg0KICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZQ0KICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gIkFTIElTIiBCQVNJUywNCiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLg0KICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZA0KICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuDQogKiA9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovDQoNCiFmdW5jdGlvbiAoJCkgew0KDQoJInVzZSBzdHJpY3QiOyAvLyBqc2hpbnQgO187DQoNCgkvKiBNT0RBTCBNQU5BR0VSIENMQVNTIERFRklOSVRJT04NCgkqID09PT09PT09PT09PT09PT09PT09PT0gKi8NCg0KCXZhciBNb2RhbE1hbmFnZXIgPSBmdW5jdGlvbiAoZWxlbWVudCwgb3B0aW9ucykgew0KCQl0aGlzLmluaXQoZWxlbWVudCwgb3B0aW9ucyk7DQoJfTsNCg0KCU1vZGFsTWFuYWdlci5wcm90b3R5cGUgPSB7DQoNCgkJY29uc3RydWN0b3I6IE1vZGFsTWFuYWdlciwNCg0KCQlpbml0OiBmdW5jdGlvbiAoZWxlbWVudCwgb3B0aW9ucykgew0KCQkJdGhpcy4kZWxlbWVudCA9ICQoZWxlbWVudCk7DQoJCQl0aGlzLm9wdGlvbnMgPSAkLmV4dGVuZCh7fSwgJC5mbi5tb2RhbG1hbmFnZXIuZGVmYXVsdHMsIHRoaXMuJGVsZW1lbnQuZGF0YSgpLCB0eXBlb2Ygb3B0aW9ucyA9PSAnb2JqZWN0JyAmJiBvcHRpb25zKTsNCgkJCXRoaXMuc3RhY2sgPSBbXTsNCgkJCXRoaXMuYmFja2Ryb3BDb3VudCA9IDA7DQoNCgkJCWlmICh0aGlzLm9wdGlvbnMucmVzaXplKSB7DQoJCQkJdmFyIHJlc2l6ZVRpbWVvdXQsDQoJCQkJCXRoYXQgPSB0aGlzOw0KDQoJCQkJJCh3aW5kb3cpLm9uKCdyZXNpemUubW9kYWwnLCBmdW5jdGlvbigpew0KCQkJCQlyZXNpemVUaW1lb3V0ICYmIGNsZWFyVGltZW91dChyZXNpemVUaW1lb3V0KTsNCgkJCQkJcmVzaXplVGltZW91dCA9IHNldFRpbWVvdXQoZnVuY3Rpb24oKXsNCgkJCQkJCWZvciAodmFyIGkgPSAwOyBpIDwgdGhhdC5zdGFjay5sZW5ndGg7IGkrKyl7DQoJCQkJCQkJdGhhdC5zdGFja1tpXS5pc1Nob3duICYmIHRoYXQuc3RhY2tbaV0ubGF5b3V0KCk7DQoJCQkJCQl9DQoJCQkJCX0sIDEwKTsNCgkJCQl9KTsNCgkJCX0NCgkJfSwNCg0KCQljcmVhdGVNb2RhbDogZnVuY3Rpb24gKGVsZW1lbnQsIG9wdGlvbnMpIHsNCgkJCSQoZWxlbWVudCkubW9kYWwoJC5leHRlbmQoeyBtYW5hZ2VyOiB0aGlzIH0sIG9wdGlvbnMpKTsNCgkJfSwNCg0KCQlhcHBlbmRNb2RhbDogZnVuY3Rpb24gKG1vZGFsKSB7DQoJCQl0aGlzLnN0YWNrLnB1c2gobW9kYWwpOw0KDQoJCQl2YXIgdGhhdCA9IHRoaXM7DQoNCgkJCW1vZGFsLiRlbGVtZW50Lm9uKCdzaG93Lm1vZGFsbWFuYWdlcicsIHRhcmdldElzU2VsZihmdW5jdGlvbiAoZSkgew0KDQoJCQkJdmFyIHNob3dNb2RhbCA9IGZ1bmN0aW9uKCl7DQoJCQkJCW1vZGFsLmlzU2hvd24gPSB0cnVlOw0KDQoJCQkJCXZhciB0cmFuc2l0aW9uID0gJC5zdXBwb3J0LnRyYW5zaXRpb24gJiYgbW9kYWwuJGVsZW1lbnQuaGFzQ2xhc3MoJ2ZhZGUnKTsNCg0KCQkJCQl0aGF0LiRlbGVtZW50DQoJCQkJCQkudG9nZ2xlQ2xhc3MoJ21vZGFsLW9wZW4nLCB0aGF0Lmhhc09wZW5Nb2RhbCgpKQ0KCQkJCQkJLnRvZ2dsZUNsYXNzKCdwYWdlLW92ZXJmbG93JywgJCh3aW5kb3cpLmhlaWdodCgpIDwgdGhhdC4kZWxlbWVudC5oZWlnaHQoKSk7DQoNCgkJCQkJbW9kYWwuJHBhcmVudCA9IG1vZGFsLiRlbGVtZW50LnBhcmVudCgpOw0KDQoJCQkJCW1vZGFsLiRjb250YWluZXIgPSB0aGF0LmNyZWF0ZUNvbnRhaW5lcihtb2RhbCk7DQoNCgkJCQkJbW9kYWwuJGVsZW1lbnQuYXBwZW5kVG8obW9kYWwuJGNvbnRhaW5lcik7DQoNCgkJCQkJdGhhdC5iYWNrZHJvcChtb2RhbCwgZnVuY3Rpb24gKCkgew0KCQkJCQkJbW9kYWwuJGVsZW1lbnQuc2hvdygpOw0KDQoJCQkJCQlpZiAodHJhbnNpdGlvbikgeyAgICAgICANCgkJCQkJCQkvL21vZGFsLiRlbGVtZW50WzBdLnN0eWxlLmRpc3BsYXkgPSAncnVuLWluJzsgICAgICAgDQoJCQkJCQkJbW9kYWwuJGVsZW1lbnRbMF0ub2Zmc2V0V2lkdGg7DQoJCQkJCQkJLy9tb2RhbC4kZWxlbWVudC5vbmUoJC5zdXBwb3J0LnRyYW5zaXRpb24uZW5kLCBmdW5jdGlvbiAoKSB7IG1vZGFsLiRlbGVtZW50WzBdLnN0eWxlLmRpc3BsYXkgPSAnYmxvY2snIH0pOyAgDQoJCQkJCQl9DQoJCQkJCQkNCgkJCQkJCW1vZGFsLmxheW91dCgpOw0KDQoJCQkJCQltb2RhbC4kZWxlbWVudA0KCQkJCQkJCS5hZGRDbGFzcygnaW4nKQ0KCQkJCQkJCS5hdHRyKCdhcmlhLWhpZGRlbicsIGZhbHNlKTsNCg0KCQkJCQkJdmFyIGNvbXBsZXRlID0gZnVuY3Rpb24gKCkgew0KCQkJCQkJCXRoYXQuc2V0Rm9jdXMoKTsNCgkJCQkJCQltb2RhbC4kZWxlbWVudC50cmlnZ2VyKCdzaG93bicpOw0KCQkJCQkJfTsNCg0KCQkJCQkJdHJhbnNpdGlvbiA/DQoJCQkJCQkJbW9kYWwuJGVsZW1lbnQub25lKCQuc3VwcG9ydC50cmFuc2l0aW9uLmVuZCwgY29tcGxldGUpIDoNCgkJCQkJCQljb21wbGV0ZSgpOw0KCQkJCQl9KTsNCgkJCQl9Ow0KDQoJCQkJbW9kYWwub3B0aW9ucy5yZXBsYWNlID8NCgkJCQkJdGhhdC5yZXBsYWNlKHNob3dNb2RhbCkgOg0KCQkJCQlzaG93TW9kYWwoKTsNCgkJCX0pKTsNCg0KCQkJbW9kYWwuJGVsZW1lbnQub24oJ2hpZGRlbi5tb2RhbG1hbmFnZXInLCB0YXJnZXRJc1NlbGYoZnVuY3Rpb24gKGUpIHsNCgkJCQl0aGF0LmJhY2tkcm9wKG1vZGFsKTsNCgkJCQkvLyBoYW5kbGUgdGhlIGNhc2Ugd2hlbiBhIG1vZGFsIG1heSBoYXZlIGJlZW4gcmVtb3ZlZCBmcm9tIHRoZSBkb20gYmVmb3JlIHRoaXMgY2FsbGJhY2sgZXhlY3V0ZXMNCgkJCQlpZiAoIW1vZGFsLiRlbGVtZW50LnBhcmVudCgpLmxlbmd0aCkgew0KCQkJCQl0aGF0LmRlc3Ryb3lNb2RhbChtb2RhbCk7DQoJCQkJfSBlbHNlIGlmIChtb2RhbC4kYmFja2Ryb3Apew0KCQkJCQl2YXIgdHJhbnNpdGlvbiA9ICQuc3VwcG9ydC50cmFuc2l0aW9uICYmIG1vZGFsLiRlbGVtZW50Lmhhc0NsYXNzKCdmYWRlJyk7DQoNCgkJCQkJLy8gdHJpZ2dlciBhIHJlbGF5b3V0IGR1ZSB0byBmaXJlYm94J3MgYnVnZ3kgdHJhbnNpdGlvbiBlbmQgZXZlbnQgDQoJCQkJCWlmICh0cmFuc2l0aW9uKSB7IG1vZGFsLiRlbGVtZW50WzBdLm9mZnNldFdpZHRoOyB9DQoJCQkJCSQuc3VwcG9ydC50cmFuc2l0aW9uICYmIG1vZGFsLiRlbGVtZW50Lmhhc0NsYXNzKCdmYWRlJykgPw0KCQkJCQkJbW9kYWwuJGJhY2tkcm9wLm9uZSgkLnN1cHBvcnQudHJhbnNpdGlvbi5lbmQsIGZ1bmN0aW9uICgpIHsgbW9kYWwuZGVzdHJveSgpOyB9KSA6DQoJCQkJCQltb2RhbC5kZXN0cm95KCk7DQoJCQkJfSBlbHNlIHsNCgkJCQkJbW9kYWwuZGVzdHJveSgpOw0KCQkJCX0NCg0KCQkJfSkpOw0KDQoJCQltb2RhbC4kZWxlbWVudC5vbignZGVzdHJveWVkLm1vZGFsbWFuYWdlcicsIHRhcmdldElzU2VsZihmdW5jdGlvbiAoZSkgew0KCQkJCXRoYXQuZGVzdHJveU1vZGFsKG1vZGFsKTsNCgkJCX0pKTsNCgkJfSwNCg0KCQlnZXRPcGVuTW9kYWxzOiBmdW5jdGlvbiAoKSB7DQoJCQl2YXIgb3Blbk1vZGFscyA9IFtdOw0KCQkJZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnN0YWNrLmxlbmd0aDsgaSsrKXsNCgkJCQlpZiAodGhpcy5zdGFja1tpXS5pc1Nob3duKSBvcGVuTW9kYWxzLnB1c2godGhpcy5zdGFja1tpXSk7DQoJCQl9DQoNCgkJCXJldHVybiBvcGVuTW9kYWxzOw0KCQl9LA0KDQoJCWhhc09wZW5Nb2RhbDogZnVuY3Rpb24gKCkgew0KCQkJcmV0dXJuIHRoaXMuZ2V0T3Blbk1vZGFscygpLmxlbmd0aCA+IDA7DQoJCX0sDQoNCgkJc2V0Rm9jdXM6IGZ1bmN0aW9uICgpIHsNCgkJCXZhciB0b3BNb2RhbDsNCg0KCQkJZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnN0YWNrLmxlbmd0aDsgaSsrKXsNCgkJCQlpZiAodGhpcy5zdGFja1tpXS5pc1Nob3duKSB0b3BNb2RhbCA9IHRoaXMuc3RhY2tbaV07DQoJCQl9DQoNCgkJCWlmICghdG9wTW9kYWwpIHJldHVybjsNCg0KCQkJdG9wTW9kYWwuZm9jdXMoKTsNCgkJfSwNCg0KCQlkZXN0cm95TW9kYWw6IGZ1bmN0aW9uIChtb2RhbCkgew0KCQkJbW9kYWwuJGVsZW1lbnQub2ZmKCcubW9kYWxtYW5hZ2VyJyk7DQoJCQlpZiAobW9kYWwuJGJhY2tkcm9wKSB0aGlzLnJlbW92ZUJhY2tkcm9wKG1vZGFsKTsNCgkJCXRoaXMuc3RhY2suc3BsaWNlKHRoaXMuZ2V0SW5kZXhPZk1vZGFsKG1vZGFsKSwgMSk7DQoNCgkJCXZhciBoYXNPcGVuTW9kYWwgPSB0aGlzLmhhc09wZW5Nb2RhbCgpOw0KDQoJCQl0aGlzLiRlbGVtZW50LnRvZ2dsZUNsYXNzKCdtb2RhbC1vcGVuJywgaGFzT3Blbk1vZGFsKTsNCg0KCQkJaWYgKCFoYXNPcGVuTW9kYWwpew0KCQkJCXRoaXMuJGVsZW1lbnQucmVtb3ZlQ2xhc3MoJ3BhZ2Utb3ZlcmZsb3cnKTsNCgkJCX0NCg0KCQkJdGhpcy5yZW1vdmVDb250YWluZXIobW9kYWwpOw0KDQoJCQl0aGlzLnNldEZvY3VzKCk7DQoJCX0sDQoNCgkJZ2V0TW9kYWxBdDogZnVuY3Rpb24gKGluZGV4KSB7DQoJCQlyZXR1cm4gdGhpcy5zdGFja1tpbmRleF07DQoJCX0sDQoNCgkJZ2V0SW5kZXhPZk1vZGFsOiBmdW5jdGlvbiAobW9kYWwpIHsNCgkJCWZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5zdGFjay5sZW5ndGg7IGkrKyl7DQoJCQkJaWYgKG1vZGFsID09PSB0aGlzLnN0YWNrW2ldKSByZXR1cm4gaTsNCgkJCX0NCgkJfSwNCg0KCQlyZXBsYWNlOiBmdW5jdGlvbiAoY2FsbGJhY2spIHsNCgkJCXZhciB0b3BNb2RhbDsNCg0KCQkJZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLnN0YWNrLmxlbmd0aDsgaSsrKXsNCgkJCQlpZiAodGhpcy5zdGFja1tpXS5pc1Nob3duKSB0b3BNb2RhbCA9IHRoaXMuc3RhY2tbaV07DQoJCQl9DQoNCgkJCWlmICh0b3BNb2RhbCkgew0KCQkJCXRoaXMuJGJhY2tkcm9wSGFuZGxlID0gdG9wTW9kYWwuJGJhY2tkcm9wOw0KCQkJCXRvcE1vZGFsLiRiYWNrZHJvcCA9IG51bGw7DQoNCgkJCQljYWxsYmFjayAmJiB0b3BNb2RhbC4kZWxlbWVudC5vbmUoJ2hpZGRlbicsDQoJCQkJCXRhcmdldElzU2VsZiggJC5wcm94eShjYWxsYmFjaywgdGhpcykgKSk7DQoNCgkJCQl0b3BNb2RhbC5oaWRlKCk7DQoJCQl9IGVsc2UgaWYgKGNhbGxiYWNrKSB7DQoJCQkJY2FsbGJhY2soKTsNCgkJCX0NCgkJfSwNCg0KCQlyZW1vdmVCYWNrZHJvcDogZnVuY3Rpb24gKG1vZGFsKSB7DQoJCQltb2RhbC4kYmFja2Ryb3AucmVtb3ZlKCk7DQoJCQltb2RhbC4kYmFja2Ryb3AgPSBudWxsOw0KCQl9LA0KDQoJCWNyZWF0ZUJhY2tkcm9wOiBmdW5jdGlvbiAoYW5pbWF0ZSwgdG1wbCkgew0KCQkJdmFyICRiYWNrZHJvcDsNCg0KCQkJaWYgKCF0aGlzLiRiYWNrZHJvcEhhbmRsZSkgew0KCQkJCSRiYWNrZHJvcCA9ICQodG1wbCkNCgkJCQkJLmFkZENsYXNzKGFuaW1hdGUpDQoJCQkJCS5hcHBlbmRUbyh0aGlzLiRlbGVtZW50KTsNCgkJCX0gZWxzZSB7DQoJCQkJJGJhY2tkcm9wID0gdGhpcy4kYmFja2Ryb3BIYW5kbGU7DQoJCQkJJGJhY2tkcm9wLm9mZignLm1vZGFsbWFuYWdlcicpOw0KCQkJCXRoaXMuJGJhY2tkcm9wSGFuZGxlID0gbnVsbDsNCgkJCQl0aGlzLmlzTG9hZGluZyAmJiB0aGlzLnJlbW92ZVNwaW5uZXIoKTsNCgkJCX0NCg0KCQkJcmV0dXJuICRiYWNrZHJvcDsNCgkJfSwNCg0KCQlyZW1vdmVDb250YWluZXI6IGZ1bmN0aW9uIChtb2RhbCkgew0KCQkJbW9kYWwuJGNvbnRhaW5lci5yZW1vdmUoKTsNCgkJCW1vZGFsLiRjb250YWluZXIgPSBudWxsOw0KCQl9LA0KDQoJCWNyZWF0ZUNvbnRhaW5lcjogZnVuY3Rpb24gKG1vZGFsKSB7DQoJCQl2YXIgJGNvbnRhaW5lcjsNCg0KCQkJJGNvbnRhaW5lciA9ICQoJzxkaXYgY2xhc3M9Im1vZGFsLXNjcm9sbGFibGUiPicpDQoJCQkJLmNzcygnei1pbmRleCcsIGdldHpJbmRleCgnbW9kYWwnLCB0aGlzLmdldE9wZW5Nb2RhbHMoKS5sZW5ndGgpKQ0KCQkJCS5hcHBlbmRUbyh0aGlzLiRlbGVtZW50KTsNCg0KCQkJaWYgKG1vZGFsICYmIG1vZGFsLm9wdGlvbnMuYmFja2Ryb3AgIT0gJ3N0YXRpYycpIHsNCgkJCQkkY29udGFpbmVyLm9uKCdjbGljay5tb2RhbCcsIHRhcmdldElzU2VsZihmdW5jdGlvbiAoZSkgew0KCQkJCQltb2RhbC5oaWRlKCk7DQoJCQkJfSkpOw0KCQkJfSBlbHNlIGlmIChtb2RhbCkgew0KCQkJCSRjb250YWluZXIub24oJ2NsaWNrLm1vZGFsJywgdGFyZ2V0SXNTZWxmKGZ1bmN0aW9uIChlKSB7DQoJCQkJCW1vZGFsLmF0dGVudGlvbigpOw0KCQkJCX0pKTsNCgkJCX0NCg0KCQkJcmV0dXJuICRjb250YWluZXI7DQoNCgkJfSwNCg0KCQliYWNrZHJvcDogZnVuY3Rpb24gKG1vZGFsLCBjYWxsYmFjaykgew0KCQkJdmFyIGFuaW1hdGUgPSBtb2RhbC4kZWxlbWVudC5oYXNDbGFzcygnZmFkZScpID8gJ2ZhZGUnIDogJycsDQoJCQkJc2hvd0JhY2tkcm9wID0gbW9kYWwub3B0aW9ucy5iYWNrZHJvcCAmJg0KCQkJCQl0aGlzLmJhY2tkcm9wQ291bnQgPCB0aGlzLm9wdGlvbnMuYmFja2Ryb3BMaW1pdDsNCg0KCQkJaWYgKG1vZGFsLmlzU2hvd24gJiYgc2hvd0JhY2tkcm9wKSB7DQoJCQkJdmFyIGRvQW5pbWF0ZSA9ICQuc3VwcG9ydC50cmFuc2l0aW9uICYmIGFuaW1hdGUgJiYgIXRoaXMuJGJhY2tkcm9wSGFuZGxlOw0KDQoJCQkJbW9kYWwuJGJhY2tkcm9wID0gdGhpcy5jcmVhdGVCYWNrZHJvcChhbmltYXRlLCBtb2RhbC5vcHRpb25zLmJhY2tkcm9wVGVtcGxhdGUpOw0KDQoJCQkJbW9kYWwuJGJhY2tkcm9wLmNzcygnei1pbmRleCcsIGdldHpJbmRleCggJ2JhY2tkcm9wJywgdGhpcy5nZXRPcGVuTW9kYWxzKCkubGVuZ3RoICkpOw0KDQoJCQkJaWYgKGRvQW5pbWF0ZSkgbW9kYWwuJGJhY2tkcm9wWzBdLm9mZnNldFdpZHRoOyAvLyBmb3JjZSByZWZsb3cNCg0KCQkJCW1vZGFsLiRiYWNrZHJvcC5hZGRDbGFzcygnaW4nKTsNCg0KCQkJCXRoaXMuYmFja2Ryb3BDb3VudCArPSAxOw0KDQoJCQkJZG9BbmltYXRlID8NCgkJCQkJbW9kYWwuJGJhY2tkcm9wLm9uZSgkLnN1cHBvcnQudHJhbnNpdGlvbi5lbmQsIGNhbGxiYWNrKSA6DQoJCQkJCWNhbGxiYWNrKCk7DQoNCgkJCX0gZWxzZSBpZiAoIW1vZGFsLmlzU2hvd24gJiYgbW9kYWwuJGJhY2tkcm9wKSB7DQoJCQkJbW9kYWwuJGJhY2tkcm9wLnJlbW92ZUNsYXNzKCdpbicpOw0KDQoJCQkJdGhpcy5iYWNrZHJvcENvdW50IC09IDE7DQoNCgkJCQl2YXIgdGhhdCA9IHRoaXM7DQoNCgkJCQkkLnN1cHBvcnQudHJhbnNpdGlvbiAmJiBtb2RhbC4kZWxlbWVudC5oYXNDbGFzcygnZmFkZScpPw0KCQkJCQltb2RhbC4kYmFja2Ryb3Aub25lKCQuc3VwcG9ydC50cmFuc2l0aW9uLmVuZCwgZnVuY3Rpb24gKCkgeyB0aGF0LnJlbW92ZUJhY2tkcm9wKG1vZGFsKSB9KSA6DQoJCQkJCXRoYXQucmVtb3ZlQmFja2Ryb3AobW9kYWwpOw0KDQoJCQl9IGVsc2UgaWYgKGNhbGxiYWNrKSB7DQoJCQkJY2FsbGJhY2soKTsNCgkJCX0NCgkJfSwNCg0KCQlyZW1vdmVTcGlubmVyOiBmdW5jdGlvbigpew0KCQkJdGhpcy4kc3Bpbm5lciAmJiB0aGlzLiRzcGlubmVyLnJlbW92ZSgpOw0KCQkJdGhpcy4kc3Bpbm5lciA9IG51bGw7DQoJCQl0aGlzLmlzTG9hZGluZyA9IGZhbHNlOw0KCQl9LA0KDQoJCXJlbW92ZUxvYWRpbmc6IGZ1bmN0aW9uICgpIHsNCgkJCXRoaXMuJGJhY2tkcm9wSGFuZGxlICYmIHRoaXMuJGJhY2tkcm9wSGFuZGxlLnJlbW92ZSgpOw0KCQkJdGhpcy4kYmFja2Ryb3BIYW5kbGUgPSBudWxsOw0KCQkJdGhpcy5yZW1vdmVTcGlubmVyKCk7DQoJCX0sDQoNCgkJbG9hZGluZzogZnVuY3Rpb24gKGNhbGxiYWNrKSB7DQoJCQljYWxsYmFjayA9IGNhbGxiYWNrIHx8IGZ1bmN0aW9uICgpIHsgfTsNCg0KCQkJdGhpcy4kZWxlbWVudA0KCQkJCS50b2dnbGVDbGFzcygnbW9kYWwtb3BlbicsICF0aGlzLmlzTG9hZGluZyB8fCB0aGlzLmhhc09wZW5Nb2RhbCgpKQ0KCQkJCS50b2dnbGVDbGFzcygncGFnZS1vdmVyZmxvdycsICQod2luZG93KS5oZWlnaHQoKSA8IHRoaXMuJGVsZW1lbnQuaGVpZ2h0KCkpOw0KDQoJCQlpZiAoIXRoaXMuaXNMb2FkaW5nKSB7DQoNCgkJCQl0aGlzLiRiYWNrZHJvcEhhbmRsZSA9IHRoaXMuY3JlYXRlQmFja2Ryb3AoJ2ZhZGUnLCB0aGlzLm9wdGlvbnMuYmFja2Ryb3BUZW1wbGF0ZSk7DQoNCgkJCQl0aGlzLiRiYWNrZHJvcEhhbmRsZVswXS5vZmZzZXRXaWR0aDsgLy8gZm9yY2UgcmVmbG93DQoNCgkJCQl2YXIgb3Blbk1vZGFscyA9IHRoaXMuZ2V0T3Blbk1vZGFscygpOw0KDQoJCQkJdGhpcy4kYmFja2Ryb3BIYW5kbGUNCgkJCQkJLmNzcygnei1pbmRleCcsIGdldHpJbmRleCgnYmFja2Ryb3AnLCBvcGVuTW9kYWxzLmxlbmd0aCArIDEpKQ0KCQkJCQkuYWRkQ2xhc3MoJ2luJyk7DQoNCgkJCQl2YXIgJHNwaW5uZXIgPSAkKHRoaXMub3B0aW9ucy5zcGlubmVyKQ0KCQkJCQkuY3NzKCd6LWluZGV4JywgZ2V0ekluZGV4KCdtb2RhbCcsIG9wZW5Nb2RhbHMubGVuZ3RoICsgMSkpDQoJCQkJCS5hcHBlbmRUbyh0aGlzLiRlbGVtZW50KQ0KCQkJCQkuYWRkQ2xhc3MoJ2luJyk7DQoNCgkJCQl0aGlzLiRzcGlubmVyID0gJCh0aGlzLmNyZWF0ZUNvbnRhaW5lcigpKQ0KCQkJCQkuYXBwZW5kKCRzcGlubmVyKQ0KCQkJCQkub24oJ2NsaWNrLm1vZGFsbWFuYWdlcicsICQucHJveHkodGhpcy5sb2FkaW5nLCB0aGlzKSk7DQoNCgkJCQl0aGlzLmlzTG9hZGluZyA9IHRydWU7DQoNCgkJCQkkLnN1cHBvcnQudHJhbnNpdGlvbiA/DQoJCQkJCXRoaXMuJGJhY2tkcm9wSGFuZGxlLm9uZSgkLnN1cHBvcnQudHJhbnNpdGlvbi5lbmQsIGNhbGxiYWNrKSA6DQoJCQkJCWNhbGxiYWNrKCk7DQoNCgkJCX0gZWxzZSBpZiAodGhpcy5pc0xvYWRpbmcgJiYgdGhpcy4kYmFja2Ryb3BIYW5kbGUpIHsNCgkJCQl0aGlzLiRiYWNrZHJvcEhhbmRsZS5yZW1vdmVDbGFzcygnaW4nKTsNCg0KCQkJCXZhciB0aGF0ID0gdGhpczsNCgkJCQkkLnN1cHBvcnQudHJhbnNpdGlvbiA/DQoJCQkJCXRoaXMuJGJhY2tkcm9wSGFuZGxlLm9uZSgkLnN1cHBvcnQudHJhbnNpdGlvbi5lbmQsIGZ1bmN0aW9uICgpIHsgdGhhdC5yZW1vdmVMb2FkaW5nKCkgfSkgOg0KCQkJCQl0aGF0LnJlbW92ZUxvYWRpbmcoKTsNCg0KCQkJfSBlbHNlIGlmIChjYWxsYmFjaykgew0KCQkJCWNhbGxiYWNrKHRoaXMuaXNMb2FkaW5nKTsNCgkJCX0NCgkJfQ0KCX07DQoNCgkvKiBQUklWQVRFIE1FVEhPRFMNCgkqID09PT09PT09PT09PT09PT09PT09PT09ICovDQoNCgkvLyBjb21wdXRlcyBhbmQgY2FjaGVzIHRoZSB6aW5kZXhlcw0KCXZhciBnZXR6SW5kZXggPSAoZnVuY3Rpb24gKCkgew0KCQl2YXIgekluZGV4RmFjdG9yLA0KCQkJYmFzZUluZGV4ID0ge307DQoNCgkJcmV0dXJuIGZ1bmN0aW9uICh0eXBlLCBwb3MpIHsNCg0KCQkJaWYgKHR5cGVvZiB6SW5kZXhGYWN0b3IgPT09ICd1bmRlZmluZWQnKXsNCgkJCQl2YXIgJGJhc2VNb2RhbCA9ICQoJzxkaXYgY2xhc3M9Im1vZGFsIGhpZGUiIC8+JykuYXBwZW5kVG8oJ2JvZHknKSwNCgkJCQkJJGJhc2VCYWNrZHJvcCA9ICQoJzxkaXYgY2xhc3M9Im1vZGFsLWJhY2tkcm9wIGhpZGUiIC8+JykuYXBwZW5kVG8oJ2JvZHknKTsNCg0KCQkJCWJhc2VJbmRleFsnbW9kYWwnXSA9ICskYmFzZU1vZGFsLmNzcygnei1pbmRleCcpOw0KCQkJCWJhc2VJbmRleFsnYmFja2Ryb3AnXSA9ICskYmFzZUJhY2tkcm9wLmNzcygnei1pbmRleCcpOw0KCQkJCXpJbmRleEZhY3RvciA9IGJhc2VJbmRleFsnbW9kYWwnXSAtIGJhc2VJbmRleFsnYmFja2Ryb3AnXTsNCg0KCQkJCSRiYXNlTW9kYWwucmVtb3ZlKCk7DQoJCQkJJGJhc2VCYWNrZHJvcC5yZW1vdmUoKTsNCgkJCQkkYmFzZUJhY2tkcm9wID0gJGJhc2VNb2RhbCA9IG51bGw7DQoJCQl9DQoNCgkJCXJldHVybiBiYXNlSW5kZXhbdHlwZV0gKyAoekluZGV4RmFjdG9yICogcG9zKTsNCg0KCQl9DQoJfSgpKTsNCg0KCS8vIG1ha2Ugc3VyZSB0aGUgZXZlbnQgdGFyZ2V0IGlzIHRoZSBtb2RhbCBpdHNlbGYgaW4gb3JkZXIgdG8gcHJldmVudA0KCS8vIG90aGVyIGNvbXBvbmVudHMgc3VjaCBhcyB0YWJzZnJvbSB0cmlnZ2VyaW5nIHRoZSBtb2RhbCBtYW5hZ2VyLg0KCS8vIGlmIEJvb3N0c3JhcCBuYW1lc3BhY2VkIGV2ZW50cywgdGhpcyB3b3VsZCBub3QgYmUgbmVlZGVkLg0KCWZ1bmN0aW9uIHRhcmdldElzU2VsZihjYWxsYmFjayl7DQoJCXJldHVybiBmdW5jdGlvbiAoZSkgew0KCQkJaWYgKGUgJiYgdGhpcyA9PT0gZS50YXJnZXQpew0KCQkJCXJldHVybiBjYWxsYmFjay5hcHBseSh0aGlzLCBhcmd1bWVudHMpOw0KCQkJfQ0KCQl9DQoJfQ0KDQoNCgkvKiBNT0RBTCBNQU5BR0VSIFBMVUdJTiBERUZJTklUSU9ODQoJKiA9PT09PT09PT09PT09PT09PT09PT09PSAqLw0KDQoJJC5mbi5tb2RhbG1hbmFnZXIgPSBmdW5jdGlvbiAob3B0aW9uLCBhcmdzKSB7DQoJCXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkgew0KCQkJdmFyICR0aGlzID0gJCh0aGlzKSwNCgkJCQlkYXRhID0gJHRoaXMuZGF0YSgnbW9kYWxtYW5hZ2VyJyk7DQoNCgkJCWlmICghZGF0YSkgJHRoaXMuZGF0YSgnbW9kYWxtYW5hZ2VyJywgKGRhdGEgPSBuZXcgTW9kYWxNYW5hZ2VyKHRoaXMsIG9wdGlvbikpKTsNCgkJCWlmICh0eXBlb2Ygb3B0aW9uID09PSAnc3RyaW5nJykgZGF0YVtvcHRpb25dLmFwcGx5KGRhdGEsIFtdLmNvbmNhdChhcmdzKSkNCgkJfSkNCgl9Ow0KDQoJJC5mbi5tb2RhbG1hbmFnZXIuZGVmYXVsdHMgPSB7DQoJCWJhY2tkcm9wTGltaXQ6IDk5OSwNCgkJcmVzaXplOiB0cnVlLA0KCQlzcGlubmVyOiAnPGRpdiBjbGFzcz0ibG9hZGluZy1zcGlubmVyIGZhZGUiIHN0eWxlPSJ3aWR0aDogMjAwcHg7IG1hcmdpbi1sZWZ0OiAtMTAwcHg7Ij48ZGl2IGNsYXNzPSJwcm9ncmVzcyBwcm9ncmVzcy1zdHJpcGVkIGFjdGl2ZSI+PGRpdiBjbGFzcz0iYmFyIiBzdHlsZT0id2lkdGg6IDEwMCU7Ij48L2Rpdj48L2Rpdj48L2Rpdj4nLA0KCQliYWNrZHJvcFRlbXBsYXRlOiAnPGRpdiBjbGFzcz0ibW9kYWwtYmFja2Ryb3AiIC8+Jw0KCX07DQoNCgkkLmZuLm1vZGFsbWFuYWdlci5Db25zdHJ1Y3RvciA9IE1vZGFsTWFuYWdlcg0KDQoJLy8gTW9kYWxNYW5hZ2VyIGhhbmRsZXMgdGhlIG1vZGFsLW9wZW4gY2xhc3Mgc28gd2UgbmVlZCANCgkvLyB0byByZW1vdmUgY29uZmxpY3RpbmcgYm9vdHN0cmFwIDMgZXZlbnQgaGFuZGxlcnMNCgkkKGZ1bmN0aW9uICgpIHsNCgkJJChkb2N1bWVudCkub2ZmKCdzaG93LmJzLm1vZGFsJykub2ZmKCdoaWRkZW4uYnMubW9kYWwnKTsNCgl9KTsNCg0KfShqUXVlcnkpOw0KOw0KLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NCiAqIGJvb3RzdHJhcC1tb2RhbC5qcyB2Mi4yLjUNCiAqID09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQogKiBDb3B5cmlnaHQgMjAxMiBKb3JkYW4gU2Nocm90ZXINCiAqDQogKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgIkxpY2Vuc2UiKTsNCiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4NCiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdA0KICoNCiAqIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMA0KICoNCiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmUNCiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuICJBUyBJUyIgQkFTSVMsDQogKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC4NCiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmQNCiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLg0KICogPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqLw0KDQoNCiFmdW5jdGlvbiAoJCkgew0KDQoJInVzZSBzdHJpY3QiOyAvLyBqc2hpbnQgO187DQoNCgkvKiBNT0RBTCBDTEFTUyBERUZJTklUSU9ODQoJKiA9PT09PT09PT09PT09PT09PT09PT09ICovDQoNCgl2YXIgTW9kYWwgPSBmdW5jdGlvbiAoZWxlbWVudCwgb3B0aW9ucykgew0KCQl0aGlzLmluaXQoZWxlbWVudCwgb3B0aW9ucyk7DQoJfTsNCg0KCU1vZGFsLnByb3RvdHlwZSA9IHsNCg0KCQljb25zdHJ1Y3RvcjogTW9kYWwsDQoNCgkJaW5pdDogZnVuY3Rpb24gKGVsZW1lbnQsIG9wdGlvbnMpIHsNCgkJCXZhciB0aGF0ID0gdGhpczsNCg0KCQkJdGhpcy5vcHRpb25zID0gb3B0aW9uczsNCg0KCQkJdGhpcy4kZWxlbWVudCA9ICQoZWxlbWVudCkNCgkJCQkuZGVsZWdhdGUoJ1tkYXRhLWRpc21pc3M9Im1vZGFsIl0nLCAnY2xpY2suZGlzbWlzcy5tb2RhbCcsICQucHJveHkodGhpcy5oaWRlLCB0aGlzKSk7DQoNCgkJCXRoaXMub3B0aW9ucy5yZW1vdGUgJiYgdGhpcy4kZWxlbWVudC5maW5kKCcubW9kYWwtYm9keScpLmxvYWQodGhpcy5vcHRpb25zLnJlbW90ZSwgZnVuY3Rpb24gKCkgew0KCQkJCXZhciBlID0gJC5FdmVudCgnbG9hZGVkJyk7DQoJCQkJdGhhdC4kZWxlbWVudC50cmlnZ2VyKGUpOw0KCQkJfSk7DQoNCgkJCXZhciBtYW5hZ2VyID0gdHlwZW9mIHRoaXMub3B0aW9ucy5tYW5hZ2VyID09PSAnZnVuY3Rpb24nID8NCgkJCQl0aGlzLm9wdGlvbnMubWFuYWdlci5jYWxsKHRoaXMpIDogdGhpcy5vcHRpb25zLm1hbmFnZXI7DQoNCgkJCW1hbmFnZXIgPSBtYW5hZ2VyLmFwcGVuZE1vZGFsID8NCgkJCQltYW5hZ2VyIDogJChtYW5hZ2VyKS5tb2RhbG1hbmFnZXIoKS5kYXRhKCdtb2RhbG1hbmFnZXInKTsNCg0KCQkJbWFuYWdlci5hcHBlbmRNb2RhbCh0aGlzKTsNCgkJfSwNCg0KCQl0b2dnbGU6IGZ1bmN0aW9uICgpIHsNCgkJCXJldHVybiB0aGlzWyF0aGlzLmlzU2hvd24gPyAnc2hvdycgOiAnaGlkZSddKCk7DQoJCX0sDQoNCgkJc2hvdzogZnVuY3Rpb24gKCkgew0KCQkJdmFyIGUgPSAkLkV2ZW50KCdzaG93Jyk7DQoNCgkJCWlmICh0aGlzLmlzU2hvd24pIHJldHVybjsNCg0KCQkJdGhpcy4kZWxlbWVudC50cmlnZ2VyKGUpOw0KDQoJCQlpZiAoZS5pc0RlZmF1bHRQcmV2ZW50ZWQoKSkgcmV0dXJuOw0KDQoJCQl0aGlzLmVzY2FwZSgpOw0KDQoJCQl0aGlzLnRhYigpOw0KDQoJCQl0aGlzLm9wdGlvbnMubG9hZGluZyAmJiB0aGlzLmxvYWRpbmcoKTsNCgkJfSwNCg0KCQloaWRlOiBmdW5jdGlvbiAoZSkgew0KCQkJZSAmJiBlLnByZXZlbnREZWZhdWx0KCk7DQoNCgkJCWUgPSAkLkV2ZW50KCdoaWRlJyk7DQoNCgkJCXRoaXMuJGVsZW1lbnQudHJpZ2dlcihlKTsNCg0KCQkJaWYgKCF0aGlzLmlzU2hvd24gfHwgZS5pc0RlZmF1bHRQcmV2ZW50ZWQoKSkgcmV0dXJuOw0KDQoJCQl0aGlzLmlzU2hvd24gPSBmYWxzZTsNCg0KCQkJdGhpcy5lc2NhcGUoKTsNCg0KCQkJdGhpcy50YWIoKTsNCg0KCQkJdGhpcy5pc0xvYWRpbmcgJiYgdGhpcy5sb2FkaW5nKCk7DQoNCgkJCSQoZG9jdW1lbnQpLm9mZignZm9jdXNpbi5tb2RhbCcpOw0KDQoJCQl0aGlzLiRlbGVtZW50DQoJCQkJLnJlbW92ZUNsYXNzKCdpbicpDQoJCQkJLnJlbW92ZUNsYXNzKCdhbmltYXRlZCcpDQoJCQkJLnJlbW92ZUNsYXNzKHRoaXMub3B0aW9ucy5hdHRlbnRpb25BbmltYXRpb24pDQoJCQkJLnJlbW92ZUNsYXNzKCdtb2RhbC1vdmVyZmxvdycpDQoJCQkJLmF0dHIoJ2FyaWEtaGlkZGVuJywgdHJ1ZSk7DQoNCgkJCSQuc3VwcG9ydC50cmFuc2l0aW9uICYmIHRoaXMuJGVsZW1lbnQuaGFzQ2xhc3MoJ2ZhZGUnKSA/DQoJCQkJdGhpcy5oaWRlV2l0aFRyYW5zaXRpb24oKSA6DQoJCQkJdGhpcy5oaWRlTW9kYWwoKTsNCgkJfSwNCg0KCQlsYXlvdXQ6IGZ1bmN0aW9uICgpIHsNCgkJCXZhciBwcm9wID0gdGhpcy5vcHRpb25zLmhlaWdodCA/ICdoZWlnaHQnIDogJ21heC1oZWlnaHQnLA0KCQkJCXZhbHVlID0gdGhpcy5vcHRpb25zLmhlaWdodCB8fCB0aGlzLm9wdGlvbnMubWF4SGVpZ2h0Ow0KDQoJCQlpZiAodGhpcy5vcHRpb25zLndpZHRoKXsNCgkJCQl0aGlzLiRlbGVtZW50LmNzcygnd2lkdGgnLCB0aGlzLm9wdGlvbnMud2lkdGgpOw0KDQoJCQkJdmFyIHRoYXQgPSB0aGlzOw0KCQkJCXRoaXMuJGVsZW1lbnQuY3NzKCdtYXJnaW4tbGVmdCcsIGZ1bmN0aW9uICgpIHsNCgkJCQkJaWYgKC8lL2lnLnRlc3QodGhhdC5vcHRpb25zLndpZHRoKSl7DQoJCQkJCQlyZXR1cm4gLShwYXJzZUludCh0aGF0Lm9wdGlvbnMud2lkdGgpIC8gMikgKyAnJSc7DQoJCQkJCX0gZWxzZSB7DQoJCQkJCQlyZXR1cm4gLSgkKHRoaXMpLndpZHRoKCkgLyAyKSArICdweCc7DQoJCQkJCX0NCgkJCQl9KTsNCgkJCX0gZWxzZSB7DQoJCQkJdGhpcy4kZWxlbWVudC5jc3MoJ3dpZHRoJywgJycpOw0KCQkJCXRoaXMuJGVsZW1lbnQuY3NzKCdtYXJnaW4tbGVmdCcsICcnKTsNCgkJCX0NCg0KCQkJdGhpcy4kZWxlbWVudC5maW5kKCcubW9kYWwtYm9keScpDQoJCQkJLmNzcygnb3ZlcmZsb3cnLCAnJykNCgkJCQkuY3NzKHByb3AsICcnKTsNCg0KCQkJaWYgKHZhbHVlKXsNCgkJCQl0aGlzLiRlbGVtZW50LmZpbmQoJy5tb2RhbC1ib2R5JykNCgkJCQkJLmNzcygnb3ZlcmZsb3cnLCAnYXV0bycpDQoJCQkJCS5jc3MocHJvcCwgdmFsdWUpOw0KCQkJfQ0KDQoJCQl2YXIgbW9kYWxPdmVyZmxvdyA9ICQod2luZG93KS5oZWlnaHQoKSAtIDEwIDwgdGhpcy4kZWxlbWVudC5oZWlnaHQoKTsNCiAgICAgICAgICAgIA0KCQkJaWYgKG1vZGFsT3ZlcmZsb3cgfHwgdGhpcy5vcHRpb25zLm1vZGFsT3ZlcmZsb3cpIHsNCgkJCQl0aGlzLiRlbGVtZW50DQoJCQkJCS5jc3MoJ21hcmdpbi10b3AnLCAwKQ0KCQkJCQkuYWRkQ2xhc3MoJ21vZGFsLW92ZXJmbG93Jyk7DQoJCQl9IGVsc2Ugew0KCQkJCXRoaXMuJGVsZW1lbnQNCgkJCQkJLmNzcygnbWFyZ2luLXRvcCcsIDAgLSB0aGlzLiRlbGVtZW50LmhlaWdodCgpIC8gMikNCgkJCQkJLnJlbW92ZUNsYXNzKCdtb2RhbC1vdmVyZmxvdycpOw0KCQkJfQ0KCQl9LA0KDQoJCXRhYjogZnVuY3Rpb24gKCkgew0KCQkJdmFyIHRoYXQgPSB0aGlzOw0KDQoJCQlpZiAodGhpcy5pc1Nob3duICYmIHRoaXMub3B0aW9ucy5jb25zdW1lVGFiKSB7DQoJCQkJdGhpcy4kZWxlbWVudC5vbigna2V5ZG93bi50YWJpbmRleC5tb2RhbCcsICdbZGF0YS10YWJpbmRleF0nLCBmdW5jdGlvbiAoZSkgew0KCQkJICAgIAlpZiAoZS5rZXlDb2RlICYmIGUua2V5Q29kZSA9PSA5KXsNCgkJCQkJCXZhciBlbGVtZW50cyA9IFtdLA0KCQkJCQkJCXRhYmluZGV4ID0gTnVtYmVyKCQodGhpcykuZGF0YSgndGFiaW5kZXgnKSk7DQoNCgkJCQkJCXRoYXQuJGVsZW1lbnQuZmluZCgnW2RhdGEtdGFiaW5kZXhdOmVuYWJsZWQ6dmlzaWJsZTpub3QoW3JlYWRvbmx5XSknKS5lYWNoKGZ1bmN0aW9uIChldikgew0KCQkJCQkJCWVsZW1lbnRzLnB1c2goTnVtYmVyKCQodGhpcykuZGF0YSgndGFiaW5kZXgnKSkpOw0KCQkJCQkJfSk7DQoJCQkJCQllbGVtZW50cy5zb3J0KGZ1bmN0aW9uKGEsYil7cmV0dXJuIGEtYn0pOw0KCQkJCQkJDQoJCQkJCQl2YXIgYXJyYXlQb3MgPSAkLmluQXJyYXkodGFiaW5kZXgsIGVsZW1lbnRzKTsNCgkJCQkJCWlmICghZS5zaGlmdEtleSl7DQoJCQkJCQkgCQlhcnJheVBvcyA8IGVsZW1lbnRzLmxlbmd0aC0xID8NCgkJCQkJCQkJCXRoYXQuJGVsZW1lbnQuZmluZCgnW2RhdGEtdGFiaW5kZXg9JytlbGVtZW50c1thcnJheVBvcysxXSsnXScpLmZvY3VzKCkgOg0KCQkJCQkJCQkJdGhhdC4kZWxlbWVudC5maW5kKCdbZGF0YS10YWJpbmRleD0nK2VsZW1lbnRzWzBdKyddJykuZm9jdXMoKTsNCgkJCQkJCQl9IGVsc2Ugew0KCQkJCQkJCQlhcnJheVBvcyA9PSAwID8NCgkJCQkJCQkJCXRoYXQuJGVsZW1lbnQuZmluZCgnW2RhdGEtdGFiaW5kZXg9JytlbGVtZW50c1tlbGVtZW50cy5sZW5ndGgtMV0rJ10nKS5mb2N1cygpIDoNCgkJCQkJCQkJCXRoYXQuJGVsZW1lbnQuZmluZCgnW2RhdGEtdGFiaW5kZXg9JytlbGVtZW50c1thcnJheVBvcy0xXSsnXScpLmZvY3VzKCk7DQoJCQkJCQkJfQ0KCQkJCQkJDQoJCQkJCQllLnByZXZlbnREZWZhdWx0KCk7DQoJCQkJCX0NCgkJCQl9KTsNCgkJCX0gZWxzZSBpZiAoIXRoaXMuaXNTaG93bikgew0KCQkJCXRoaXMuJGVsZW1lbnQub2ZmKCdrZXlkb3duLnRhYmluZGV4Lm1vZGFsJyk7DQoJCQl9DQoJCX0sDQoNCgkJZXNjYXBlOiBmdW5jdGlvbiAoKSB7DQoJCQl2YXIgdGhhdCA9IHRoaXM7DQoJCQlpZiAodGhpcy5pc1Nob3duICYmIHRoaXMub3B0aW9ucy5rZXlib2FyZCkgew0KCQkJCWlmICghdGhpcy4kZWxlbWVudC5hdHRyKCd0YWJpbmRleCcpKSB0aGlzLiRlbGVtZW50LmF0dHIoJ3RhYmluZGV4JywgLTEpOw0KDQoJCQkJdGhpcy4kZWxlbWVudC5vbigna2V5dXAuZGlzbWlzcy5tb2RhbCcsIGZ1bmN0aW9uIChlKSB7DQoJCQkJCWUud2hpY2ggPT0gMjcgJiYgdGhhdC5oaWRlKCk7DQoJCQkJfSk7DQoJCQl9IGVsc2UgaWYgKCF0aGlzLmlzU2hvd24pIHsNCgkJCQl0aGlzLiRlbGVtZW50Lm9mZigna2V5dXAuZGlzbWlzcy5tb2RhbCcpDQoJCQl9DQoJCX0sDQoNCgkJaGlkZVdpdGhUcmFuc2l0aW9uOiBmdW5jdGlvbiAoKSB7DQoJCQl2YXIgdGhhdCA9IHRoaXMNCgkJCQksIHRpbWVvdXQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsNCgkJCQkJdGhhdC4kZWxlbWVudC5vZmYoJC5zdXBwb3J0LnRyYW5zaXRpb24uZW5kKTsNCgkJCQkJdGhhdC5oaWRlTW9kYWwoKTsNCgkJCQl9LCA1MDApOw0KDQoJCQl0aGlzLiRlbGVtZW50Lm9uZSgkLnN1cHBvcnQudHJhbnNpdGlvbi5lbmQsIGZ1bmN0aW9uICgpIHsNCgkJCQljbGVhclRpbWVvdXQodGltZW91dCk7DQoJCQkJdGhhdC5oaWRlTW9kYWwoKTsNCgkJCX0pOw0KCQl9LA0KDQoJCWhpZGVNb2RhbDogZnVuY3Rpb24gKCkgew0KCQkJdmFyIHByb3AgPSB0aGlzLm9wdGlvbnMuaGVpZ2h0ID8gJ2hlaWdodCcgOiAnbWF4LWhlaWdodCc7DQoJCQl2YXIgdmFsdWUgPSB0aGlzLm9wdGlvbnMuaGVpZ2h0IHx8IHRoaXMub3B0aW9ucy5tYXhIZWlnaHQ7DQoNCgkJCWlmICh2YWx1ZSl7DQoJCQkJdGhpcy4kZWxlbWVudC5maW5kKCcubW9kYWwtYm9keScpDQoJCQkJCS5jc3MoJ292ZXJmbG93JywgJycpDQoJCQkJCS5jc3MocHJvcCwgJycpOw0KCQkJfQ0KDQoJCQl0aGlzLiRlbGVtZW50DQoJCQkJLmhpZGUoKQ0KCQkJCS50cmlnZ2VyKCdoaWRkZW4nKTsNCgkJfSwNCg0KCQlyZW1vdmVMb2FkaW5nOiBmdW5jdGlvbiAoKSB7DQoJCQl0aGlzLiRsb2FkaW5nLnJlbW92ZSgpOw0KCQkJdGhpcy4kbG9hZGluZyA9IG51bGw7DQoJCQl0aGlzLmlzTG9hZGluZyA9IGZhbHNlOw0KCQl9LA0KDQoJCWxvYWRpbmc6IGZ1bmN0aW9uIChjYWxsYmFjaykgew0KCQkJY2FsbGJhY2sgPSBjYWxsYmFjayB8fCBmdW5jdGlvbiAoKSB7fTsNCg0KCQkJdmFyIGFuaW1hdGUgPSB0aGlzLiRlbGVtZW50Lmhhc0NsYXNzKCdmYWRlJykgPyAnZmFkZScgOiAnJzsNCg0KCQkJaWYgKCF0aGlzLmlzTG9hZGluZykgew0KCQkJCXZhciBkb0FuaW1hdGUgPSAkLnN1cHBvcnQudHJhbnNpdGlvbiAmJiBhbmltYXRlOw0KDQoJCQkJdGhpcy4kbG9hZGluZyA9ICQoJzxkaXYgY2xhc3M9ImxvYWRpbmctbWFzayAnICsgYW5pbWF0ZSArICciPicpDQoJCQkJCS5hcHBlbmQodGhpcy5vcHRpb25zLnNwaW5uZXIpDQoJCQkJCS5hcHBlbmRUbyh0aGlzLiRlbGVtZW50KTsNCg0KCQkJCWlmIChkb0FuaW1hdGUpIHRoaXMuJGxvYWRpbmdbMF0ub2Zmc2V0V2lkdGg7IC8vIGZvcmNlIHJlZmxvdw0KDQoJCQkJdGhpcy4kbG9hZGluZy5hZGRDbGFzcygnaW4nKTsNCg0KCQkJCXRoaXMuaXNMb2FkaW5nID0gdHJ1ZTsNCg0KCQkJCWRvQW5pbWF0ZSA/DQoJCQkJCXRoaXMuJGxvYWRpbmcub25lKCQuc3VwcG9ydC50cmFuc2l0aW9uLmVuZCwgY2FsbGJhY2spIDoNCgkJCQkJY2FsbGJhY2soKTsNCg0KCQkJfSBlbHNlIGlmICh0aGlzLmlzTG9hZGluZyAmJiB0aGlzLiRsb2FkaW5nKSB7DQoJCQkJdGhpcy4kbG9hZGluZy5yZW1vdmVDbGFzcygnaW4nKTsNCg0KCQkJCXZhciB0aGF0ID0gdGhpczsNCgkJCQkkLnN1cHBvcnQudHJhbnNpdGlvbiAmJiB0aGlzLiRlbGVtZW50Lmhhc0NsYXNzKCdmYWRlJyk/DQoJCQkJCXRoaXMuJGxvYWRpbmcub25lKCQuc3VwcG9ydC50cmFuc2l0aW9uLmVuZCwgZnVuY3Rpb24gKCkgeyB0aGF0LnJlbW92ZUxvYWRpbmcoKSB9KSA6DQoJCQkJCXRoYXQucmVtb3ZlTG9hZGluZygpOw0KDQoJCQl9IGVsc2UgaWYgKGNhbGxiYWNrKSB7DQoJCQkJY2FsbGJhY2sodGhpcy5pc0xvYWRpbmcpOw0KCQkJfQ0KCQl9LA0KDQoJCWZvY3VzOiBmdW5jdGlvbiAoKSB7DQoJCQl2YXIgJGZvY3VzRWxlbSA9IHRoaXMuJGVsZW1lbnQuZmluZCh0aGlzLm9wdGlvbnMuZm9jdXNPbik7DQoNCgkJCSRmb2N1c0VsZW0gPSAkZm9jdXNFbGVtLmxlbmd0aCA/ICRmb2N1c0VsZW0gOiB0aGlzLiRlbGVtZW50Ow0KDQoJCQkkZm9jdXNFbGVtLmZvY3VzKCk7DQoJCX0sDQoNCgkJYXR0ZW50aW9uOiBmdW5jdGlvbiAoKXsNCgkJCS8vIE5PVEU6IHRyYW5zaXRpb25FbmQgd2l0aCBrZXlmcmFtZXMgY2F1c2VzIG9kZCBiZWhhdmlvdXINCg0KCQkJaWYgKHRoaXMub3B0aW9ucy5hdHRlbnRpb25BbmltYXRpb24pew0KCQkJCXRoaXMuJGVsZW1lbnQNCgkJCQkJLnJlbW92ZUNsYXNzKCdhbmltYXRlZCcpDQoJCQkJCS5yZW1vdmVDbGFzcyh0aGlzLm9wdGlvbnMuYXR0ZW50aW9uQW5pbWF0aW9uKTsNCg0KCQkJCXZhciB0aGF0ID0gdGhpczsNCg0KCQkJCXNldFRpbWVvdXQoZnVuY3Rpb24gKCkgew0KCQkJCQl0aGF0LiRlbGVtZW50DQoJCQkJCQkuYWRkQ2xhc3MoJ2FuaW1hdGVkJykNCgkJCQkJCS5hZGRDbGFzcyh0aGF0Lm9wdGlvbnMuYXR0ZW50aW9uQW5pbWF0aW9uKTsNCgkJCQl9LCAwKTsNCgkJCX0NCg0KDQoJCQl0aGlzLmZvY3VzKCk7DQoJCX0sDQoNCg0KCQlkZXN0cm95OiBmdW5jdGlvbiAoKSB7DQoJCQl2YXIgZSA9ICQuRXZlbnQoJ2Rlc3Ryb3knKTsNCg0KCQkJdGhpcy4kZWxlbWVudC50cmlnZ2VyKGUpOw0KDQoJCQlpZiAoZS5pc0RlZmF1bHRQcmV2ZW50ZWQoKSkgcmV0dXJuOw0KDQoJCQl0aGlzLiRlbGVtZW50DQoJCQkJLm9mZignLm1vZGFsJykNCgkJCQkucmVtb3ZlRGF0YSgnbW9kYWwnKQ0KCQkJCS5yZW1vdmVDbGFzcygnaW4nKQ0KCQkJCS5hdHRyKCdhcmlhLWhpZGRlbicsIHRydWUpOw0KCQkJDQoJCQlpZiAodGhpcy4kcGFyZW50ICE9PSB0aGlzLiRlbGVtZW50LnBhcmVudCgpKSB7DQoJCQkJdGhpcy4kZWxlbWVudC5hcHBlbmRUbyh0aGlzLiRwYXJlbnQpOw0KCQkJfSBlbHNlIGlmICghdGhpcy4kcGFyZW50Lmxlbmd0aCkgew0KCQkJCS8vIG1vZGFsIGlzIG5vdCBwYXJ0IG9mIHRoZSBET00gc28gcmVtb3ZlIGl0Lg0KCQkJCXRoaXMuJGVsZW1lbnQucmVtb3ZlKCk7DQoJCQkJdGhpcy4kZWxlbWVudCA9IG51bGw7DQoJCQl9DQoNCgkJCXRoaXMuJGVsZW1lbnQudHJpZ2dlcignZGVzdHJveWVkJyk7DQoJCX0NCgl9Ow0KDQoNCgkvKiBNT0RBTCBQTFVHSU4gREVGSU5JVElPTg0KCSogPT09PT09PT09PT09PT09PT09PT09PT0gKi8NCg0KCSQuZm4ubW9kYWwgPSBmdW5jdGlvbiAob3B0aW9uLCBhcmdzKSB7DQoJCXJldHVybiB0aGlzLmVhY2goZnVuY3Rpb24gKCkgew0KCQkJdmFyICR0aGlzID0gJCh0aGlzKSwNCgkJCQlkYXRhID0gJHRoaXMuZGF0YSgnbW9kYWwnKSwNCgkJCQlvcHRpb25zID0gJC5leHRlbmQoe30sICQuZm4ubW9kYWwuZGVmYXVsdHMsICR0aGlzLmRhdGEoKSwgdHlwZW9mIG9wdGlvbiA9PSAnb2JqZWN0JyAmJiBvcHRpb24pOw0KDQoJCQlpZiAoIWRhdGEpICR0aGlzLmRhdGEoJ21vZGFsJywgKGRhdGEgPSBuZXcgTW9kYWwodGhpcywgb3B0aW9ucykpKTsNCgkJCWlmICh0eXBlb2Ygb3B0aW9uID09ICdzdHJpbmcnKSBkYXRhW29wdGlvbl0uYXBwbHkoZGF0YSwgW10uY29uY2F0KGFyZ3MpKTsNCgkJCWVsc2UgaWYgKG9wdGlvbnMuc2hvdykgZGF0YS5zaG93KCkNCgkJfSkNCgl9Ow0KDQoJJC5mbi5tb2RhbC5kZWZhdWx0cyA9IHsNCgkJa2V5Ym9hcmQ6IHRydWUsDQoJCWJhY2tkcm9wOiB0cnVlLA0KCQlsb2FkaW5nOiBmYWxzZSwNCgkJc2hvdzogdHJ1ZSwNCgkJd2lkdGg6IG51bGwsDQoJCWhlaWdodDogbnVsbCwNCgkJbWF4SGVpZ2h0OiBudWxsLA0KCQltb2RhbE92ZXJmbG93OiBmYWxzZSwNCgkJY29uc3VtZVRhYjogdHJ1ZSwNCgkJZm9jdXNPbjogbnVsbCwNCgkJcmVwbGFjZTogZmFsc2UsDQoJCXJlc2l6ZTogZmFsc2UsDQoJCWF0dGVudGlvbkFuaW1hdGlvbjogJ3NoYWtlJywNCgkJbWFuYWdlcjogJ2JvZHknLA0KCQlzcGlubmVyOiAnPGRpdiBjbGFzcz0ibG9hZGluZy1zcGlubmVyIiBzdHlsZT0id2lkdGg6IDIwMHB4OyBtYXJnaW4tbGVmdDogLTEwMHB4OyI+PGRpdiBjbGFzcz0icHJvZ3Jlc3MgcHJvZ3Jlc3Mtc3RyaXBlZCBhY3RpdmUiPjxkaXYgY2xhc3M9ImJhciIgc3R5bGU9IndpZHRoOiAxMDAlOyI+PC9kaXY+PC9kaXY+PC9kaXY+JywNCgkJYmFja2Ryb3BUZW1wbGF0ZTogJzxkaXYgY2xhc3M9Im1vZGFsLWJhY2tkcm9wIiAvPicNCgl9Ow0KDQoJJC5mbi5tb2RhbC5Db25zdHJ1Y3RvciA9IE1vZGFsOw0KDQoNCgkvKiBNT0RBTCBEQVRBLUFQSQ0KCSogPT09PT09PT09PT09PT0gKi8NCg0KCSQoZnVuY3Rpb24gKCkgew0KCQkkKGRvY3VtZW50KS5vZmYoJ2NsaWNrLm1vZGFsJykub24oJ2NsaWNrLm1vZGFsLmRhdGEtYXBpJywgJ1tkYXRhLXRvZ2dsZT0ibW9kYWwiXScsIGZ1bmN0aW9uICggZSApIHsNCgkJCXZhciAkdGhpcyA9ICQodGhpcyksDQoJCQkJaHJlZiA9ICR0aGlzLmF0dHIoJ2hyZWYnKSwNCgkJCQkkdGFyZ2V0ID0gJCgkdGhpcy5hdHRyKCdkYXRhLXRhcmdldCcpIHx8IChocmVmICYmIGhyZWYucmVwbGFjZSgvLiooPz0jW15cc10rJCkvLCAnJykpKSwgLy9zdHJpcCBmb3IgaWU3DQoJCQkJb3B0aW9uID0gJHRhcmdldC5kYXRhKCdtb2RhbCcpID8gJ3RvZ2dsZScgOiAkLmV4dGVuZCh7IHJlbW90ZTogIS8jLy50ZXN0KGhyZWYpICYmIGhyZWYgfSwgJHRhcmdldC5kYXRhKCksICR0aGlzLmRhdGEoKSk7DQoNCgkJCWUucHJldmVudERlZmF1bHQoKTsNCgkJCSR0YXJnZXQNCgkJCQkubW9kYWwob3B0aW9uKQ0KCQkJCS5vbmUoJ2hpZGUnLCBmdW5jdGlvbiAoKSB7DQoJCQkJCSR0aGlzLmZvY3VzKCk7DQoJCQkJfSkNCgkJfSk7DQoJfSk7DQoNCn0od2luZG93LmpRdWVyeSk7DQo7DQovKioNCiAqIFVBbGJlcnRhIFV0aWxpdGllcw0KICogQXV0aG9yOiBLeWxlIFNjaG1pZHQgLSBreWxlLnNjaG1pZHRAdWFsYmVydGEuY2ENCiAqLw0KDQovLyBidWlsZCBuYW1lc3BhY2UNCnZhciBVQWxiZXJ0YSA9IFVBbGJlcnRhIHx8IHt9Ow0KVUFsYmVydGEuU2l0ZWNvcmUgPSBVQWxiZXJ0YS5TaXRlY29yZSB8fCB7fTsNCg0KVUFsYmVydGEuU2l0ZWNvcmUuVXRpbGl0aWVzID0gVUFsYmVydGEuU2l0ZWNvcmUuVXRpbGl0aWVzIHx8IChmdW5jdGlvbiAoJCkgew0KICAgICd1c2Ugc3RyaWN0JzsNCg0KICAgIHZhciBXaW5kb3dUeXBlID0gew0KICAgICAgICBNb2JpbGU6ICJtb2JpbGUiLA0KICAgICAgICBUYWJsZXQ6ICJ0YWJsZXQiLA0KICAgICAgICBEZXNrdG9wOiAiZGVza3RvcCIsDQogICAgICAgIEhpZ2hyZXM6ICJoaWdoLXJlc29sdXRpb24iDQogICAgfTsNCg0KICAgIHZhciBEYXRlRm9ybWF0ID0gew0KICAgICAgICBVbml4OiAieXl5eS1NTS1kZCBISDptbTpzcyIsDQogICAgICAgIFVuaXhEYXRlT25seTogInl5eXktTU0tZGQiLA0KICAgICAgICBMb25nOiAiTU1NTSBkLCB5eXl5IGg6bW0gYSIsDQogICAgICAgIExvbmdOb1llYXI6ICJNTU1NIGQgaDptbSBhIiwNCiAgICAgICAgU2hvcnQ6ICJNTU1NIGQsIHl5eXkiLA0KICAgICAgICBTaG9ydE5vWWVhcjogIk1NTU0gZCIsDQogICAgICAgIFRpbWVPbmx5OiAiaDptbSBhIiwNCiAgICAgICAgVGltZXN0YW1wOiAidGltZXN0YW1wIg0KICAgIH07DQoNCiAgICAvLyBjYWxsIGEgZnVuY3Rpb24gYWZ0ZXIgYW4gaW50ZXJ2YWwgaGFzIHBhc3NlZA0KICAgIHZhciBkZWxheSA9IChmdW5jdGlvbiAoKSB7DQogICAgICAgIHZhciB0aW1lcnMgPSB7fTsNCiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIChjYWxsYmFjaywgdGltZSwgaWQpIHsNCiAgICAgICAgICAgIGlmKHRpbWVyc1tpZF0pIHsNCiAgICAgICAgICAgICAgICBjbGVhclRpbWVvdXQodGltZXJzW2lkXSk7DQogICAgICAgICAgICB9DQogICAgICAgICAgICB0aW1lcnNbaWRdID0gc2V0VGltZW91dChjYWxsYmFjaywgdGltZSk7DQogICAgICAgIH07DQogICAgfSkoKTsNCg0KICAgIC8vIGdldCB0aGUgd2luZG93IHR5cGUNCiAgICBmdW5jdGlvbiBnZXRXaW5kb3dUeXBlKCkgew0KICAgICAgICB2YXIgd2lkdGggPSAkKHdpbmRvdykud2lkdGgoKTsNCg0KICAgICAgICBpZih3aWR0aCA8IDY5MCkgew0KICAgICAgICAgICAgcmV0dXJuIFdpbmRvd1R5cGUuTW9iaWxlOw0KICAgICAgICB9DQogICAgICAgIGlmKHdpZHRoIDwgOTgwKSB7DQogICAgICAgICAgICByZXR1cm4gV2luZG93VHlwZS5UYWJsZXQ7DQogICAgICAgIH0NCiAgICAgICAgaWYod2lkdGggPCAxMjAwKSB7DQogICAgICAgICAgICByZXR1cm4gV2luZG93VHlwZS5EZXNrdG9wOw0KICAgICAgICB9DQogICAgICAgIHJldHVybiBXaW5kb3dUeXBlLkhpZ2hyZXM7DQogICAgfQ0KDQogICAgLy8gZ2V0IGRhdGUgZnJvbSBqc29uIHN0cmluZw0KICAgIGZ1bmN0aW9uIGdldERhdGVGcm9tSnNvbihqc29uU3RyaW5nLCBmb3JtYXQpIHsNCiAgICAgICAgaWYoanNvblN0cmluZyA9PSB1bmRlZmluZWQgfHwgZm9ybWF0ID09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgcmV0dXJuICIiOw0KICAgICAgICB9DQoNCiAgICAgICAgdmFyIGRhdGUgPSBuZXcgRGF0ZShwYXJzZUludChqc29uU3RyaW5nLnN1YnN0cig2KSkpLmdldFRpbWUoKTsNCg0KICAgICAgICBpZihmb3JtYXQgPT0gRGF0ZUZvcm1hdC5UaW1lc3RhbXApIHsNCiAgICAgICAgICAgIHJldHVybiBkYXRlOw0KICAgICAgICB9DQoNCiAgICAgICAgcmV0dXJuICQuZm9ybWF0LmRhdGUoZGF0ZSwgZm9ybWF0KTsNCiAgICB9DQoNCiAgICAvLyBtdWx0aXNlbGVjdCBidXR0b24gdGV4dA0KICAgIGZ1bmN0aW9uIG11bHRpc2VsZWN0QnV0dG9uVGV4dChvcHRpb25zLCBzZWxlY3QpIHsNCiAgICAgICAgaWYgKG9wdGlvbnMubGVuZ3RoID09IDApIHsNCiAgICAgICAgICAgIHJldHVybiAnU2hvdyBBbGwgPGIgY2xhc3M9ImNhcmV0Ij48L2I+JzsNCiAgICAgICAgfSBlbHNlIGlmIChvcHRpb25zLmxlbmd0aCA+IDIpIHsNCiAgICAgICAgICAgIHJldHVybiBvcHRpb25zLmxlbmd0aCArICcgc2VsZWN0ZWQgPGIgY2xhc3M9ImNhcmV0Ij48L2I+JzsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHZhciBzZWxlY3RlZCA9ICcnOw0KICAgICAgICAgICAgb3B0aW9ucy5lYWNoKGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgIHNlbGVjdGVkICs9ICQodGhpcykudGV4dCgpICsgJywgJzsNCiAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgcmV0dXJuIHNlbGVjdGVkLnN1YnN0cigwLCBzZWxlY3RlZC5sZW5ndGggLTIpICsgJyA8YiBjbGFzcz0iY2FyZXQiPjwvYj4nOw0KICAgICAgICB9DQogICAgfQ0KDQogICAgcmV0dXJuIHsNCiAgICAgICAgV2luZG93VHlwZTogV2luZG93VHlwZSwNCiAgICAgICAgRGF0ZUZvcm1hdDogRGF0ZUZvcm1hdCwNCiAgICAgICAgRGVsYXk6IGRlbGF5LA0KICAgICAgICBHZXRXaW5kb3dUeXBlOiBnZXRXaW5kb3dUeXBlLA0KICAgICAgICBHZXREYXRlRnJvbUpzb246IGdldERhdGVGcm9tSnNvbiwNCiAgICAgICAgTXVsdGlzZWxlY3RCdXR0b25UZXh0OiBtdWx0aXNlbGVjdEJ1dHRvblRleHQNCiAgICB9DQp9KShqUXVlcnkpOw0KOw0KKGZ1bmN0aW9uICgkKSB7DQogICAgJC5mbi5EZXZpY2VJbWFnZVNjYWxpbmcgPSBmdW5jdGlvbiAob3B0aW9ucykgew0KICAgICAgICB2YXIgZGVmT3B0aW9ucyA9IHsNCiAgICAgICAgICAgIHNtV2lkdGg6IDQ4MCwNCiAgICAgICAgICAgIG1XaWR0aDogNjkwLA0KICAgICAgICAgICAgdFdpZHRoOiA5ODAsDQogICAgICAgICAgICBkV2lkdGg6IDEyMDAsDQogICAgICAgICAgICBjb250ZW50SUQ6ICJsYXlvdXRjb250YWluZXIiDQogICAgICAgIH07DQogICAgICAgIGRlZk9wdGlvbnMgPSAkLmV4dGVuZChkZWZPcHRpb25zLCBvcHRpb25zKTsNCiAgICAgICAgcmV0dXJuIHRoaXMuZWFjaChmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICB2YXIgdnBXaWR0aCA9ICQoIiMiICsgZGVmT3B0aW9ucy5jb250ZW50SUQpLndpZHRoKCksIHR5cGUgPSAiIjsNCiAgICAgICAgICAgIGlmICh2cFdpZHRoIDw9IGRlZk9wdGlvbnMuc21XaWR0aCkgew0KICAgICAgICAgICAgICAgIHR5cGUgPSAic21hbGxtb2JpbGUiOw0KICAgICAgICAgICAgfQ0KICAgICAgICAgICAgZWxzZSBpZiAodnBXaWR0aCA8PSBkZWZPcHRpb25zLm1XaWR0aCkgew0KICAgICAgICAgICAgICAgIHR5cGUgPSAibW9iaWxlIjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIGVsc2UgaWYgKHZwV2lkdGggPD0gZGVmT3B0aW9ucy50V2lkdGgpIHsNCiAgICAgICAgICAgICAgICB0eXBlID0gInRhYmxldCI7DQogICAgICAgICAgICB9DQogICAgICAgICAgICBlbHNlIHsNCiAgICAgICAgICAgICAgICB0eXBlID0gImRlc2t0b3AiOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyBNb2RpZmllZCBiZWxvdyBmb3IgSUU2IGNvbXBhdGliaWxpdHkNCiAgICAgICAgICAgIGlmICgkKHRoaXMpLmF0dHIoInNyYyIpICE9PSAkKHRoaXMpLmF0dHIoImRhdGEtaW1nc2l6ZS0iICsgdHlwZSkpIHsNCiAgICAgICAgICAgICAgICAkKHRoaXMpLmF0dHIoInNyYyIsICQodGhpcykuYXR0cigiZGF0YS1pbWdzaXplLSIgKyB0eXBlKSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0pOw0KICAgIH07DQp9KShqUXVlcnkpOzsNCi8vIEJ1aWxkIG91dCB0aGUgTmFtZSBzcGFjZSBpZiBpdCBkb2Vzbid0IGFsbCByZWFkeSBleGlzdA0KdmFyIFVBbGJlcnRhID0gVUFsYmVydGEgfHwge307DQpVQWxiZXJ0YS5TaXRlY29yZSA9IFVBbGJlcnRhLlNpdGVjb3JlIHx8IHt9Ow0KDQpVQWxiZXJ0YS5TaXRlY29yZS5FbWVyZ2VuY3lNZXNzYWdlID0gZnVuY3Rpb24gKCQpIHsNCg0KICAgIHZhciBfdXJsID0gJy9hcGkvZW1lcmdlbmN5bWVzc2FnZS5qc29uJywNCiAgICAgICAgX2NvbnRhaW5lclNlbGVjdG9yID0gJyNlbWVyZ2VuY3lNZXNzYWdlJywNCiAgICAgICAgX3RpbWVvdXQgPSA5MDAwMDsNCg0KICAgIC8qDQogICAgKiBHZXQgTWVzc2FnZXMNCiAgICAqIFJldHJpZXZlcyBhbnkgZW1lcmdlbmN5IG1lc3NhZ2VzIGZyb20gdGhlIHdlYiBzZXJ2aWNlDQogICAgKg0KICAgICogY29udGFpbmVyU2VsZWN0b3I6IFtTdHJpbmddIFRoZSBKUXVlcnkgc2VsZWN0b3Igc3RyaW5nIG9mIHRoZSBET00gRWxlbWVudCB0byBwbGFjZSB0aGUgbWVzc2FnZSBpbg0KICAgICogdGltZW91dDogW0ludGVnZXJdIFRoZSB0aW1lIGluIG1pbGxpc2Vjb25kcyB0byB3YWl0IGZvciB0aGUgcmVzcG9uc2UgYXMgd2VsbCBhcyB0aGUgZGVsYXkgYmVmb3JlIG1ha2luZyB0aGUgcmVxdWVzdCBhZ2Fpbg0KICAgICovDQogICAgZnVuY3Rpb24gZ2V0TWVzc2FnZXMoY29udGFpbmVyU2VsZWN0b3IsIHRpbWVvdXQpIHsNCiAgICAgICAgLy8gSWYgdGhlIGNvbnRhaW5lciBzZWxlY3RvciBpcyBhIHN0cmluZyB1c2UgdGhlIHBhc3NlZCB2YWx1ZQ0KICAgICAgICBpZiAodHlwZW9mIGNvbnRhaW5lclNlbGVjdG9yID09ICdzdHJpbmcnKSB7DQogICAgICAgICAgICBfY29udGFpbmVyU2VsZWN0b3IgPSBjb250YWluZXJTZWxlY3RvcjsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIElmIHRoZSB0aW1lb3V0IGlzIG5vdCBhIG51bWJlciB1c2UgdGhlIGRlZmF1bHQgdmFsdWUgb2YgOTAgc2Vjb25kcw0KICAgICAgICBpZiAodHlwZW9mIHRpbWVvdXQgPT0gJ251bWJlcicpIHsNCiAgICAgICAgICAgIF90aW1lb3V0ID0gdGltZW91dDsNCiAgICAgICAgfQ0KICAgICAgICAvL0NhbGwgdGhlIGZ1bmN0aW9uIGFuZCBzZXQgdXAgYSByZXBlYXRpbmcgY2FsbCB0byB0aGF0IGZ1bmN0aW9uDQogICAgICAgIHZhciBtZXNzYWdlSW50ZXJ2YWwgPSBzZXRJbnRlcnZhbChwcm9jZXNzUmVxdWVzdCwgX3RpbWVvdXQpOw0KICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsgY2xlYXJJbnRlcnZhbChtZXNzYWdlSW50ZXJ2YWwpOyB9LCA2MDAwMDApOw0KICAgICAgICBwcm9jZXNzUmVxdWVzdCgpOw0KICAgIH0NCg0KICAgIC8qDQogICAgKiBQcm9jZXNzIFJlcXVlc3QNCiAgICAqIE1ha2VzIHRoZSBhamF4IGNhbGwgdG8gdGhlIHNlcnZlcg0KICAgICovDQogICAgZnVuY3Rpb24gcHJvY2Vzc1JlcXVlc3QoKSB7DQogICAgICAgICQuYWpheCh7DQogICAgICAgICAgICB0eXBlOiAnR0VUJywNCiAgICAgICAgICAgIGRhdGFUeXBlOiAnanNvbicsDQogICAgICAgICAgICBjb250ZW50VHlwZTogJ2FwcGxpY2F0aW9uL2pzb24nLA0KICAgICAgICAgICAgdXJsOiBfdXJsLA0KICAgICAgICAgICAgdGltZW91dDogX3RpbWVvdXQsDQogICAgICAgICAgICBjYWNoZTogZmFsc2UsDQogICAgICAgICAgICBzdWNjZXNzOiBhamF4U3VjY2VzcywNCiAgICAgICAgICAgIGVycm9yOiBhamF4RXJyb3INCiAgICAgICAgfSk7DQogICAgfQ0KDQogICAgLyoNCiAgICAqIEFqYXggU3VjY2Vzcw0KICAgICogUHJvY2Vzc2VzIHRoZSBzdWNjZXNzZnVsIGFqYXggY2FsbA0KICAgICoNCiAgICAqIGRhdGE6IFtPYmplY3RdIFRoZSByZXR1cm5lZCBvYmplY3QgZnJvbSB0aGUgd2ViIHNlcnZpY2UNCiAgICAqLw0KICAgIGZ1bmN0aW9uIGFqYXhTdWNjZXNzKGRhdGEpIHsNCiAgICAgICAgdmFyIG1lc3NhZ2UgPSAnJzsNCiAgICAgICAgaWYgKGRhdGEuTWVzc2FnZVRleHQgIT0gJycpIHsNCiAgICAgICAgICAgIGlmICgkKF9jb250YWluZXJTZWxlY3RvcikubGVuZ3RoIDw9IDApIHsNCiAgICAgICAgICAgICAgICAkKCdoZWFkZXInKS5iZWZvcmUoIjxkaXYgY2xhc3M9J2VtZXJnZW5jeScgaWQ9J2VtZXJnZW5jeU1lc3NhZ2UnPjwvZGl2PiIpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBpZiAoZGF0YS5NZXNzYWdlVGl0bGUgIT0gJycpIHsNCiAgICAgICAgICAgICAgICBtZXNzYWdlID0gJzxoMT4nICsgZGF0YS5NZXNzYWdlVGl0bGUgKyAnPC9oMT4mbmJzcDsmbmJzcDsnOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICBtZXNzYWdlICs9ICc8cD4nICsgZGF0YS5NZXNzYWdlVGV4dCArICc8L3A+JzsNCg0KICAgICAgICAgICAgJChfY29udGFpbmVyU2VsZWN0b3IpLmVtcHR5KCkuaHRtbChtZXNzYWdlKTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICQoX2NvbnRhaW5lclNlbGVjdG9yKS5yZW1vdmUoKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qDQogICAgKiBBamF4IEVycm9yDQogICAgKiBQcm9jZXNzZXMgdGhlIGVycm9yIGV2ZW50IGR1cmluZyBhbiBhamF4IGNhbGwNCiAgICAqDQogICAgKiBkYXRhOiBbT2JqZWN0XSBUaGUgcmV0dXJuZWQgb2JqZWN0IGZyb20gdGhlIHdlYiBzZXJ2aWNlDQogICAgKi8NCiAgICBmdW5jdGlvbiBhamF4RXJyb3IoZGF0YSkgew0KICAgIH0NCg0KICAgIHJldHVybiB7DQogICAgICAgIEdldE1lc3NhZ2VzOiBnZXRNZXNzYWdlcw0KICAgIH07DQp9IChqUXVlcnkpOzsNCi8qKg0KICogUGxhY2Vob2xkZXIgUHJvY2Vzc2luZw0KICogQXV0aG9yOiBEZWFuIFZpZ29yZW4gLSB2aWdvcmVuQHVhbGJlcnRhLmNhDQogKg0KICogQWRkcyBwbGFjZWhvbGRlciB0ZXh0IHRvIGlucHV0cyBmb3IgYnJvd3NlcnMgdGhhdCBkbyBub3Qgc3VwcG9ydCB0aGF0IGF0dHJpYnV0ZS4NCiAqIFJlcXVpcmVzIGEgcGxhY2Vob2xkZXIgY3NzIGNsYXNzDQogKg0KICogVGhpcyBpcyBnbG9iYWwgZnVuY3Rpb25hbGl0eSAod2h5IGl0J3MgZGlyZWN0bHkgdW5kZXIgdGhlIFVBbGJlcnRhIG5hbWUgc3BhY2UpIGl0IGlzIG5vdCBzcGVjaWZpYyB0byBzaXRlY29yZSBidXQgZm9yIGJyb3dzZXIgY29tcGF0aWJpbGl0eQ0KICovDQp2YXIgVUFsYmVydGEgPSBVQWxiZXJ0YSB8fCB7fTsNCg0KVUFsYmVydGEuSW5wdXRQbGFjZWhvbGRlcnMgPSBmdW5jdGlvbiAoJCkgew0KICAgIHZhciBfaXNQbGFjZWhvbGRlclN1cHBvcnRlZCA9ICdwbGFjZWhvbGRlcicgaW4gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW5wdXQnKSAmJiAncGxhY2Vob2xkZXInIGluIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RleHRhcmVhJyksDQogICAgICAgIF9wbGFjZWhvbGRlckNsYXNzID0gJ3BsYWNlaG9sZGVyJzsNCg0KICAgIGZ1bmN0aW9uIGluaXQocGxhY2Vob2xkZXJDbGFzcyl7DQogICAgICAgIGlmKCFfaXNQbGFjZWhvbGRlclN1cHBvcnRlZCl7DQoNCiAgICAgICAgICAgIGlmKHBsYWNlaG9sZGVyQ2xhc3Mpew0KICAgICAgICAgICAgICAgIF9wbGFjZWhvbGRlckNsYXNzID0gcGxhY2Vob2xkZXJDbGFzczsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgLy9HZXQgdGhlIHRleHQgYXJlYXMgYW5kIGlucHV0cyB0aGF0IGhhdmUgcGxhY2Vob2xkZXJzIGJ1dCBkbyBub3QgaGF2ZSB0aGUgcGxhY2Vob2xkZXIgY2xhc3MNCiAgICAgICAgICAgICQoJ2lucHV0W3BsYWNlaG9sZGVyXSwgdGV4dGFyZWFbcGxhY2Vob2xkZXJdJykuYmluZCh7DQogICAgICAgICAgICAgICAgJ2ZvY3VzJzogY2xlYXJQbGFjZWhvbGRlciwNCiAgICAgICAgICAgICAgICAnYmx1cic6IGFkZFBsYWNlaG9sZGVyDQogICAgICAgICAgICB9KS50cmlnZ2VyKCdibHVyJyk7DQoNCiAgICAgICAgICAgIC8vRnVuY3Rpb25hbGl0eSBmb3Igd2hlbiBlbnRlciBpcyBwcmVzc2VkIG9uIHRoZSBzZWFyY2ggYm94IG9yIHRoZSBzZWFyY2ggYnV0dG9uIGlzIGNsaWNrZWQgdGhlIHBsYWNlaG9sZGVyIGlzIGNsZWFyZWQNCiAgICAgICAgICAgICQoJy5zZWFyY2gtcXVlcnknKS5rZXlkb3duKGZ1bmN0aW9uIChhKSB7DQogICAgICAgICAgICAgICAgYSA9IGEgfHwgd2luZG93LmV2ZW50Ow0KICAgICAgICAgICAgICAgIGlmIChhLmtleUNvZGUgPT0gMTMgfHwgYS53aGljaCA9PSAxMykgew0KICAgICAgICAgICAgICAgICAgICAkKCcuJyArIF9wbGFjZWhvbGRlckNsYXNzKS5lYWNoKGNsZWFyUGxhY2Vob2xkZXIpOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAkKCcuZ2xvYmFsLXNlYXJjaC1idG4nKS5jbGljayhmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgJCgnLicgKyBfcGxhY2Vob2xkZXJDbGFzcykuZWFjaChjbGVhclBsYWNlaG9sZGVyKTsNCiAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAvL09uIGZvcm0gc3VibWl0IG1ha2Ugc3VyZSB0byBjbGVhciBhbGwgcGxhY2Vob2xkZXJzDQogICAgICAgICAgICAkKGRvY3VtZW50KS5kZWxlZ2F0ZSgnZm9ybScsICdzdWJtaXQnLGZ1bmN0aW9uKCl7DQogICAgICAgICAgICAgICAgJCgnLicgKyBfcGxhY2Vob2xkZXJDbGFzcykuZWFjaChjbGVhclBsYWNlaG9sZGVyKTsNCiAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAvL0NsZWFyIHRoZSBwbGFjZWhvbGRlciB3aGVuIGEgcGFnZSBpcyByZWxvYWRlZA0KICAgICAgICAgICAgJCh3aW5kb3cpLmJpbmQoJ2JlZm9yZXVubG9hZCcsZnVuY3Rpb24oKXsNCiAgICAgICAgICAgICAgICAkKCcuJyArIF9wbGFjZWhvbGRlckNsYXNzKS5lYWNoKGNsZWFyUGxhY2Vob2xkZXIpOw0KICAgICAgICAgICAgfSk7DQogICAgICAgIH0NCiAgICB9DQoNCiAgICAvKg0KICAgICAqIENsZWFyIFBsYWNlaG9sZGVyDQogICAgICogUmVtb3ZlcyB0aGUgdGV4dCBmcm9tIHRoZSBpbnB1dCBhbmQgcmVtb3ZlcyB0aGUgcGxhY2Vob2xkZXIgY2xhc3MNCiAgICAqLw0KICAgIGZ1bmN0aW9uIGNsZWFyUGxhY2Vob2xkZXIoKXsNCiAgICAgICAgdmFyIGlucHV0ID0gJCh0aGlzKTsNCiAgICAgICAgaWYoaW5wdXQudmFsKCkgPT0gIGlucHV0LmF0dHIoJ3BsYWNlaG9sZGVyJykpew0KICAgICAgICAgICAgaW5wdXQudmFsKCcnKTsNCiAgICAgICAgICAgIGlucHV0LnJlbW92ZUNsYXNzKF9wbGFjZWhvbGRlckNsYXNzKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIC8qDQogICAgICogQWRkIFBsYWNlaG9sZGVyDQogICAgICogQWRkcyB0aGUgcGxhY2Vob2xkZXIgdGV4dCB0byB0aGUgaW5wdXQgYW5kIGFkZHMgdGhlIHBsYWNlaG9sZGVyIGNsYXNzDQogICAgICovDQogICAgZnVuY3Rpb24gYWRkUGxhY2Vob2xkZXIoKXsNCiAgICAgICAgdmFyIGlucHV0ID0gJCh0aGlzKTsNCiAgICAgICAgaWYoaW5wdXQudmFsKCkgPT0gJycgfHwgaW5wdXQudmFsKCkgPT0gaW5wdXQuYXR0cigncGxhY2Vob2xkZXInKSl7DQogICAgICAgICAgICBpbnB1dC5hZGRDbGFzcyhfcGxhY2Vob2xkZXJDbGFzcyk7DQogICAgICAgICAgICBpbnB1dC52YWwoaW5wdXQuYXR0cigncGxhY2Vob2xkZXInKSk7DQogICAgICAgIH0NCiAgICAgICAgZWxzZXsNCiAgICAgICAgICAgIGlucHV0LnJlbW92ZUNsYXNzKF9wbGFjZWhvbGRlckNsYXNzKTsNCiAgICAgICAgfQ0KICAgIH0NCg0KICAgIHJldHVybnsNCiAgICAgICAgaW5pdGlhbGl6ZTogaW5pdA0KICAgIH0NCn0oalF1ZXJ5KTs7DQovKioNCiogVUFsYmVydGEgR2xvYmFsIFNlYXJjaCAoQmxhZGUpIA0KKiBBdXRob3I6IEphc29uIEt1bGF0dW5nYSAtIGprMTdAdWFsYmVydGEuY2ENCiovDQp2YXIgVUFsYmVydGEgPSBVQWxiZXJ0YSB8fCB7fTsNClVBbGJlcnRhLlNpdGVjb3JlID0gVUFsYmVydGEuU2l0ZWNvcmUgfHwge307DQoNClVBbGJlcnRhLlNpdGVjb3JlLkdsb2JhbFNlYXJjaCA9IChmdW5jdGlvbiAoJCkgew0KDQoNCiAgICBmdW5jdGlvbiBLZXlWYWx1ZShrZXksIHZhbHVlKSB7DQogICAgICAgIHRoaXMua2V5ID0ga2V5Ow0KICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gc2VhcmNoKG9wdGlvbnMpIHsNCg0KICAgICAgICB2YXIgdmFsdWUgPSBqUXVlcnkob3B0aW9ucy5zZWxlY3RvcikudmFsKCk7DQogICAgICAgIGlmICh2YWx1ZSA9PSAiIikgew0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9DQoNCiAgICAgICAgb3B0aW9ucy5xdWVyeSA9IGVzY2FwZSh2YWx1ZSk7DQoNCiAgICAgICAgdmFyIHBhcmFtcyA9IFtdOw0KICAgICAgICBwYXJhbXMucHVzaChuZXcgS2V5VmFsdWUoImN4Iiwgb3B0aW9ucy5nb29nbGVJZCkpOw0KICAgICAgICBwYXJhbXMucHVzaChuZXcgS2V5VmFsdWUoInEiLCBvcHRpb25zLnF1ZXJ5KSk7DQogICAgICAgIHBhcmFtcy5wdXNoKG5ldyBLZXlWYWx1ZSgiY29mIiwgIkZPUklEJTNBMTEjMTE1MCIpKTsNCg0KICAgICAgICB2YXIgcmVzdWx0VXJsID0gb3B0aW9ucy5yZXN1bHRVcmw7DQoNCiAgICAgICAgZm9yICh2YXIgbmR4IGluIHBhcmFtcykgew0KICAgICAgICAgICAgdmFyIHBhcmFtID0gcGFyYW1zW25keF07DQogICAgICAgICAgICBpZiAocGFyYW0gJiYgcGFyYW0ua2V5ICYmIHBhcmFtLnZhbHVlKSB7DQogICAgICAgICAgICAgICAgcmVzdWx0VXJsID0gdXBkYXRlUXVlcnlTdHJpbmcocGFyYW0ua2V5LCBwYXJhbS52YWx1ZSwgcmVzdWx0VXJsKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KDQogICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gcmVzdWx0VXJsOw0KICAgICAgICByZXR1cm4gZmFsc2U7DQoNCiAgICB9Ow0KDQogICAgZnVuY3Rpb24gdXBkYXRlUXVlcnlTdHJpbmcoa2V5LCB2YWx1ZSwgdXJsKSB7DQogICAgICAgIGlmICghdXJsKSB1cmwgPSB3aW5kb3cubG9jYXRpb24uaHJlZjsNCiAgICAgICAgdmFyIHJlID0gbmV3IFJlZ0V4cCgiKFs/fCZdKSIgKyBrZXkgKyAiPS4qPygmfCN8JCkiLCAiZ2kiKTsNCg0KICAgICAgICBpZiAodXJsLm1hdGNoKHJlKSkgew0KICAgICAgICAgICAgaWYgKHZhbHVlKSByZXR1cm4gdXJsLnJlcGxhY2UocmUsICckMScgKyBrZXkgKyAiPSIgKyB2YWx1ZSArICckMicpOw0KICAgICAgICAgICAgZWxzZSByZXR1cm4gdXJsLnJlcGxhY2UocmUsICckMicpOw0KICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgaWYgKHZhbHVlKSB7DQogICAgICAgICAgICAgICAgdmFyIHNlcGFyYXRvciA9IHVybC5pbmRleE9mKCc/JykgIT09IC0xID8gJyYnIDogJz8nLA0KICAgICAgICAgICAgICAgICAgICBoYXNoID0gdXJsLnNwbGl0KCcjJyk7DQogICAgICAgICAgICAgICAgdXJsID0gaGFzaFswXSArIHNlcGFyYXRvciArIGtleSArICc9JyArIHZhbHVlOw0KICAgICAgICAgICAgICAgIGlmIChoYXNoWzFdKSB1cmwgKz0gJyMnICsgaGFzaFsxXTsNCiAgICAgICAgICAgICAgICByZXR1cm4gdXJsOw0KICAgICAgICAgICAgfSBlbHNlIHJldHVybiB1cmw7DQogICAgICAgIH0NCiAgICB9DQoNCg0KDQoNCiAgICBmdW5jdGlvbiBpbml0KGN1c3RvbU9wdGlvbnMpIHsNCiAgICAgICAgdmFyIG9wdGlvbnMgPSB7fTsNCiAgICAgICAgb3B0aW9ucy5zZWxlY3RvciA9ICcuc2VhcmNoLXF1ZXJ5JzsNCiAgICAgICAgb3B0aW9ucy5idG5TZWxlY3RvciA9ICcuZ2xvYmFsLXNlYXJjaC1idG4nOw0KICAgICAgICBvcHRpb25zLmdvb2dsZUlkID0gJyc7DQogICAgICAgIG9wdGlvbnMucXVlcnkgPSAnJzsNCiAgICAgICAgb3B0aW9ucy5yZXN1bHRVcmwgPSAnJzsNCg0KICAgICAgICAvL292ZXJyaWRlIGRlZmF1bHRzLg0KICAgICAgICBvcHRpb25zID0gJC5leHRlbmQoe30sIG9wdGlvbnMsIGN1c3RvbU9wdGlvbnMpOw0KDQoNCiAgICAgICAgaWYgKCFvcHRpb25zLnJlc3VsdFVybCB8fCAhb3B0aW9ucy5zZWxlY3RvciB8fCAhb3B0aW9ucy5nb29nbGVJZCkgew0KICAgICAgICAgICAgLy9pZiBtaXNzaW5nIGEgcmVxdWlyZWQgdmFsdWUsIGRvbnQgYXR0YWNoIGhhbmRsZXIuDQogICAgICAgICAgICByZXR1cm47DQogICAgICAgIH0NCg0KICAgICAgICAkKG9wdGlvbnMuc2VsZWN0b3IpLmtleWRvd24oZnVuY3Rpb24gKGEpIHsNCiAgICAgICAgICAgIGEgPSBhIHx8IHdpbmRvdy5ldmVudDsNCiAgICAgICAgICAgIGlmIChhLmtleUNvZGUgPT0gMTMgfHwgYS53aGljaCA9PSAxMykgew0KICAgICAgICAgICAgICAgIGEucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgICAgICAgICByZXR1cm4gc2VhcmNoKG9wdGlvbnMpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgIH0pOw0KDQogICAgICAgICQob3B0aW9ucy5idG5TZWxlY3RvcikuY2xpY2soZnVuY3Rpb24gKGEpIHsNCiAgICAgICAgICAgIGEucHJldmVudERlZmF1bHQoKTsNCiAgICAgICAgICAgIHJldHVybiBzZWFyY2gob3B0aW9ucyk7DQogICAgICAgIH0pOw0KDQogICAgfQ0KDQogICAgcmV0dXJuIHsNCiAgICAgICAgaW5pdDogaW5pdA0KICAgIH0NCn0pKGpRdWVyeSk7Ow0KLyoqDQoqIFVBbGJlcnRhIFNpdGVjb3JlIFBhZ2UgTG9hZA0KKiBTY3JpcHQgdGhhdCBpcyBydW4gb24gZXZlcnkgcGFnZSBsb2FkIHRvIHByb3ZpZGUgY2VydGFpbiBzaXRlIHdpZGUgZnVuY3Rpb25hbGl0eQ0KKi8NCg0KLy8gQWxsIGZ1bmN0aW9uYWxpdHkgdGhhdCBuZWVkcyB0byBiZSBjYWxsZWQgb24gZG9tIHJlYWR5DQokKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7DQoNCiAgICAvL1NldHRpbmcgR2xvYmFsIFZhcmlhYmxlcw0KICAgIHZhciB3aW5IZWlnaHQgPSAkKHdpbmRvdykuaGVpZ2h0KCksDQogICAgICAgIGhlYWRIZWlnaHQgPSAkKCdoZWFkZXInKS5oZWlnaHQoKSwNCiAgICAgICAgZm9vdGVySGVpZ2h0ID0gJCgnZm9vdGVyJykuaGVpZ2h0KCksDQogICAgICAgIGJvZHlNaW5IZWlnaHQgPSB3aW5IZWlnaHQgLSAoaGVhZEhlaWdodCArIGZvb3RlckhlaWdodCArIDIwKSwNCiAgICAgICAgbmF2VGl0bGUgPSAkKCcjbWFpbi1uYXYgLm5hdmlnYXRpb24tdG9nZ2xlIHNwYW4nKTsNCg0KICAgICQoJy5jb250ZW50LXdyYXBwZXInKS5jc3MoJ21pbi1oZWlnaHQnLCBib2R5TWluSGVpZ2h0ICsgJ3B4Jyk7DQogICAgJCgnLmhlYWRpbmctbGluaycpLnRvb2x0aXAoKTsNCg0KICAgIC8vIG5hdmlnYXRpb24NCiAgICAkKCcubmF2LXRvZ2dsZScpLm9uKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7DQogICAgICAgICQodGhpcykucGFyZW50KCkudG9nZ2xlQ2xhc3MoJ2V4cGFuZGVkJyk7DQogICAgICAgICQodGhpcykucGFyZW50KCkucGFyZW50KCkudG9nZ2xlQ2xhc3MoJ25hdi1leHBhbmQnKTsNCiAgICAgICAgZS5zdG9wUHJvcGFnYXRpb24oKTsNCiAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgIH0pOw0KICAgICQoImhlYWRlciAubmF2aWdhdGlvbi10b2dnbGUiKS5vbignY2xpY2snLCBmdW5jdGlvbiAoZSkgew0KICAgICAgICAkKHRoaXMpLnRvZ2dsZUNsYXNzKCdjb2xsYXBzZWQnKTsNCiAgICAgICAgJCgnaGVhZGVyIC5uYXYtd3JhcHBlcicpLnRvZ2dsZUNsYXNzKCdvbicpOw0KICAgICAgICAkKCdoZWFkZXIgLm5hdi13cmFwcGVyJykudHJpZ2dlcignY2xhc3NUb2dnbGVkJywgJ29uJyk7DQogICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7DQogICAgICAgIHJldHVybiBmYWxzZTsNCiAgICB9KTsNCiAgICAkKCdoZWFkZXIgLm5hdi13cmFwcGVyJykub24oJ2NsYXNzVG9nZ2xlZCcsIGZ1bmN0aW9uIChlLCBjbGFzc05hbWUpIHsNCiAgICAgICAgbmF2VGl0bGUuaHRtbCgkKHRoaXMpLmhhc0NsYXNzKGNsYXNzTmFtZSkgPyAnSGlkZSBOYXZpZ2F0aW9uJyA6ICdTaG93IE5hdmlnYXRpb24nKTsNCiAgICB9KTsNCg0KICAgIC8vIFByb2Nlc3MgYWxsIG9mIHRoZSBpbWFnZXMgb24gdGhlIHBhZ2UgdG8gbG9hZCB0aGUgY29ycmVjdCByZXNvbHV0aW9uIGZvciB0aGUgc2NyZWVuIHNpemUNCiAgICAkKCdpbWcnKS5EZXZpY2VJbWFnZVNjYWxpbmcoKTsNCiAgICAkKHdpbmRvdykucmVzaXplKGZ1bmN0aW9uICgpIHsNCiAgICAgICAgJCgnaW1nJykuRGV2aWNlSW1hZ2VTY2FsaW5nKCk7DQogICAgfSk7DQoNCiAgICAvLyBQcm9jZXNzZXMgdGhlIEVtZXJnZW5jeSBtZXNzYWdpbmcgY2FsbCB0byBjaGVjayBmb3IgYW55IGVtZXJnZW5jeSBtZXNzYWdlcyB0byBiZSBkaXNwbGF5ZWQNCiAgICBVQWxiZXJ0YS5TaXRlY29yZS5FbWVyZ2VuY3lNZXNzYWdlLkdldE1lc3NhZ2VzKCk7DQoNCiAgICAvL3J1biB0aGUgY29sbGFwc2UgcGx1Z2luIGZvciBCb290c3RyYXAuIEluaXRpYWxpemVzIGFsbCBjb2xsYXBzaWJsZSBlbGVtZW50cw0KICAgICQoIi5jb2xsYXBzZSIpLmNvbGxhcHNlKCk7DQoNCiAgICAvL1NldCB1cCBpbnB1dCBwbGFjZWhvbGRlcnMgZm9yIGJyb3dzZXJzIHRoYXQgZG8gbm90IHN1cHBvcnQgdGhlbQ0KICAgIFVBbGJlcnRhLklucHV0UGxhY2Vob2xkZXJzLmluaXRpYWxpemUoKTsNCn0pOw0KDQovL0luZGV4IG9mIGZ1bmN0aW9uYWxpdHkgZm9yIE9sZGVyIElFIFZlcnNpb25zDQppZiAoIUFycmF5LnByb3RvdHlwZS5pbmRleE9mKSB7DQogICAgQXJyYXkucHJvdG90eXBlLmluZGV4T2YgPSBmdW5jdGlvbiAoZWx0IC8qLCBmcm9tKi8pIHsNCiAgICAgICAgdmFyIGxlbiA9IHRoaXMubGVuZ3RoID4+PiAwOw0KDQogICAgICAgIHZhciBmcm9tID0gTnVtYmVyKGFyZ3VtZW50c1sxXSkgfHwgMDsNCiAgICAgICAgZnJvbSA9IChmcm9tIDwgMCkNCiAgICAgICAgICAgID8gTWF0aC5jZWlsKGZyb20pDQogICAgICAgICAgICA6IE1hdGguZmxvb3IoZnJvbSk7DQogICAgICAgIGlmIChmcm9tIDwgMCkNCiAgICAgICAgICAgIGZyb20gKz0gbGVuOw0KDQogICAgICAgIGZvciAoOyBmcm9tIDwgbGVuOyBmcm9tKyspIHsNCiAgICAgICAgICAgIGlmIChmcm9tIGluIHRoaXMgJiYNCiAgICAgICAgICAgICAgICB0aGlzW2Zyb21dID09PSBlbHQpDQogICAgICAgICAgICAgICAgcmV0dXJuIGZyb207DQogICAgICAgIH0NCiAgICAgICAgcmV0dXJuIC0xOw0KICAgIH07DQp9DQoNCi8vIG1ha2Ugc3VyZSB0aGUgc2lkZWJhciBkb2VzIG5vdCBleHRlbmQgcGFzdCBjb250ZW50IGFyZWEgb24gZGVza3RvcCB2aWV3DQokKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7DQogICAgdmFyIGNvbnRlbnRDb250YWluZXJMYW5kaW5nUGFnZSwgY29udGVudENvbnRhaW5lckZhY3VsdHlIb21lID0gbnVsbDsNCiAgICB2YXIgbnVkZ2VPZmZzZXQgPSAxMTA7DQoNCiAgICBpZiAoJCgnLmNvbnRlbnQtd3JhcHBlcicpLmhhc0NsYXNzKCdsYW5kaW5nLXBhZ2UnKSkgew0KICAgICAgICBjb250ZW50Q29udGFpbmVyTGFuZGluZ1BhZ2UgPSAkKCcuY29udGVudC13cmFwcGVyLmxhbmRpbmctcGFnZScpOw0KICAgIH0NCg0KICAgIGlmICgkKCcuY29udGVudC13cmFwcGVyJykuaGFzQ2xhc3MoJ2ZhY3VsdHktaG9tZScpKSB7DQogICAgICAgIGNvbnRlbnRDb250YWluZXJGYWN1bHR5SG9tZSA9ICQoJy5jb250ZW50LXdyYXBwZXIuZmFjdWx0eS1ob21lJyk7DQogICAgfQ0KDQogICAgZnVuY3Rpb24gcmVzaXplQ29udGFpbmVyKCkgew0KICAgICAgICB2YXIgbmV3SGVpZ2h0ID0gKCQoJy5zaWRlYmFyJykuaGVpZ2h0KCkgKyBudWRnZU9mZnNldCkgKyAncHgnOw0KDQogICAgICAgIGlmICgkKHdpbmRvdykud2lkdGgoKSA+IDk3OSAmJiBjb250ZW50Q29udGFpbmVyTGFuZGluZ1BhZ2UpIHsNCiAgICAgICAgICAgIGNvbnRlbnRDb250YWluZXJMYW5kaW5nUGFnZS5jc3MoJ21pbi1oZWlnaHQnLCBuZXdIZWlnaHQpOw0KICAgICAgICB9DQoNCiAgICAgICAgaWYgKCQod2luZG93KS53aWR0aCgpID4gNjg5ICYmIGNvbnRlbnRDb250YWluZXJGYWN1bHR5SG9tZSkgew0KICAgICAgICAgICAgY29udGVudENvbnRhaW5lckZhY3VsdHlIb21lLmNzcygnbWluLWhlaWdodCcsIG5ld0hlaWdodCk7DQogICAgICAgIH0NCiAgICB9Ow0KDQogICAgcmVzaXplQ29udGFpbmVyKCk7DQogICAgJCh3aW5kb3cpLnJlc2l6ZShyZXNpemVDb250YWluZXIpOw0KfSk7Ow0KLyoqDQoqIFVBbGJlcnRhIEF0aGxldGljcyBHYW1lIExpc3QNCiogQXV0aG9yOiBLeWxlIFNjaG1pZHQgLSBreWxlLnNjaG1pZHRAdWFsYmVydGEuY2ENCiovDQoNCi8vIGJ1aWxkIG5hbWVzcGFjZQ0KdmFyIFVBbGJlcnRhID0gVUFsYmVydGEgfHwge307DQpVQWxiZXJ0YS5TaXRlY29yZSA9IFVBbGJlcnRhLlNpdGVjb3JlIHx8IHt9Ow0KDQpVQWxiZXJ0YS5TaXRlY29yZS5BdGhsZXRpY3NHYW1lTGlzdCA9IFVBbGJlcnRhLlNpdGVjb3JlLkF0aGxldGljc0dhbWVMaXN0IHx8IChmdW5jdGlvbiAoKSB7DQogICAgZnVuY3Rpb24gZ2V0SW5zdGFuY2UoKSB7DQogICAgICAgIHJldHVybiAoZnVuY3Rpb24gKCQpIHsNCiAgICAgICAgICAgICd1c2Ugc3RyaWN0JzsNCg0KICAgICAgICAgICAgdmFyIERhdGEgPSB7DQogICAgICAgICAgICAgICAgICAgIHNlcnZpY2VVcmw6ICIiLCAvLyB0aGUgdXJsIG9mIHRoZSBnYW1lcyBzZXJ2aWNlDQogICAgICAgICAgICAgICAgICAgIGRpc3BsYXlMaW1pdDogOCwgLy8gdGhlIG1heGltdW0gbnVtYmVyIG9mIGdhbWVzIHRvIHNob3cNCg0KICAgICAgICAgICAgICAgICAgICAvLyBjb25zdGFudHMNCiAgICAgICAgICAgICAgICAgICAgQ29uc3RhbnRzOiB7DQogICAgICAgICAgICAgICAgICAgICAgICAvLyBwcm9ncmFtIHR5cGUNCiAgICAgICAgICAgICAgICAgICAgICAgIFByb2dyYW1UeXBlOiB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgQmVhcnM6IDEsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgUGFuZGFzOiAyLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEF0aGxldGljczogMw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgICAgIFV0aWxzID0gew0KICAgICAgICAgICAgICAgICAgICAvLyBnZXQgdGhlIHByb2dyYW0gdHlwZSBuYW1lDQogICAgICAgICAgICAgICAgICAgIGdldFByb2dyYW1UeXBlOiBmdW5jdGlvbiAocHJvZ3JhbUlkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2gocHJvZ3JhbUlkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBEYXRhLkNvbnN0YW50cy5Qcm9ncmFtVHlwZS5CZWFyczoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICJiZWFycyI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgRGF0YS5Db25zdGFudHMuUHJvZ3JhbVR5cGUuUGFuZGFzOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gInBhbmRhcyI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAiYXRobGV0aWNzIjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgICAgICBBSkFYID0gew0KICAgICAgICAgICAgICAgICAgICAvLyBnZXQgZ2FtZXMNCiAgICAgICAgICAgICAgICAgICAgZ2V0R2FtZXM6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGdldCBkYXRhDQogICAgICAgICAgICAgICAgICAgICAgICAkLmFqYXgoew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFUeXBlOiAianNvbiIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IEFKQVguRXZlbnRzLmVycm9yLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IEFKQVguRXZlbnRzLnN1Y2Nlc3MsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiBEYXRhLnNlcnZpY2VVcmwgKyAiJmxpbWl0PSIgKyBEYXRhLmRpc3BsYXlMaW1pdA0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgICAgICAgICAgRXZlbnRzOiB7DQogICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5zaG93RXJyb3IoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLnNob3dHYW1lcyhkYXRhKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgICAgICBJbnRlcmZhY2UgPSB7DQogICAgICAgICAgICAgICAgICAgIGNvbnRhaW5lcjogW10sDQoNCiAgICAgICAgICAgICAgICAgICAgLy8gc2V0dXAgdGhlIGludGVyZmFjZQ0KICAgICAgICAgICAgICAgICAgICBzZXR1cDogZnVuY3Rpb24gKGNvbnRhaW5lcklkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAvLyBzdG9yZSB0aGUgbGlzdA0KICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLmNvbnRhaW5lciA9ICQoIiMiICsgY29udGFpbmVySWQpOw0KICAgICAgICAgICAgICAgICAgICB9LA0KDQogICAgICAgICAgICAgICAgICAgIC8vIHNob3cgdGhlIGdhbWVzDQogICAgICAgICAgICAgICAgICAgIHNob3dHYW1lczogZnVuY3Rpb24oZ2FtZXMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHJlbW92ZSBsb2FkZXINCiAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5jb250YWluZXIuZmluZCgibGk6Zmlyc3QiKS5yZW1vdmUoKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2F2ZSBib3R0b20gcm93DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYm90dG9tUm93ID0gSW50ZXJmYWNlLmNvbnRhaW5lci5odG1sKCk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGlmIG5vIGdhbWVzLCBzaG93IG1lc3NhZ2UNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGdhbWVzLmxlbmd0aCA9PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLmNvbnRhaW5lci5odG1sKCI8bGk+VGhlcmUgYXJlIG5vIGdhbWVzIHRvIGRpc3BsYXkuPC9saT4iICsgYm90dG9tUm93KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UuY29udGFpbmVyLmh0bWwoIiIpOw0KDQogICAgICAgICAgICAgICAgICAgICAgICBmb3IodmFyIGkgaW4gZ2FtZXMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ2FtZSA9IGdhbWVzW2ldOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZ2V0IGdhbWUgbWFya3VwIHN0cmluZ3MNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY29tcGxldGVkU3RyID0gZ2FtZS5Db21wbGV0ZWQgPyAicGxheWVkLWdhbWUiIDogInVwY29taW5nLWdhbWUiOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpc0hvbWVHYW1lID0gZ2FtZS5Ib21lVGVhbS5Jc1VBbGJlcnRhOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0ZWFtU3RyID0gVXRpbHMuZ2V0UHJvZ3JhbVR5cGUoaXNIb21lR2FtZSA/IGdhbWUuSG9tZVRlYW0uUHJvZ3JhbS5JRCA6IGdhbWUuQXdheVRlYW0uUHJvZ3JhbS5JRCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRlYW1TdHJpbmcgPSAoaXNIb21lR2FtZSA/IChnYW1lLkhvbWVUZWFtLk5hbWUgPT0gbnVsbCA/ICIiIDogKGdhbWUuSG9tZVRlYW0uTmFtZSArICIgIikpIDogKGdhbWUuQXdheVRlYW0uTmFtZSA9PSBudWxsID8gIiIgOiAoZ2FtZS5Bd2F5VGVhbS5OYW1lICsgIiAiKSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBvcHBvbmVudFN0cmluZyA9IGdhbWUuSXNFdmVudCA/IGdhbWUuRXZlbnROYW1lIDogKGlzSG9tZUdhbWUgPyAidnMgIiArIGdhbWUuQXdheVRlYW0uTmFtZSA6ICJAICIgKyBnYW1lLkhvbWVUZWFtLk5hbWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpc0hvbWVXaW4gPSBnYW1lLkNvbXBsZXRlZCA/IGdhbWUuSG9tZVNjb3JlID4gZ2FtZS5Bd2F5U2NvcmUgOiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXNUaWUgPSBnYW1lLkNvbXBsZXRlZCAmJiBnYW1lLkhvbWVTY29yZSA9PSBnYW1lLkF3YXlTY29yZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXNVQWxiZXJ0YVdpbiA9IGlzSG9tZUdhbWUgJiYgaXNIb21lV2luIHx8ICFpc0hvbWVHYW1lICYmICFpc0hvbWVXaW47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdHNTdHIgPSBnYW1lLkNvbXBsZXRlZCAmJiAhZ2FtZS5Jc0V2ZW50ID8gKCI8c3BhbiBjbGFzcz0nV0wnPiIgKyAoaXNIb21lV2luID8gZ2FtZS5Ib21lU2NvcmUgOiBnYW1lLkF3YXlTY29yZSkgKyAiIC0gIiArIChpc0hvbWVXaW4gPyBnYW1lLkF3YXlTY29yZSA6IGdhbWUuSG9tZVNjb3JlKSArICI8c3Bhbj4iICsgKGlzVGllID8gIlQiIDogKGlzVUFsYmVydGFXaW4gPyAoZ2FtZS5PdmVydGltZSA/ICJPVFciIDogIlciKSA6IChnYW1lLk92ZXJ0aW1lID8gIk9UTCIgOiAiTCIpKSkgKyAiPC9zcGFuPjwvc3Bhbj4iKSA6IFVBbGJlcnRhLlNpdGVjb3JlLlV0aWxpdGllcy5HZXREYXRlRnJvbUpzb24oZ2FtZS5TdGFydCwgVUFsYmVydGEuU2l0ZWNvcmUuVXRpbGl0aWVzLkRhdGVGb3JtYXQuTG9uZ05vWWVhcik7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBnZXQgbGluayBzdHJpbmdzDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdhbWVVcmwgPSBnYW1lLkdhbWVVcmwgIT0gbnVsbCA/IGdhbWUuR2FtZVVybCA6ICIjIjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGVhbVVybCA9IGdhbWUuVGVhbVVybCAhPSBudWxsID8gZ2FtZS5UZWFtVXJsIDogIiMiOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZWNhcFVybCA9IGdhbWUuUmVjYXBVcmwgIT0gbnVsbCA/ICIgfCA8YSBocmVmPSciICsgZ2FtZS5SZWNhcFVybCArICInPlJlY2FwPC9hPiIgOiAiIjsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnYW1lSHRtbCA9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICI8bGkgY2xhc3M9J3NjaGVkdWxlLW1vZHVsZSAiICsgY29tcGxldGVkU3RyICsgIiAiICsgdGVhbVN0ciArICInPiIgKw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIjxoNSBjbGFzcz0nc2NoZWR1bGUtdGl0bGUnPiIgKw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICI8YSBocmVmPSciICsgZ2FtZVVybCArICInPiIgKyByZXN1bHRzU3RyICsgIjwvYT4iICsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoZ2FtZS5Db21wbGV0ZWQgPyAiPHNwYW4gY2xhc3M9J3NjaGVkdWxlLWxpbmtzJz4iICsgcmVjYXBVcmwgKyAiIHwgPGEgaHJlZj0nIiArIGdhbWVVcmwgKyAiJz5Cb3hzY29yZTwvYT48L3NwYW4+IiA6ICIiKSArDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiPC9oNT4iICsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICI8c3BhbiBjbGFzcz0nc2NoZWR1bGUtdGVhbXMnPjxhIGhyZWY9JyIgKyB0ZWFtVXJsICsgIic+IiArIHRlYW1TdHJpbmcgKyBnYW1lLkhvbWVUZWFtLlNwb3J0LkRlc2NyaXB0aW9uICsgIjwvYT4gIiArIG9wcG9uZW50U3RyaW5nICsgIjwvc3Bhbj4iICsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIjwvbGk+IjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UuY29udGFpbmVyLmFwcGVuZChnYW1lSHRtbCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFkZCBiYWNrIG9uIGJvdHRvbSByb3cNCiAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5jb250YWluZXIuYXBwZW5kKGJvdHRvbVJvdyk7DQogICAgICAgICAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgICAgICAgICAgLy8gc2hvdyBhbiBlcnJvcg0KICAgICAgICAgICAgICAgICAgICBzaG93RXJyb3I6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHJlbW92ZSBsb2FkZXINCiAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5jb250YWluZXIuZmluZCgibGk6Zmlyc3QiKS5yZW1vdmUoKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2F2ZSBib3R0b20gcm93DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYm90dG9tUm93ID0gSW50ZXJmYWNlLmNvbnRhaW5lci5odG1sKCk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNldCBlcnJvcg0KICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLmNvbnRhaW5lci5odG1sKCI8bGk+QW4gZXJyb3Igb2NjdXJyZWQgd2hpbGUgbG9hZGluZyB0aGUgZ2FtZXMuIFBsZWFzZSByZWZyZXNoIHRoZSBwYWdlIHRvIHRyeSBhZ2Fpbi48L2xpPiIgKyBib3R0b21Sb3cpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgOw0KDQogICAgICAgICAgICAvLyBpbnN0YW5jZSBpbml0aWFsaXphdGlvbg0KICAgICAgICAgICAgZnVuY3Rpb24gaW5pdChjb250YWluZXJJZCwgc2VydmljZVVybCwgZGlzcGxheUxpbWl0KSB7DQogICAgICAgICAgICAgICAgRGF0YS5zZXJ2aWNlVXJsID0gc2VydmljZVVybDsNCiAgICAgICAgICAgICAgICBEYXRhLmRpc3BsYXlMaW1pdCA9IGRpc3BsYXlMaW1pdDsNCg0KICAgICAgICAgICAgICAgIEludGVyZmFjZS5zZXR1cChjb250YWluZXJJZCk7DQogICAgICAgICAgICAgICAgQUpBWC5nZXRHYW1lcygpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgIEluaXRpYWxpemU6IGluaXQNCiAgICAgICAgICAgIH07DQogICAgICAgIH0gKGpRdWVyeSkpOw0KICAgIH0NCg0KICAgIHJldHVybiB7DQogICAgICAgIEdldEluc3RhbmNlOiBnZXRJbnN0YW5jZQ0KICAgIH07DQp9ICgpKTsNCjsNCi8qKg0KKiBVQWxiZXJ0YSBBdGhsZXRpY3MgR2FtZSBTbGlkZXINCiogQXV0aG9yOiBLeWxlIFNjaG1pZHQgLSBreWxlLnNjaG1pZHRAdWFsYmVydGEuY2ENCiovDQoNCi8vIGJ1aWxkIG5hbWVzcGFjZQ0KdmFyIFVBbGJlcnRhID0gVUFsYmVydGEgfHwge307DQpVQWxiZXJ0YS5TaXRlY29yZSA9IFVBbGJlcnRhLlNpdGVjb3JlIHx8IHt9Ow0KDQpVQWxiZXJ0YS5TaXRlY29yZS5BdGhsZXRpY3NHYW1lU2xpZGVyID0gVUFsYmVydGEuU2l0ZWNvcmUuQXRobGV0aWNzR2FtZVNsaWRlciB8fCAoZnVuY3Rpb24gKCkgew0KICAgIGZ1bmN0aW9uIGdldEluc3RhbmNlKCkgew0KICAgICAgICByZXR1cm4gKGZ1bmN0aW9uICgkKSB7DQogICAgICAgICAgICAndXNlIHN0cmljdCc7DQoNCiAgICAgICAgICAgIHZhciBEYXRhID0gew0KICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlVXJsOiAiIiwgLy8gdGhlIHVybCBvZiB0aGUgZ2FtZXMgc2VydmljZQ0KICAgICAgICAgICAgICAgICAgICBnYW1lczogW10sIC8vIHRoZSBsaXN0IG9mIGdhbWVzIHRoYXQgaGF2ZSBiZWVuIGxvYWRlZA0KICAgICAgICAgICAgICAgICAgICBjdXJyZW50RGlzcGxheTogMCwgLy8gdGhlIGN1cnJlbnQgbnVtYmVyIG9mIGdhbWVzIHRvIGRpc3BsYXkgb24gZWFjaCBzbGlkZQ0KDQogICAgICAgICAgICAgICAgICAgIC8vIGNvbnN0YW50cw0KICAgICAgICAgICAgICAgICAgICBDb25zdGFudHM6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGRpc3BsYXkgdHlwZQ0KICAgICAgICAgICAgICAgICAgICAgICAgRGlzcGxheVNpemU6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBTbWFsbDogMiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBNZWRpdW06IDQsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgTGFyZ2U6IDYNCiAgICAgICAgICAgICAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHByb2dyYW0gdHlwZQ0KICAgICAgICAgICAgICAgICAgICAgICAgUHJvZ3JhbVR5cGU6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBCZWFyczogMSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBQYW5kYXM6IDIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgQXRobGV0aWNzOiAzDQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9LA0KDQogICAgICAgICAgICAgICAgVXRpbHMgPSB7DQogICAgICAgICAgICAgICAgICAgIC8vIGdldCB0aGUgY3VycmVudCBkaXNwbGF5IHR5cGUNCiAgICAgICAgICAgICAgICAgICAgZ2V0RGlzcGxheVR5cGU6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkaXNwbGF5VHlwZTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoKFVBbGJlcnRhLlNpdGVjb3JlLlV0aWxpdGllcy5HZXRXaW5kb3dUeXBlKCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFVBbGJlcnRhLlNpdGVjb3JlLlV0aWxpdGllcy5XaW5kb3dUeXBlLlNtYWxsOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgVUFsYmVydGEuU2l0ZWNvcmUuVXRpbGl0aWVzLldpbmRvd1R5cGUuTW9iaWxlOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5VHlwZSA9IERhdGEuQ29uc3RhbnRzLkRpc3BsYXlTaXplLlNtYWxsOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFVBbGJlcnRhLlNpdGVjb3JlLlV0aWxpdGllcy5XaW5kb3dUeXBlLlRhYmxldDoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGlzcGxheVR5cGUgPSBEYXRhLkNvbnN0YW50cy5EaXNwbGF5U2l6ZS5NZWRpdW07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRpc3BsYXlUeXBlID0gRGF0YS5Db25zdGFudHMuRGlzcGxheVNpemUuTGFyZ2U7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGlzcGxheVR5cGU7DQogICAgICAgICAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgICAgICAgICAgLy8gZ2V0IHRoZSBwcm9ncmFtIHR5cGUgbmFtZQ0KICAgICAgICAgICAgICAgICAgICBnZXRQcm9ncmFtVHlwZTogZnVuY3Rpb24gKHByb2dyYW1JZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgc3dpdGNoKHByb2dyYW1JZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgRGF0YS5Db25zdGFudHMuUHJvZ3JhbVR5cGUuQmVhcnM6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAiYmVhcnMiOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIERhdGEuQ29uc3RhbnRzLlByb2dyYW1UeXBlLlBhbmRhczoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICJwYW5kYXMiOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWZhdWx0Og0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gImF0aGxldGljcyI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9LA0KDQogICAgICAgICAgICAgICAgQUpBWCA9IHsNCiAgICAgICAgICAgICAgICAgICAgbG9hZGluZ0RhdGE6IGZhbHNlLA0KDQogICAgICAgICAgICAgICAgICAgIC8vIGdldCBnYW1lcw0KICAgICAgICAgICAgICAgICAgICBnZXRHYW1lczogZnVuY3Rpb24gKGFmdGVyR2FtZUlkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZihBSkFYLmxvYWRpbmdEYXRhKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgQUpBWC5sb2FkaW5nRGF0YSA9IHRydWU7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGdldCBleHRyYSB1cmwgcGFyYW1zDQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXh0cmEgPSAiIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGFmdGVyR2FtZUlkICE9IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4dHJhICs9ICImYWZ0ZXJnYW1lPSIgKyBlbmNvZGVVUklDb21wb25lbnQoYWZ0ZXJHYW1lSWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBnZXQgZGF0YQ0KICAgICAgICAgICAgICAgICAgICAgICAgJC5hamF4KHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhVHlwZTogImpzb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiBBSkFYLkV2ZW50cy5lcnJvciwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBSkFYLkV2ZW50cy5zdWNjZXNzKGRhdGEsIGFmdGVyR2FtZUlkID4gMCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmw6IERhdGEuc2VydmljZVVybCArICImbGltaXQ9IiArIERhdGEuY3VycmVudERpc3BsYXkgKyBleHRyYQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgICAgICAgICAgRXZlbnRzOiB7DQogICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5zaG93RXJyb3IoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBBSkFYLmxvYWRpbmdEYXRhID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9LA0KDQogICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSwgYWRkVG9FbmQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UuYWRkR2FtZXMoZGF0YSwgYWRkVG9FbmQsIGZhbHNlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBBSkFYLmxvYWRpbmdEYXRhID0gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9LA0KDQogICAgICAgICAgICAgICAgSW50ZXJmYWNlID0gew0KICAgICAgICAgICAgICAgICAgICBzbGlkZXI6IFtdLA0KDQogICAgICAgICAgICAgICAgICAgIC8vIHNldHVwIHRoZSBpbnRlcmZhY2UNCiAgICAgICAgICAgICAgICAgICAgc2V0dXA6IGZ1bmN0aW9uIChjb250YWluZXJJZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gZ2V0IHZhcnMNCiAgICAgICAgICAgICAgICAgICAgICAgIERhdGEuY3VycmVudERpc3BsYXkgPSBVdGlscy5nZXREaXNwbGF5VHlwZSgpOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBjcmVhdGUgc2xpZGVyDQogICAgICAgICAgICAgICAgICAgICAgICAkKCIjIiArIGNvbnRhaW5lcklkKS5mbGV4c2xpZGVyKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmltYXRpb246ICJzbGlkZSIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5pbWF0aW9uTG9vcDogZmFsc2UsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbE5hdjogZmFsc2UsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2xpZGVzaG93OiBmYWxzZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydDogSW50ZXJmYWNlLkV2ZW50cy5zbGlkZXJTdGFydCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhZnRlcjogSW50ZXJmYWNlLkV2ZW50cy5zbGlkZXJBZnRlcg0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNldHVwIHJlc2l6ZSBsb2dpYw0KICAgICAgICAgICAgICAgICAgICAgICAgJCh3aW5kb3cpLnJlc2l6ZShmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBVQWxiZXJ0YS5TaXRlY29yZS5VdGlsaXRpZXMuRGVsYXkoSW50ZXJmYWNlLkV2ZW50cy5yZXNpemUsIDMwMCwgY29udGFpbmVySWQgKyAiLXJlc2l6ZSIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgICAgICAgICAgLy8gYWRkIGdhbWVzDQogICAgICAgICAgICAgICAgICAgIGFkZEdhbWVzOiBmdW5jdGlvbihnYW1lcywgYWRkVG9FbmQsIGlzUmVmcmVzaCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gaWYgbm8gZ2FtZXMsIHJlbW92ZSB0aGUgbG9hZGluZyBzbGlkZQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYoZ2FtZXMubGVuZ3RoID09IDAgJiYgIWlzUmVmcmVzaCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHJlbW92ZSBzbGlkZXIgaWYgdGhlcmUgYXJlIG5vIGdhbWVzIHRvIGRpc3BsYXkgYXQgYWxsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoRGF0YS5nYW1lcy5sZW5ndGggPT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2Uuc2xpZGVyLnJlbW92ZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5zbGlkZXIucmVtb3ZlU2xpZGUoYWRkVG9FbmQgPyBJbnRlcmZhY2Uuc2xpZGVyLmNvdW50IC0gMSA6IDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdhbWVzSHRtbCA9IFtdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdhbWVzTGlzdCA9IFtdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNsaWRlSW5kZXggPSBhZGRUb0VuZCA/IEludGVyZmFjZS5zbGlkZXIuY291bnQgLSAxIDogMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnYW1lSW5kZXggPSBhZGRUb0VuZCA/IERhdGEuZ2FtZXMubGVuZ3RoIDogMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzbGlkZVRvID0gc2xpZGVJbmRleCAtIDE7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmlyc3RMb2FkID0gRGF0YS5nYW1lcy5sZW5ndGggPT0gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvcih2YXIgaSBpbiBnYW1lcykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnYW1lID0gZ2FtZXNbaV07DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBnZXQgZ2FtZSBtYXJrdXAgc3RyaW5ncw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjb21wbGV0ZWRTdHIgPSBnYW1lLkNvbXBsZXRlZCA/ICJwbGF5ZWQtZ2FtZSIgOiAidXBjb21pbmctZ2FtZSI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlzSG9tZUdhbWUgPSBnYW1lLkhvbWVUZWFtLklzVUFsYmVydGE7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRlYW1TdHIgPSBVdGlscy5nZXRQcm9ncmFtVHlwZShpc0hvbWVHYW1lID8gZ2FtZS5Ib21lVGVhbS5Qcm9ncmFtLklkIDogZ2FtZS5Bd2F5VGVhbS5Qcm9ncmFtLklkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgb3Bwb25lbnRTdHJpbmcgPSBnYW1lLklzRXZlbnQgPyBnYW1lLkV2ZW50TmFtZSA6IChpc0hvbWVHYW1lID8gInZzICIgKyBnYW1lLkF3YXlUZWFtLk5hbWUgOiAiQCAiICsgZ2FtZS5Ib21lVGVhbS5OYW1lKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXNIb21lV2luID0gZ2FtZS5Db21wbGV0ZWQgPyBnYW1lLkhvbWVTY29yZSA+IGdhbWUuQXdheVNjb3JlIDogZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlzVGllID0gZ2FtZS5Db21wbGV0ZWQgJiYgZ2FtZS5Ib21lU2NvcmUgPT0gZ2FtZS5Bd2F5U2NvcmU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlzVUFsYmVydGFXaW4gPSBpc0hvbWVHYW1lICYmIGlzSG9tZVdpbiB8fCAhaXNIb21lR2FtZSAmJiAhaXNIb21lV2luOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXN1bHRzU3RyID0gZ2FtZS5Db21wbGV0ZWQgJiYgIWdhbWUuSXNFdmVudCA/ICgoaXNIb21lV2luID8gZ2FtZS5Ib21lU2NvcmUgOiBnYW1lLkF3YXlTY29yZSkgKyAiIC0gIiArIChpc0hvbWVXaW4gPyBnYW1lLkF3YXlTY29yZSA6IGdhbWUuSG9tZVNjb3JlKSArICIgIiArIChpc1RpZSA/ICJUIiA6IChpc1VBbGJlcnRhV2luID8gKGdhbWUuT3ZlcnRpbWUgPyAiT1RXIiA6ICJXIikgOiAoZ2FtZS5PdmVydGltZSA/ICJPVEwiIDogIkwiKSkpKSA6IFVBbGJlcnRhLlNpdGVjb3JlLlV0aWxpdGllcy5HZXREYXRlRnJvbUpzb24oZ2FtZS5TdGFydCwgVUFsYmVydGEuU2l0ZWNvcmUuVXRpbGl0aWVzLkRhdGVGb3JtYXQuU2hvcnROb1llYXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpY29uU3RyID0gZ2FtZS5Ib21lVGVhbS5TcG9ydC5EZXNjcmlwdGlvbi50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1xzL2csICItIik7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBnZXQgbGluayBzdHJpbmdzDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdhbWVVcmwgPSBnYW1lLkdhbWVVcmwgIT0gbnVsbCA/IGdhbWUuR2FtZVVybCA6ICIjIjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGVhbVVybCA9IGdhbWUuVGVhbVVybCAhPSBudWxsID8gZ2FtZS5UZWFtVXJsIDogIiMiOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBuZXdzVXJsID0gZ2FtZS5SZWNhcFVybCAhPSBudWxsICYmIGdhbWUuQ29tcGxldGVkID8gIjxhIGhyZWY9JyIgKyBnYW1lLlJlY2FwVXJsICsgIic+UmVjYXA8L2E+IHwgIiA6IChnYW1lLlByZXZpZXdVcmwgIT0gbnVsbCA/ICI8YSBocmVmPSciICsgZ2FtZS5QcmV2aWV3VXJsICsgIic+UHJldmlldzwvYT4gfCAiIDogIiIpOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGdhbWVIdG1sID0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIjxkaXYgY2xhc3M9J2V4dHJ1ZGUgc2NvcmUtbW9kdWxlICIgKyBjb21wbGV0ZWRTdHIgKyAiICIgKyB0ZWFtU3RyICsgIicgZGF0YS1pZD0nIiArIGdhbWUuSWQgKyAiJz4iICsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICI8aDUgY2xhc3M9J3Njb3JlLXRpdGxlJz4iICsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiPGEgaHJlZj0nIiArIHRlYW1VcmwgKyAiJz48aSBjbGFzcz0naWNvbi0iICsgaWNvblN0ciArICInPjwvaT4gIiArIGdhbWUuSG9tZVRlYW0uU3BvcnQuRGVzY3JpcHRpb24gKyAiPC9hPiIgKw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICI8c3BhbiBjbGFzcz0nc2NvcmUtaG92ZXItbGlua3MnPiIgKyBuZXdzVXJsICsgIjxhIGhyZWY9JyIgKyBnYW1lVXJsICsgIic+R2FtZSBJbmZvPC9hPjwvc3Bhbj4iICsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICI8L2g1PiIgKw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIjxzcGFuIGNsYXNzPSdzY29yZS1vcHBvbmVudCc+IiArIG9wcG9uZW50U3RyaW5nICsgIjwvc3Bhbj4iICsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICI8ZGl2IGNsYXNzPSdzY29yZS1yZXN1bHRzJz4iICsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiPGEgaHJlZj0nIiArIGdhbWVVcmwgKyAiJz48aDM+IiArIHJlc3VsdHNTdHIgKyAiPC9oMz48L2E+IiArDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiPC9kaXY+IiArDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICI8L2Rpdj4iOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWVzSHRtbC5wdXNoKGdhbWVIdG1sKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lc0xpc3QucHVzaChnYW1lKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGdhbWVzSHRtbC5sZW5ndGggPT0gRGF0YS5jdXJyZW50RGlzcGxheSB8fCBpID09IGdhbWVzLmxlbmd0aCAtIDEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLnNsaWRlci5hZGRTbGlkZSgiPGxpPiIgKyBnYW1lc0h0bWwuam9pbigiIikgKyAiPC9saT4iLCBzbGlkZUluZGV4KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZXNIdG1sLmxlbmd0aCA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNsaWRlSW5kZXgrKzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoIWFkZFRvRW5kKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzbGlkZVRvKys7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZighaXNSZWZyZXNoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IodmFyIGogaW4gZ2FtZXNMaXN0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRGF0YS5nYW1lcy5zcGxpY2UoZ2FtZUluZGV4LCAwLCBnYW1lc0xpc3Rbal0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWVJbmRleCsrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZXNMaXN0Lmxlbmd0aCA9IDA7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKEludGVyZmFjZS5zbGlkZXIudmFycyAhPSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcHJldmlvdXNBbmltYXRpb25TcGVlZCA9IEludGVyZmFjZS5zbGlkZXIudmFycy5hbmltYXRpb25TcGVlZDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2Uuc2xpZGVyLnZhcnMuYW5pbWF0aW9uU3BlZWQgPSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5zbGlkZXIuZmxleEFuaW1hdGUoZmlyc3RMb2FkID8gMSA6IEludGVyZmFjZS5zbGlkZXIuY3VycmVudFNsaWRlID4gMCA/IHNsaWRlVG8gKyAxIDogc2xpZGVUbyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLnNsaWRlci52YXJzLmFuaW1hdGlvblNwZWVkID0gcHJldmlvdXNBbmltYXRpb25TcGVlZDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLnNsaWRlci5mbGV4QW5pbWF0ZShmaXJzdExvYWQgPyAxIDogc2xpZGVUbyk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgICAgICAgICAgLy8gc2hvdyBhbiBlcnJvcg0KICAgICAgICAgICAgICAgICAgICBzaG93RXJyb3I6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5zbGlkZXIuaHRtbCgiQW4gZXJyb3Igb2NjdXJyZWQgd2hpbGUgbG9hZGluZyB0aGUgZ2FtZXMuIFBsZWFzZSByZWZyZXNoIHRoZSBwYWdlIHRvIHRyeSBhZ2Fpbi4iKTsNCiAgICAgICAgICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgICAgICAgICBFdmVudHM6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNsaWRlciBldmVudCBmb3Igd2hlbiB0aGUgZmlyc3Qgc2xpZGUgaXMgc2hvd24NCiAgICAgICAgICAgICAgICAgICAgICAgIHNsaWRlclN0YXJ0OiBmdW5jdGlvbiAoc2xpZGVyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2F2ZSBzbGlkZXINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2Uuc2xpZGVyID0gc2xpZGVyOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZ2V0IGluaXRpYWwgZ2FtZXMNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBBSkFYLmdldEdhbWVzKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9LA0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBzbGlkZXIgZXZlbnQgYWZ0ZXIgYSBzbGlkZSBoYXMgc2xpZA0KICAgICAgICAgICAgICAgICAgICAgICAgc2xpZGVyQWZ0ZXI6IGZ1bmN0aW9uIChzbGlkZXIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayBmb3IgbmVlZCB0byBsb2FkIHByZXZpb3VzIGdhbWVzDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoc2xpZGVyLmFuaW1hdGluZ1RvID09IDAgJiYgc2xpZGVyLnNsaWRlcy5maXJzdCgpLmhhc0NsYXNzKCJsb2FkaW5nIikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQUpBWC5nZXRHYW1lcyhEYXRhLmdhbWVzWzBdLklkICogLTEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNoZWNrIGZvciBuZWVkIHRvIGxvYWQgbmV4dCBnYW1lcw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKHNsaWRlci5hbmltYXRpbmdUbyA9PSBzbGlkZXIuY291bnQgLSAxICYmIHNsaWRlci5zbGlkZXMubGFzdCgpLmhhc0NsYXNzKCJsb2FkaW5nIikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQUpBWC5nZXRHYW1lcyhEYXRhLmdhbWVzW0RhdGEuZ2FtZXMubGVuZ3RoIC0gMV0uSWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHdpbmRvdy92aWV3cG9ydCB3YXMgcmVzaXplZA0KICAgICAgICAgICAgICAgICAgICAgICAgcmVzaXplOiBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2hlY2sgZm9yIG5ldyBkaXNwbGF5IHR5cGUNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGlzcGxheVR5cGUgPSBVdGlscy5nZXREaXNwbGF5VHlwZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGRpc3BsYXlUeXBlICE9IERhdGEuY3VycmVudERpc3BsYXkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgRGF0YS5jdXJyZW50RGlzcGxheSA9IGRpc3BsYXlUeXBlOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHN0b3JlIGN1cnJlbnQgZmlyc3QgZ2FtZSB2aXNpYmxlDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjdXJyZW50R2FtZSA9ICQoSW50ZXJmYWNlLnNsaWRlci5zbGlkZXNbSW50ZXJmYWNlLnNsaWRlci5jdXJyZW50U2xpZGVdKS5maW5kKCIuc2NvcmUtbW9kdWxlOmZpcnN0IikuZGF0YSgiaWQiKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBlbnN1cmUgImxvYWRpbmciIHNsaWRlcyBhcmUgaW4gcGxhY2UgKHRoaXMgcHJldmVudHMgYSBidWcpDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCFJbnRlcmZhY2Uuc2xpZGVyLnNsaWRlcy5maXJzdCgpLmhhc0NsYXNzKCJsb2FkaW5nIikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5zbGlkZXIuYWRkU2xpZGUoIjxsaSBjbGFzcz0nbG9hZGluZyc+PC9saT4iLCAwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZighSW50ZXJmYWNlLnNsaWRlci5zbGlkZXMubGFzdCgpLmhhc0NsYXNzKCJsb2FkaW5nIikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5zbGlkZXIuYWRkU2xpZGUoIjxsaSBjbGFzcz0nbG9hZGluZyc+PC9saT4iKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHJlbW92ZSBhbGwgZ2FtZSBzbGlkZXMsIHRoZW4gcmUtYWRkIHRoZW0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yKHZhciBpID0gSW50ZXJmYWNlLnNsaWRlci5jb3VudCAtIDE7IGkgPj0gMDsgaS0tKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZighJChJbnRlcmZhY2Uuc2xpZGVyLnNsaWRlc1tpXSkuaGFzQ2xhc3MoImxvYWRpbmciKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5zbGlkZXIucmVtb3ZlU2xpZGUoaSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLmFkZEdhbWVzKERhdGEuZ2FtZXMsIGZhbHNlLCB0cnVlKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBtb3ZlIHRvIHNsaWRlIHRoYXQgaGFzIHRoZSBjdXJyZW50IGdhbWUNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLnNsaWRlci5mbGV4QW5pbWF0ZShJbnRlcmZhY2Uuc2xpZGVyLnNsaWRlcy5maW5kKCJbZGF0YS1pZD0iICsgY3VycmVudEdhbWUgKyAiXSIpLnBhcmVudCgpLmluZGV4KCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIDsNCg0KICAgICAgICAgICAgLy8gaW5zdGFuY2UgaW5pdGlhbGl6YXRpb24NCiAgICAgICAgICAgIGZ1bmN0aW9uIGluaXQoY29udGFpbmVySWQsIHNlcnZpY2VVcmwpIHsNCiAgICAgICAgICAgICAgICBEYXRhLnNlcnZpY2VVcmwgPSBzZXJ2aWNlVXJsOw0KICAgICAgICAgICAgICAgIEludGVyZmFjZS5zZXR1cChjb250YWluZXJJZCk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHJldHVybiB7DQogICAgICAgICAgICAgICAgSW5pdGlhbGl6ZTogaW5pdA0KICAgICAgICAgICAgfTsNCiAgICAgICAgfSAoalF1ZXJ5KSk7DQogICAgfQ0KDQogICAgcmV0dXJuIHsNCiAgICAgICAgR2V0SW5zdGFuY2U6IGdldEluc3RhbmNlDQogICAgfTsNCn0gKCkpOw0KOw0KLyoqDQoqIFVBbGJlcnRhIEF0aGxldGljcyBSb3N0ZXINCiogQXV0aG9yOiBLeWxlIFNjaG1pZHQgLSBreWxlLnNjaG1pZHRAdWFsYmVydGEuY2ENCiovDQoNCi8vIGJ1aWxkIG5hbWVzcGFjZQ0KdmFyIFVBbGJlcnRhID0gVUFsYmVydGEgfHwge307DQpVQWxiZXJ0YS5TaXRlY29yZSA9IFVBbGJlcnRhLlNpdGVjb3JlIHx8IHt9Ow0KDQpVQWxiZXJ0YS5TaXRlY29yZS5BdGhsZXRpY3NSb3N0ZXIgPSBVQWxiZXJ0YS5TaXRlY29yZS5BdGhsZXRpY3NSb3N0ZXIgfHwgKGZ1bmN0aW9uICgpIHsNCiAgICBmdW5jdGlvbiBnZXRJbnN0YW5jZSgpIHsNCiAgICAgICAgcmV0dXJuIChmdW5jdGlvbiAoJCkgew0KICAgICAgICAgICAgJ3VzZSBzdHJpY3QnOw0KDQogICAgICAgICAgICB2YXIgRGF0YSA9IHsNCiAgICAgICAgICAgICAgICAgICAgc2VydmljZVVybDogIiINCiAgICAgICAgICAgICAgICB9LA0KDQogICAgICAgICAgICAgICAgQUpBWCA9IHsNCiAgICAgICAgICAgICAgICAgICAgLy8gZ2V0IHBlcnNvbg0KICAgICAgICAgICAgICAgICAgICBnZXRQZXJzb246IGZ1bmN0aW9uIChlbGVtZW50LCBpZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgJC5hamF4KHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhVHlwZTogImpzb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFKQVguRXZlbnRzLmVycm9yKGVsZW1lbnQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGRhdGEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQUpBWC5FdmVudHMuc3VjY2VzcyhlbGVtZW50LCBkYXRhKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogRGF0YS5zZXJ2aWNlVXJsLnJlcGxhY2UoIntpZH0iLCBlbmNvZGVVUklDb21wb25lbnQoaWQpKQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgICAgICAgICAgRXZlbnRzOiB7DQogICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKGVsZW1lbnQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2Uuc2hvd0Vycm9yKGVsZW1lbnQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGVsZW1lbnQsIHBlcnNvbikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5zaG93UGVyc29uKGVsZW1lbnQsIHBlcnNvbik7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9LA0KDQogICAgICAgICAgICAgICAgSW50ZXJmYWNlID0gew0KICAgICAgICAgICAgICAgICAgICBoaXN0b3J5Q291bnQ6IDAsDQoNCiAgICAgICAgICAgICAgICAgICAgLy8gc2V0dXAgdGhlIGludGVyZmFjZQ0KICAgICAgICAgICAgICAgICAgICBzZXR1cDogZnVuY3Rpb24gKGNvbnRhaW5lcklkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAvLyBzZXQgYWxsIG5hbWUgbGlua3MgdG8gb3BlbiB0aGUgYmlvIGNvbnRhaW5lciBhbmQgZ2V0IHRoZSBwZXJzb24NCiAgICAgICAgICAgICAgICAgICAgICAgICQoIiMiICsgY29udGFpbmVySWQpLmZpbmQoImxpW2RhdGEtaWRdIikubm90KCJsaVtkYXRhLWlkJD0nLWJpbyddIikuY2xpY2soZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGJpb0l0ZW0gPSAkKHRoaXMpLm5leHQoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCIucm9zdGVyIGxpW2RhdGEtaWQkPSctYmlvJ10iKS5ub3QoYmlvSXRlbSkuYWRkQ2xhc3MoImhpZGRlbiIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGJpb0l0ZW0uaGFzQ2xhc3MoImxvYWRpbmciKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBBSkFYLmdldFBlcnNvbigkKHRoaXMpLCAkKHRoaXMpLmRhdGEoImlkIikpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiaW9JdGVtLnRvZ2dsZUNsYXNzKCJoaWRkZW4iKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaGFzaCA9IGJpb0l0ZW0uaGFzQ2xhc3MoImhpZGRlbiIpID8gIiIgOiAkKHRoaXMpLmF0dHIoImlkIik7DQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gb3BlbiBwcmVzZXQgcGVyc29uDQogICAgICAgICAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5leHBhbmRQZXJzb24oY29udGFpbmVySWQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSwgMTAwKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gaGFzaCBjaGFuZ2UgZXZlbnQNCiAgICAgICAgICAgICAgICAgICAgICAgICQod2luZG93KS5oYXNoY2hhbmdlKGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UuZXhwYW5kUGVyc29uKGNvbnRhaW5lcklkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICB9LA0KDQogICAgICAgICAgICAgICAgICAgIC8vIGV4cGFuZCBwZXJzb24NCiAgICAgICAgICAgICAgICAgICAgZXhwYW5kUGVyc29uOiBmdW5jdGlvbiAoY29udGFpbmVySWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNoZWNrIGhhc2gNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoYXNoID0gd2luZG93LmxvY2F0aW9uLmhhc2gucmVwbGFjZSgiIyIsICIiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKGhhc2ggPT0gIiIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBoaWRlIGFsbCBiaW9zDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgiLnJvc3RlciBsaVtkYXRhLWlkJD0nLWJpbyddIikuYWRkQ2xhc3MoImhpZGRlbiIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayBpZiB0aGUgaGFzaCBpdGVtIGlzIGhpZGRlbg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKCQoIiMiICsgY29udGFpbmVySWQpLmZpbmQoIiMiICsgaGFzaCkubmV4dCgpLmhhc0NsYXNzKCJoaWRkZW4iKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBzaW11bGF0ZSBjbGljayBvbiB0aGUgaGFzaCBpdGVtDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoIiMiICsgY29udGFpbmVySWQpLmZpbmQoIiMiICsgaGFzaCkuY2xpY2soKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgICAgICAgICAgLy8gc2hvdyB0aGUgcGVyc29uDQogICAgICAgICAgICAgICAgICAgIHNob3dQZXJzb246IGZ1bmN0aW9uIChlbGVtZW50LCBwZXJzb24pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBiaW9JdGVtID0gZWxlbWVudC5uZXh0KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiaW9JdGVtLnRvZ2dsZUNsYXNzKCJsb2FkaW5nIik7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBodG1sID0gIiI7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGltYWdlDQogICAgICAgICAgICAgICAgICAgICAgICBpZihwZXJzb24uSGFzUGhvdG8pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sICs9ICI8aW1nIHNyYz0nIiArIERhdGEuc2VydmljZVVybC5yZXBsYWNlKCJ7aWR9IiwgZW5jb2RlVVJJQ29tcG9uZW50KHBlcnNvbi5JZCkpICsgIi9pbWFnZSIgKyAiJyBhbHQ9JyIgKyBwZXJzb24uRmlyc3ROYW1lICsgIiAiICsgcGVyc29uLkxhc3ROYW1lICsgIicvPiI7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGZpZWxkcw0KICAgICAgICAgICAgICAgICAgICAgICAgaHRtbCArPSAiPHVsIGNsYXNzPSdyb3N0ZXItaXRlbSc+IjsNCiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWwgKz0gSW50ZXJmYWNlLmFkZEZpZWxkKCJQb3NpdGlvbiIsIHBlcnNvbi5Qb3NpdGlvbik7DQogICAgICAgICAgICAgICAgICAgICAgICBodG1sICs9IEludGVyZmFjZS5hZGRGaWVsZCgiSGVpZ2h0IiwgcGVyc29uLkhlaWdodCk7DQogICAgICAgICAgICAgICAgICAgICAgICBodG1sICs9IEludGVyZmFjZS5hZGRGaWVsZCgiRWxpZ2liaWxpdHkiLCBwZXJzb24uRWxpZ2liaWxpdHkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaHRtbCArPSBJbnRlcmZhY2UuYWRkRmllbGQoIkZhY3VsdHkiLCBwZXJzb24uRmFjdWx0eSk7DQogICAgICAgICAgICAgICAgICAgICAgICBodG1sICs9IEludGVyZmFjZS5hZGRGaWVsZCgiSG9tZXRvd24iLCBwZXJzb24uSG9tZXRvd24pOw0KICAgICAgICAgICAgICAgICAgICAgICAgaHRtbCArPSBJbnRlcmZhY2UuYWRkRmllbGQoIkxhc3QgVGVhbSIsIHBlcnNvbi5QcmV2aW91c1RlYW0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgaHRtbCArPSBJbnRlcmZhY2UuYWRkRmllbGQoIkV4cGVyaWVuY2UiLCBwZXJzb24uWWVhcnMsICIgeWVhcihzKSIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaHRtbCArPSBJbnRlcmZhY2UuYWRkRmllbGQoIlR3aXR0ZXIiLCBwZXJzb24uVHdpdHRlciAhPSB1bmRlZmluZWQgJiYgcGVyc29uLlR3aXR0ZXIgIT0gIiIgPyAiPGEgaHJlZj0naHR0cDovL3R3aXR0ZXIuY29tLyIgKyBwZXJzb24uVHdpdHRlciArICInIHRhcmdldD0nX2JsYW5rJz5AIiArIHBlcnNvbi5Ud2l0dGVyICsgIjwvYT4iIDogcGVyc29uLlR3aXR0ZXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaHRtbCArPSBJbnRlcmZhY2UuYWRkRmllbGQoIkVNYWlsIiwgcGVyc29uLkVtYWlsICE9IHVuZGVmaW5lZCAmJiBwZXJzb24uRW1haWwgIT0gIiIgPyAiPGEgaHJlZj0nbWFpbHRvOiIgKyBwZXJzb24uRW1haWwgKyAiJz4iICsgcGVyc29uLkVtYWlsICsgIjwvYT4iIDogcGVyc29uLkVtYWlsKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gYWRkIGFkb3B0IHVybA0KICAgICAgICAgICAgICAgICAgICAgICAgaWYocGVyc29uLkFkb3B0VXJsICE9IHVuZGVmaW5lZCAmJiBwZXJzb24uQWRvcHRVcmwgIT0gIiIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sICs9ICI8bGk+PGEgY2xhc3M9J2J0biBidG4tbWljcm8gYnRuLWdyZWVuJyBocmVmPSciICsgcGVyc29uLkFkb3B0VXJsICsgIicgdGFyZ2V0PSdfYmxhbmsnPkFkb3B0IFRoaXMgQXRobGV0ZTwvYT48L2xpPiI7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWwgKz0gIjwvdWw+IjsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gYmlvDQogICAgICAgICAgICAgICAgICAgICAgICBodG1sICs9ICI8ZGl2PiIgKyBwZXJzb24uQmlvICsgIjwvZGl2PiI7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGJpb0l0ZW0uaHRtbChodG1sKTsNCiAgICAgICAgICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgICAgICAgICAvLyBhZGQgZmllbGQNCiAgICAgICAgICAgICAgICAgICAgYWRkRmllbGQ6IGZ1bmN0aW9uIChsYWJlbCwgdmFsdWUsIGV4dHJhKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZihleHRyYSA9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleHRyYSA9ICIiOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYodmFsdWUgIT0gdW5kZWZpbmVkICYmIHZhbHVlICE9ICIiKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICI8bGk+PHNwYW4+IiArIGxhYmVsICsgIjo8L3NwYW4+ICIgKyB2YWx1ZSArIGV4dHJhICsgIjwvbGk+IjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAiIjsNCiAgICAgICAgICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgICAgICAgICAvLyBzaG93IGFuIGVycm9yDQogICAgICAgICAgICAgICAgICAgIHNob3dFcnJvcjogZnVuY3Rpb24gKGVsZW1lbnQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBiaW9JdGVtID0gZWxlbWVudC5uZXh0KCk7DQogICAgICAgICAgICAgICAgICAgICAgICBiaW9JdGVtLnRvZ2dsZUNsYXNzKCJsb2FkaW5nIik7DQogICAgICAgICAgICAgICAgICAgICAgICBiaW9JdGVtLmh0bWwoIkFuIGVycm9yIG9jY3VycmVkIHdoaWxlIG9idGFpbmluZyB0aGUgcGVyc29uLiBQbGVhc2UgcmVmcmVzaCB0aGUgcGFnZSBhbmQgdHJ5IGFnYWluLiIpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgOw0KDQogICAgICAgICAgICAvLyBpbnN0YW5jZSBpbml0aWFsaXphdGlvbg0KICAgICAgICAgICAgZnVuY3Rpb24gaW5pdChjb250YWluZXJJZCwgc2VydmljZVVybCkgew0KICAgICAgICAgICAgICAgIERhdGEuc2VydmljZVVybCA9IHNlcnZpY2VVcmw7DQogICAgICAgICAgICAgICAgSW50ZXJmYWNlLnNldHVwKGNvbnRhaW5lcklkKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICBJbml0aWFsaXplOiBpbml0DQogICAgICAgICAgICB9Ow0KICAgICAgICB9IChqUXVlcnkpKTsNCiAgICB9DQoNCiAgICByZXR1cm4gew0KICAgICAgICBHZXRJbnN0YW5jZTogZ2V0SW5zdGFuY2UNCiAgICB9Ow0KfSAoKSk7DQo7DQovKioNCiogVUFsYmVydGEgQXRobGV0aWNzIFNjaGVkdWxlDQoqIEF1dGhvcjogS3lsZSBTY2htaWR0IC0ga3lsZS5zY2htaWR0QHVhbGJlcnRhLmNhDQoqLw0KDQovLyBidWlsZCBuYW1lc3BhY2UNCnZhciBVQWxiZXJ0YSA9IFVBbGJlcnRhIHx8IHt9Ow0KVUFsYmVydGEuU2l0ZWNvcmUgPSBVQWxiZXJ0YS5TaXRlY29yZSB8fCB7fTsNCg0KVUFsYmVydGEuU2l0ZWNvcmUuQXRobGV0aWNzU2NoZWR1bGUgPSBVQWxiZXJ0YS5TaXRlY29yZS5BdGhsZXRpY3NTY2hlZHVsZSB8fCAoZnVuY3Rpb24gKCkgew0KDQogICAgZnVuY3Rpb24gZ2V0SW5zdGFuY2UoKSB7DQogICAgICAgIHJldHVybiAoZnVuY3Rpb24gKCQpIHsNCiAgICAgICAgICAgICd1c2Ugc3RyaWN0JzsNCg0KICAgICAgICAgICAgdmFyIERhdGEgPSB7DQogICAgICAgICAgICAgICAgdGVhbXM6IFtdLCAvLyB0ZWFtcw0KICAgICAgICAgICAgICAgIHRlYW1JdGVtczogW10sIC8vIHRlYW0gaXRlbXMNCiAgICAgICAgICAgICAgICBjdXJyZW50RGF0ZTogIiIsIC8vIHRoZSBjdXJyZW50IGRhdGUNCiAgICAgICAgICAgICAgICBnYW1lczogW10sIC8vIGdhbWVzDQogICAgICAgICAgICAgICAgdGVhbUlkOiBbXSwgLy8gdGVhbSB0byBzaG93IHNjaGVkdWxlIGZvcg0KDQogICAgICAgICAgICAgICAgLy8gQ29uc3RhbnQgdmFsdWVzDQogICAgICAgICAgICAgICAgQ29uc3RhbnRzOiB7DQogICAgICAgICAgICAgICAgICAgIC8vIENhbGVuZGFyIHR5cGVzDQogICAgICAgICAgICAgICAgICAgIENhbGVuZGFyVHlwZXM6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIERheTogImRheSIsDQogICAgICAgICAgICAgICAgICAgICAgICBNb250aDogIm1vbnRoIg0KICAgICAgICAgICAgICAgICAgICB9LA0KDQogICAgICAgICAgICAgICAgICAgIC8vIERhdGUgcG9zdGZpeA0KICAgICAgICAgICAgICAgICAgICBEYXRlUG9zdGZpeDogIlQwMDowMDowMC4wMDAtMDA6MDAiLA0KDQogICAgICAgICAgICAgICAgICAgIC8vIEdhbWVzIHBlciBwYWdlDQogICAgICAgICAgICAgICAgICAgIEdhbWVzUGVyUGFnZTogMTANCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIFV0aWxzID0gew0KICAgICAgICAgICAgICAgICAgICAvLyBMZWZ0IHBhZCBhIHN0cmluZyB1c2luZyB0aGUgc3BlY2lmaWVkIHN0cmluZyB1cCB0byB0aGUgZGVzaXJlZCBsZW5ndGgNCiAgICAgICAgICAgICAgICAgICAgcGFkTGVmdDogZnVuY3Rpb24gKHRoZVN0cmluZywgcGFkU3RyaW5nLCBsZW5ndGgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGVTdHJpbmcudG9TdHJpbmcoKS5sZW5ndGggPCBsZW5ndGggPyBVdGlscy5wYWRMZWZ0KHBhZFN0cmluZyArIHRoZVN0cmluZywgcGFkU3RyaW5nLCBsZW5ndGgpIDogdGhlU3RyaW5nOw0KICAgICAgICAgICAgICAgICAgICB9LA0KDQogICAgICAgICAgICAgICAgICAgIC8vIEdldCB0aGUgdmFsdWUgb2YgYSBtdWx0aWxpc3Qgd2lkZ2V0DQogICAgICAgICAgICAgICAgICAgIGdldE11bHRpbGlzdFZhbHVlOiBmdW5jdGlvbiAob2JqKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gb2JqLm11bHRpc2VsZWN0KCJnZXRTZWxlY3RlZCIpLnZhbCgpIHx8IFtdOw0KICAgICAgICAgICAgICAgICAgICB9LA0KDQogICAgICAgICAgICAgICAgICAgIC8vIFNldCB0aGUgdmFsdWUgb2YgYSBtdWx0aWxpc3Qgd2lkZ2V0DQogICAgICAgICAgICAgICAgICAgIHNldE11bHRpbGlzdFZhbHVlOiBmdW5jdGlvbiAob2JqLCB2YWx1ZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgb2JqLnZhbCh2YWx1ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICBvYmoubXVsdGlzZWxlY3QoInJlZnJlc2giKTsNCiAgICAgICAgICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgICAgICAgICAvLyBHZXQgdGhlIHZhbHVlIG9mIGEgZGF0ZXBpY2tlciB3aWRnZXQNCiAgICAgICAgICAgICAgICAgICAgZ2V0RGF0ZXBpY2tlclZhbHVlOiBmdW5jdGlvbiAob2JqKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gb2JqLmRhdGEoImRhdGVwaWNrZXIiKS5nZXRGb3JtYXR0ZWREYXRlKCk7DQogICAgICAgICAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgYSBkYXRlIGlzIGJlZm9yZSBhbm90aGVyIGRhdGUNCiAgICAgICAgICAgICAgICAgICAgaXNEYXRlQmVmb3JlOiBmdW5jdGlvbiAodmFsdWUsIGNoZWNrRGF0ZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGUgPSBEYXRlLnBhcnNlKHZhbHVlLnN1YnN0cigwLCAxMCkpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJlZm9yZURhdGUgPSBEYXRlLnBhcnNlKGNoZWNrRGF0ZS5zdWJzdHIoMCwgMTApKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzTmFOKGRhdGUpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZSA9IERhdGUucGFyc2UoJC5mb3JtYXQuZGF0ZSh2YWx1ZS5zdWJzdHIoMCwgMTApICsgRGF0YS5Db25zdGFudHMuRGF0ZVBvc3RmaXgsIFVBbGJlcnRhLlNpdGVjb3JlLlV0aWxpdGllcy5EYXRlRm9ybWF0LlNob3J0KSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmVmb3JlRGF0ZSA9IERhdGUucGFyc2UoJC5mb3JtYXQuZGF0ZShjaGVja0RhdGUuc3Vic3RyKDAsIDEwKSArIERhdGEuQ29uc3RhbnRzLkRhdGVQb3N0Zml4LCBVQWxiZXJ0YS5TaXRlY29yZS5VdGlsaXRpZXMuRGF0ZUZvcm1hdC5TaG9ydCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNOYU4oZGF0ZSkgfHwgaXNOYU4oYmVmb3JlRGF0ZSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRlIDw9IGJlZm9yZURhdGU7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIEFKQVggPSB7DQogICAgICAgICAgICAgICAgICAgIGN1cnJlbnRSZXF1ZXN0OiB1bmRlZmluZWQsIC8vIHRoZSBjdXJyZW50IEFKQVggeGhyIGl0ZW0NCg0KICAgICAgICAgICAgICAgICAgICAvLyBnZXQgZ2FtZXMgZnJvbSBzZXJ2ZXIgb3IgY2FjaGUgaWYgYWxyZWFkeSBwdWxsZWQNCiAgICAgICAgICAgICAgICAgICAgZ2V0R2FtZXM6IGZ1bmN0aW9uIChkYXRlVHlwZSwgZGF0ZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2hlY2sgaWYgYSByZXF1ZXN0IGlzIGFscmVhZHkgaW4gcHJvZ3Jlc3MNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChBSkFYLmN1cnJlbnRSZXF1ZXN0ICE9IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFib3J0IHJlcXVlc3QgYW5kIHJlc2V0IHZhcg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFKQVguY3VycmVudFJlcXVlc3QuYWJvcnQoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2hlY2sgaWYgcGFyYW1zIG5vdCBwYXNzZWQgaW4NCiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGVUeXBlID0gZGF0ZVR5cGUgIT09IHVuZGVmaW5lZCA/IGRhdGVUeXBlIDogVXRpbHMuZ2V0TXVsdGlsaXN0VmFsdWUoSW50ZXJmYWNlLmNhbGVuZGFyVHlwZUNvbnRyb2wpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZSA9IGRhdGUgIT09IHVuZGVmaW5lZCA/IGRhdGUgOiAoZGF0ZVR5cGUgPT0gRGF0YS5Db25zdGFudHMuQ2FsZW5kYXJUeXBlcy5Nb250aCA/IChJbnRlcmZhY2UubW9udGhWaXNpYmxlICsgIi0wMSIpIDogVXRpbHMuZ2V0RGF0ZXBpY2tlclZhbHVlKEludGVyZmFjZS5jYWxlbmRhckNvbnRyb2wpKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gZ2V0IG1vbnRoIGFuZCB5ZWFyIGZyb20gZGF0ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1vbnRoU3RyaW5nID0gZGF0ZS5zdWJzdHIoMCwgNyk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNob3cgZGF0ZSBzdHJpbmcNCiAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5zaG93RGF0ZVRleHQoZGF0ZVR5cGUsIGRhdGUpOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBjbGVhciBnYW1lIGxpc3QgY29udHJvbCBhbmQgcGFnaW5nIGNvbnRyb2wNCiAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5nYW1lTGlzdENvbnRyb2wuaHRtbCgiIik7DQogICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UuZ2FtZVBhZ2luZ0NvbnRyb2wuaHRtbCgiIik7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNob3cgbG9hZGluZyBzcGlubmVyDQogICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2Uuc2hvd0xvYWRpbmcoKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2hlY2sgaWYgZ2FtZXMgYXJlIGFscmVhZHkgc2F2ZWQNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciByZXF1ZXN0ID0geyBNb250aDogbW9udGhTdHJpbmcgfTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChEYXRhLmdhbWVzW21vbnRoU3RyaW5nXSA9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBnZXQgZXh0cmEgc2VydmljZSB1cmwgc3RyaW5nDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNlcnZpY2VVcmxFeHRyYSA9ICIiOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChEYXRhLnRlYW1JZC5sZW5ndGggPiAxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlcnZpY2VVcmxFeHRyYSA9ICJQcm9ncmFtLyIgKyBEYXRhLnRlYW1JZFswXSArICIvU3BvcnQvIiArIERhdGEudGVhbUlkWzFdICsgIi8iOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGdldCBnYW1lcyBmb3IgbW9udGggZnJvbSBzZXJ2aWNlDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgQUpBWC5jdXJyZW50UmVxdWVzdCA9ICQuYWpheCh7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhY2hlOiBmYWxzZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGVudFR5cGU6ICJhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PXV0Zi04IiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YTogJC50b0pTT04ocmVxdWVzdCksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRhdGFUeXBlOiAianNvbiIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiBBSkFYLkV2ZW50cy5lcnJvciwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGRhdGEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFKQVguRXZlbnRzLnN1Y2Nlc3MobW9udGhTdHJpbmcsIGRhdGEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAiUE9TVCIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogIi9hcGkvYXRobGV0aWNzLyIgKyBzZXJ2aWNlVXJsRXh0cmEgKyAiZ2FtZXMuanNvbiINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZ2V0IGdhbWVzIGZyb20gYXJyYXkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2Uuc2hvd0dhbWVzKERhdGEuZ2FtZXNbbW9udGhTdHJpbmddKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgICAgICAgICBFdmVudHM6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLmdhbWVMaXN0Q29udHJvbC5odG1sKCI8bGk+PHA+QW4gZXJyb3Igb2NjdXJyZWQgd2hpbGUgb2J0YWluaW5nIGdhbWUvZXZlbnQgaW5mb3JtYXRpb24uIFBsZWFzZSByZWZyZXNoIHRoZSBwYWdlIGFuZCB0cnkgYWdhaW4uPC9wPjwvbGk+Iik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgQUpBWC5jdXJyZW50UmVxdWVzdCA9IHVuZGVmaW5lZDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChtb250aFN0cmluZywgZGF0YSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIERhdGEuZ2FtZXNbbW9udGhTdHJpbmddID0gZGF0YTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2Uuc2hvd0dhbWVzKGRhdGEpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFKQVguY3VycmVudFJlcXVlc3QgPSB1bmRlZmluZWQ7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIEludGVyZmFjZSA9IHsNCiAgICAgICAgICAgICAgICAgICAgY29udGFpbmVySWQ6ICIiLCAgICAgICAgICAvLyBpZCBvZiB0aGUgY29udGFpbmVyIG9mIHRoZSBzY2hlZHVsZQ0KICAgICAgICAgICAgICAgICAgICBjYWxlbmRhckNvbnRyb2w6IFtdLCAgICAgIC8vIGNhbGVuZGFyIGNvbnRyb2wNCiAgICAgICAgICAgICAgICAgICAgY2FsZW5kYXJUeXBlQ29udHJvbDogW10sICAvLyBjYWxlbmRhciB0eXBlIGNvbnRyb2wNCiAgICAgICAgICAgICAgICAgICAgdGVhbUxpc3RDb250cm9sOiBbXSwgICAgICAvLyB0ZWFtIGxpc3QgY29udHJvbA0KICAgICAgICAgICAgICAgICAgICBkYXRlVGV4dENvbnRyb2w6IFtdLCAgICAgIC8vIHNlbGVjdGVkIGRhdGUgdGV4dCBjb250cm9sDQogICAgICAgICAgICAgICAgICAgIGdhbWVMaXN0Q29udHJvbDogW10sICAgICAvLyBnYW1lIGxpc3QgY29udHJvbA0KICAgICAgICAgICAgICAgICAgICBnYW1lUGFnaW5nQ29udHJvbDogW10sICAgLy8gZ2FtZSBwYWdpbmcgY29udHJvbA0KICAgICAgICAgICAgICAgICAgICBtb250aFZpc2libGU6ICIiLCAgICAgICAgIC8vIHRoZSBtb250aCB2aXNpYmxlIGluIHRoZSBjYWxlbmRhciBjb250cm9sLA0KICAgICAgICAgICAgICAgICAgICBnYW1lc1Zpc2libGU6IFtdLCAgICAgICAgLy8gdGhlIGdhbWVzIHRoYXQgY2FuIGJlIHNlZW4gKGJhc2VkIG9uIGZpbHRlcnMpLCB1c2VkIGZvciBwYWdpbmcNCiAgICAgICAgICAgICAgICAgICAgbG9hZGluZ1NlbGVjdG9yOiAiIiwgICAgICAvLyB0aGUgc2VsZWN0b3IgZm9yIHRoZSBsb2FkaW5nIHNwaW5uZXINCg0KICAgICAgICAgICAgICAgICAgICAvLyBzZXR1cCB0aGUgaW50ZXJmYWNlDQogICAgICAgICAgICAgICAgICAgIHNldHVwOiBmdW5jdGlvbiAoY29udGFpbmVySWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGdldCBpbnRlcmZhY2UgY29tcG9uZW50cw0KICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLmNvbnRhaW5lcklkID0gY29udGFpbmVySWQ7DQogICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UuY2FsZW5kYXJDb250cm9sID0gJCgiIyIgKyBJbnRlcmZhY2UuY29udGFpbmVySWQgKyAiIC5ldmVudC1saXN0LWNhbGVuZGFyLWZpbHRlciIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLmNhbGVuZGFyVHlwZUNvbnRyb2wgPSAkKCIjIiArIEludGVyZmFjZS5jb250YWluZXJJZCArICIgLmZpbHRlci1kYXkgc2VsZWN0Iik7DQogICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UudGVhbUxpc3RDb250cm9sID0gJCgiIyIgKyBJbnRlcmZhY2UuY29udGFpbmVySWQgKyAiIC5jYWxlbmRhci1ldmVudCBzZWxlY3QiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5kYXRlVGV4dENvbnRyb2wgPSAkKCIjIiArIGNvbnRhaW5lcklkICsgIiAubGF0ZXN0LW5ld3MgLmZpbHRlcmVkLWJ5Iik7DQogICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UuZ2FtZUxpc3RDb250cm9sID0gJCgiIyIgKyBjb250YWluZXJJZCArICIgLmV2ZW50LWxpc3QiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5nYW1lUGFnaW5nQ29udHJvbCA9ICQoIiMiICsgY29udGFpbmVySWQgKyAiIC5ldmVudHMtcGFnaW5hdGlvbiIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLmxvYWRpbmdTZWxlY3RvciA9ICIjIiArIGNvbnRhaW5lcklkICsgIiAuZXZlbnRzLWxvYWRpbmciOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBzZXQgZGVmYXVsdCB2YWx1ZXMNCiAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5jYWxlbmRhclR5cGVDb250cm9sLnZhbChEYXRhLkNvbnN0YW50cy5DYWxlbmRhclR5cGVzLk1vbnRoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh3aW5kb3cubG9jYXRpb24uaGFzaCAhPSAiIikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS50ZWFtTGlzdENvbnRyb2wudmFsKHdpbmRvdy5sb2NhdGlvbi5oYXNoLnJlcGxhY2UoIiMiLCAiIikuc3BsaXQoIjsiKSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNyZWF0ZSB3aWRnZXRzDQogICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UuY2FsZW5kYXJDb250cm9sLmRhdGVwaWNrZXIoew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdDogInl5eXktbW0tZGQiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvZGF5SGlnaGxpZ2h0OiB0cnVlDQogICAgICAgICAgICAgICAgICAgICAgICB9KS5vbigiY2hhbmdlTW9udGgiLCBJbnRlcmZhY2UuRXZlbnRzLm1vbnRoQ2hhbmdlZCkub24oImNoYW5nZURhdGUiLCBJbnRlcmZhY2UuRXZlbnRzLmRhdGVTZWxlY3RlZCk7DQogICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UuY2FsZW5kYXJUeXBlQ29udHJvbC5tdWx0aXNlbGVjdCh7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U6IEludGVyZmFjZS5FdmVudHMuY2FsZW5kYXJUeXBlQ2hhbmdlZA0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UudGVhbUxpc3RDb250cm9sLm11bHRpc2VsZWN0KHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBidXR0b25UZXh0OiBVQWxiZXJ0YS5TaXRlY29yZS5VdGlsaXRpZXMuTXVsdGlzZWxlY3RCdXR0b25UZXh0LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlOiBmdW5jdGlvbiAoZWxlbWVudCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaGFzaCA9IFV0aWxzLmdldE11bHRpbGlzdFZhbHVlKEludGVyZmFjZS50ZWFtTGlzdENvbnRyb2wpLmpvaW4oIjsiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLkV2ZW50cy5maWx0ZXJMaXN0Q2hhbmdlZCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBoYXNoIGNoYW5nZSBldmVudA0KICAgICAgICAgICAgICAgICAgICAgICAgJCh3aW5kb3cpLmhhc2hjaGFuZ2UoZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIFV0aWxzLnNldE11bHRpbGlzdFZhbHVlKEludGVyZmFjZS50ZWFtTGlzdENvbnRyb2wsIHdpbmRvdy5sb2NhdGlvbi5oYXNoLnJlcGxhY2UoIiMiLCAiIikuc3BsaXQoIjsiKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgQUpBWC5nZXRHYW1lcygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNldCBzdG9yZWQgdmFsdWVzDQogICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UubW9udGhWaXNpYmxlID0gVXRpbHMuZ2V0RGF0ZXBpY2tlclZhbHVlKEludGVyZmFjZS5jYWxlbmRhckNvbnRyb2wpLnN1YnN0cigwLCA3KTsNCiAgICAgICAgICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgICAgICAgICAvLyBzaG93IGRhdGUgdGV4dA0KICAgICAgICAgICAgICAgICAgICBzaG93RGF0ZVRleHQ6IGZ1bmN0aW9uIChkYXRlVHlwZSwgZGF0ZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGh0bWwgPSAifCAiOw0KDQogICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKGRhdGVUeXBlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBEYXRhLkNvbnN0YW50cy5DYWxlbmRhclR5cGVzLkRheToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaHRtbCArPSAkLmZvcm1hdC5kYXRlKGRhdGUgKyAiICIsICJkZGQsIE1NTU0gZCwgeXl5eSIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIERhdGEuQ29uc3RhbnRzLkNhbGVuZGFyVHlwZXMuTW9udGg6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWwgKz0gJC5mb3JtYXQuZGF0ZShkYXRlICsgIiAiLCAiTU1NTSwgeXl5eSIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLmRhdGVUZXh0Q29udHJvbC5odG1sKGh0bWwpOw0KICAgICAgICAgICAgICAgICAgICB9LA0KDQogICAgICAgICAgICAgICAgICAgIC8vIHNob3cgZ2FtZXMgb24gcGFnZQ0KICAgICAgICAgICAgICAgICAgICBzaG93R2FtZXM6IGZ1bmN0aW9uIChnYW1lTGlzdCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gZW1wdHkgdGhlIHZpZXdhYmxlIGdhbWVzIGxpc3QNCiAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5nYW1lc1Zpc2libGUubGVuZ3RoID0gMDsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gcHJvY2VzcyBnYW1lcw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSBpbiBnYW1lTGlzdCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnYW1lID0gZ2FtZUxpc3RbaV07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSEFDSzogRW5zdXJlIHdlIGFyZSBvbmx5IHByb2Nlc3NpbmcgYWN0dWFsIGdhbWVzDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGdhbWUuSWQgPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGZpeCBnYW1lIHN0YXJ0IGRhdGUNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnYW1lLlN0YXJ0RGF0ZSA9IFVBbGJlcnRhLlNpdGVjb3JlLlV0aWxpdGllcy5HZXREYXRlRnJvbUpzb24oZ2FtZS5TdGFydCwgVUFsYmVydGEuU2l0ZWNvcmUuVXRpbGl0aWVzLkRhdGVGb3JtYXQuU2hvcnROb1llYXIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdhbWUuU3RhcnRUaW1lID0gVUFsYmVydGEuU2l0ZWNvcmUuVXRpbGl0aWVzLkdldERhdGVGcm9tSnNvbihnYW1lLlN0YXJ0LCBVQWxiZXJ0YS5TaXRlY29yZS5VdGlsaXRpZXMuRGF0ZUZvcm1hdC5UaW1lT25seSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2FtZS5TdGFydFVuaXggPSBVQWxiZXJ0YS5TaXRlY29yZS5VdGlsaXRpZXMuR2V0RGF0ZUZyb21Kc29uKGdhbWUuU3RhcnQsIFVBbGJlcnRhLlNpdGVjb3JlLlV0aWxpdGllcy5EYXRlRm9ybWF0LlVuaXhEYXRlT25seSk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayBmaWx0ZXJzDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFJbnRlcmZhY2UuY2hlY2tGaWx0ZXJzKGdhbWUpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFkZCBnYW1lIHRvIHZpZXdhYmxlIGxpc3QNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UuZ2FtZXNWaXNpYmxlLnB1c2goZ2FtZSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGRpc3BsYXkgZmlyc3QgcGFnZSBvZiBnYW1lcw0KICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLnNob3dQYWdlKDEpOw0KICAgICAgICAgICAgICAgICAgICB9LA0KDQogICAgICAgICAgICAgICAgICAgIC8vIHNob3cgcGFnaW5nIGxpbmtzDQogICAgICAgICAgICAgICAgICAgIHNob3dQYWdpbmc6IGZ1bmN0aW9uIChwYWdlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAvLyBjbGVhciBwYWdlcw0KICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLmdhbWVQYWdpbmdDb250cm9sLmh0bWwoIiIpOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayBmb3IgZW1wdHkgbGlzdA0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEludGVyZmFjZS5nYW1lc1Zpc2libGUubGVuZ3RoID09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFkZCBwYWdlcw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFjdGl2ZVBhZ2UgPSBwYXJzZUludChwYWdlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtYXhQYWdlID0gTWF0aC5jZWlsKEludGVyZmFjZS5nYW1lc1Zpc2libGUubGVuZ3RoIC8gMTApOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPD0gbWF4UGFnZTsgaSsrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2hlY2sgZm9yIGFjdGl2ZSBwYWdlDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkgPT0gYWN0aXZlUGFnZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UuZ2FtZVBhZ2luZ0NvbnRyb2wuYXBwZW5kKCc8bGkgY2xhc3M9ImFjdGl2ZSI+JyArIGkgKyAnPC9saT4nKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UuZ2FtZVBhZ2luZ0NvbnRyb2wuYXBwZW5kKCc8bGk+PGEgaHJlZj0iamF2YXNjcmlwdDp2b2lkKG51bGwpIj4nICsgaSArICc8L2E+PC9saT4nKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFkZCBjbGljayBoYW5kbGVyDQogICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UuZ2FtZVBhZ2luZ0NvbnRyb2wuZmluZCgiYSIpLmNsaWNrKEludGVyZmFjZS5FdmVudHMucGFnZUNsaWNrZWQpOw0KICAgICAgICAgICAgICAgICAgICB9LA0KDQogICAgICAgICAgICAgICAgICAgIC8vIHNob3cgc2VsZWN0ZWQgcGFnZSBvZiBnYW1lcw0KICAgICAgICAgICAgICAgICAgICBzaG93UGFnZTogZnVuY3Rpb24gKHBhZ2UpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNsZWFyIGdhbWVzDQogICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UuZ2FtZUxpc3RDb250cm9sLmh0bWwoIiIpOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayBmb3IgZW1wdHkgbGlzdA0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEludGVyZmFjZS5nYW1lc1Zpc2libGUubGVuZ3RoID09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBkaXNwbGF5ICJubyBnYW1lcyIgbWVzc2FnZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5nYW1lTGlzdENvbnRyb2wuaHRtbCgnPGxpPjxoND5ObyBHYW1lcy9FdmVudHMgRm91bmQ8L2g0PjwvbGk+Jyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBzaG93IGdhbWVzIG9uIHNlbGVjdGVkIHBhZ2UNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAocGFyc2VJbnQocGFnZSkgLSAxKSAqIERhdGEuQ29uc3RhbnRzLkdhbWVzUGVyUGFnZTsgaSA8IERhdGEuQ29uc3RhbnRzLkdhbWVzUGVyUGFnZSAqIHBhZ2U7IGkrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnYW1lID0gSW50ZXJmYWNlLmdhbWVzVmlzaWJsZVtpXTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVuc3VyZSBnYW1lIGlzIHZhbGlkDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGdhbWUgPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNyZWF0ZSBodG1sIGNvbXBvbmVudHMNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXNIb21lR2FtZSA9IGdhbWUuSG9tZVRlYW0uSXNVQWxiZXJ0YTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGVhbVN0cmluZyA9IChpc0hvbWVHYW1lID8gKGdhbWUuSG9tZVRlYW0uTmFtZSA9PSBudWxsID8gIiIgOiAoZ2FtZS5Ib21lVGVhbS5OYW1lICsgIiAiKSkgOiAoZ2FtZS5Bd2F5VGVhbS5OYW1lID09IG51bGwgPyAiIiA6IChnYW1lLkF3YXlUZWFtLk5hbWUgKyAiICIpKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGlzSG9tZVdpbiA9IGdhbWUuQ29tcGxldGVkID8gZ2FtZS5Ib21lU2NvcmUgPiBnYW1lLkF3YXlTY29yZSA6IGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpc1RpZSA9IGdhbWUuQ29tcGxldGVkICYmIGdhbWUuSG9tZVNjb3JlID09IGdhbWUuQXdheVNjb3JlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpc1VBbGJlcnRhV2luID0gaXNIb21lR2FtZSAmJiBpc0hvbWVXaW4gfHwgIWlzSG9tZUdhbWUgJiYgIWlzSG9tZVdpbjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZ2FtZVRpdGxlID0gdGVhbVN0cmluZyArIGdhbWUuSG9tZVRlYW0uU3BvcnQuRGVzY3JpcHRpb24gKyAoZ2FtZS5Jc0V2ZW50ID8gIjogIiArIGdhbWUuRXZlbnROYW1lIDogKGlzSG9tZUdhbWUgPyAiIHZzICIgKyBnYW1lLkF3YXlUZWFtLk5hbWUgOiAiIEAgIiArIGdhbWUuSG9tZVRlYW0uTmFtZSkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkYXRlSHRtbCA9IGdhbWUuU3RhcnREYXRlICsgKGdhbWUuU3RhcnRUaW1lID09ICIxMjowMCBBTSIgPyAiIiA6ICIgIiArIGdhbWUuU3RhcnRUaW1lKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0c1N0ciA9IGdhbWUuQ29tcGxldGVkICYmICFnYW1lLklzRXZlbnQgPyAoKGlzSG9tZVdpbiA/IGdhbWUuSG9tZVNjb3JlIDogZ2FtZS5Bd2F5U2NvcmUpICsgIiAtICIgKyAoaXNIb21lV2luID8gZ2FtZS5Bd2F5U2NvcmUgOiBnYW1lLkhvbWVTY29yZSkgKyAiPHNwYW4+IiArIChpc1RpZSA/ICJUIiA6IChpc1VBbGJlcnRhV2luID8gKGdhbWUuT3ZlcnRpbWUgPyAiT1RXIiA6ICJXIikgOiAoZ2FtZS5PdmVydGltZSA/ICJPVEwiIDogIkwiKSkpICsgIjwvc3Bhbj4iKSA6ICIiOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY3JlYXRlIGdhbWUgaHRtbA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBodG1sID0gJzxsaT4nICsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzxhIGhyZWY9IicgKyBnYW1lLkdhbWVVcmwgKyAnIj4nICsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzxkaXYgY2xhc3M9Imxpc3QtaXRlbS1jb250ZW50Ij4nICsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzxoND4nICsgZ2FtZVRpdGxlICsgJzwvaDQ+JyArDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8cCBjbGFzcz0ibGlzdC1pdGVtLWV4dHJhIj4nICsgZGF0ZUh0bWwgKyAnPC9wPicgKw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAocmVzdWx0c1N0ciAhPSAnJyA/ICc8cCBjbGFzcz0ibGlzdC1pdGVtLWV4dHJhIj4nICsgcmVzdWx0c1N0ciArICc8L3A+JyA6ICcnKSArDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8L2Rpdj4nICsgJzwvYT4nICsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzwvbGk+JzsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFkZCBnYW1lIHRvIGxpc3QNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UuZ2FtZUxpc3RDb250cm9sLmFwcGVuZChodG1sKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2hvdyBwYWdpbmcNCiAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5zaG93UGFnaW5nKHBhZ2UpOw0KICAgICAgICAgICAgICAgICAgICB9LA0KDQogICAgICAgICAgICAgICAgICAgIC8vIGNoZWNrIHRvIHNlZSBpZiBhbiBnYW1lIGlzIHBhcnQgb2YgZmlsdGVycw0KICAgICAgICAgICAgICAgICAgICBjaGVja0ZpbHRlcnM6IGZ1bmN0aW9uIChnYW1lKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayBkYXRlcyBiYXNlZCBvbiBjYWxlbmRhciB0eXBlDQogICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKFV0aWxzLmdldE11bHRpbGlzdFZhbHVlKEludGVyZmFjZS5jYWxlbmRhclR5cGVDb250cm9sKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZSBkYXRlIHNlbGVjdGVkIGlzIG9uIHRoZSBnYW1lIGRhdGUNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIERhdGEuQ29uc3RhbnRzLkNhbGVuZGFyVHlwZXMuRGF5Og0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoVXRpbHMuZ2V0RGF0ZXBpY2tlclZhbHVlKEludGVyZmFjZS5jYWxlbmRhckNvbnRyb2wpICE9IGdhbWUuU3RhcnRVbml4KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG1vbnRoIGlzIHNraXBwZWQgYXMgd2UgYXJlIHB1bGxpbmcgZ2FtZXMgYmFzZWQgb24gdGhlIG1vbnRoLCBzbyBzaG93IGFsbCBmb3IgbW9udGggdHlwZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgRGF0YS5Db25zdGFudHMuQ2FsZW5kYXJUeXBlcy5Nb250aDoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNoZWNrIHNlbGVjdGVkIHRlYW1zIChub25lIHNlbGVjdGVkID0gc2VsZWN0IGFsbCkNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzZWxlY3RlZFRlYW1zID0gVXRpbHMuZ2V0TXVsdGlsaXN0VmFsdWUoSW50ZXJmYWNlLnRlYW1MaXN0Q29udHJvbCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZWN0ZWRUZWFtcy5sZW5ndGggPiAwICYmICQuaW5BcnJheShnYW1lLkhvbWVUZWFtLlByb2dyYW0uSWQgKyAiLSIgKyBnYW1lLkhvbWVUZWFtLlNwb3J0LklkLCBzZWxlY3RlZFRlYW1zKSA8IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICB9LA0KDQogICAgICAgICAgICAgICAgICAgIC8vIHNob3cgdGhlIGxvYWRpbmcgc3Bpbm5lcg0KICAgICAgICAgICAgICAgICAgICBzaG93TG9hZGluZzogZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhlIHNwaW5uZXIgaXMgYWxyZWFkeSBzaG93bg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCQoSW50ZXJmYWNlLmxvYWRpbmdTZWxlY3RvcikubGVuZ3RoID09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UuZ2FtZUxpc3RDb250cm9sLmFwcGVuZCgnPGxpIGNsYXNzPSJsb2FkaW5nIj48L2xpPicpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9LA0KDQogICAgICAgICAgICAgICAgICAgIEV2ZW50czogew0KICAgICAgICAgICAgICAgICAgICAgICAgbW9udGhDaGFuZ2VkOiBmdW5jdGlvbiAoZXZlbnQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBzZXQgY2FsZW5kYXIgdHlwZSB0byBtb250aA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIFV0aWxzLnNldE11bHRpbGlzdFZhbHVlKEludGVyZmFjZS5jYWxlbmRhclR5cGVDb250cm9sLCBEYXRhLkNvbnN0YW50cy5DYWxlbmRhclR5cGVzLk1vbnRoKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHN0b3JlIHZpc2libGUgbW9udGgNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UubW9udGhWaXNpYmxlID0gZXZlbnQuZGF0ZS5nZXRVVENGdWxsWWVhcigpICsgIi0iICsgVXRpbHMucGFkTGVmdChldmVudC5kYXRlLmdldFVUQ01vbnRoKCkgKyAxLCAiMCIsIDIpOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgQUpBWC5nZXRHYW1lcyhEYXRhLkNvbnN0YW50cy5DYWxlbmRhclR5cGVzLk1vbnRoLCBJbnRlcmZhY2UubW9udGhWaXNpYmxlICsgIi0wMSIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZVNlbGVjdGVkOiBmdW5jdGlvbiAoZXZlbnQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBzZXQgY2FsZW5kYXIgdHlwZSB0byBkYXkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBVdGlscy5zZXRNdWx0aWxpc3RWYWx1ZShJbnRlcmZhY2UuY2FsZW5kYXJUeXBlQ29udHJvbCwgRGF0YS5Db25zdGFudHMuQ2FsZW5kYXJUeXBlcy5EYXkpOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGUgPSBldmVudC5kYXRlLmdldFVUQ0Z1bGxZZWFyKCkgKyAiLSIgKyBVdGlscy5wYWRMZWZ0KGV2ZW50LmRhdGUuZ2V0VVRDTW9udGgoKSArIDEsICIwIiwgMikgKyAiLSIgKyBVdGlscy5wYWRMZWZ0KGV2ZW50LmRhdGUuZ2V0VVRDRGF0ZSgpLCAiMCIsIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFKQVguZ2V0R2FtZXMoRGF0YS5Db25zdGFudHMuQ2FsZW5kYXJUeXBlcy5EYXksIGRhdGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgICAgICAgICAgICAgY2FsZW5kYXJUeXBlQ2hhbmdlZDogZnVuY3Rpb24gKG9wdGlvbikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFKQVguZ2V0R2FtZXMoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlckxpc3RDaGFuZ2VkOiBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgQUpBWC5nZXRHYW1lcygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgICAgICAgICAgICAgcGFnZUNsaWNrZWQ6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBzaG93IGNsaWNrZWQgcGFnZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5zaG93UGFnZSgkKHRoaXMpLmh0bWwoKSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9Ow0KDQogICAgICAgICAgICAvLyBpbnN0YW5jZSBpbml0aWFsaXphdGlvbg0KDQogICAgICAgICAgICBmdW5jdGlvbiBpbml0KGNvbnRhaW5lcklkLCB0ZWFtSWQpIHsNCiAgICAgICAgICAgICAgICBJbnRlcmZhY2Uuc2V0dXAoY29udGFpbmVySWQpOw0KICAgICAgICAgICAgICAgIERhdGEudGVhbUlkID0gdGVhbUlkLnNwbGl0KCItIik7DQoNCiAgICAgICAgICAgICAgICAvLyBpbml0aWFsaXplIGRhdGEgb2JqZWN0cw0KICAgICAgICAgICAgICAgIERhdGEudGVhbXMgPSBJbnRlcmZhY2UudGVhbUxpc3RDb250cm9sLmNoaWxkcmVuKCkubWFwKGZ1bmN0aW9uICgpIHsgcmV0dXJuIHRoaXMudmFsdWU7IH0pLmdldCgpOw0KICAgICAgICAgICAgICAgIEludGVyZmFjZS50ZWFtTGlzdENvbnRyb2wuY2hpbGRyZW4oKS5lYWNoKGZ1bmN0aW9uICgpIHsgRGF0YS50ZWFtSXRlbXNbdGhpcy52YWx1ZV0gPSB0aGlzLnRleHQ7IH0pOw0KICAgICAgICAgICAgICAgIERhdGEuY3VycmVudERhdGUgPSBVdGlscy5nZXREYXRlcGlja2VyVmFsdWUoSW50ZXJmYWNlLmNhbGVuZGFyQ29udHJvbCk7DQoNCiAgICAgICAgICAgICAgICAvLyBnZXQgZ2FtZXMNCiAgICAgICAgICAgICAgICBBSkFYLmdldEdhbWVzKFV0aWxzLmdldE11bHRpbGlzdFZhbHVlKEludGVyZmFjZS5jYWxlbmRhclR5cGVDb250cm9sKSwgRGF0YS5jdXJyZW50RGF0ZSk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHJldHVybiB7DQogICAgICAgICAgICAgICAgSW5pdGlhbGl6ZTogaW5pdA0KICAgICAgICAgICAgfTsNCiAgICAgICAgfShqUXVlcnkpKTsNCiAgICB9DQoNCiAgICByZXR1cm4gew0KICAgICAgICBHZXRJbnN0YW5jZTogZ2V0SW5zdGFuY2UNCiAgICB9Ow0KfSgpKTs7DQovKioNCiAqIFVBbGJlcnRhIERhdGEgTGlzdA0KICovDQoNCi8vIGJ1aWxkIG5hbWVzcGFjZQ0KdmFyIFVBbGJlcnRhID0gVUFsYmVydGEgfHwge307DQpVQWxiZXJ0YS5TaXRlY29yZSA9IFVBbGJlcnRhLlNpdGVjb3JlIHx8IHt9Ow0KDQpVQWxiZXJ0YS5TaXRlY29yZS5EYXRhTGlzdCA9IGZ1bmN0aW9uKCQpIHsNCiAgICANCiAgICB2YXIgX29wdGlvbnMgPSANCiAgICAgICAgew0KICAgICAgICAgICAgQ29udGFpbmVySWQ6ICcnLA0KICAgICAgICAgICAgU2VydmljZVVybCA6ICcnLA0KICAgICAgICAgICAgQ3NzQ2xhc3NQcmVmaXggOiAnZGF0YScsDQogICAgICAgICAgICBTaG93RGF0ZTogdHJ1ZSwNCiAgICAgICAgICAgIFNob3dEZXNjcmlwdGlvbjogdHJ1ZSwNCiAgICAgICAgICAgIEl0ZW1zUGVyUGFnZTogMjANCiAgICAgICAgfSwNCiAgICAgICAgX2Nvb2tpZVZhbHVlID0gJycsDQogICAgICAgIF9jdXJyZW50UGFnZSA9ICcnOw0KDQogICAgZnVuY3Rpb24gaW5pdChvcHRpb25zKSB7DQogICAgICAgICQuZXh0ZW5kKF9vcHRpb25zLCBvcHRpb25zKTsNCiAgICAgICAgX2Nvb2tpZVZhbHVlID0gJC5jb29raWUoJ2RhdGEtbGlzdC1jdXJyZW50LXBhZ2UnKTsNCiAgICAgICAgX2N1cnJlbnRQYWdlID0gKF9jb29raWVWYWx1ZSA9PSAnJyB8fCBfY29va2llVmFsdWUgPT0gbnVsbCkgPyAxIDogX2Nvb2tpZVZhbHVlOw0KICAgICAgICANCiAgICAgICAgc2VsZWN0KCk7DQogICAgfQ0KICAgIA0KICAgIGZ1bmN0aW9uIHNlbGVjdCgpIHsNCiAgICAgICAgJC5hamF4KHsNCiAgICAgICAgICAgIHR5cGU6ICdHRVQnLA0KICAgICAgICAgICAgZGF0YVR5cGU6ICdqc29uJywNCiAgICAgICAgICAgIHVybDogX29wdGlvbnMuU2VydmljZVVybCwNCiAgICAgICAgICAgIHRpbWVvdXQ6IDMwMDAwLA0KICAgICAgICAgICAgc3VjY2VzczogYWpheFN1Y2Nlc3MsDQogICAgICAgICAgICBlcnJvcjogYWpheEVycm9yDQogICAgICAgIH0pOw0KICAgIH0NCiAgICANCiAgICBmdW5jdGlvbiBhamF4U3VjY2VzcyhkYXRhKSB7DQogICAgICAgIGlmIChkYXRhLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgIGZvciAodmFyIGUgPSAwOyBlIDwgZGF0YS5sZW5ndGg7IGUrKykgew0KICAgICAgICAgICAgICAgIHZhciBjbGFzc05hbWUgPSAnLicgKyBfb3B0aW9ucy5Dc3NDbGFzc1ByZWZpeCArICctbW9kdWxlJzsNCiAgICAgICAgICAgICAgICAkKGNsYXNzTmFtZSkudG9nZ2xlQ2xhc3MoJ2xvYWRpbmcnKTsNCg0KICAgICAgICAgICAgICAgIHZhciBpdGVtID0gZGF0YVtlXTsNCg0KICAgICAgICAgICAgICAgIC8vIEZpcnN0LCBjcmVhdGUgdGhlIGxpc3QgZWxlbWVudA0KICAgICAgICAgICAgICAgIHZhciBsaXN0RWxlbWVudCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7DQogICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgLy8gSWYgdGhlIGl0ZW0gaGFzIGEgbGluaywgd3JhcCB0aGUgdGl0bGUgaW4gaXQNCiAgICAgICAgICAgICAgICB2YXIgdGl0bGVIZWFkaW5nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaDQnKTsNCg0KICAgICAgICAgICAgICAgIC8vIElmIHRoZSB0aXRsZSBpcyBsb25nZXIgdGhhbiBYIGNoYXJhY3RlcnMsIHRydW5jYXRlIGl0IGFuZCBhZGQgYW4gZWxsaXBzaXMNCiAgICAgICAgICAgICAgICB2YXIgbWF4VGl0bGVMZW5ndGggPSAzMDsNCiAgICAgICAgICAgICAgICB2YXIgdHJ1bmNhdGVkVGl0bGU7DQoNCiAgICAgICAgICAgICAgICB2YXIgdGl0bGUgPSBpdGVtLlRpdGxlLmxlbmd0aCA+IG1heFRpdGxlTGVuZ3RoLCBzdHIgPSB0aXRsZSA/IGl0ZW0uVGl0bGUuc3Vic3RyKDAsIG1heFRpdGxlTGVuZ3RoIC0gMSkgOiBpdGVtLlRpdGxlOw0KICAgICAgICAgICAgICAgIHN0ciA9IHRpdGxlID8gc3RyLnN1YnN0cigwLCBzdHIubGFzdEluZGV4T2YoJyAnKSkgOiBzdHI7DQogICAgICAgICAgICAgICAgdHJ1bmNhdGVkVGl0bGUgPSB0aXRsZSA/IHN0ciArICcuLi4nIDogc3RyOw0KDQogICAgICAgICAgICAgICAgaWYgKGl0ZW0uTGluayAhPSAnJykgew0KICAgICAgICAgICAgICAgICAgICB2YXIgbGluayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTsNCiAgICAgICAgICAgICAgICAgICAgbGluay5ocmVmID0gaXRlbS5MaW5rOw0KICAgICAgICAgICAgICAgICAgICBsaW5rLmlubmVySFRNTCA9IHRydW5jYXRlZFRpdGxlOw0KDQogICAgICAgICAgICAgICAgICAgIHRpdGxlSGVhZGluZy5hcHBlbmRDaGlsZChsaW5rKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIHRpdGxlSGVhZGluZy5pbm5lckhUTUwgPSB0cnVuY2F0ZWRUaXRsZTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBsaXN0RWxlbWVudC5hcHBlbmRDaGlsZCh0aXRsZUhlYWRpbmcpOw0KDQogICAgICAgICAgICAgICAgLy8gSWYgYSBwdWJsaWNhdGlvbiBkYXRlIGlzIGF2YWlsYWJsZSBhbmQgY29uZmlndXJlZCB0bw0KICAgICAgICAgICAgICAgIC8vIGRpc3BsYXksIGFkZCBpdCBub3cuDQogICAgICAgICAgICAgICAgdmFyIGRhdGVTdHJpbmcgPSBpdGVtLkRhdGUubWF0Y2goL1xkKy8pOw0KDQogICAgICAgICAgICAgICAgaWYgKGRhdGVTdHJpbmcgIT0gJycgJiYgX29wdGlvbnMuU2hvd0RhdGUpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGVQYXJhZ3JhcGggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7DQogICAgICAgICAgICAgICAgICAgIGRhdGVQYXJhZ3JhcGguY2xhc3NOYW1lID0gJ2RhdGUnOw0KDQogICAgICAgICAgICAgICAgICAgIHZhciBkYXRlSW50ID0gcGFyc2VJbnQoZGF0ZVN0cmluZ1swXSk7DQogICAgICAgICAgICAgICAgICAgIHZhciBkID0gbmV3IERhdGUoZGF0ZUludCk7DQoNCiAgICAgICAgICAgICAgICAgICAgZGF0ZVBhcmFncmFwaC5pbm5lckhUTUwgPSBkLnRvTG9jYWxlRGF0ZVN0cmluZygpOw0KICAgICAgICAgICAgICAgICAgICBsaXN0RWxlbWVudC5hcHBlbmRDaGlsZChkYXRlUGFyYWdyYXBoKTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAvLyBJZiBhIGRlc2NyaXB0aW9uIGlzIGF2YWlsYWxibGUgYW5kIGNvbmZpZ3VyZWQgdG8gDQogICAgICAgICAgICAgICAgLy8gZGlzcGxheSwgYWRkIGl0DQogICAgICAgICAgICAgICAgaWYgKGl0ZW0uRGVzY3JpcHRpb24gIT0gJycgJiYgX29wdGlvbnMuU2hvd0Rlc2NyaXB0aW9uKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBkZXNjRGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpOw0KICAgICAgICAgICAgICAgICAgICBkZXNjRGl2LmNsYXNzTmFtZSA9ICdkZXNjcmlwdGlvbic7DQogICAgICAgICAgICAgICAgICAgIGRlc2NEaXYuaW5uZXJIVE1MID0gaXRlbS5EZXNjcmlwdGlvbjsNCg0KICAgICAgICAgICAgICAgICAgICBsaXN0RWxlbWVudC5hcHBlbmRDaGlsZChkZXNjRGl2KTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAkKF9vcHRpb25zLkNvbnRhaW5lcklkKS5hcHBlbmQobGlzdEVsZW1lbnQpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAvLyBJZiB0aGUgbGlzdCBpcyBncmVhdGVyIHRoYW4gMTUgaXRlbXMsIHBhZ2luYXRlIGl0DQogICAgICAgICAgICBpZiAoZGF0YS5sZW5ndGggPiBfb3B0aW9ucy5JdGVtc1BlclBhZ2UpIHsNCiAgICAgICAgICAgICAgICAkKCcuZGF0YS1saXN0LW5hdmlnYXRpb24nKS5qUGFnZXMoeyBjb250YWluZXJJRDogJ2RhdGEtbGlzdCcsIG1pbkhlaWdodDogJycsIHN0YXJ0UGFnZTogX2N1cnJlbnRQYWdlLCBwZXJQYWdlOiBfb3B0aW9ucy5JdGVtc1BlclBhZ2UsIGZpcnN0OiAnZmlyc3QnLCBwcmV2aW91czogJ3ByZXZpb3VzJywgbmV4dDogJ25leHQnLCBsYXN0OiAnbGFzdCcsIHN0YXJ0UmFuZ2U6IDEsIG1pZFJhbmdlOiA1LCBlbmRSYW5nZTogMSwgY2FsbGJhY2s6IGZ1bmN0aW9uIChwYWdlcywgaXRlbXMpIHsgJC5jb29raWUoJ2RhdGEtbGlzdC1jdXJyZW50LXBhZ2UnLCBwYWdlcy5jdXJyZW50LCB7IGV4cGlyZXM6IDEsIHBhdGg6ICcvJyB9KTsgfSB9KTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfQ0KICAgIH0NCiAgICANCiAgICBmdW5jdGlvbiBhamF4RXJyb3IoKSB7DQogICAgfQ0KDQogICAgcmV0dXJuIHsNCiAgICAgICAgSW5pdGlhbGl6ZTogaW5pdA0KICAgIH07DQoNCn0oalF1ZXJ5KTs7DQovKioNCiAqIFVBbGJlcnRhIEV2ZW50DQogKiBBdXRob3I6IEt5bGUgU2NobWlkdCAtIGt5bGUuc2NobWlkdEB1YWxiZXJ0YS5jYQ0KICovDQoNCi8vIGJ1aWxkIG5hbWVzcGFjZQ0KdmFyIFVBbGJlcnRhID0gVUFsYmVydGEgfHwge307DQpVQWxiZXJ0YS5TaXRlY29yZSA9IFVBbGJlcnRhLlNpdGVjb3JlIHx8IHt9Ow0KDQpVQWxiZXJ0YS5TaXRlY29yZS5FdmVudCA9IFVBbGJlcnRhLlNpdGVjb3JlLkV2ZW50IHx8IChmdW5jdGlvbigpIHsNCiAgICBmdW5jdGlvbiBnZXRJbnN0YW5jZSgpIHsNCiAgICAgICAgcmV0dXJuIChmdW5jdGlvbigkKSB7DQogICAgICAgICAgICAndXNlIHN0cmljdCc7DQoNCiAgICAgICAgICAgIHZhciBEYXRhID0gew0KICAgICAgICAgICAgICAgICAgICBldmVudDoge30gICAvLyB0aGUgZXZlbnQNCiAgICAgICAgICAgICAgICB9LA0KICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgIEludGVyZmFjZSA9IHsNCiAgICAgICAgICAgICAgICAgICAgLy8gU2V0dXAgdGhlIGludGVyZmFjZQ0KICAgICAgICAgICAgICAgICAgICBzZXR1cDogZnVuY3Rpb24gKGNvbnRhaW5lcklkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAvLyBzZXQgcGFnZSB0aXRsZQ0KICAgICAgICAgICAgICAgICAgICAgICAgJCgidGl0bGUiKS5odG1sKCQoInRpdGxlIikuaHRtbCgpLnRyaW0oKS5yZXBsYWNlKC9eRXZlbnQvLCBEYXRhLmV2ZW50LlRpdGxlKSk7DQogICAgICAgICAgICAgICAgICAgICAgICAkKCJ1bC5icmVhZGNydW1icyA+IGxpLmJjLWhlcmUiKS5odG1sKERhdGEuZXZlbnQuVGl0bGUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgJCgiaDEucGFnZS10aXRsZSIpLmh0bWwoRGF0YS5ldmVudC5UaXRsZSk7DQoNCgkJCQkJCS8vIGFkZCBjbGljayBldmVudCB0byBsaW5rDQogICAgICAgICAgICAgICAgICAgICAgICAkKCIjIiArIGNvbnRhaW5lcklkICsgIiAuZXZlbnQtbWFwLWxpbmsiKS5jbGljayhJbnRlcmZhY2UuRXZlbnRzLm1hcExpbmtDbGlja2VkKTsNCiAgICAgICAgICAgICAgICAgICAgfSwNCg0KCQkJCQlFdmVudHM6IHsNCgkJCQkJCW1hcExpbmtDbGlja2VkOiBmdW5jdGlvbigpIHsNCgkJCQkJCQl2YXIgZXZlbnQgPSBEYXRhLmV2ZW50Ow0KCQkJCQkJICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVuc3VyZSBhbiBldmVudCB3YXMgYWN0dWFsbHkgYWRkZWQNCgkJCQkJCSAgICBpZihldmVudC5UaXRsZSA9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoIk5vIGV2ZW50IHdhcyBzcGVjaWZpZWQgdG8gYmUgdmlld2VkIG9uIENhbXB1cyBNYXBzLlxuXG5QbGVhc2UgcmVmcmVzaCB0aGUgcGFnZSBhbmQgdHJ5IGFnYWluLiIpDQoJCQkJCQkgICAgICAgIHJldHVybjsNCgkJCQkJCSAgICB9DQoJCQkJCQkJDQoJCQkJCQkJLy8gZW5zdXJlIGhpZGRlbiBjb250YWluZXIgZXhpc3RzDQoJCQkJCQkJaWYoJCgiI2hpZGRlbkZvcm1Db250YWluZXIiKS5sZW5ndGggPT0gMCkgew0KCQkJCQkJCQkkKCJib2R5IikuYXBwZW5kKCc8ZGl2IGlkPSJoaWRkZW5Gb3JtQ29udGFpbmVyIj48L2Rpdj4nKTsNCgkJCQkJCQl9DQoJCQkJCQkJDQoJCQkJCQkJLy8gYWRkIGZvcm0gdG8gY29udGFpbmVyIGFuZCBzdWJtaXQNCgkJCQkJCQkkKCIjaGlkZGVuRm9ybUNvbnRhaW5lciIpDQoJCQkJCQkJCS5odG1sKCIiKQ0KCQkJCQkJCQkuYXBwZW5kKCQoIjxmb3JtPiIpDQoJCQkJCQkJCQkuYXR0cih7DQoJCQkJCQkJCQkJbWV0aG9kOiAiUE9TVCIsDQoJCQkJCQkJCQkJYWN0aW9uOiAiaHR0cDovL3d3dy5jYW1wdXNtYXAudWFsYmVydGEuY2EiLA0KCQkJCQkJCQkJCWlkOiAiaGlkRm9ybSIsDQoJCQkJCQkJCQkJdGFyZ2V0OiAiX2JsYW5rIg0KCQkJCQkJCQkJfSkNCgkJCQkJCQkJCS5hcHBlbmQoJCgiPGlucHV0PiIpLmF0dHIoew0KCQkJCQkJCQkJCXR5cGU6ICJoaWRkZW4iLA0KCQkJCQkJCQkJCW5hbWU6ICJ0aXRsZSIsDQoJCQkJCQkJCQkJdmFsdWU6IGV2ZW50LlRpdGxlDQoJCQkJCQkJCQl9KSkNCgkJCQkJCQkJCS5hcHBlbmQoJCgiPGlucHV0PiIpLmF0dHIoew0KCQkJCQkJCQkJCXR5cGU6ICJoaWRkZW4iLA0KCQkJCQkJCQkJCW5hbWU6ICJkZXNjIiwNCgkJCQkJCQkJCQl2YWx1ZTogZXZlbnQuRGVzY3JpcHRpb24NCgkJCQkJCQkJCX0pKQ0KCQkJCQkJCQkJLmFwcGVuZCgkKCI8aW5wdXQ+IikuYXR0cih7DQoJCQkJCQkJCQkJdHlwZTogImhpZGRlbiIsDQoJCQkJCQkJCQkJbmFtZTogImxvY2F0aW9uIiwNCgkJCQkJCQkJCQl2YWx1ZTogZXZlbnQuTG9jYXRpb24NCgkJCQkJCQkJCX0pKQ0KCQkJCQkJCQkJLmFwcGVuZCgkKCI8aW5wdXQ+IikuYXR0cih7DQoJCQkJCQkJCQkJdHlwZTogImhpZGRlbiIsDQoJCQkJCQkJCQkJbmFtZTogInRpbWUiLA0KCQkJCQkJCQkJCXZhbHVlOiBldmVudC5EYXRlDQoJCQkJCQkJCQl9KSkNCgkJCQkJCQkJCS5hcHBlbmQoJCgiPGlucHV0PiIpLmF0dHIoew0KCQkJCQkJCQkJCXR5cGU6ICJoaWRkZW4iLA0KCQkJCQkJCQkJCW5hbWU6ICJjYXRlZ29yeSIsDQoJCQkJCQkJCQkJdmFsdWU6IGV2ZW50LkNhdGVnb3JpZXMNCgkJCQkJCQkJCX0pKQ0KCQkJCQkJCQkJLmFwcGVuZCgkKCI8aW5wdXQ+IikuYXR0cih7DQoJCQkJCQkJCQkJdHlwZTogImhpZGRlbiIsDQoJCQkJCQkJCQkJbmFtZTogImZhY3VsdHkiLA0KCQkJCQkJCQkJCXZhbHVlOiBldmVudC5DYWxlbmRhcnMNCgkJCQkJCQkJCX0pKQ0KCQkJCQkJCQkJLmFwcGVuZCgkKCI8aW5wdXQ+IikuYXR0cih7DQoJCQkJCQkJCQkJdHlwZTogImhpZGRlbiIsDQoJCQkJCQkJCQkJbmFtZTogImxhdCIsDQoJCQkJCQkJCQkJdmFsdWU6IGV2ZW50LlBvc2l0aW9uTGF0DQoJCQkJCQkJCQl9KSkNCgkJCQkJCQkJCS5hcHBlbmQoJCgiPGlucHV0PiIpLmF0dHIoew0KCQkJCQkJCQkJCXR5cGU6ICJoaWRkZW4iLA0KCQkJCQkJCQkJCW5hbWU6ICJsbmciLA0KCQkJCQkJCQkJCXZhbHVlOiBldmVudC5Qb3NpdGlvbkxuZw0KCQkJCQkJCQkJfSkpDQoJCQkJCQkJCQkuc3VibWl0KCkNCgkJCQkJCQkJKTsNCgkJCQkJCX0NCgkJCQkJfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIDsNCg0KICAgICAgICAgICAgLy8gaW5zdGFuY2UgaW5pdGlhbGl6YXRpb24NCiAgICAgICAgICAgIGZ1bmN0aW9uIGluaXQoY29udGFpbmVySWQsIGV2ZW50KSB7DQogICAgICAgICAgICAgICAgLy8gaW5pdGlhbGl6ZSBkYXRhIG9iamVjdHMNCiAgICAgICAgICAgICAgICBEYXRhLmV2ZW50ID0gZXZlbnQ7DQogICAgICAgICAgICAgICAgDQoJCQkJLy8gc2V0dXAgaW50ZXJmYWNlDQogICAgICAgICAgICAgICAgSW50ZXJmYWNlLnNldHVwKGNvbnRhaW5lcklkKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICBJbml0aWFsaXplOiBpbml0DQogICAgICAgICAgICB9Ow0KICAgICAgICB9KGpRdWVyeSkpOw0KICAgIH0NCg0KICAgIHJldHVybiB7DQogICAgICAgIEdldEluc3RhbmNlOiBnZXRJbnN0YW5jZQ0KICAgIH07DQp9KCkpOw0KOw0KLyoqDQoqIFVBbGJlcnRhIEV2ZW50IExpc3QNCiogQXV0aG9yOiBLeWxlIFNjaG1pZHQgLSBreWxlLnNjaG1pZHRAdWFsYmVydGEuY2ENCiovDQoNCi8vIGJ1aWxkIG5hbWVzcGFjZQ0KdmFyIFVBbGJlcnRhID0gVUFsYmVydGEgfHwge307DQpVQWxiZXJ0YS5TaXRlY29yZSA9IFVBbGJlcnRhLlNpdGVjb3JlIHx8IHt9Ow0KDQpVQWxiZXJ0YS5TaXRlY29yZS5FdmVudExpc3QgPSBVQWxiZXJ0YS5TaXRlY29yZS5FdmVudExpc3QgfHwgKGZ1bmN0aW9uICgpIHsNCg0KICAgIGZ1bmN0aW9uIGdldEluc3RhbmNlKCkgew0KICAgICAgICByZXR1cm4gKGZ1bmN0aW9uICgkKSB7DQogICAgICAgICAgICAndXNlIHN0cmljdCc7DQoNCiAgICAgICAgICAgIHZhciBEYXRhID0gew0KICAgICAgICAgICAgICAgIGNhbGVuZGFyczogW10sICAgICAgLy8gY2FsZW5kYXJzDQogICAgICAgICAgICAgICAgY2FsZW5kYXJJdGVtczogW10sICAvLyBjYWxlbmRhciBpdGVtcw0KICAgICAgICAgICAgICAgIGNhdGVnb3J5SXRlbXM6IFtdLCAgLy8gY2F0ZWdvcnkgaXRlbXMNCiAgICAgICAgICAgICAgICBjdXJyZW50RGF0ZTogIiIsICAgIC8vIHRoZSBjdXJyZW50IGRhdGUNCiAgICAgICAgICAgICAgICBldmVudHM6IFtdLCAgICAgICAgIC8vIGV2ZW50cw0KDQogICAgICAgICAgICAgICAgLy8gQ29uc3RhbnQgdmFsdWVzDQogICAgICAgICAgICAgICAgQ29uc3RhbnRzOiB7DQogICAgICAgICAgICAgICAgICAgIC8vIENhbGVuZGFyIHR5cGVzDQogICAgICAgICAgICAgICAgICAgIENhbGVuZGFyVHlwZXM6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgIEN1cnJlbnQ6ICJjdXJyZW50IiwNCiAgICAgICAgICAgICAgICAgICAgICAgIERheTogImRheSIsDQogICAgICAgICAgICAgICAgICAgICAgICBNb250aDogIm1vbnRoIg0KICAgICAgICAgICAgICAgICAgICB9LA0KDQogICAgICAgICAgICAgICAgICAgIC8vIERhdGUgZm9ybWF0cw0KICAgICAgICAgICAgICAgICAgICBEYXRlRm9ybWF0czogew0KICAgICAgICAgICAgICAgICAgICAgICAgTG9uZzogIk1NTSBkLCB5eXl5IGg6bW0gYSIsDQogICAgICAgICAgICAgICAgICAgICAgICBTaG9ydDogIk1NTSBkLCB5eXl5IiwNCiAgICAgICAgICAgICAgICAgICAgICAgIFRpbWVPbmx5OiAiaDptbSBhIg0KICAgICAgICAgICAgICAgICAgICB9LA0KDQogICAgICAgICAgICAgICAgICAgIC8vIERhdGUgcG9zdGZpeA0KICAgICAgICAgICAgICAgICAgICBEYXRlUG9zdGZpeDogIlQwMDowMDowMC4wMDAtMDA6MDAiLA0KDQogICAgICAgICAgICAgICAgICAgIC8vIEV2ZW50cyBwZXIgcGFnZQ0KICAgICAgICAgICAgICAgICAgICBFdmVudHNQZXJQYWdlOiAxMA0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgVXRpbHMgPSB7DQogICAgICAgICAgICAgICAgICAgIC8vIExlZnQgcGFkIGEgc3RyaW5nIHVzaW5nIHRoZSBzcGVjaWZpZWQgc3RyaW5nIHVwIHRvIHRoZSBkZXNpcmVkIGxlbmd0aA0KICAgICAgICAgICAgICAgICAgICBwYWRMZWZ0OiBmdW5jdGlvbiAodGhlU3RyaW5nLCBwYWRTdHJpbmcsIGxlbmd0aCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoZVN0cmluZy50b1N0cmluZygpLmxlbmd0aCA8IGxlbmd0aCA/IFV0aWxzLnBhZExlZnQocGFkU3RyaW5nICsgdGhlU3RyaW5nLCBwYWRTdHJpbmcsIGxlbmd0aCkgOiB0aGVTdHJpbmc7DQogICAgICAgICAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgICAgICAgICAgLy8gR2V0IHRoZSB2YWx1ZSBvZiBhIG11bHRpbGlzdCB3aWRnZXQNCiAgICAgICAgICAgICAgICAgICAgZ2V0TXVsdGlsaXN0VmFsdWU6IGZ1bmN0aW9uIChvYmopIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvYmoubXVsdGlzZWxlY3QoImdldFNlbGVjdGVkIikudmFsKCkgfHwgW107DQogICAgICAgICAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgICAgICAgICAgLy8gU2V0IHRoZSB2YWx1ZSBvZiBhIG11bHRpbGlzdCB3aWRnZXQNCiAgICAgICAgICAgICAgICAgICAgc2V0TXVsdGlsaXN0VmFsdWU6IGZ1bmN0aW9uIChvYmosIHZhbHVlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBvYmoudmFsKHZhbHVlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIG9iai5tdWx0aXNlbGVjdCgicmVmcmVzaCIpOw0KICAgICAgICAgICAgICAgICAgICB9LA0KDQogICAgICAgICAgICAgICAgICAgIC8vIEdldCB0aGUgdmFsdWUgb2YgYSBkYXRlcGlja2VyIHdpZGdldA0KICAgICAgICAgICAgICAgICAgICBnZXREYXRlcGlja2VyVmFsdWU6IGZ1bmN0aW9uIChvYmopIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBvYmouZGF0YSgiZGF0ZXBpY2tlciIpLmdldEZvcm1hdHRlZERhdGUoKTsNCiAgICAgICAgICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgICAgICAgICAvLyBDaGVjayBpZiBhIGRhdGUgaXMgaW4gYSBkYXRlIHJhbmdlDQogICAgICAgICAgICAgICAgICAgIGlzRGF0ZUluUmFuZ2U6IGZ1bmN0aW9uICh2YWx1ZSwgc3RhcnQsIGVuZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGUgPSBEYXRlLnBhcnNlKHZhbHVlLnN1YnN0cigwLCAxMCkpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0YXJ0RGF0ZSA9IERhdGUucGFyc2Uoc3RhcnQuc3Vic3RyKDAsIDEwKSksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kRGF0ZSA9IERhdGUucGFyc2UoZW5kLnN1YnN0cigwLCAxMCkpOw0KDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNOYU4oZGF0ZSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRlID0gRGF0ZS5wYXJzZSgkLmZvcm1hdC5kYXRlKHZhbHVlLnN1YnN0cigwLCAxMCkgKyBEYXRhLkNvbnN0YW50cy5EYXRlUG9zdGZpeCwgRGF0YS5Db25zdGFudHMuRGF0ZUZvcm1hdHMuU2hvcnQpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGFydERhdGUgPSBEYXRlLnBhcnNlKCQuZm9ybWF0LmRhdGUoc3RhcnQuc3Vic3RyKDAsIDEwKSArIERhdGEuQ29uc3RhbnRzLkRhdGVQb3N0Zml4LCBEYXRhLkNvbnN0YW50cy5EYXRlRm9ybWF0cy5TaG9ydCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVuZERhdGUgPSBEYXRlLnBhcnNlKCQuZm9ybWF0LmRhdGUoZW5kLnN1YnN0cigwLCAxMCkgKyBEYXRhLkNvbnN0YW50cy5EYXRlUG9zdGZpeCwgRGF0YS5Db25zdGFudHMuRGF0ZUZvcm1hdHMuU2hvcnQpKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzTmFOKGRhdGUpIHx8IGlzTmFOKHN0YXJ0RGF0ZSkgfHwgaXNOYU4oZW5kRGF0ZSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAoKHN0YXJ0RGF0ZSA8PSBkYXRlKSAmJiAoZGF0ZSA8PSBlbmREYXRlKSk7DQogICAgICAgICAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgICAgICAgICAgLy8gQ2hlY2sgaWYgYSBkYXRlIGlzIGJlZm9yZSBhbm90aGVyIGRhdGUNCiAgICAgICAgICAgICAgICAgICAgaXNEYXRlQmVmb3JlOiBmdW5jdGlvbiAodmFsdWUsIGNoZWNrRGF0ZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGUgPSBEYXRlLnBhcnNlKHZhbHVlLnN1YnN0cigwLCAxMCkpLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJlZm9yZURhdGUgPSBEYXRlLnBhcnNlKGNoZWNrRGF0ZS5zdWJzdHIoMCwgMTApKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGlzTmFOKGRhdGUpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZSA9IERhdGUucGFyc2UoJC5mb3JtYXQuZGF0ZSh2YWx1ZS5zdWJzdHIoMCwgMTApICsgRGF0YS5Db25zdGFudHMuRGF0ZVBvc3RmaXgsIERhdGEuQ29uc3RhbnRzLkRhdGVGb3JtYXRzLlNob3J0KSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYmVmb3JlRGF0ZSA9IERhdGUucGFyc2UoJC5mb3JtYXQuZGF0ZShjaGVja0RhdGUuc3Vic3RyKDAsIDEwKSArIERhdGEuQ29uc3RhbnRzLkRhdGVQb3N0Zml4LCBEYXRhLkNvbnN0YW50cy5EYXRlRm9ybWF0cy5TaG9ydCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoaXNOYU4oZGF0ZSkgfHwgaXNOYU4oYmVmb3JlRGF0ZSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkYXRlIDw9IGJlZm9yZURhdGU7DQogICAgICAgICAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgICAgICAgICAgLy8gRm9ybWF0IGRhdGUgcmFuZ2UgYXMgYSBzdHJpbmcNCiAgICAgICAgICAgICAgICAgICAgZm9ybWF0RGF0ZVJhbmdlOiBmdW5jdGlvbiAoc3RhcnQsIGVuZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZvcm1hdCA9IERhdGEuQ29uc3RhbnRzLkRhdGVGb3JtYXRzLkxvbmc7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNoZWNrIGlmIG9ubHkgZGF0ZSBpcyBzcGVjaWZpZWQgKGFsbCBkYXkgZXZlbnQpDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3RhcnQubGVuZ3RoID09IDEwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gdXNlIHNob3J0IGRhdGUgZm9ybWF0DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybWF0ID0gRGF0YS5Db25zdGFudHMuRGF0ZUZvcm1hdHMuU2hvcnQ7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBtYWtlIGRhdGVzIHByb3BlciB0aW1lc3RhbXBzDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhcnQgKz0gRGF0YS5Db25zdGFudHMuRGF0ZVBvc3RmaXg7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZW5kICs9IERhdGEuQ29uc3RhbnRzLkRhdGVQb3N0Zml4Ow0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2hlY2sgaWYgb25seSBvbmUgZGF5IChyZXR1cm4gdGhlIGRhdGUgaWYgc28pDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXJ0ID09IGVuZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJC5mb3JtYXQuZGF0ZShzdGFydCwgZm9ybWF0KTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGdldCBmb3JtYXR0ZWQgZGF0ZXMNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzdGFydEZvcm1hdHRlZCA9ICQuZm9ybWF0LmRhdGUoc3RhcnQsIGZvcm1hdCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZW5kRm9ybWF0dGVkID0gJC5mb3JtYXQuZGF0ZShlbmQsIHN0YXJ0LnN1YnN0cigwLCAxMCkgIT0gZW5kLnN1YnN0cigwLCAxMCkgPyBmb3JtYXQgOiBEYXRhLkNvbnN0YW50cy5EYXRlRm9ybWF0cy5UaW1lT25seSk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzdGFydEZvcm1hdHRlZCArICIgLSAiICsgZW5kRm9ybWF0dGVkOw0KICAgICAgICAgICAgICAgICAgICB9LA0KDQogICAgICAgICAgICAgICAgICAgIC8vIEdldCBhcnJheSBpbnRlcnNlY3Rpb24NCiAgICAgICAgICAgICAgICAgICAgYXJyYXlJbnRlcnNlY3Q6IGZ1bmN0aW9uIChhcnIxLCBhcnIyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJC5tYXAoYXJyMSwgZnVuY3Rpb24gKHZhbCkgeyByZXR1cm4gJC5pbkFycmF5KHZhbCwgYXJyMikgPCAwID8gbnVsbCA6IHZhbDsgfSk7DQogICAgICAgICAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgICAgICAgICAgLy8gQWRkIGEgY2xpY2sgaGFuZGxlciB0byBpdGVtcyBpZiBvbmUgZG9lcyBub3QgYWxyZWFkeSBleGlzdA0KICAgICAgICAgICAgICAgICAgICBhZGRDbGlja0hhbmRsZXI6IGZ1bmN0aW9uIChpdGVtcywgaGFuZGxlcikgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW1zLmRhdGEoImV2ZW50cyIpID09IHVuZGVmaW5lZCB8fCBpdGVtcy5kYXRhKCJldmVudHMiKS5jbGljayA9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpdGVtcy5jbGljayhoYW5kbGVyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgQUpBWCA9IHsNCiAgICAgICAgICAgICAgICAgICAgY3VycmVudFJlcXVlc3Q6IHVuZGVmaW5lZCwgLy8gdGhlIGN1cnJlbnQgQUpBWCB4aHIgaXRlbQ0KDQogICAgICAgICAgICAgICAgICAgIC8vIGdldCBldmVudHMgZnJvbSBzZXJ2ZXIgb3IgY2FjaGUgaWYgYWxyZWFkeSBwdWxsZWQNCiAgICAgICAgICAgICAgICAgICAgZ2V0RXZlbnRzOiBmdW5jdGlvbiAoZGF0ZVR5cGUsIGRhdGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNoZWNrIGlmIGEgcmVxdWVzdCBpcyBhbHJlYWR5IGluIHByb2dyZXNzDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoQUpBWC5jdXJyZW50UmVxdWVzdCAhPSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBhYm9ydCByZXF1ZXN0IGFuZCByZXNldCB2YXINCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBBSkFYLmN1cnJlbnRSZXF1ZXN0LmFib3J0KCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNoZWNrIGlmIHBhcmFtcyBub3QgcGFzc2VkIGluDQogICAgICAgICAgICAgICAgICAgICAgICBkYXRlVHlwZSA9IGRhdGVUeXBlICE9PSB1bmRlZmluZWQgPyBkYXRlVHlwZSA6IFV0aWxzLmdldE11bHRpbGlzdFZhbHVlKEludGVyZmFjZS5jYWxlbmRhclR5cGVDb250cm9sKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGUgPSBkYXRlICE9PSB1bmRlZmluZWQgPyBkYXRlIDogKGRhdGVUeXBlID09IERhdGEuQ29uc3RhbnRzLkNhbGVuZGFyVHlwZXMuTW9udGggPyAoSW50ZXJmYWNlLm1vbnRoVmlzaWJsZSArICItMDEiKSA6IFV0aWxzLmdldERhdGVwaWNrZXJWYWx1ZShJbnRlcmZhY2UuY2FsZW5kYXJDb250cm9sKSk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGdldCBtb250aCBhbmQgeWVhciBmcm9tIGRhdGUNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtb250aFN0cmluZyA9IGRhdGUuc3Vic3RyKDAsIDcpOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBzaG93IGRhdGUgc3RyaW5nDQogICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2Uuc2hvd0RhdGVUZXh0KGRhdGVUeXBlLCBkYXRlKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2xlYXIgZXZlbnQgbGlzdCBjb250cm9sIGFuZCBwYWdpbmcgY29udHJvbA0KICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLmV2ZW50TGlzdENvbnRyb2wuaHRtbCgiIik7DQogICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UuZXZlbnRQYWdpbmdDb250cm9sLmh0bWwoIiIpOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBzaG93IGxvYWRpbmcgc3Bpbm5lcg0KICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLnNob3dMb2FkaW5nKCk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNoZWNrIGlmIGV2ZW50cyBhcmUgYWxyZWFkeSBzYXZlZA0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHJlcXVlc3QgPSB7IENhbGVuZGFyczogRGF0YS5jYWxlbmRhcnMsIE1vbnRoOiBtb250aFN0cmluZyB9Ow0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKERhdGEuZXZlbnRzW21vbnRoU3RyaW5nXSA9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBnZXQgZXZlbnRzIGZvciBtb250aCBmcm9tIHNlcnZpY2UNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBBSkFYLmN1cnJlbnRSZXF1ZXN0ID0gJC5hamF4KHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FjaGU6IGZhbHNlLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250ZW50VHlwZTogImFwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9dXRmLTgiLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhOiAkLnRvSlNPTihyZXF1ZXN0KSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVR5cGU6ICJqc29uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IEFKQVguRXZlbnRzLmVycm9yLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgQUpBWC5FdmVudHMuc3VjY2Vzcyhtb250aFN0cmluZywgZGF0YSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICJQT1NUIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAiL2FwaS9ldmVudHMvZXZlbnRsaXN0Lmpzb24iDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGdldCBldmVudHMgZnJvbSBhcnJheQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5zaG93RXZlbnRzKERhdGEuZXZlbnRzW21vbnRoU3RyaW5nXSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgICAgICAgICAgRXZlbnRzOiB7DQogICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5ldmVudExpc3RDb250cm9sLmh0bWwoIjxsaT48cD5BbiBlcnJvciBvY2N1cnJlZCB3aGlsZSBvYnRhaW5pbmcgZXZlbnQgaW5mb3JtYXRpb24uIFBsZWFzZSByZWZyZXNoIHRoZSBwYWdlIGFuZCB0cnkgYWdhaW4uPC9wPjwvbGk+Iik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgQUpBWC5jdXJyZW50UmVxdWVzdCA9IHVuZGVmaW5lZDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChtb250aFN0cmluZywgZGF0YSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIERhdGEuZXZlbnRzW21vbnRoU3RyaW5nXSA9IGRhdGE7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLnNob3dFdmVudHMoZGF0YSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgQUpBWC5jdXJyZW50UmVxdWVzdCA9IHVuZGVmaW5lZDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgSW50ZXJmYWNlID0gew0KICAgICAgICAgICAgICAgICAgICBjb250YWluZXJJZDogIiIsICAgICAgICAgIC8vIGlkIG9mIHRoZSBjb250YWluZXIgb2YgdGhlIGV2ZW50IGxpc3QNCiAgICAgICAgICAgICAgICAgICAgaXNDb25kZW5zZWRWaWV3OiBmYWxzZSwgICAvLyBjb25kZW5zZWQgdmlldyBvciBub3QNCiAgICAgICAgICAgICAgICAgICAgaGlkZUNhdGVnb3JpZXM6IGZhbHNlLCAgICAvLyBoaWRlIGNhdGVnb3JpZXMgb3Igbm90DQogICAgICAgICAgICAgICAgICAgIGV2ZW50c1BhdGg6ICIiLCAgICAgICAgICAgLy8gdGhlIHBhdGggb2YgdGhlIGV2ZW50cyBwYWdlDQogICAgICAgICAgICAgICAgICAgIGNhbGVuZGFyQ29udHJvbDogW10sICAgICAgLy8gY2FsZW5kYXIgY29udHJvbA0KICAgICAgICAgICAgICAgICAgICBjYWxlbmRhclR5cGVDb250cm9sOiBbXSwgIC8vIGNhbGVuZGFyIHR5cGUgY29udHJvbA0KICAgICAgICAgICAgICAgICAgICBjYWxlbmRhckxpc3RDb250cm9sOiBbXSwgIC8vIGNhbGVuZGFyIGxpc3QgY29udHJvbA0KICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeUxpc3RDb250cm9sOiBbXSwgIC8vIGNhdGVnb3J5IGxpc3QgY29udHJvbA0KICAgICAgICAgICAgICAgICAgICBkYXRlVGV4dENvbnRyb2w6IFtdLCAgICAgIC8vIHNlbGVjdGVkIGRhdGUgdGV4dCBjb250cm9sDQogICAgICAgICAgICAgICAgICAgIGV2ZW50TGlzdENvbnRyb2w6IFtdLCAgICAgLy8gZXZlbnQgbGlzdCBjb250cm9sDQogICAgICAgICAgICAgICAgICAgIGV2ZW50UGFnaW5nQ29udHJvbDogW10sICAgLy8gZXZlbnQgcGFnaW5nIGNvbnRyb2wNCiAgICAgICAgICAgICAgICAgICAgbW9udGhWaXNpYmxlOiAiIiwgICAgICAgICAvLyB0aGUgbW9udGggdmlzaWJsZSBpbiB0aGUgY2FsZW5kYXIgY29udHJvbCwNCiAgICAgICAgICAgICAgICAgICAgZXZlbnRzVmlzaWJsZTogW10sICAgICAgICAvLyB0aGUgZXZlbnRzIHRoYXQgY2FuIGJlIHNlZW4gKGJhc2VkIG9uIGZpbHRlcnMpLCB1c2VkIGZvciBwYWdpbmcNCiAgICAgICAgICAgICAgICAgICAgbG9hZGluZ1NlbGVjdG9yOiAiIiwgICAgICAvLyB0aGUgc2VsZWN0b3IgZm9yIHRoZSBsb2FkaW5nIHNwaW5uZXINCg0KICAgICAgICAgICAgICAgICAgICAvLyBzZXR1cCB0aGUgaW50ZXJmYWNlDQogICAgICAgICAgICAgICAgICAgIHNldHVwOiBmdW5jdGlvbiAoY29udGFpbmVySWQsIGlzQ29uZGVuc2VkVmlldywgaGlkZUNhdGVnb3JpZXMsIGV2ZW50c1BhdGgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGdldCBpbnRlcmZhY2UgY29tcG9uZW50cw0KICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLmNvbnRhaW5lcklkID0gY29udGFpbmVySWQ7DQogICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UuaXNDb25kZW5zZWRWaWV3ID0gaXNDb25kZW5zZWRWaWV3Ow0KICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLmhpZGVDYXRlZ29yaWVzID0gaGlkZUNhdGVnb3JpZXM7DQogICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UuZXZlbnRzUGF0aCA9IGV2ZW50c1BhdGg7DQogICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UuY2FsZW5kYXJDb250cm9sID0gJCgiIyIgKyBJbnRlcmZhY2UuY29udGFpbmVySWQgKyAiIC5ldmVudC1saXN0LWNhbGVuZGFyLWZpbHRlciIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLmNhbGVuZGFyVHlwZUNvbnRyb2wgPSAkKCIjIiArIEludGVyZmFjZS5jb250YWluZXJJZCArICIgLmZpbHRlci1kYXkgc2VsZWN0Iik7DQogICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UuY2FsZW5kYXJMaXN0Q29udHJvbCA9ICQoIiMiICsgSW50ZXJmYWNlLmNvbnRhaW5lcklkICsgIiAuY2FsZW5kYXItZXZlbnQgc2VsZWN0Iik7DQogICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UuY2F0ZWdvcnlMaXN0Q29udHJvbCA9ICQoIiMiICsgY29udGFpbmVySWQgKyAiIC5jYXRlZ29yeS1ldmVudCBzZWxlY3QiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5kYXRlVGV4dENvbnRyb2wgPSAkKCIjIiArIGNvbnRhaW5lcklkICsgIiAubGF0ZXN0LW5ld3MgLmZpbHRlcmVkLWJ5Iik7DQogICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UuZXZlbnRMaXN0Q29udHJvbCA9ICQoIiMiICsgY29udGFpbmVySWQgKyAiIC5ldmVudC1saXN0Iik7DQogICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UuZXZlbnRQYWdpbmdDb250cm9sID0gJCgiIyIgKyBjb250YWluZXJJZCArICIgLmV2ZW50cy1wYWdpbmF0aW9uIik7DQogICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UubG9hZGluZ1NlbGVjdG9yID0gIiMiICsgY29udGFpbmVySWQgKyAiIC5ldmVudHMtbG9hZGluZyI7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNoZWNrIGZvciBjb25kZW5zZWQgdmlldw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEludGVyZmFjZS5pc0NvbmRlbnNlZFZpZXcpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjaGFuZ2UgaW50ZXJmYWNlIHRvIGNvbmRlbnNlZCB2aWV3DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgiIyIgKyBJbnRlcmZhY2UuY29udGFpbmVySWQgKyAiIC5maWx0ZXItY29udCAuc3BhbjYiKS5yZW1vdmVDbGFzcygic3BhbjYiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCIjIiArIEludGVyZmFjZS5jb250YWluZXJJZCArICIgLm5ld3MtaGVhZGluZyIpLmhpZGUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBEYXRhLkNvbnN0YW50cy5FdmVudHNQZXJQYWdlID0gNTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2V0IGRlZmF1bHQgdmFsdWVzDQogICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UuY2FsZW5kYXJUeXBlQ29udHJvbC52YWwoRGF0YS5Db25zdGFudHMuQ2FsZW5kYXJUeXBlcy5DdXJyZW50KTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gY3JlYXRlIHdpZGdldHMNCiAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5jYWxlbmRhckNvbnRyb2wuZGF0ZXBpY2tlcih7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybWF0OiAieXl5eS1tbS1kZCIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdG9kYXlIaWdobGlnaHQ6IHRydWUNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pLm9uKCJjaGFuZ2VNb250aCIsIEludGVyZmFjZS5FdmVudHMubW9udGhDaGFuZ2VkKS5vbigiY2hhbmdlRGF0ZSIsIEludGVyZmFjZS5FdmVudHMuZGF0ZVNlbGVjdGVkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5jYWxlbmRhclR5cGVDb250cm9sLm11bHRpc2VsZWN0KHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZTogSW50ZXJmYWNlLkV2ZW50cy5jYWxlbmRhclR5cGVDaGFuZ2VkDQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5jYWxlbmRhckxpc3RDb250cm9sLm11bHRpc2VsZWN0KHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBidXR0b25UZXh0OiBVQWxiZXJ0YS5TaXRlY29yZS5VdGlsaXRpZXMuTXVsdGlzZWxlY3RCdXR0b25UZXh0LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlOiBJbnRlcmZhY2UuRXZlbnRzLmZpbHRlckxpc3RDaGFuZ2VkDQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5jYXRlZ29yeUxpc3RDb250cm9sLm11bHRpc2VsZWN0KHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBidXR0b25UZXh0OiBVQWxiZXJ0YS5TaXRlY29yZS5VdGlsaXRpZXMuTXVsdGlzZWxlY3RCdXR0b25UZXh0LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlOiBJbnRlcmZhY2UuRXZlbnRzLmZpbHRlckxpc3RDaGFuZ2VkDQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gaGlkZSBjYWxlbmRhciBsaXN0IGNvbnRyb2wgaWYgb25seSBvbmUgaXRlbSBpbiBsaXN0DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoSW50ZXJmYWNlLmNhbGVuZGFyTGlzdENvbnRyb2wuY2hpbGRyZW4oKS5sZW5ndGggPT0gMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoIiMiICsgSW50ZXJmYWNlLmNvbnRhaW5lcklkICsgIiAuY2FsZW5kYXItZXZlbnQiKS5oaWRlKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNoZWNrIGlmIHdlIGFyZSB0byBoaWRlIHRoZSBjYXRlZ29yaWVzDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoSW50ZXJmYWNlLmhpZGVDYXRlZ29yaWVzKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgiIyIgKyBJbnRlcmZhY2UuY29udGFpbmVySWQgKyAiIC5jYXRlZ29yeS1ldmVudCIpLmhpZGUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2V0IHN0b3JlZCB2YWx1ZXMNCiAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5tb250aFZpc2libGUgPSBVdGlscy5nZXREYXRlcGlja2VyVmFsdWUoSW50ZXJmYWNlLmNhbGVuZGFyQ29udHJvbCkuc3Vic3RyKDAsIDcpOw0KICAgICAgICAgICAgICAgICAgICB9LA0KDQogICAgICAgICAgICAgICAgICAgIC8vIHNob3cgZGF0ZSB0ZXh0DQogICAgICAgICAgICAgICAgICAgIHNob3dEYXRlVGV4dDogZnVuY3Rpb24gKGRhdGVUeXBlLCBkYXRlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaHRtbCA9ICJ8ICI7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaCAoZGF0ZVR5cGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIERhdGEuQ29uc3RhbnRzLkNhbGVuZGFyVHlwZXMuQ3VycmVudDoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaHRtbCArPSBJbnRlcmZhY2UuY2FsZW5kYXJUeXBlQ29udHJvbC5maW5kKCI6c2VsZWN0ZWQiKS5odG1sKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgRGF0YS5Db25zdGFudHMuQ2FsZW5kYXJUeXBlcy5EYXk6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWwgKz0gJC5mb3JtYXQuZGF0ZShkYXRlICsgIiAiLCAiZGRkLCBNTU1NIGQsIHl5eXkiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBEYXRhLkNvbnN0YW50cy5DYWxlbmRhclR5cGVzLk1vbnRoOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sICs9ICQuZm9ybWF0LmRhdGUoZGF0ZSArICIgIiwgIk1NTU0sIHl5eXkiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5kYXRlVGV4dENvbnRyb2wuaHRtbChodG1sKTsNCiAgICAgICAgICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgICAgICAgICAvLyBzaG93IGV2ZW50cyBvbiBwYWdlDQogICAgICAgICAgICAgICAgICAgIHNob3dFdmVudHM6IGZ1bmN0aW9uIChldmVudExpc3QpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVtcHR5IHRoZSB2aWV3YWJsZSBldmVudHMgbGlzdA0KICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLmV2ZW50c1Zpc2libGUubGVuZ3RoID0gMDsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gcHJvY2VzcyBldmVudHMNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgaW4gZXZlbnRMaXN0KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGV2ZW50ID0gZXZlbnRMaXN0W2ldOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2hlY2sgZmlsdGVycw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghSW50ZXJmYWNlLmNoZWNrRmlsdGVycyhldmVudCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYWRkIGV2ZW50IHRvIHZpZXdhYmxlIGxpc3QNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UuZXZlbnRzVmlzaWJsZS5wdXNoKGV2ZW50KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gZGlzcGxheSBmaXJzdCBwYWdlIG9mIGV2ZW50cw0KICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLnNob3dQYWdlKDEpOw0KICAgICAgICAgICAgICAgICAgICB9LA0KDQogICAgICAgICAgICAgICAgICAgIC8vIHNob3cgcGFnaW5nIGxpbmtzDQogICAgICAgICAgICAgICAgICAgIHNob3dQYWdpbmc6IGZ1bmN0aW9uIChwYWdlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAvLyBjbGVhciBwYWdlcw0KICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLmV2ZW50UGFnaW5nQ29udHJvbC5odG1sKCIiKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2hlY2sgZm9yIGVtcHR5IGxpc3QNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChJbnRlcmZhY2UuZXZlbnRzVmlzaWJsZS5sZW5ndGggPT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gYWRkIHBhZ2VzDQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYWN0aXZlUGFnZSA9IHBhcnNlSW50KHBhZ2UpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG1heFBhZ2UgPSBNYXRoLmNlaWwoSW50ZXJmYWNlLmV2ZW50c1Zpc2libGUubGVuZ3RoIC8gMTApOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPD0gbWF4UGFnZTsgaSsrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2hlY2sgZm9yIGFjdGl2ZSBwYWdlDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkgPT0gYWN0aXZlUGFnZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UuZXZlbnRQYWdpbmdDb250cm9sLmFwcGVuZCgnPGxpIGNsYXNzPSJhY3RpdmUiPicgKyBpICsgJzwvbGk+Jyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLmV2ZW50UGFnaW5nQ29udHJvbC5hcHBlbmQoJzxsaT48YSBocmVmPSJqYXZhc2NyaXB0OnZvaWQobnVsbCkiPicgKyBpICsgJzwvYT48L2xpPicpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gYWRkIGNsaWNrIGhhbmRsZXINCiAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5ldmVudFBhZ2luZ0NvbnRyb2wuZmluZCgiYSIpLmNsaWNrKEludGVyZmFjZS5FdmVudHMucGFnZUNsaWNrZWQpOw0KICAgICAgICAgICAgICAgICAgICB9LA0KDQogICAgICAgICAgICAgICAgICAgIC8vIHNob3cgc2VsZWN0ZWQgcGFnZSBvZiBldmVudHMNCiAgICAgICAgICAgICAgICAgICAgc2hvd1BhZ2U6IGZ1bmN0aW9uIChwYWdlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAvLyBjbGVhciBldmVudHMNCiAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5ldmVudExpc3RDb250cm9sLmh0bWwoIiIpOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayBmb3IgZW1wdHkgbGlzdA0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEludGVyZmFjZS5ldmVudHNWaXNpYmxlLmxlbmd0aCA9PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZGlzcGxheSAibm8gZXZlbnRzIiBtZXNzYWdlDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLmV2ZW50TGlzdENvbnRyb2wuaHRtbCgnPGxpPjxoND5ObyBFdmVudHMgRm91bmQ8L2g0PjwvbGk+Jyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBzaG93IGV2ZW50cyBvbiBzZWxlY3RlZCBwYWdlDQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gKHBhcnNlSW50KHBhZ2UpIC0gMSkgKiBEYXRhLkNvbnN0YW50cy5FdmVudHNQZXJQYWdlOyBpIDwgRGF0YS5Db25zdGFudHMuRXZlbnRzUGVyUGFnZSAqIHBhZ2U7IGkrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBldmVudCA9IEludGVyZmFjZS5ldmVudHNWaXNpYmxlW2ldOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZW5zdXJlIGV2ZW50IGlzIHZhbGlkDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50ID09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjcmVhdGUgaHRtbCBjb21wb25lbnRzDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGVIdG1sID0gVXRpbHMuZm9ybWF0RGF0ZVJhbmdlKGV2ZW50LlN0YXJ0RGF0ZSwgZXZlbnQuRW5kRGF0ZSksDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50TGlua0h0bWwgPSBldmVudC5DYWxlbmRhcnMgPT0gdW5kZWZpbmVkIHx8IGV2ZW50LkNhbGVuZGFyc1swXSA9PSB1bmRlZmluZWQgfHwgRGF0YS5jYWxlbmRhckl0ZW1zW2V2ZW50LkNhbGVuZGFyc1swXV0gPT0gdW5kZWZpbmVkID8gIiMiIDogSW50ZXJmYWNlLmV2ZW50c1BhdGggKyBEYXRhLmNhbGVuZGFySXRlbXNbZXZlbnQuQ2FsZW5kYXJzWzBdXS5rZXkgKyAiLyIgKyBldmVudC5FdmVudElkLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsb2NhdGlvbkh0bWwgPSBldmVudC5Mb2NhdGlvbiA9PSB1bmRlZmluZWQgPyAiIiA6IGV2ZW50LkxvY2F0aW9uOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY3JlYXRlIGV2ZW50IGh0bWwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaHRtbCA9ICc8bGk+JyArDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8YSBocmVmPSInICsgZXZlbnRMaW5rSHRtbCArICciPicgKw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPGRpdiBjbGFzcz0ibGlzdC1pdGVtLWNvbnRlbnQiPicgKw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPGg0PicgKyBldmVudC5UaXRsZSArICc8L2g0PicgKw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPHAgY2xhc3M9Imxpc3QtaXRlbS1leHRyYSI+JyArIGRhdGVIdG1sICsgJzwvcD4nICsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKEludGVyZmFjZS5pc0NvbmRlbnNlZFZpZXcgPyAnJyA6ICc8cCBjbGFzcz0ibGlzdC1pdGVtLWV4dHJhIj4nICsgbG9jYXRpb25IdG1sICsgJzwvcD4nKSArDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8L2Rpdj4nICsgJzwvYT4nICsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzwvbGk+JzsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFkZCBldmVudCB0byBsaXN0DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLmV2ZW50TGlzdENvbnRyb2wuYXBwZW5kKGh0bWwpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayBmb3IgY29uZGVuc2VkIHZpZXcNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghSW50ZXJmYWNlLmlzQ29uZGVuc2VkVmlldykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNob3cgcGFnaW5nDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLnNob3dQYWdpbmcocGFnZSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFkZCBzaG93IG1vcmUgZXZlbnRzIGxpbmsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UuZXZlbnRMaXN0Q29udHJvbC5hcHBlbmQoJzxsaSBjbGFzcz0iYm90dG9tLXJvdyI+PGEgaHJlZj0iL2V2ZW50cyI+U2hvdyBNb3JlIEV2ZW50czwvYT48L2xpPicpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGhpZGUgcGFnaW5nIGxpc3QNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UuZXZlbnRQYWdpbmdDb250cm9sLmhpZGUoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayB0byBzZWUgaWYgYW4gZXZlbnQgaXMgcGFydCBvZiBmaWx0ZXJzDQogICAgICAgICAgICAgICAgICAgIGNoZWNrRmlsdGVyczogZnVuY3Rpb24gKGV2ZW50KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAvLyBza2lwIGludmFsaWQgZGF0ZSBldmVudHMNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChldmVudC5TdGFydERhdGUgPT0gdW5kZWZpbmVkIHx8IGV2ZW50LkVuZERhdGUgPT0gdW5kZWZpbmVkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayBkYXRlcyBiYXNlZCBvbiBjYWxlbmRhciB0eXBlDQogICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2ggKFV0aWxzLmdldE11bHRpbGlzdFZhbHVlKEludGVyZmFjZS5jYWxlbmRhclR5cGVDb250cm9sKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZSBkYXRlIHNlbGVjdGVkIChjdXJyZW50IGRhdGUpIGlzIG9uIG9yIGJlZm9yZSB0aGUgZXZlbnQgZW5kIGRhdGUNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIERhdGEuQ29uc3RhbnRzLkNhbGVuZGFyVHlwZXMuQ3VycmVudDoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFVdGlscy5pc0RhdGVCZWZvcmUoVXRpbHMuZ2V0RGF0ZXBpY2tlclZhbHVlKEludGVyZmFjZS5jYWxlbmRhckNvbnRyb2wpLCBldmVudC5FbmREYXRlKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayBpZiB0aGUgZGF0ZSBzZWxlY3RlZCBpcyBiZXR3ZWVuIHRoZSBldmVudCBkYXRlcyAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgRGF0YS5Db25zdGFudHMuQ2FsZW5kYXJUeXBlcy5EYXk6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghVXRpbHMuaXNEYXRlSW5SYW5nZShVdGlscy5nZXREYXRlcGlja2VyVmFsdWUoSW50ZXJmYWNlLmNhbGVuZGFyQ29udHJvbCksIGV2ZW50LlN0YXJ0RGF0ZSwgZXZlbnQuRW5kRGF0ZSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbW9udGggaXMgc2tpcHBlZCBhcyB3ZSBhcmUgcHVsbGluZyBldmVudHMgYmFzZWQgb24gdGhlIG1vbnRoLCBzbyBzaG93IGFsbCBmb3IgbW9udGggdHlwZSAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgRGF0YS5Db25zdGFudHMuQ2FsZW5kYXJUeXBlcy5Nb250aDoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNoZWNrIHNlbGVjdGVkIGNhbGVuZGFycyAobm9uZSBzZWxlY3RlZCA9IHNlbGVjdCBhbGwpDQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2VsZWN0ZWRDYWxlbmRhcnMgPSBVdGlscy5nZXRNdWx0aWxpc3RWYWx1ZShJbnRlcmZhY2UuY2FsZW5kYXJMaXN0Q29udHJvbCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXZlbnRDYWxlbmRhcnMgPSBldmVudC5DYWxlbmRhcnMgPT0gdW5kZWZpbmVkID8gW10gOiAkLm1hcChldmVudC5DYWxlbmRhcnMsIGZ1bmN0aW9uICh2YWwpIHsgcmV0dXJuIHZhbDsgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZWN0ZWRDYWxlbmRhcnMubGVuZ3RoID4gMCAmJiBVdGlscy5hcnJheUludGVyc2VjdChzZWxlY3RlZENhbGVuZGFycywgZXZlbnRDYWxlbmRhcnMpLmxlbmd0aCA9PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayBzZWxlY3RlZCBjYXRlZ29yaWVzIChub25lIHNlbGVjdGVkID0gc2VsZWN0IGFsbCkNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzZWxlY3RlZENhdGVnb3JpZXMgPSBVdGlscy5nZXRNdWx0aWxpc3RWYWx1ZShJbnRlcmZhY2UuY2F0ZWdvcnlMaXN0Q29udHJvbCk7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXZlbnRDYXRlZ29yaWVzID0gZXZlbnQuQ2F0ZWdvcmllcyA9PSB1bmRlZmluZWQgPyBbXSA6ICQubWFwKGV2ZW50LkNhdGVnb3JpZXMsIGZ1bmN0aW9uICh2YWwpIHsgcmV0dXJuIHZhbDsgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZWN0ZWRDYXRlZ29yaWVzLmxlbmd0aCA+IDAgJiYgVXRpbHMuYXJyYXlJbnRlcnNlY3Qoc2VsZWN0ZWRDYXRlZ29yaWVzLCBldmVudENhdGVnb3JpZXMpLmxlbmd0aCA9PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsNCiAgICAgICAgICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgICAgICAgICAvLyBzaG93IHRoZSBsb2FkaW5nIHNwaW5uZXINCiAgICAgICAgICAgICAgICAgICAgc2hvd0xvYWRpbmc6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNoZWNrIGlmIHRoZSBzcGlubmVyIGlzIGFscmVhZHkgc2hvd24NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICgkKEludGVyZmFjZS5sb2FkaW5nU2VsZWN0b3IpLmxlbmd0aCA9PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLmV2ZW50TGlzdENvbnRyb2wuYXBwZW5kKCc8bGkgY2xhc3M9ImxvYWRpbmciPjwvbGk+Jyk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgICAgICAgICAgRXZlbnRzOiB7DQogICAgICAgICAgICAgICAgICAgICAgICBtb250aENoYW5nZWQ6IGZ1bmN0aW9uIChldmVudCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNldCBjYWxlbmRhciB0eXBlIHRvIG1vbnRoDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgVXRpbHMuc2V0TXVsdGlsaXN0VmFsdWUoSW50ZXJmYWNlLmNhbGVuZGFyVHlwZUNvbnRyb2wsIERhdGEuQ29uc3RhbnRzLkNhbGVuZGFyVHlwZXMuTW9udGgpOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc3RvcmUgdmlzaWJsZSBtb250aA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5tb250aFZpc2libGUgPSBldmVudC5kYXRlLmdldFVUQ0Z1bGxZZWFyKCkgKyAiLSIgKyBVdGlscy5wYWRMZWZ0KGV2ZW50LmRhdGUuZ2V0VVRDTW9udGgoKSArIDEsICIwIiwgMik7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBBSkFYLmdldEV2ZW50cyhEYXRhLkNvbnN0YW50cy5DYWxlbmRhclR5cGVzLk1vbnRoLCBJbnRlcmZhY2UubW9udGhWaXNpYmxlICsgIi0wMSIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgICAgICAgICAgICAgZGF0ZVNlbGVjdGVkOiBmdW5jdGlvbiAoZXZlbnQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBzZXQgY2FsZW5kYXIgdHlwZSB0byBkYXkNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBVdGlscy5zZXRNdWx0aWxpc3RWYWx1ZShJbnRlcmZhY2UuY2FsZW5kYXJUeXBlQ29udHJvbCwgRGF0YS5Db25zdGFudHMuQ2FsZW5kYXJUeXBlcy5EYXkpOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGUgPSBldmVudC5kYXRlLmdldFVUQ0Z1bGxZZWFyKCkgKyAiLSIgKyBVdGlscy5wYWRMZWZ0KGV2ZW50LmRhdGUuZ2V0VVRDTW9udGgoKSArIDEsICIwIiwgMikgKyAiLSIgKyBVdGlscy5wYWRMZWZ0KGV2ZW50LmRhdGUuZ2V0VVRDRGF0ZSgpLCAiMCIsIDIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEFKQVguZ2V0RXZlbnRzKERhdGEuQ29uc3RhbnRzLkNhbGVuZGFyVHlwZXMuRGF5LCBkYXRlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGVuZGFyVHlwZUNoYW5nZWQ6IGZ1bmN0aW9uIChvcHRpb24pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjaGFuZ2UgY2FsZW5kYXIgdmFsdWUgaWYgdHlwZSBjaGFuZ2VkIHRvICJjdXJyZW50Ig0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChvcHRpb24udmFsKCkgPT0gRGF0YS5Db25zdGFudHMuQ2FsZW5kYXJUeXBlcy5DdXJyZW50KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5jYWxlbmRhckNvbnRyb2wuZGF0ZXBpY2tlcigidXBkYXRlIiwgRGF0YS5jdXJyZW50RGF0ZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgQUpBWC5nZXRFdmVudHMoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlckxpc3RDaGFuZ2VkOiBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgQUpBWC5nZXRFdmVudHMoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2VDbGlja2VkOiBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2hvdyBjbGlja2VkIHBhZ2UNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2Uuc2hvd1BhZ2UoJCh0aGlzKS5odG1sKCkpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfTsNCg0KICAgICAgICAgICAgLy8gaW5zdGFuY2UgaW5pdGlhbGl6YXRpb24NCg0KICAgICAgICAgICAgZnVuY3Rpb24gaW5pdChjb250YWluZXJJZCwgaXNDb25kZW5zZWRWaWV3LCBoaWRlQ2F0ZWdvcmllcywgZXZlbnRzUGF0aCkgew0KICAgICAgICAgICAgICAgIEludGVyZmFjZS5zZXR1cChjb250YWluZXJJZCwgaXNDb25kZW5zZWRWaWV3LCBoaWRlQ2F0ZWdvcmllcywgZXZlbnRzUGF0aCk7DQoNCiAgICAgICAgICAgICAgICAvLyBpbml0aWFsaXplIGRhdGEgb2JqZWN0cw0KICAgICAgICAgICAgICAgIERhdGEuY2FsZW5kYXJzID0gSW50ZXJmYWNlLmNhbGVuZGFyTGlzdENvbnRyb2wuY2hpbGRyZW4oKS5tYXAoZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpcy52YWx1ZTsgfSkuZ2V0KCk7DQogICAgICAgICAgICAgICAgSW50ZXJmYWNlLmNhbGVuZGFyTGlzdENvbnRyb2wuY2hpbGRyZW4oKS5lYWNoKGZ1bmN0aW9uICgpIHsgRGF0YS5jYWxlbmRhckl0ZW1zW3RoaXMudmFsdWVdID0geyBrZXk6ICQodGhpcykuZGF0YSgia2V5IiksIG5hbWU6IHRoaXMudGV4dCB9OyB9KTsNCiAgICAgICAgICAgICAgICBJbnRlcmZhY2UuY2F0ZWdvcnlMaXN0Q29udHJvbC5jaGlsZHJlbigpLmVhY2goZnVuY3Rpb24gKCkgeyBEYXRhLmNhdGVnb3J5SXRlbXNbdGhpcy52YWx1ZV0gPSB0aGlzLnRleHQ7IH0pOw0KICAgICAgICAgICAgICAgIERhdGEuY3VycmVudERhdGUgPSBVdGlscy5nZXREYXRlcGlja2VyVmFsdWUoSW50ZXJmYWNlLmNhbGVuZGFyQ29udHJvbCk7DQoNCiAgICAgICAgICAgICAgICAvLyBnZXQgZXZlbnRzDQogICAgICAgICAgICAgICAgQUpBWC5nZXRFdmVudHMoVXRpbHMuZ2V0TXVsdGlsaXN0VmFsdWUoSW50ZXJmYWNlLmNhbGVuZGFyVHlwZUNvbnRyb2wpLCBEYXRhLmN1cnJlbnREYXRlKTsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcmV0dXJuIHsNCiAgICAgICAgICAgICAgICBJbml0aWFsaXplOiBpbml0DQogICAgICAgICAgICB9Ow0KICAgICAgICB9KGpRdWVyeSkpOw0KICAgIH0NCg0KICAgIHJldHVybiB7DQogICAgICAgIEdldEluc3RhbmNlOiBnZXRJbnN0YW5jZQ0KICAgIH07DQp9KCkpOzsNCi8qKg0KICogVUFsYmVydGEgRk1BIENhcm91c2VsDQogKiBBdXRob3I6IERlYW4gVmlnb3JlbiAtIHZpZ29yZW5AdWFsYmVydGEuY2ENCiAqLw0KDQovL1JlZmVyZW5jZXMgVG8gT3RoZXIgU2NyaXB0cw0KLy9AcmVmZXJlbmNlIGpxdWVyeS5mbGV4c2xpZGVyLW1pbi5qcw0KDQovLyBidWlsZCBuYW1lc3BhY2UNCnZhciBVQWxiZXJ0YSA9IFVBbGJlcnRhIHx8IHt9Ow0KVUFsYmVydGEuU2l0ZWNvcmUgPSBVQWxiZXJ0YS5TaXRlY29yZSB8fCB7fTsNClVBbGJlcnRhLlNpdGVjb3JlLkZlYXR1cmUgPSBVQWxiZXJ0YS5TaXRlY29yZS5GZWF0dXJlIHx8IHt9Ow0KDQoNClVBbGJlcnRhLlNpdGVjb3JlLkZlYXR1cmUuQ2Fyb3VzZWwgPSBVQWxiZXJ0YS5TaXRlY29yZS5GZWF0dXJlLkNhcm91c2VsIHx8IChmdW5jdGlvbiAoKSB7DQogICAgZnVuY3Rpb24gZ2V0SW5zdGFuY2UoKSB7DQogICAgICAgIHJldHVybiAoZnVuY3Rpb24gKCQpIHsNCg0KICAgICAgICAgICAgZnVuY3Rpb24gc3RhcnQoY29udGFpbmVySWQsIHBhdXNlT25Ib3ZlciwgcmFuZG9taXplKSB7DQogICAgICAgICAgICAgICAgJCgnIycgKyBjb250YWluZXJJZCArICcuZmxleHNsaWRlcicpLmZsZXhzbGlkZXIoew0KICAgICAgICAgICAgICAgICAgICBhbmltYXRpb246ICJzbGlkZSIsDQogICAgICAgICAgICAgICAgICAgIHNlbGVjdG9yOiAiLnNsaWRlcyA+IGRpdi5zbGlkZSIsDQogICAgICAgICAgICAgICAgICAgIHBhdXNlT25Ib3ZlcjogcGF1c2VPbkhvdmVyLA0KICAgICAgICAgICAgICAgICAgICByYW5kb21pemU6IHJhbmRvbWl6ZSwNCiAgICAgICAgICAgICAgICAgICAgc2xpZGVzaG93U3BlZWQ6IDEyMDAwDQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHJldHVybiB7DQogICAgICAgICAgICAgICAgU3RhcnQ6IHN0YXJ0DQogICAgICAgICAgICB9Ow0KICAgICAgICB9IChqUXVlcnkpKTsNCiAgICB9DQoNCiAgICByZXR1cm4gew0KICAgICAgICBHZXRJbnN0YW5jZTogZ2V0SW5zdGFuY2UNCiAgICB9Ow0KfSAoKSk7DQo7DQovKioNCiAqIFVBbGJlcnRhIEZNQSBUYWJiZWQgU2xpZGVyDQogKiBBdXRob3I6IERlYW4gVmlnb3JlbiAtIHZpZ29yZW5AdWFsYmVydGEuY2ENCiAqLw0KDQovLyBidWlsZCBuYW1lc3BhY2UNCnZhciBVQWxiZXJ0YSA9IFVBbGJlcnRhIHx8IHt9Ow0KVUFsYmVydGEuU2l0ZWNvcmUgPSBVQWxiZXJ0YS5TaXRlY29yZSB8fCB7fTsNClVBbGJlcnRhLlNpdGVjb3JlLkZlYXR1cmUgPSBVQWxiZXJ0YS5TaXRlY29yZS5GZWF0dXJlIHx8IHt9Ow0KDQpVQWxiZXJ0YS5TaXRlY29yZS5GZWF0dXJlLlRhYmJlZCA9IGZ1bmN0aW9uICgkKSB7DQogICAgZnVuY3Rpb24gaW5pdCgpIHsNCiAgICAgICAgJCgnLnNsaWRlJykuYWRkQ2xhc3MoJ2ZtYS1zbGlkZScpLnJlbW92ZUNsYXNzKCdzbGlkZScpOw0KICAgICAgICAvLyBpbml0DQogICAgICAgIHZhciBmbWFDb250YWluZXIgPSAkKCcuZm1hLWNvbnRhaW5lcicpOw0KICAgICAgICB2YXIgZm1hU2xpZGVzID0gZm1hQ29udGFpbmVyLmZpbmQoJy5mbWEtc2xpZGUnKTsNCiAgICAgICAgdmFyIGZtYVRhYnMgPSBmbWFDb250YWluZXIucGFyZW50KCkuZmluZCgnLmZtYS10YWJzIGxpJyk7DQoNCiAgICAgICAgLy8gc2V0QWN0aXZlDQogICAgICAgIGZtYVRhYnMuY2xpY2soZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgc2V0QWN0aXZlKCQodGhpcykuaW5kZXgoKSk7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0pOw0KDQogICAgICAgIGZtYVNsaWRlcy5jbGljayhmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICBzZXRBY3RpdmUoJCh0aGlzKS5pbmRleCgpKTsNCiAgICAgICAgICAgIHJldHVybiBmbWFTbGlkZXMuZXEoaW5kZXgpLmhhc0NsYXNzKCdmbWEtYWN0aXZlJyk7DQogICAgICAgIH0pOw0KDQogICAgICAgIGZtYVRhYnMuaG92ZXIoZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgdG9nZ2xlSG92ZXIoJCh0aGlzKS5pbmRleCgpKTsNCiAgICAgICAgfSwgZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgdG9nZ2xlSG92ZXIoJCh0aGlzKS5pbmRleCgpKTsNCiAgICAgICAgfSk7DQoNCiAgICAgICAgZm1hU2xpZGVzLmhvdmVyKGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHRvZ2dsZUhvdmVyKCQodGhpcykuaW5kZXgoKSk7DQogICAgICAgIH0sIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHRvZ2dsZUhvdmVyKCQodGhpcykuaW5kZXgoKSk7DQogICAgICAgIH0pOw0KDQogICAgICAgIHZhciBnZXRTbGlkZXNXaWR0aCA9IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHZhciBzbGlkZXNXaWR0aCA9IDA7DQogICAgICAgICAgICBmbWFTbGlkZXMuZWFjaChmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgc2xpZGVzV2lkdGggKz0gJCh0aGlzKS53aWR0aCgpOw0KICAgICAgICAgICAgfSk7DQogICAgICAgICAgICByZXR1cm4gc2xpZGVzV2lkdGg7DQogICAgICAgIH07DQoNCiAgICAgICAgdmFyIHRvdGFsV2lkdGggPSBnZXRTbGlkZXNXaWR0aCgpOw0KDQogICAgICAgIHZhciBzZXRBY3RpdmUgPSBmdW5jdGlvbiAoaSkgew0KDQogICAgICAgICAgICB2YXIgbGVmdFBvaW50ID0gZm1hU2xpZGVzLmVxKGkpLnBvc2l0aW9uKCkubGVmdDsNCiAgICAgICAgICAgIHZhciBjb250YWluZXJXaWR0aCA9ICQoJy5mbWEtc2xpZGUtd3JhcHBlcicpLndpZHRoKCk7DQogICAgICAgICAgICB2YXIgc2xpZGVQb3NpdGlvbiA9IDA7DQoNCiAgICAgICAgICAgIGZtYVNsaWRlcy5yZW1vdmVDbGFzcygnZm1hLWFjdGl2ZScpOw0KICAgICAgICAgICAgZm1hU2xpZGVzLmVxKGkpLmFkZENsYXNzKCdmbWEtYWN0aXZlJyk7DQogICAgICAgICAgICBmbWFUYWJzLnJlbW92ZUNsYXNzKCdmbWEtYnV0dG9uLWFjdGl2ZScpOw0KICAgICAgICAgICAgZm1hVGFicy5lcShpKS5hZGRDbGFzcygnZm1hLWJ1dHRvbi1hY3RpdmUnKTsNCg0KICAgICAgICAgICAgaWYgKGkgPT0gMCkgew0KICAgICAgICAgICAgICAgICQoJy5mbWEtc2xpZGUtc2Nyb2xsZXInKS5jc3MoJ2xlZnQnLCAnMHB4Jyk7DQogICAgICAgICAgICB9IGVsc2UgaWYgKGkgPT0gKGZtYVNsaWRlcy5sZW5ndGggLSAxKSkgew0KICAgICAgICAgICAgICAgIHNsaWRlUG9zaXRpb24gPSBjb250YWluZXJXaWR0aCAtIGdldFNsaWRlc1dpZHRoKCk7DQogICAgICAgICAgICAgICAgJCgnLmZtYS1zbGlkZS1zY3JvbGxlcicpLmNzcygnbGVmdCcsIHNsaWRlUG9zaXRpb24gKyAncHgnKTsNCiAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgc2xpZGVQb3NpdGlvbiA9ICgoY29udGFpbmVyV2lkdGggLSBmbWFTbGlkZXMuZXEoaSkud2lkdGgoKSkgLyAyKSAtIGxlZnRQb2ludDsNCiAgICAgICAgICAgICAgICAkKCcuZm1hLXNsaWRlLXNjcm9sbGVyJykuY3NzKCdsZWZ0Jywgc2xpZGVQb3NpdGlvbiArICdweCcpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH07DQoNCiAgICAgICAgdmFyIHRvZ2dsZUhvdmVyID0gZnVuY3Rpb24gKGkpIHsNCiAgICAgICAgICAgIGZtYVNsaWRlcy5lcShpKS50b2dnbGVDbGFzcygnZm1hLWhvdmVyJyk7DQogICAgICAgICAgICBmbWFUYWJzLmVxKGkpLnRvZ2dsZUNsYXNzKCdmbWEtYnV0dG9uLWhvdmVyJyk7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH07DQoNCiAgICAgICAgc2V0QWN0aXZlKDApOw0KDQoNCiAgICB9DQoNCiAgICByZXR1cm4gew0KICAgICAgICBJbml0aWFsaXplOiBpbml0DQogICAgfTsNCn0gKGpRdWVyeSk7Ow0KLyoqDQoqIFVBbGJlcnRhIEZpbHRlcmFibGUgRGF0YSBMaXN0DQoqIEF1dGhvcjogS3lsZSBTY2htaWR0IC0ga3lsZS5zY2htaWR0QHVhbGJlcnRhLmNhDQoqIEJhc2VkIG9uIGNvZGUgZnJvbSBMYW5lIE9sc29uIC0gbGFuZS5vbHNvbkB1YWxiZXJ0YS5jYQ0KKi8NCg0KKGZ1bmN0aW9uICgkKSB7DQogICAgJC5mbi5GaWx0ZXJhYmxlRGF0YUxpc3QgPSBmdW5jdGlvbiAob3B0aW9ucykgew0KICAgICAgICAvLyBjcmVhdGUgc2V0dGluZ3MsIGV4dGVuZGluZyB0aGVtIHdpdGggYW55IG9wdGlvbnMgdGhhdCB3ZXJlIHByb3ZpZGVkDQogICAgICAgIHZhciBEYXRhID0gew0KICAgICAgICAgICAgaWQ6ICIiLA0KDQogICAgICAgICAgICBzZXR0aW5nczogJC5leHRlbmQoew0KICAgICAgICAgICAgICAgIGNhdGVnb3J5V3JhcHBlcjogIiIsDQogICAgICAgICAgICAgICAgY2xhc3NQcmVmaXg6ICJmaWx0ZXJhYmxlLWxpc3QiLA0KICAgICAgICAgICAgICAgIGZpbHRlclRleHRib3hJY29uQ2xhc3M6ICJpY29uLWZpbHRlciIsDQogICAgICAgICAgICAgICAgZmlsdGVyVGV4dGJveFRleHQ6ICJmaWx0ZXIgaXRlbXMiLA0KICAgICAgICAgICAgICAgIG5vUmVzdWx0c1RleHQ6ICJTb3JyeSwgdGhlcmUgYXJlIG5vIGl0ZW1zIG1hdGNoaW5nIHlvdXIgZmlsdGVyLiIsDQogICAgICAgICAgICAgICAgcmVzdWx0c0NhdGVnb3J5VGV4dDogIkZpbHRlcmVkIEl0ZW1zIg0KICAgICAgICAgICAgfSwgb3B0aW9ucykNCiAgICAgICAgfSwNCg0KCQkJVXRpbHMgPSB7DQoJCQkgICAgZ2V0TmV3UmFuZG9tSWQ6IGZ1bmN0aW9uICgpIHsNCgkJCSAgICAgICAgdmFyIG5ld0lkID0gImZpbHRlcmVkRGF0YUxpc3RfIiArIE1hdGguZmxvb3IoKE1hdGgucmFuZG9tKCkgKiAxMDAwKSArIDEpOw0KCQkJICAgICAgICBpZiAoJCgiIyIgKyBuZXdJZCkubGVuZ3RoID4gMCkgew0KCQkJICAgICAgICAgICAgcmV0dXJuIFV0aWxzLmdldE5ld1JhbmRvbUlkKCk7DQoJCQkgICAgICAgIH0NCgkJCSAgICAgICAgcmV0dXJuIG5ld0lkOw0KCQkJICAgIH0NCgkJCX0sDQoNCgkJCU1ldGhvZHMgPSB7DQoJCQkgICAgYWRkTWFya3VwOiBmdW5jdGlvbiAod2lkZ2V0KSB7DQoJCQkgICAgICAgIHZhciB3cmFwcGVyID0gRGF0YS5zZXR0aW5ncy5jYXRlZ29yeVdyYXBwZXIsDQoJCQkJCQlwcmVmaXggPSBEYXRhLnNldHRpbmdzLmNsYXNzUHJlZml4LA0KCQkJCQkJaWNvbiA9IERhdGEuc2V0dGluZ3MuZmlsdGVyVGV4dGJveEljb25DbGFzcywNCgkJCQkJCXRleHRib3hUZXh0ID0gRGF0YS5zZXR0aW5ncy5maWx0ZXJUZXh0Ym94VGV4dCwNCgkJCQkJCW5vUmVzdWx0cyA9IERhdGEuc2V0dGluZ3Mubm9SZXN1bHRzVGV4dCwNCgkJCQkJCXJlc3VsdHNDYXRlZ29yeSA9IERhdGEuc2V0dGluZ3MucmVzdWx0c0NhdGVnb3J5VGV4dDsNCg0KCQkJICAgICAgICAvLyBhZGQgaWQgdG8gd2lkZ2V0IGlmIG5lZWRlZCBhbmQgc3RvcmUgaWQNCgkJCSAgICAgICAgaWYgKHdpZGdldC5hdHRyKCJpZCIpID09ICIiKSB7DQoJCQkgICAgICAgICAgICAvLyBhZGQgaWQNCgkJCSAgICAgICAgICAgIHdpZGdldC5hdHRyKCJpZCIsIFV0aWxzLmdldE5ld1JhbmRvbUlkKCkpOw0KCQkJICAgICAgICB9DQoJCQkgICAgICAgIERhdGEuaWQgPSB3aWRnZXQuYXR0cigiaWQiKTsNCg0KCQkJICAgICAgICB3aWRnZXQNCgkJCSAgICAgICAgLy8gYWRkIGZpbHRlcmluZw0KCQkJCQkJLmFwcGVuZCgnPGxpIGNsYXNzPSInICsgcHJlZml4ICsgJy1maWx0ZXIiPicgKw0KCQkJCQkJCQkJJzxzcGFuIGNsYXNzPSInICsgcHJlZml4ICsgJy1sYWJlbCI+JyArIHJlc3VsdHNDYXRlZ29yeSArICc8L3NwYW4+JyArDQoJCQkJCQkJCQknPGkgY2xhc3M9IicgKyBpY29uICsgJyI+PC9pPicgKw0KCQkJCQkJCQkJJzxpbnB1dCB0eXBlPSJ0ZXh0IiBwbGFjZWhvbGRlcj0iJyArIHRleHRib3hUZXh0ICsgJyIgY2xhc3M9IicgKyBwcmVmaXggKyAnLWZpbHRlci1maWVsZCIgLz4nICsNCgkJCQkJCQkJCSc8dWwgY2xhc3M9IicgKyBwcmVmaXggKyAnLXJlc3VsdHMiPicgKw0KCQkJCQkJCQkJCSc8bGkgY2xhc3M9IicgKyBwcmVmaXggKyAnLXJlc3VsdC10aXRsZSI+JyArDQoJCQkJCQkJCQkJCSc8JyArIHdyYXBwZXIgKyAnPjwvJyArIHdyYXBwZXIgKyAnPicgKw0KCQkJCQkJCQkJCSc8L2xpPicgKw0KCQkJCQkJCQkJCSc8bGkgY2xhc3M9IicgKyBwcmVmaXggKyAnLXJlc3VsdC1ub25lIj4nICsNCgkJCQkJCQkJCQkJJzxwPicgKyBub1Jlc3VsdHMgKyAnPC9wPicgKw0KCQkJCQkJCQkJCSc8L2xpPicgKw0KCQkJCQkJCQkJJzwvdWw+JyArDQoJCQkJCQkJCSc8L2xpPicpDQoJCQkgICAgICAgIC8vIHByb2Nlc3MgY2F0ZWdvcmllcw0KCQkJCQkJLmNoaWxkcmVuKCJsaSIpDQoJCQkJCQkJLmFkZENsYXNzKHByZWZpeCArICItY2F0ZWdvcnkiKQ0KCQkJCQkJCS5lYWNoKGZ1bmN0aW9uICgpIHsNCgkJCQkJCQkgICAgLy8gcHJvY2VzcyBpdGVtcw0KCQkJCQkJCSAgICBpZiAod3JhcHBlciAhPSAiIikgew0KCQkJCQkJCSAgICAgICAgJCh0aGlzKS5jaGlsZHJlbigiYSIpDQoJCQkJCQkJCQkJLndyYXAoIjwiICsgd3JhcHBlciArICIvPiIpOw0KCQkJCQkJCSAgICB9DQoJCQkJCQkJICAgICQodGhpcykuY2hpbGRyZW4oInVsIikNCgkJCQkJCQkJCS5hZGRDbGFzcyhwcmVmaXggKyAiLWl0ZW1zIikNCgkJCQkJCQkJCS5ub3QoIi4iICsgcHJlZml4ICsgIi1yZXN1bHRzIikNCgkJCQkJCQkJCQkuYWRkQ2xhc3MocHJlZml4ICsgIi1zZWFyY2hhYmxlIik7DQoJCQkJCQkJfSkNCgkJCQkJCQkuZmlyc3QoKQ0KCQkJCQkJCQkuYWRkQ2xhc3MocHJlZml4ICsgIi1hY3RpdmUiKTsNCgkJCSAgICB9LA0KDQoJCQkgICAgYWRkRXZlbnRzOiBmdW5jdGlvbiAod2lkZ2V0KSB7DQoJCQkgICAgICAgIHZhciB3cmFwcGVyID0gRGF0YS5zZXR0aW5ncy5jYXRlZ29yeVdyYXBwZXIsDQoJCQkJCQlwcmVmaXggPSBEYXRhLnNldHRpbmdzLmNsYXNzUHJlZml4Ow0KDQoJCQkgICAgICAgIC8vIGFkZCBhY3RpdmUgY2xhc3MgdG8gbGluayBjYXRlZ29yeSB3aGVuIGNsaWNrZWQNCgkJCSAgICAgICAgd2lkZ2V0LmZpbmQoIi4iICsgcHJlZml4ICsgIi1jYXRlZ29yeSA+ICIgKyAod3JhcHBlciA9PSAiIiA/ICJhIiA6IHdyYXBwZXIpICsgIiwgLiIgKyBwcmVmaXggKyAiLWNhdGVnb3J5IGlucHV0IikuY2xpY2soZnVuY3Rpb24gKCkgew0KCQkJICAgICAgICAgICAgd2lkZ2V0LmZpbmQoIi4iICsgcHJlZml4ICsgIi1jYXRlZ29yeSIpLnJlbW92ZUNsYXNzKHByZWZpeCArICItYWN0aXZlIik7DQoJCQkgICAgICAgICAgICAkKHRoaXMpLnBhcmVudCgpLmFkZENsYXNzKHByZWZpeCArICItYWN0aXZlIik7DQoJCQkgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQoJCQkgICAgICAgIH0pOw0KDQoJCQkgICAgICAgIC8vIHBvcHVsYXRlIHJlc3VsdHMgd2l0aCBhbGwgbGlua3MgYnkgZGVmYXVsdA0KCQkJICAgICAgICB3aWRnZXQuZmluZCgiLiIgKyBwcmVmaXggKyAiLXJlc3VsdC10aXRsZSA+ICIgKyAod3JhcHBlciA9PSAiIiA/ICJhIiA6IHdyYXBwZXIpKS5odG1sKCJEaXNwbGF5aW5nIGFsbCAiICsgd2lkZ2V0LmZpbmQoIi4iICsgcHJlZml4ICsgIi1zZWFyY2hhYmxlIGEiKS5zaXplKCkgKyAiIGl0ZW1zLiA8c21hbGw+QmVnaW4gdHlwaW5nIHRvIGZpbHRlci4uLjwvc21hbGw+Iik7DQoJCQkgICAgICAgIHdpZGdldC5maW5kKCIuIiArIHByZWZpeCArICItc2VhcmNoYWJsZSBhIikuZWFjaChmdW5jdGlvbiAoKSB7DQoJCQkgICAgICAgICAgICB3aWRnZXQuZmluZCgiLiIgKyBwcmVmaXggKyAiLXJlc3VsdHMiKS5hcHBlbmQoJzxsaSBjbGFzcz0iJyArIHByZWZpeCArICctcmVzdWx0LWl0ZW0iPicgKyAkKHRoaXMpLnBhcmVudCgpLmh0bWwoKSArICI8L2xpPiIpOw0KCQkJICAgICAgICB9KTsNCgkJCSAgICAgICAgd2lkZ2V0LmZpbmQoIi4iICsgcHJlZml4ICsgIi1yZXN1bHQtbm9uZSIpLmhpZGUoKTsNCg0KCQkJICAgICAgICAvLyBsaXZlIHNlYXJjaCBwbHVnaW4gaW5pdGlhbGl6YXRpb24gICAgICAgIA0KCQkJICAgICAgICB3aWRnZXQuZmluZCgiLiIgKyBwcmVmaXggKyAiLWZpbHRlci1maWVsZCIpLnNlYXJjaCgiIyIgKyBEYXRhLmlkICsgIiAuIiArIHByZWZpeCArICItc2VhcmNoYWJsZSBhIiwgZnVuY3Rpb24gKG9uKSB7DQoJCQkgICAgICAgICAgICAvLyB0aGlzIGhhcHBlbnMgb24gYW55IGtleWRvd24sIGtleXVwLCBrZXlwcmVzcywgb3IgYmx1ciBldmVudA0KCQkJICAgICAgICAgICAgb24uYWxsKGZ1bmN0aW9uIChyZXN1bHRzKSB7DQoJCQkgICAgICAgICAgICAgICAgdmFyIHNpemUgPSByZXN1bHRzID8gcmVzdWx0cy5zaXplKCkgOiAwOw0KCQkJICAgICAgICAgICAgICAgIHdpZGdldC5maW5kKCIuIiArIHByZWZpeCArICItcmVzdWx0LXRpdGxlID4gIiArICh3cmFwcGVyID09ICIiID8gImEiIDogd3JhcHBlcikpLmh0bWwoIkRpc3BsYXlpbmcgIiArIHNpemUgKyAiIG1hdGNoZXMgZm9yICZxdW90OyIgKyB3aWRnZXQuZmluZCgiLiIgKyBwcmVmaXggKyAiLWZpbHRlci1maWVsZCIpLnZhbCgpLnJlcGxhY2UoLz4vZywgIiZndDsiKS5yZXBsYWNlKC88L2csICImbHQ7IikgKyAiJnF1b3QiKTsNCgkJCSAgICAgICAgICAgIH0pOw0KDQoJCQkgICAgICAgICAgICAvLyB0aGlzIGhhcHBlbnMgd2hlbiB0aGUgZmlsdGVyIGZpZWxkIGhhcyBub3RoaW5nIGVudGVyZWQNCgkJCSAgICAgICAgICAgIG9uLnJlc2V0KGZ1bmN0aW9uICgpIHsNCgkJCSAgICAgICAgICAgICAgICB3aWRnZXQuZmluZCgiLiIgKyBwcmVmaXggKyAiLXJlc3VsdC10aXRsZSA+ICIgKyAod3JhcHBlciA9PSAiIiA/ICJhIiA6IHdyYXBwZXIpKS5odG1sKCJEaXNwbGF5aW5nIGFsbCAiICsgd2lkZ2V0LmZpbmQoIi4iICsgcHJlZml4ICsgIi1zZWFyY2hhYmxlIGEiKS5zaXplKCkgKyAiIGxpbmtzLiA8c21hbGw+QmVnaW4gdHlwaW5nIHRvIGZpbHRlci4uLjwvc21hbGw+Iik7DQoJCQkgICAgICAgICAgICAgICAgd2lkZ2V0LmZpbmQoIi4iICsgcHJlZml4ICsgIi1yZXN1bHQtaXRlbSIpLnJlbW92ZSgpOw0KCQkJICAgICAgICAgICAgICAgIHdpZGdldC5maW5kKCIuIiArIHByZWZpeCArICItc2VhcmNoYWJsZSBhIikuZWFjaChmdW5jdGlvbiAoKSB7DQoJCQkgICAgICAgICAgICAgICAgICAgIHdpZGdldC5maW5kKCIuIiArIHByZWZpeCArICItcmVzdWx0cyIpLmFwcGVuZCgnPGxpIGNsYXNzPSInICsgcHJlZml4ICsgJy1yZXN1bHQtaXRlbSI+JyArICQodGhpcykucGFyZW50KCkuaHRtbCgpICsgIjwvbGk+Iik7DQoJCQkgICAgICAgICAgICAgICAgfSk7DQoJCQkgICAgICAgICAgICAgICAgd2lkZ2V0LmZpbmQoIi4iICsgcHJlZml4ICsgIi1yZXN1bHQtbm9uZSIpLmhpZGUoKTsNCgkJCSAgICAgICAgICAgIH0pOw0KDQoJCQkgICAgICAgICAgICAvLyB0aGlzIGhhcHBlbnMgd2hlbiB0aGVyZSBhcmUgbm8gcmVzdWx0cyBiYXNlIG9uIHRoZSBxdWVyeQ0KCQkJICAgICAgICAgICAgb24uZW1wdHkoZnVuY3Rpb24gKCkgew0KCQkJICAgICAgICAgICAgICAgIHdpZGdldC5maW5kKCIuIiArIHByZWZpeCArICItcmVzdWx0LW5vbmUiKS5zaG93KCk7DQoJCQkgICAgICAgICAgICAgICAgd2lkZ2V0LmZpbmQoIi4iICsgcHJlZml4ICsgIi1yZXN1bHQtaXRlbSIpLnJlbW92ZSgpOw0KCQkJICAgICAgICAgICAgfSk7DQoNCgkJCSAgICAgICAgICAgIC8vIHRoaXMgaGFwcGVucyB3aGVuIHRoZXJlIGFyZSByZXN1bHRzDQoJCQkgICAgICAgICAgICBvbi5yZXN1bHRzKGZ1bmN0aW9uIChyZXN1bHRzKSB7DQoJCQkgICAgICAgICAgICAgICAgd2lkZ2V0LmZpbmQoIi4iICsgcHJlZml4ICsgIi1yZXN1bHQtbm9uZSIpLmhpZGUoKTsNCgkJCSAgICAgICAgICAgICAgICB3aWRnZXQuZmluZCgiLiIgKyBwcmVmaXggKyAiLXJlc3VsdC1pdGVtIikucmVtb3ZlKCk7DQoJCQkgICAgICAgICAgICAgICAgcmVzdWx0cy5lYWNoKGZ1bmN0aW9uICgpIHsNCgkJCSAgICAgICAgICAgICAgICAgICAgd2lkZ2V0LmZpbmQoIi4iICsgcHJlZml4ICsgIi1yZXN1bHRzIikuYXBwZW5kKCc8bGkgY2xhc3M9IicgKyBwcmVmaXggKyAnLXJlc3VsdC1pdGVtIj4nICsgJCh0aGlzKS5wYXJlbnQoKS5odG1sKCkgKyAiPC9saT4iKTsNCgkJCSAgICAgICAgICAgICAgICB9KTsNCgkJCSAgICAgICAgICAgIH0pOw0KCQkJICAgICAgICB9KTsNCgkJCSAgICB9DQoJCQl9DQoJCTsNCg0KICAgICAgICByZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIE1ldGhvZHMuYWRkTWFya3VwKCQodGhpcykpOw0KICAgICAgICAgICAgTWV0aG9kcy5hZGRFdmVudHMoJCh0aGlzKSk7DQogICAgICAgIH0pOw0KICAgIH07DQp9KShqUXVlcnkpOw0KOw0KLyoqDQoqIFVBbGJlcnRhIE1lZGlhIEdhbGxlcnkNCiogQXV0aG9yOiBLeWxlIFNjaG1pZHQgLSBreWxlLnNjaG1pZHRAdWFsYmVydGEuY2ENCiovDQoNCi8vIGJ1aWxkIG5hbWVzcGFjZQ0KdmFyIFVBbGJlcnRhID0gVUFsYmVydGEgfHwge307DQpVQWxiZXJ0YS5TaXRlY29yZSA9IFVBbGJlcnRhLlNpdGVjb3JlIHx8IHt9Ow0KDQpVQWxiZXJ0YS5TaXRlY29yZS5NZWRpYUdhbGxlcnkgPSBVQWxiZXJ0YS5TaXRlY29yZS5NZWRpYUdhbGxlcnkgfHwgKGZ1bmN0aW9uICgpIHsNCiAgICBmdW5jdGlvbiBnZXRJbnN0YW5jZSgpIHsNCiAgICAgICAgcmV0dXJuIChmdW5jdGlvbiAoJCkgew0KICAgICAgICAgICAgJ3VzZSBzdHJpY3QnOw0KDQogICAgICAgICAgICAvLyBkZXNjcmlwdGlvbiBvYmplY3QNCiAgICAgICAgICAgIHZhciBEZXNjcmlwdGlvbiA9IGZ1bmN0aW9uICgpIHsgdGhpcy52YWx1ZSA9ICIiIH07DQogICAgICAgICAgICBEZXNjcmlwdGlvbi5wcm90b3R5cGUuYWRkVmFsdWUgPSBmdW5jdGlvbiAoZmllbGQsIHZhbHVlKSB7DQogICAgICAgICAgICAgICAgaWYoRGF0YS5maWVsZHNUb1Nob3cuaW5kZXhPZihmaWVsZCkgIT0gLTEgJiYgdmFsdWUubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgICAgICAgICB0aGlzLnZhbHVlID0gdGhpcy52YWx1ZSArICh0aGlzLnZhbHVlLmxlbmd0aCA+IDAgPyAiPGJyIC8+IiA6ICIiKSArIHZhbHVlOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH07DQoNCiAgICAgICAgICAgIHZhciBEYXRhID0gew0KICAgICAgICAgICAgICAgICAgICBpdGVtczogW10sIC8vIGl0ZW1zDQogICAgICAgICAgICAgICAgICAgIGl0ZW1zUGVyUGFnZTogOSwgLy8gaXRlbXMgcGVyIHBhZ2UNCiAgICAgICAgICAgICAgICAgICAgcHJlc2V0Q2F0ZWdvcmllczogW10sIC8vIGNhdGVnb3JpZXMgdG8gYWx3YXlzIGZpbHRlciBvbg0KICAgICAgICAgICAgICAgICAgICBwcmVzZXRUeXBlOiAiIiwgLy8gdHlwZSB0byBhbHdheXMgZmlsdGVyIG9uDQogICAgICAgICAgICAgICAgICAgIGZpZWxkc1RvU2hvdzogW10sIC8vIGZpZWxkcyB0byBzaG93DQoNCiAgICAgICAgICAgICAgICAgICAgLy8gQ29uc3RhbnQgdmFsdWVzDQogICAgICAgICAgICAgICAgICAgIENvbnN0YW50czogew0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gTWVkaWEgdHlwZXMNCiAgICAgICAgICAgICAgICAgICAgICAgIE1lZGlhVHlwZXM6IHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBBdWRpbzogImF1ZGlvIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBJbWFnZTogImltYWdlIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBWaWRlbzogInZpZGVvIg0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgICAgIFV0aWxzID0gew0KICAgICAgICAgICAgICAgICAgICAvLyBHZXQgdGhlIHZhbHVlIG9mIGEgbXVsdGlsaXN0IHdpZGdldA0KICAgICAgICAgICAgICAgICAgICBnZXRNdWx0aWxpc3RWYWx1ZTogZnVuY3Rpb24gKG9iaikgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9iai5tdWx0aXNlbGVjdCgiZ2V0U2VsZWN0ZWQiKS52YWwoKSB8fCBbXTsNCiAgICAgICAgICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgICAgICAgICAvLyBTZXQgdGhlIHZhbHVlIG9mIGEgbXVsdGlsaXN0IHdpZGdldA0KICAgICAgICAgICAgICAgICAgICBzZXRNdWx0aWxpc3RWYWx1ZTogZnVuY3Rpb24gKG9iaiwgdmFsdWUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIG9iai52YWwodmFsdWUpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYoVXRpbHMuaXNNdWx0aWxpc3RDcmVhdGVkKG9iaikpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvYmoubXVsdGlzZWxlY3QoInJlZnJlc2giKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayBpZiBhIG11bHRpbGlzdCBoYXMgYmVlbiBjcmVhdGVkDQogICAgICAgICAgICAgICAgICAgIGlzTXVsdGlsaXN0Q3JlYXRlZDogZnVuY3Rpb24gKG9iaikgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIG9iai5uZXh0KCkuaGFzKCIubXVsdGlzZWxlY3QtY29udGFpbmVyLmRyb3Bkb3duLW1lbnUiKS5sZW5ndGggPiAwOw0KICAgICAgICAgICAgICAgICAgICB9LA0KDQogICAgICAgICAgICAgICAgICAgIC8vIEdldCBhcnJheSBpbnRlcnNlY3Rpb24NCiAgICAgICAgICAgICAgICAgICAgYXJyYXlJbnRlcnNlY3Q6IGZ1bmN0aW9uIChhcnIxLCBhcnIyKSB7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJC5tYXAoYXJyMSwgZnVuY3Rpb24gKHZhbCkgeyByZXR1cm4gJC5pbkFycmF5KHZhbCwgYXJyMikgPCAwID8gbnVsbCA6IHZhbDsgfSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9LA0KDQogICAgICAgICAgICAgICAgQUpBWCA9IHsNCiAgICAgICAgICAgICAgICAgICAgLy8gZ2V0IGl0ZW1zIGZyb20gc2VydmVyDQogICAgICAgICAgICAgICAgICAgIGdldEl0ZW1zOiBmdW5jdGlvbiAoZm9sZGVySWQsIG9yZGVyQnkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNob3cgbG9hZGluZyBzcGlubmVyDQogICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2Uuc2hvd0xvYWRpbmcoKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gZ2V0IGl0ZW1zIGZyb20gc2VydmljZQ0KICAgICAgICAgICAgICAgICAgICAgICAgQUpBWC5jdXJyZW50UmVxdWVzdCA9ICQuYWpheCh7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IEFKQVguRXZlbnRzLmVycm9yLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IEFKQVguRXZlbnRzLnN1Y2Nlc3MsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdXJsOiAiL2FwaS9tZWRpYWdhbGxlcnkvZm9sZGVyLyIgKyBlbmNvZGVVUklDb21wb25lbnQoZm9sZGVySWQpICsgIi5qc29uP29yZGVyYnk9IiArIGVuY29kZVVSSUNvbXBvbmVudChvcmRlckJ5KQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgICAgICAgICAgRXZlbnRzOiB7DQogICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5pdGVtc0NvbnRyb2wuaHRtbCgiPHA+QW4gZXJyb3Igb2NjdXJyZWQgd2hpbGUgb2J0YWluaW5nIGl0ZW0gaW5mb3JtYXRpb24uIFBsZWFzZSByZWZyZXNoIHRoZSBwYWdlIGFuZCB0cnkgYWdhaW4uPC9wPiIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGRhdGEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBzdG9yZSB0aGUgaXRlbXMNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKGRhdGEpLmVhY2goZnVuY3Rpb24oaW5kZXgsIGl0ZW0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2hlY2sgcHJlc2V0IGNhdGVnb3JpZXMgYW5kIHR5cGUNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNhdGVnb3J5Q2hlY2sgPSBEYXRhLnByZXNldENhdGVnb3JpZXMubGVuZ3RoID09IDAgfHwgVXRpbHMuYXJyYXlJbnRlcnNlY3QoJC5tYXAoaXRlbS5DYXRlZ29yaWVzLCBmdW5jdGlvbiAodmFsKSB7IHJldHVybiB2YWwuS2V5OyB9KSwgRGF0YS5wcmVzZXRDYXRlZ29yaWVzKS5sZW5ndGggPiAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdHlwZUNoZWNrID0gRGF0YS5wcmVzZXRUeXBlID09ICIiIHx8IGl0ZW0uVHlwZSA9PSBEYXRhLnByZXNldFR5cGU7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoY2F0ZWdvcnlDaGVjayAmJiB0eXBlQ2hlY2spIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIERhdGEuaXRlbXNbaXRlbS5JZF0gPSBpdGVtOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLnNob3dJdGVtcygpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgICAgIEludGVyZmFjZSA9IHsNCiAgICAgICAgICAgICAgICAgICAgY29udGFpbmVySWQ6ICIiLCAvLyBpZCBvZiB0aGUgY29udGFpbmVyIG9mIHRoZSBzY2hlZHVsZQ0KICAgICAgICAgICAgICAgICAgICBjYXRlZ29yeUxpc3RDb250cm9sOiBbXSwgLy8gY2F0ZWdvcnkgbGlzdCBjb250cm9sDQogICAgICAgICAgICAgICAgICAgIHR5cGVMaXN0Q29udHJvbDogW10sIC8vIHR5cGUgbGlzdCBjb250cm9sDQogICAgICAgICAgICAgICAgICAgIGN1c3RvbUxpc3RDb250cm9sMTogW10sIC8vIGN1c3RvbSBsaXN0IGNvbnRyb2wgMQ0KICAgICAgICAgICAgICAgICAgICBjdXN0b21MaXN0Q29udHJvbDI6IFtdLCAvLyBjdXN0b20gbGlzdCBjb250cm9sIDINCiAgICAgICAgICAgICAgICAgICAgY3VzdG9tTGlzdENvbnRyb2wzOiBbXSwgLy8gY3VzdG9tIGxpc3QgY29udHJvbCAzDQogICAgICAgICAgICAgICAgICAgIGN1c3RvbUxpc3RDb250cm9sNDogW10sIC8vIGN1c3RvbSBsaXN0IGNvbnRyb2wgNA0KICAgICAgICAgICAgICAgICAgICBpdGVtc0NvbnRyb2w6IFtdLCAvLyBpdGVtcyBjb250cm9sDQogICAgICAgICAgICAgICAgICAgIGl0ZW1QYWdpbmdDb250cm9sOiBbXSwgLy8gaXRlbSBwYWdpbmcgY29udHJvbA0KICAgICAgICAgICAgICAgICAgICBpdGVtc1Zpc2libGU6IFtdLCAvLyB0aGUgaXRlbXMgdGhhdCBjYW4gYmUgc2VlbiAoYmFzZWQgb24gZmlsdGVycyksIHVzZWQgZm9yIHBhZ2luZw0KICAgICAgICAgICAgICAgICAgICBsb2FkaW5nU2VsZWN0b3I6ICIiLCAvLyB0aGUgc2VsZWN0b3IgZm9yIHRoZSBsb2FkaW5nIHNwaW5uZXINCg0KICAgICAgICAgICAgICAgICAgICAvLyBzZXR1cCB0aGUgaW50ZXJmYWNlDQogICAgICAgICAgICAgICAgICAgIHNldHVwOiBmdW5jdGlvbiAoY29udGFpbmVySWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGdldCBpbnRlcmZhY2UgY29tcG9uZW50cw0KICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLmNvbnRhaW5lcklkID0gY29udGFpbmVySWQ7DQogICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UuY2F0ZWdvcnlMaXN0Q29udHJvbCA9ICQoIiMiICsgSW50ZXJmYWNlLmNvbnRhaW5lcklkICsgIiAubWVkaWEtZmlsdGVyLWNhdGVnb3J5IHNlbGVjdCIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLnR5cGVMaXN0Q29udHJvbCA9ICQoIiMiICsgSW50ZXJmYWNlLmNvbnRhaW5lcklkICsgIiAubWVkaWEtZmlsdGVyLXR5cGUgc2VsZWN0Iik7DQogICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UuY3VzdG9tTGlzdENvbnRyb2wxID0gJCgiIyIgKyBJbnRlcmZhY2UuY29udGFpbmVySWQgKyAiIC5tZWRpYS1maWx0ZXItY3VzdG9tMSBzZWxlY3QiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5jdXN0b21MaXN0Q29udHJvbDIgPSAkKCIjIiArIEludGVyZmFjZS5jb250YWluZXJJZCArICIgLm1lZGlhLWZpbHRlci1jdXN0b20yIHNlbGVjdCIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLmN1c3RvbUxpc3RDb250cm9sMyA9ICQoIiMiICsgSW50ZXJmYWNlLmNvbnRhaW5lcklkICsgIiAubWVkaWEtZmlsdGVyLWN1c3RvbTMgc2VsZWN0Iik7DQogICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UuY3VzdG9tTGlzdENvbnRyb2w0ID0gJCgiIyIgKyBJbnRlcmZhY2UuY29udGFpbmVySWQgKyAiIC5tZWRpYS1maWx0ZXItY3VzdG9tNCBzZWxlY3QiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5pdGVtc0NvbnRyb2wgPSAkKCIjIiArIEludGVyZmFjZS5jb250YWluZXJJZCArICIgLmdhbGxlcnktY29udGFpbmVyIik7DQogICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UuaXRlbVBhZ2luZ0NvbnRyb2wgPSAkKCIjIiArIEludGVyZmFjZS5jb250YWluZXJJZCArICIgLmV2ZW50cy1wYWdpbmF0aW9uIik7DQogICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UubG9hZGluZ1NlbGVjdG9yID0gIiMiICsgSW50ZXJmYWNlLmNvbnRhaW5lcklkICsgIiAuZXZlbnRzLWxvYWRpbmciOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBzZXQgZGVmYXVsdCB2YWx1ZXMNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmKHdpbmRvdy5sb2NhdGlvbi5oYXNoICE9ICIiKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLnNldERyb3Bkb3duc1VzaW5nSGFzaCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBjcmVhdGUgd2lkZ2V0cw0KICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLmNhdGVnb3J5TGlzdENvbnRyb2wubXVsdGlzZWxlY3Qoew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvblRleHQ6IFVBbGJlcnRhLlNpdGVjb3JlLlV0aWxpdGllcy5NdWx0aXNlbGVjdEJ1dHRvblRleHQsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2Uuc2V0SGFzaCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UuRXZlbnRzLmZpbHRlcnNDaGFuZ2VkKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UudHlwZUxpc3RDb250cm9sLm11bHRpc2VsZWN0KHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBidXR0b25UZXh0OiBVQWxiZXJ0YS5TaXRlY29yZS5VdGlsaXRpZXMuTXVsdGlzZWxlY3RCdXR0b25UZXh0LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLnNldEhhc2goKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLkV2ZW50cy5maWx0ZXJzQ2hhbmdlZCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLmN1c3RvbUxpc3RDb250cm9sMS5tdWx0aXNlbGVjdCh7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uVGV4dDogVUFsYmVydGEuU2l0ZWNvcmUuVXRpbGl0aWVzLk11bHRpc2VsZWN0QnV0dG9uVGV4dCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZTogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5zZXRIYXNoKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5FdmVudHMuZmlsdGVyc0NoYW5nZWQoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5jdXN0b21MaXN0Q29udHJvbDIubXVsdGlzZWxlY3Qoew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJ1dHRvblRleHQ6IFVBbGJlcnRhLlNpdGVjb3JlLlV0aWxpdGllcy5NdWx0aXNlbGVjdEJ1dHRvblRleHQsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgb25DaGFuZ2U6IGZ1bmN0aW9uKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2Uuc2V0SGFzaCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UuRXZlbnRzLmZpbHRlcnNDaGFuZ2VkKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UuY3VzdG9tTGlzdENvbnRyb2wzLm11bHRpc2VsZWN0KHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBidXR0b25UZXh0OiBVQWxiZXJ0YS5TaXRlY29yZS5VdGlsaXRpZXMuTXVsdGlzZWxlY3RCdXR0b25UZXh0LA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uQ2hhbmdlOiBmdW5jdGlvbigpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLnNldEhhc2goKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLkV2ZW50cy5maWx0ZXJzQ2hhbmdlZCgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLmN1c3RvbUxpc3RDb250cm9sNC5tdWx0aXNlbGVjdCh7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgYnV0dG9uVGV4dDogVUFsYmVydGEuU2l0ZWNvcmUuVXRpbGl0aWVzLk11bHRpc2VsZWN0QnV0dG9uVGV4dCwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvbkNoYW5nZTogZnVuY3Rpb24oKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5zZXRIYXNoKCk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5FdmVudHMuZmlsdGVyc0NoYW5nZWQoKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2V0IHVwIG1hc29ucnkNCiAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5pdGVtc0NvbnRyb2wubWFzb25yeSh7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gb3B0aW9ucw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbHVtbldpZHRoOiAnLmdhbGxlcnktaXRlbScsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaXRlbVNlbGVjdG9yOiAnLmdhbGxlcnktaXRlbScsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ3V0dGVyOiAxNSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFuc2l0aW9uRHVyYXRpb246IDANCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBoYXNoIGNoYW5nZSBldmVudA0KICAgICAgICAgICAgICAgICAgICAgICAgJCh3aW5kb3cpLmhhc2hjaGFuZ2UoZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5zZXREcm9wZG93bnNVc2luZ0hhc2goKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2Uuc2hvd0l0ZW1zKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgICAgICAgICAvLyBzaG93IGl0ZW1zIG9uIHBhZ2UNCiAgICAgICAgICAgICAgICAgICAgc2hvd0l0ZW1zOiBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAvLyBlbXB0eSB0aGUgdmlld2FibGUgaXRlbXMgbGlzdA0KICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLml0ZW1zVmlzaWJsZS5sZW5ndGggPSAwOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBwcm9jZXNzIGdhbWVzDQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpIGluIERhdGEuaXRlbXMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXRlbSA9IERhdGEuaXRlbXNbaV07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gSEFDSzogRW5zdXJlIHdlIGFyZSBvbmx5IHByb2Nlc3NpbmcgYWN0dWFsIGl0ZW1zDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoaXRlbS5JZCA9PSB1bmRlZmluZWQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZm9ybWF0IGl0ZW0gZGF0ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uRGF0ZUZvcm1hdHRlZCA9IGl0ZW0uRGF0ZSA9PSB1bmRlZmluZWQgPyAiIiA6IGl0ZW0uRGF0ZUZvcm1hdHRlZCB8fCBVQWxiZXJ0YS5TaXRlY29yZS5VdGlsaXRpZXMuR2V0RGF0ZUZyb21Kc29uKGl0ZW0uRGF0ZSwgVUFsYmVydGEuU2l0ZWNvcmUuVXRpbGl0aWVzLkRhdGVGb3JtYXQuU2hvcnQpOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZml4IGVtcHR5IHRodW1ibmFpbCBhbmQgaW1hZ2UgdXJsJ3MNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihpdGVtLlRodW1ibmFpbEltYWdlVXJsLmxlbmd0aCA9PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uVGh1bWJuYWlsSW1hZ2VVcmwgPSAiL0Rlc2lnbi9pbWcvIiArIGl0ZW0uVHlwZSArICIucG5nIjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayBmaWx0ZXJzDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFJbnRlcmZhY2UuY2hlY2tGaWx0ZXJzKGl0ZW0pKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFkZCBpdGVtIHRvIHZpZXdhYmxlIGxpc3QNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UuaXRlbXNWaXNpYmxlLnB1c2goaXRlbSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGRpc3BsYXkgZmlyc3QgcGFnZSBvZiBnYW1lcw0KICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLnNob3dQYWdlKDEpOw0KICAgICAgICAgICAgICAgICAgICB9LA0KDQogICAgICAgICAgICAgICAgICAgIC8vIHNob3cgcGFnaW5nIGxpbmtzDQogICAgICAgICAgICAgICAgICAgIHNob3dQYWdpbmc6IGZ1bmN0aW9uIChwYWdlKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAvLyBjbGVhciBwYWdlcw0KICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLml0ZW1QYWdpbmdDb250cm9sLmh0bWwoIiIpOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayBmb3IgZW1wdHkgbGlzdA0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEludGVyZmFjZS5pdGVtc1Zpc2libGUubGVuZ3RoID09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFkZCBwYWdlcw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGFjdGl2ZVBhZ2UgPSBwYXJzZUludChwYWdlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtYXhQYWdlID0gTWF0aC5jZWlsKEludGVyZmFjZS5pdGVtc1Zpc2libGUubGVuZ3RoIC8gRGF0YS5pdGVtc1BlclBhZ2UpOw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPD0gbWF4UGFnZTsgaSsrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2hlY2sgZm9yIGFjdGl2ZSBwYWdlDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGkgPT0gYWN0aXZlUGFnZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UuaXRlbVBhZ2luZ0NvbnRyb2wuYXBwZW5kKCc8bGkgY2xhc3M9ImFjdGl2ZSI+JyArIGkgKyAnPC9saT4nKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UuaXRlbVBhZ2luZ0NvbnRyb2wuYXBwZW5kKCc8bGk+PGEgaHJlZj0iamF2YXNjcmlwdDp2b2lkKG51bGwpIj4nICsgaSArICc8L2E+PC9saT4nKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFkZCBjbGljayBoYW5kbGVyDQogICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UuaXRlbVBhZ2luZ0NvbnRyb2wuZmluZCgiYSIpLmNsaWNrKEludGVyZmFjZS5FdmVudHMucGFnZUNsaWNrZWQpOw0KICAgICAgICAgICAgICAgICAgICB9LA0KDQogICAgICAgICAgICAgICAgICAgIC8vIHNob3cgc2VsZWN0ZWQgcGFnZSBvZiBpdGVtcw0KICAgICAgICAgICAgICAgICAgICBzaG93UGFnZTogZnVuY3Rpb24gKHBhZ2UpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGhpZGUgaXRlbXMgaW4gb3JkZXIgdG8gcHJldmVudCByZW5kZXJpbmcgZmxhc2gNCiAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5pdGVtc0NvbnRyb2wuY3NzKCJ2aXNpYmlsaXR5IiwgImhpZGRlbiIpOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBjbGVhciBnYW1lcw0KICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLml0ZW1zQ29udHJvbC5odG1sKCIiKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2hlY2sgZm9yIGVtcHR5IGxpc3QNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChJbnRlcmZhY2UuaXRlbXNWaXNpYmxlLmxlbmd0aCA9PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gZGlzcGxheSAibm8gaXRlbXMiIG1lc3NhZ2UNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UuaXRlbXNDb250cm9sLmh0bWwoJzxoND5ObyBJdGVtcyBGb3VuZDwvaDQ+Jyk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLnNob3dQYWdpbmcocGFnZSk7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBzaG93IGl0ZW1zIG9uIHNlbGVjdGVkIHBhZ2UNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAocGFyc2VJbnQocGFnZSkgLSAxKSAqIERhdGEuaXRlbXNQZXJQYWdlOyBpIDwgRGF0YS5pdGVtc1BlclBhZ2UgKiBwYWdlOyBpKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXRlbSA9IEludGVyZmFjZS5pdGVtc1Zpc2libGVbaV07DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBlbnN1cmUgaXRlbSBpcyB2YWxpZA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpdGVtID09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjcmVhdGUgZGVzY3JpcHRpb24NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGVzY3JpcHRpb24gPSBuZXcgRGVzY3JpcHRpb24oKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbi5hZGRWYWx1ZSgiY2FwdGlvbiIsIGl0ZW0uQ2FwdGlvbik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb24uYWRkVmFsdWUoImR1cmF0aW9uIiwgaXRlbS5EdXJhdGlvbik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb24uYWRkVmFsdWUoImF0dHJpYnV0aW9uIiwgaXRlbS5BdHRyaWJ1dGlvbik7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBjcmVhdGUgaXRlbSBodG1sDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNob3dUaXRsZSA9IERhdGEuZmllbGRzVG9TaG93LmluZGV4T2YoInRpdGxlIikgIT0gLTEgJiYgaXRlbS5UaXRsZS5sZW5ndGggPiAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzaG93RGF0ZSA9IERhdGEuZmllbGRzVG9TaG93LmluZGV4T2YoImRhdGUiKSAhPSAtMSAmJiBpdGVtLkRhdGVGb3JtYXR0ZWQubGVuZ3RoID4gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2hvd0Rlc2NyaXB0aW9uID0gZGVzY3JpcHRpb24udmFsdWUubGVuZ3RoID4gMDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbGluayA9IGl0ZW0uTGluay5sZW5ndGggPiAwID8gaXRlbS5MaW5rIDogIiMiOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhZGREYXRhID0gaXRlbS5MaW5rLmxlbmd0aCA9PSAwOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBodG1sID0gJzxhIGhyZWY9IicgKyBsaW5rICsgJyIgY2xhc3M9ImV4dHJ1ZGUgZ2FsbGVyeS1pdGVtIicgKyAoYWRkRGF0YSA/ICgnZGF0YS1pZD0iJyArIGl0ZW0uSWQgKyAnIiBkYXRhLXRhcmdldD0iI3ZpZGVvTW9kYWwiIGRhdGEtdG9nZ2xlPSJtb2RhbCInKSA6ICcnKSArICc+JyArDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzxpbWcgc3JjPSInICsgaXRlbS5UaHVtYm5haWxJbWFnZVVybCArICciJyArICgoc2hvd1RpdGxlIHx8IHNob3dEZXNjcmlwdGlvbikgPyAnJyA6ICcgY2xhc3M9InN0YW5kYWxvbmUiJykgKyAnPicgKw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICgoc2hvd1RpdGxlIHx8IHNob3dEZXNjcmlwdGlvbikgPyAoJzxkaXYgY2xhc3M9ImdhbGxlcnktZGVzY3JpcHRpb24iPicgKw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAoc2hvd1RpdGxlID8gKCc8aDM+JyArIGl0ZW0uVGl0bGUgKyAnPC9oMz4nKSA6ICcnKSArDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIChzaG93RGF0ZSA/ICgnPHAgY2xhc3M9ImRhdGUiPicgKyBpdGVtLkRhdGVGb3JtYXR0ZWQgKyAnPC9wPicpIDogJycpICsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKHNob3dEZXNjcmlwdGlvbiA/ICgnPHAgY2xhc3M9ImNhcHRpb24iPicgKyBkZXNjcmlwdGlvbi52YWx1ZSArICc8L3A+JykgOiAnJykgKw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8L2Rpdj4nKSA6ICcnKSArDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPC9hPic7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBhZGQgaXRlbSB0byBsaXN0DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLml0ZW1zQ29udHJvbC5hcHBlbmQoaHRtbCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGluaXRpYWxpemUgTWFzb25yeSBhZnRlciBhbGwgaW1hZ2VzIGhhdmUgbG9hZGVkDQogICAgICAgICAgICAgICAgICAgICAgICBpbWFnZXNMb2FkZWQoSW50ZXJmYWNlLml0ZW1zQ29udHJvbFswXSwgZnVuY3Rpb24oKSB7IEludGVyZmFjZS5pdGVtc0NvbnRyb2wubWFzb25yeSgncmVsb2FkSXRlbXMnKTsgSW50ZXJmYWNlLml0ZW1zQ29udHJvbC5tYXNvbnJ5KCk7IEludGVyZmFjZS5pdGVtc0NvbnRyb2wuY3NzKCJ2aXNpYmlsaXR5IiwgInZpc2libGUiKTsgfSk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFkZCBzY3JpcHQgZm9yIGl0ZW1zIHRvIGxvYWQgY29udGVudA0KICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLml0ZW1zQ29udHJvbC5maW5kKCJhW2RhdGEtaWRdIikuY2xpY2soSW50ZXJmYWNlLkV2ZW50cy5pdGVtQ2xpY2tlZCk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNob3cgcGFnaW5nDQogICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2Uuc2hvd1BhZ2luZyhwYWdlKTsNCiAgICAgICAgICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayB0byBzZWUgaWYgYW4gaXRlbSBpcyBwYXJ0IG9mIGZpbHRlcnMNCiAgICAgICAgICAgICAgICAgICAgY2hlY2tGaWx0ZXJzOiBmdW5jdGlvbiAoaXRlbSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2hlY2sgc2VsZWN0ZWQgY2F0ZWdvcmllcyAobm9uZSBzZWxlY3RlZCA9IHNlbGVjdCBhbGwpDQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2VsZWN0ZWRDYXRlZ29yaWVzID0gVXRpbHMuZ2V0TXVsdGlsaXN0VmFsdWUoSW50ZXJmYWNlLmNhdGVnb3J5TGlzdENvbnRyb2wpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW1DYXRlZ29yaWVzID0gJC5tYXAoaXRlbS5DYXRlZ29yaWVzLCBmdW5jdGlvbiAodmFsKSB7IHJldHVybiB2YWwuS2V5OyB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWxlY3RlZENhdGVnb3JpZXMubGVuZ3RoID4gMCAmJiBVdGlscy5hcnJheUludGVyc2VjdChzZWxlY3RlZENhdGVnb3JpZXMsIGl0ZW1DYXRlZ29yaWVzKS5sZW5ndGggPT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2hlY2sgc2VsZWN0ZWQgdHlwZXMgKG5vbmUgc2VsZWN0ZWQgPSBzZWxlY3QgYWxsKQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNlbGVjdGVkVHlwZXMgPSBVdGlscy5nZXRNdWx0aWxpc3RWYWx1ZShJbnRlcmZhY2UudHlwZUxpc3RDb250cm9sKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWxlY3RlZFR5cGVzLmxlbmd0aCA+IDAgJiYgJC5pbkFycmF5KGl0ZW0uVHlwZSwgc2VsZWN0ZWRUeXBlcykgPCAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayBzZWxlY3RlZCBjdXN0b20gZmllbGQgMSAobm9uZSBzZWxlY3RlZCA9IHNlbGVjdCBhbGwpDQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2VsZWN0ZWRDdXN0b20xID0gVXRpbHMuZ2V0TXVsdGlsaXN0VmFsdWUoSW50ZXJmYWNlLmN1c3RvbUxpc3RDb250cm9sMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZWN0ZWRDdXN0b20xLmxlbmd0aCA+IDAgJiYgVXRpbHMuYXJyYXlJbnRlcnNlY3Qoc2VsZWN0ZWRDdXN0b20xLCBpdGVtLkN1c3RvbUZpZWxkMSkubGVuZ3RoID09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNoZWNrIHNlbGVjdGVkIGN1c3RvbSBmaWVsZCAyIChub25lIHNlbGVjdGVkID0gc2VsZWN0IGFsbCkNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBzZWxlY3RlZEN1c3RvbTIgPSBVdGlscy5nZXRNdWx0aWxpc3RWYWx1ZShJbnRlcmZhY2UuY3VzdG9tTGlzdENvbnRyb2wyKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzZWxlY3RlZEN1c3RvbTIubGVuZ3RoID4gMCAmJiBVdGlscy5hcnJheUludGVyc2VjdChzZWxlY3RlZEN1c3RvbTIsIGl0ZW0uQ3VzdG9tRmllbGQyKS5sZW5ndGggPT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2hlY2sgc2VsZWN0ZWQgY3VzdG9tIGZpZWxkIDMgKG5vbmUgc2VsZWN0ZWQgPSBzZWxlY3QgYWxsKQ0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHNlbGVjdGVkQ3VzdG9tMyA9IFV0aWxzLmdldE11bHRpbGlzdFZhbHVlKEludGVyZmFjZS5jdXN0b21MaXN0Q29udHJvbDMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNlbGVjdGVkQ3VzdG9tMy5sZW5ndGggPiAwICYmIFV0aWxzLmFycmF5SW50ZXJzZWN0KHNlbGVjdGVkQ3VzdG9tMywgaXRlbS5DdXN0b21GaWVsZDMpLmxlbmd0aCA9PSAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayBzZWxlY3RlZCBjdXN0b20gZmllbGQgNCAobm9uZSBzZWxlY3RlZCA9IHNlbGVjdCBhbGwpDQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgc2VsZWN0ZWRDdXN0b200ID0gVXRpbHMuZ2V0TXVsdGlsaXN0VmFsdWUoSW50ZXJmYWNlLmN1c3RvbUxpc3RDb250cm9sNCk7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZWN0ZWRDdXN0b200Lmxlbmd0aCA+IDAgJiYgVXRpbHMuYXJyYXlJbnRlcnNlY3Qoc2VsZWN0ZWRDdXN0b200LCBpdGVtLkN1c3RvbUZpZWxkNCkubGVuZ3RoID09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgICAgICAgICB9LA0KDQogICAgICAgICAgICAgICAgICAgIC8vIHNob3cgdGhlIGxvYWRpbmcgc3Bpbm5lcg0KICAgICAgICAgICAgICAgICAgICBzaG93TG9hZGluZzogZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhlIHNwaW5uZXIgaXMgYWxyZWFkeSBzaG93bg0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCQoSW50ZXJmYWNlLmxvYWRpbmdTZWxlY3RvcikubGVuZ3RoID09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UuaXRlbXNDb250cm9sLmFwcGVuZCgnPHNwYW4gY2xhc3M9ImxvYWRpbmciPjwvc3Bhbj4nKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgICAgICAgICAvLyBzZXQgZHJvcGRvd25zIHVzaW5nIGhhc2ggdmFsdWUNCiAgICAgICAgICAgICAgICAgICAgc2V0RHJvcGRvd25zVXNpbmdIYXNoOiBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2F0ZWdvcmllcyA9IFtdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHR5cGVzID0gW107DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgY3VzdG9tMSA9IFtdOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN1c3RvbTIgPSBbXTsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjdXN0b20zID0gW107DQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgY3VzdG9tNCA9IFtdOw0KICAgICAgICAgICAgICAgICAgICAgICAgJCh3aW5kb3cubG9jYXRpb24uaGFzaC5yZXBsYWNlKC9eIy8sICIiKS5zcGxpdCgiIyIpKS5lYWNoKGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIga2V5cyA9IHRoaXMuc3BsaXQoIjsiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzd2l0Y2goa2V5cy5zaGlmdCgpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgImNhdGVnb3J5IjoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhdGVnb3JpZXMgPSBrZXlzOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgInR5cGUiOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZXMgPSBrZXlzOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgSW50ZXJmYWNlLmN1c3RvbUxpc3RDb250cm9sMS5zaWJsaW5ncygiaDMiKS5jaGlsZHJlbigpLnRleHQoKS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1xzL2csICIiKTogIC8vIGN1c3RvbSBmaWVsZCAxDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXN0b20xID0ga2V5czsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjYXNlIEludGVyZmFjZS5jdXN0b21MaXN0Q29udHJvbDIuc2libGluZ3MoImgzIikuY2hpbGRyZW4oKS50ZXh0KCkudG9Mb3dlckNhc2UoKS5yZXBsYWNlKC9ccy9nLCAiIik6ICAvLyBjdXN0b20gZmllbGQgMg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3VzdG9tMiA9IGtleXM7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBJbnRlcmZhY2UuY3VzdG9tTGlzdENvbnRyb2wzLnNpYmxpbmdzKCJoMyIpLmNoaWxkcmVuKCkudGV4dCgpLnRvTG93ZXJDYXNlKCkucmVwbGFjZSgvXHMvZywgIiIpOiAgLy8gY3VzdG9tIGZpZWxkIDMNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN1c3RvbTMgPSBrZXlzOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgSW50ZXJmYWNlLmN1c3RvbUxpc3RDb250cm9sNC5zaWJsaW5ncygiaDMiKS5jaGlsZHJlbigpLnRleHQoKS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1xzL2csICIiKTogIC8vIGN1c3RvbSBmaWVsZCA0DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjdXN0b200ID0ga2V5czsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgVXRpbHMuc2V0TXVsdGlsaXN0VmFsdWUoSW50ZXJmYWNlLmNhdGVnb3J5TGlzdENvbnRyb2wsIGNhdGVnb3JpZXMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgVXRpbHMuc2V0TXVsdGlsaXN0VmFsdWUoSW50ZXJmYWNlLnR5cGVMaXN0Q29udHJvbCwgdHlwZXMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgVXRpbHMuc2V0TXVsdGlsaXN0VmFsdWUoSW50ZXJmYWNlLmN1c3RvbUxpc3RDb250cm9sMSwgY3VzdG9tMSk7DQogICAgICAgICAgICAgICAgICAgICAgICBVdGlscy5zZXRNdWx0aWxpc3RWYWx1ZShJbnRlcmZhY2UuY3VzdG9tTGlzdENvbnRyb2wyLCBjdXN0b20yKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIFV0aWxzLnNldE11bHRpbGlzdFZhbHVlKEludGVyZmFjZS5jdXN0b21MaXN0Q29udHJvbDMsIGN1c3RvbTMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgVXRpbHMuc2V0TXVsdGlsaXN0VmFsdWUoSW50ZXJmYWNlLmN1c3RvbUxpc3RDb250cm9sNCwgY3VzdG9tNCk7DQogICAgICAgICAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgICAgICAgICAgLy8gc2V0IHRoZSBoYXNoIHZhbHVlDQogICAgICAgICAgICAgICAgICAgIHNldEhhc2g6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBoYXNoID0gIiI7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGdldCBjYXRlZ29yaWVzDQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgY2F0ZWdvcmllcyA9IFV0aWxzLmdldE11bHRpbGlzdFZhbHVlKEludGVyZmFjZS5jYXRlZ29yeUxpc3RDb250cm9sKS5qb2luKCI7Iik7DQogICAgICAgICAgICAgICAgICAgICAgICBpZihjYXRlZ29yaWVzLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNoICs9ICIjY2F0ZWdvcnk7IiArIGNhdGVnb3JpZXM7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGdldCB0eXBlcw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHR5cGVzID0gVXRpbHMuZ2V0TXVsdGlsaXN0VmFsdWUoSW50ZXJmYWNlLnR5cGVMaXN0Q29udHJvbCkuam9pbigiOyIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYodHlwZXMubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGhhc2ggKz0gIiN0eXBlOyIgKyB0eXBlczsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gY3VzdG9tIDENCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjdXN0b20xID0gVXRpbHMuZ2V0TXVsdGlsaXN0VmFsdWUoSW50ZXJmYWNlLmN1c3RvbUxpc3RDb250cm9sMSkuam9pbigiOyIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYoY3VzdG9tMS5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN1c3RvbTFOYW1lID0gSW50ZXJmYWNlLmN1c3RvbUxpc3RDb250cm9sMS5zaWJsaW5ncygiaDMiKS5jaGlsZHJlbigpLnRleHQoKS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1xzL2csICIiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNoICs9ICIjIiArIGN1c3RvbTFOYW1lICsgIjsiICsgY3VzdG9tMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gY3VzdG9tIDINCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjdXN0b20yID0gVXRpbHMuZ2V0TXVsdGlsaXN0VmFsdWUoSW50ZXJmYWNlLmN1c3RvbUxpc3RDb250cm9sMikuam9pbigiOyIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYoY3VzdG9tMi5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN1c3RvbTJOYW1lID0gSW50ZXJmYWNlLmN1c3RvbUxpc3RDb250cm9sMi5zaWJsaW5ncygiaDMiKS5jaGlsZHJlbigpLnRleHQoKS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1xzL2csICIiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNoICs9ICIjIiArIGN1c3RvbTJOYW1lICsgIjsiICsgY3VzdG9tMjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gY3VzdG9tIDMNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjdXN0b20zID0gVXRpbHMuZ2V0TXVsdGlsaXN0VmFsdWUoSW50ZXJmYWNlLmN1c3RvbUxpc3RDb250cm9sMykuam9pbigiOyIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYoY3VzdG9tMy5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN1c3RvbTNOYW1lID0gSW50ZXJmYWNlLmN1c3RvbUxpc3RDb250cm9sMy5zaWJsaW5ncygiaDMiKS5jaGlsZHJlbigpLnRleHQoKS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1xzL2csICIiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNoICs9ICIjIiArIGN1c3RvbTNOYW1lICsgIjsiICsgY3VzdG9tMzsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gY3VzdG9tIDQNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjdXN0b200ID0gVXRpbHMuZ2V0TXVsdGlsaXN0VmFsdWUoSW50ZXJmYWNlLmN1c3RvbUxpc3RDb250cm9sNCkuam9pbigiOyIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgaWYoY3VzdG9tNC5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGN1c3RvbTROYW1lID0gSW50ZXJmYWNlLmN1c3RvbUxpc3RDb250cm9sNC5zaWJsaW5ncygiaDMiKS5jaGlsZHJlbigpLnRleHQoKS50b0xvd2VyQ2FzZSgpLnJlcGxhY2UoL1xzL2csICIiKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXNoICs9ICIjIiArIGN1c3RvbTROYW1lICsgIjsiICsgY3VzdG9tNDsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhhc2ggPSBoYXNoOw0KICAgICAgICAgICAgICAgICAgICB9LA0KDQogICAgICAgICAgICAgICAgICAgIEV2ZW50czogew0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gZmlsdGVycyB3ZXJlIGNoYW5nZWQsIGZpbHRlciBpdGVtcw0KICAgICAgICAgICAgICAgICAgICAgICAgZmlsdGVyc0NoYW5nZWQ6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2Uuc2hvd0l0ZW1zKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9LA0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBhIHBhZ2Ugd2FzIGNsaWNrZWQgb24sIGNoYW5nZSB2aWV3IHRvIHRoYXQgcGFnZQ0KICAgICAgICAgICAgICAgICAgICAgICAgcGFnZUNsaWNrZWQ6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBzaG93IGNsaWNrZWQgcGFnZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5zaG93UGFnZSgkKHRoaXMpLmh0bWwoKSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9LA0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBhbiBpdGVtIHdhcyBjbGlja2VkIG9uLCBzaG93IGRldGFpbHMNCiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW1DbGlja2VkOiBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW0gPSBEYXRhLml0ZW1zWyQodGhpcykuZGF0YSgiaWQiKV07DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBzZXQgdGl0bGUNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCIjdmlkZW9Nb2RhbCAubW9kYWwtaGVhZGVyIGgzIikudGV4dChpdGVtLlRpdGxlKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNoZWNrIGl0ZW0gdHlwZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN3aXRjaChpdGVtLlR5cGUpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBEYXRhLkNvbnN0YW50cy5NZWRpYVR5cGVzLkF1ZGlvOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gaGlkZSBpZnJhbWUNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoIiN2aWRlb01vZGFsIC52aWRlby1tb2QtY29udGFpbmVyIikuaGlkZSgpOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBhZGQgY3VzdG9tIGF1ZGlvIG1hcmt1cA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGF1ZGlvSHRtbCA9ICc8YXVkaW8gY2xhc3M9Im1vZGFsLWF1ZGlvIiBjb250cm9scz4nICsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzxzb3VyY2Ugc3JjPSInICsgaXRlbS5BdWRpb1VybE9nZyArICciIHR5cGU9ImF1ZGlvL29nZyIgLz4nICsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJzxzb3VyY2Ugc3JjPSInICsgaXRlbS5BdWRpb1VybE1wMyArICciIHR5cGU9ImF1ZGlvL21wZWciIC8+JyArDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc8c3Bhbj5Zb3VyIGJyb3dzZXIgZG9lcyBub3Qgc3VwcG9ydCBwbGF5aW5nIG9mIHRoaXMgYXVkaW8uIFBsZWFzZSA8YSBocmVmPSInICsgaXRlbS5BdWRpb1VybE1wMyArICciPmRvd25sb2FkPC9hPiB0aGUgYXVkaW8gaWYgeW91IHdpc2ggdG8gbGlzdGVuIHRvIGl0Ljwvc3Bhbj4nICsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnPC9hdWRpbz4nOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgiI3ZpZGVvTW9kYWwgLm1vZGFsLWJvZHkiKS5hcHBlbmQoYXVkaW9IdG1sKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgRGF0YS5Db25zdGFudHMuTWVkaWFUeXBlcy5JbWFnZToNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGhpZGUgaWZyYW1lDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCIjdmlkZW9Nb2RhbCAudmlkZW8tbW9kLWNvbnRhaW5lciIpLmhpZGUoKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gYWRkIGN1c3RvbSBpbWFnZSBtYXJrdXANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGl0ZW0uSW1hZ2VVcmwubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbWFnZUh0bWwgPSAnPGRpdiBjbGFzcz0ibW9kYWwtaW1hZ2UnICsgKGl0ZW0uRGVzY3JpcHRpb24ubGVuZ3RoID09IDAgPyAnIHN0YW5kYWxvbmUnIDogJycpICsgJyI+PGltZyBzcmM9IicgKyBpdGVtLkltYWdlVXJsICsgJyIgYWx0PSInICsgaXRlbS5UaXRsZSArICciIC8+PC9kaXY+JzsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCIjdmlkZW9Nb2RhbCAubW9kYWwtYm9keSIpLmFwcGVuZChpbWFnZUh0bWwpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FzZSBEYXRhLkNvbnN0YW50cy5NZWRpYVR5cGVzLlZpZGVvOg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gbm8gbW9kYWwgZm9yIG1vYmlsZQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCQod2luZG93KS53aWR0aCgpIDwgNjkwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uID0gaXRlbS5WaWRlb1VybE1vYmlsZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNldCB2aWRlbyBpZnJhbWUgdXJsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAkKCIjdmlkZW9Nb2RhbCBpZnJhbWUiKS5hdHRyKCJzcmMiLCBpdGVtLlZpZGVvVXJsICsgIiZhdXRvcGxheT0xIik7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIGFkZCBjdXN0b20gZGVzY3JpcHRpb24gbWFya3VwDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoaXRlbS5EZXNjcmlwdGlvbi5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoIiN2aWRlb01vZGFsIC5tb2RhbC1ib2R5IikuYXBwZW5kKCI8ZGl2IGNsYXNzPSdtb2RhbC1kZXNjcmlwdGlvbic+IiArIGl0ZW0uRGVzY3JpcHRpb24gKyAiPC9kaXY+Iik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgOw0KDQogICAgICAgICAgICAvLyBpbnN0YW5jZSBpbml0aWFsaXphdGlvbg0KICAgICAgICAgICAgZnVuY3Rpb24gaW5pdChjb250YWluZXJJZCwgZm9sZGVySWQsIGl0ZW1zUGVyUGFnZSwgcHJlc2V0Q2F0ZWdvcmllcywgcHJlc2V0VHlwZSwgZmllbGRzVG9TaG93LCBvcmRlckJ5KSB7DQogICAgICAgICAgICAgICAgSW50ZXJmYWNlLnNldHVwKGNvbnRhaW5lcklkKTsNCg0KICAgICAgICAgICAgICAgIC8vIHNldCB2YXJzDQogICAgICAgICAgICAgICAgRGF0YS5pdGVtc1BlclBhZ2UgPSBpdGVtc1BlclBhZ2U7DQogICAgICAgICAgICAgICAgRGF0YS5wcmVzZXRDYXRlZ29yaWVzID0gcHJlc2V0Q2F0ZWdvcmllcy5sZW5ndGggPiAwID8gcHJlc2V0Q2F0ZWdvcmllcy5zcGxpdCgiOyIpIDogW107DQogICAgICAgICAgICAgICAgRGF0YS5wcmVzZXRUeXBlID0gcHJlc2V0VHlwZTsNCiAgICAgICAgICAgICAgICBEYXRhLmZpZWxkc1RvU2hvdyA9IGZpZWxkc1RvU2hvdy5sZW5ndGggPiAwID8gZmllbGRzVG9TaG93LnNwbGl0KCI7IikgOiBbXTsNCg0KICAgICAgICAgICAgICAgIC8vIGdldCBpdGVtcw0KICAgICAgICAgICAgICAgIEFKQVguZ2V0SXRlbXMoZm9sZGVySWQsIG9yZGVyQnkpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgIEluaXRpYWxpemU6IGluaXQNCiAgICAgICAgICAgIH07DQogICAgICAgIH0gKGpRdWVyeSkpOw0KICAgIH0NCg0KICAgIHJldHVybiB7DQogICAgICAgIEdldEluc3RhbmNlOiBnZXRJbnN0YW5jZQ0KICAgIH07DQp9ICgpKTsNCjsNCi8qKg0KKiBVQWxiZXJ0YSBOZXdzIEFyY2hpdmUNCiogQXV0aG9yOiBEZWFuIFZpZ29yZW4gLSB2aWdvcmVuQHVhbGJlcnRhLmNhDQoqLw0KDQovLyBidWlsZCBuYW1lc3BhY2UNCnZhciBVQWxiZXJ0YSA9IFVBbGJlcnRhIHx8IHt9Ow0KVUFsYmVydGEuU2l0ZWNvcmUgPSBVQWxiZXJ0YS5TaXRlY29yZSB8fCB7fTsNClVBbGJlcnRhLlNpdGVjb3JlLk5ld3MgPSBVQWxiZXJ0YS5TaXRlY29yZS5OZXdzIHx8IHt9Ow0KDQpVQWxiZXJ0YS5TaXRlY29yZS5OZXdzLkFyY2hpdmUgPSBmdW5jdGlvbiAoJCkgew0KICAgIHZhciBfb3B0aW9ucyA9IHsNCiAgICAgICAgU2VydmljZVVybDogIiIsDQogICAgICAgIEl0ZW1zUGVyUGFnZTogMTAsDQogICAgICAgIE51bWJlck9mUGFnZXM6IDEsDQogICAgICAgIFBhZ2VMaW5rc1RvU2hvdzogMTAsDQogICAgICAgIEFjdGl2ZVBhZ2U6IDEsDQogICAgICAgIFNlYXJjaFRlcm06ICIiLA0KICAgICAgICBDYXRlZ29yaWVzOiAiIiwNCiAgICAgICAgU3RpY2t5U29ydGluZzogZmFsc2UNCiAgICB9LA0KICAgICAgICBfcHJldkhhc2ggPSAiIiwNCiAgICAgICAgX2ludGVydmFsUHJldkhhc2ggPSAiIiwNCiAgICAgICAgX3BhZ2luZyA9IHsNCiAgICAgICAgICAgIHBhZ2VDaGFuZ2U6IGZ1bmN0aW9uIChwYWdlTnVtYmVyKSB7DQogICAgICAgICAgICAgICAgaWYgKHBhZ2VOdW1iZXIgIT0gX29wdGlvbnMuQWN0aXZlUGFnZSkgew0KICAgICAgICAgICAgICAgICAgICBfYWpheC5nZXRBcnRpY2xlRGF0YShwYWdlTnVtYmVyKTsNCiAgICAgICAgICAgICAgICAgICAgX3BhZ2luZy51cGRhdGVQYWdlU2VsZWN0aW9uKHBhZ2VOdW1iZXIpOw0KICAgICAgICAgICAgICAgICAgICBfb3B0aW9ucy5BY3RpdmVQYWdlID0gcGFnZU51bWJlcjsNCiAgICAgICAgICAgICAgICAgICAgJCgiLm5ld3MtcGFnaW5hdGlvbiA+IGxpIikucmVtb3ZlQ2xhc3MoImFjdGl2ZSIpOw0KICAgICAgICAgICAgICAgICAgICAkKCJhW2RhdGEtYXJjaGl2ZS1wYWdlID0gJyIgKyBwYWdlTnVtYmVyICsgIiddIikucGFyZW50KCkuYWRkQ2xhc3MoImFjdGl2ZSIpOw0KICAgICAgICAgICAgICAgICAgICBfaGFzaHRhZy51cGRhdGVIYXNoKHBhZ2VOdW1iZXIpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgIHVwZGF0ZVBhZ2VTZWxlY3Rpb246IGZ1bmN0aW9uIChwYWdlTnVtYmVyKSB7DQogICAgICAgICAgICAgICAgaWYgKF9vcHRpb25zLk51bWJlck9mUGFnZXMgPiBfb3B0aW9ucy5QYWdlTGlua3NUb1Nob3cpIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHNob3dGaXJzdEVsbGlwc2UgPSAocGFnZU51bWJlciA+PSAoX29wdGlvbnMuUGFnZUxpbmtzVG9TaG93IC8gMikpLA0KICAgICAgICAgICAgICAgICAgICAgICAgc2hvd0xhc3RFbGxpcHNlID0gKHBhZ2VOdW1iZXIgPD0gKF9vcHRpb25zLk51bWJlck9mUGFnZXMgLSAoX29wdGlvbnMuUGFnZUxpbmtzVG9TaG93IC8gMikpKSwNCiAgICAgICAgICAgICAgICAgICAgICAgIHBhZ2VzVG9TaG93ID0gX29wdGlvbnMuUGFnZUxpbmtzVG9TaG93Ow0KDQogICAgICAgICAgICAgICAgICAgICQoIi5uZXdzLXBhZ2luYXRpb24gPiBsaSIpLmFkZENsYXNzKCJoaWRkZW4iKTsNCg0KICAgICAgICAgICAgICAgICAgICBpZiAoc2hvd0ZpcnN0RWxsaXBzZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgJCgiLm5ld3MtcGFnaW5hdGlvbi1icmVhayIpLmZpcnN0KCkucmVtb3ZlQ2xhc3MoImhpZGRlbiIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgJCgiYVtkYXRhLWFyY2hpdmUtcGFnZSA9ICcxJ10iKS5wYXJlbnQoKS5yZW1vdmVDbGFzcygiaGlkZGVuIik7DQogICAgICAgICAgICAgICAgICAgICAgICBwYWdlc1RvU2hvdyAtPSAyOw0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgaWYgKHNob3dMYXN0RWxsaXBzZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgJCgiLm5ld3MtcGFnaW5hdGlvbi1icmVhayIpLmxhc3QoKS5yZW1vdmVDbGFzcygiaGlkZGVuIik7DQogICAgICAgICAgICAgICAgICAgICAgICAkKCJhW2RhdGEtYXJjaGl2ZS1wYWdlID0gJyIgKyBfb3B0aW9ucy5OdW1iZXJPZlBhZ2VzICsgIiddIikucGFyZW50KCkucmVtb3ZlQ2xhc3MoImhpZGRlbiIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcGFnZXNUb1Nob3cgLT0gMjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIHZhciBiZWdpbm5pbmdOdW1iZXIgPSBwYWdlTnVtYmVyIC0gKHBhZ2VzVG9TaG93IC8gMikgKyAxLA0KICAgICAgICAgICAgICAgICAgICAgICAgZW5kTnVtYmVyID0gYmVnaW5uaW5nTnVtYmVyICsgcGFnZXNUb1Nob3cgLSAxOw0KDQogICAgICAgICAgICAgICAgICAgIGlmIChiZWdpbm5pbmdOdW1iZXIgPD0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYmVnaW5uaW5nTnVtYmVyID0gMTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGVuZE51bWJlciA9IHBhZ2VzVG9TaG93Ow0KICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGJlZ2lubmluZ051bWJlciA+PSAoX29wdGlvbnMuTnVtYmVyT2ZQYWdlcyAtIHBhZ2VzVG9TaG93KSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgYmVnaW5uaW5nTnVtYmVyID0gX29wdGlvbnMuTnVtYmVyT2ZQYWdlcyAtIHBhZ2VzVG9TaG93Ow0KICAgICAgICAgICAgICAgICAgICAgICAgZW5kTnVtYmVyID0gX29wdGlvbnMuTnVtYmVyT2ZQYWdlczsNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSBiZWdpbm5pbmdOdW1iZXI7IGkgPD0gZW5kTnVtYmVyOyBpKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICQoImFbZGF0YS1hcmNoaXZlLXBhZ2UgPSAnIiArIGkgKyAiJ10iKS5wYXJlbnQoKS5yZW1vdmVDbGFzcygiaGlkZGVuIik7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQogICAgICAgIF9zZWFyY2ggPSB7DQogICAgICAgICAgICBwcmVmb3JtU2VhcmNoOiBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgdmFyIHVybCA9IGRvY3VtZW50LmxvY2F0aW9uLnNlYXJjaC5zdWJzdHIoMSkuc3BsaXQoJyYnKSwNCiAgICAgICAgICAgICAgICAgICAgdmFsdWUgPSBlbmNvZGVVUkkoJCgiI3NlYXJjaCIpLnZhbCgpKTsNCg0KICAgICAgICAgICAgICAgIGlmICh1cmwgPT0gJycpIHsNCiAgICAgICAgICAgICAgICAgICAgZG9jdW1lbnQubG9jYXRpb24uc2VhcmNoID0gJz9zZWFyY2g9JyArIHZhbHVlOw0KICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBpID0gdXJsLmxlbmd0aDsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHg7DQogICAgICAgICAgICAgICAgICAgIHdoaWxlIChpLS0pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHggPSB1cmxbaV0uc3BsaXQoJz0nKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh4WzBdID09ICdzZWFyY2gnKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgeFsxXSA9IHZhbHVlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybFtpXSA9IHguam9pbignPScpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGlmIChpIDwgMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdXJsW3VybC5sZW5ndGhdID0gWydzZWFyY2gnLCB2YWx1ZV0uam9pbignPScpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGRvY3VtZW50LmxvY2F0aW9uLnNlYXJjaCA9IHVybC5qb2luKCcmJyk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICBfaGFzaHRhZyA9IHsNCiAgICAgICAgICAgIHVwZGF0ZUhhc2g6IGZ1bmN0aW9uIChuZXdIYXNoKSB7DQogICAgICAgICAgICAgICAgX3ByZXZIYXNoID0gd2luZG93LmxvY2F0aW9uLmhhc2g7DQogICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhhc2ggPSBuZXdIYXNoOw0KICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgYmFjazogZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5oYXNoID0gd2luZG93LmxvY2F0aW9uLmhhc2ggPT0gX3ByZXZIYXNoID8gIiIgOiBfcHJldkhhc2g7DQogICAgICAgICAgICB9LA0KDQogICAgICAgICAgICB1cmxJbml0OiBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgdmFyIGggPSB3aW5kb3cubG9jYXRpb24uaGFzaC5yZXBsYWNlKC8jL2csICIiKTsNCiAgICAgICAgICAgICAgICBpZiAoaCAhPSAiIikgew0KICAgICAgICAgICAgICAgICAgICAkKCIubmV3cy1wYWdpbmF0aW9uLWl0ZW1bZGF0YS1hcmNoaXZlLXBhZ2UgPSAnIiArIGggKyAiJ10iKS5jbGljaygpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0NCiAgICAgICAgfSwNCiAgICAgICAgX2FqYXggPSB7DQogICAgICAgICAgICBnZXRBcnRpY2xlRGF0YTogZnVuY3Rpb24gKHBhZ2VOdW1iZXIpIHsNCiAgICAgICAgICAgICAgICAkLmFqYXgoew0KICAgICAgICAgICAgICAgICAgICB0eXBlOiAiR0VUIiwNCiAgICAgICAgICAgICAgICAgICAgdXJsOiBfb3B0aW9ucy5TZXJ2aWNlVXJsICsgIj9wYWdlc2l6ZT0iICsgX29wdGlvbnMuSXRlbXNQZXJQYWdlICsgIiZwYWdlPSIgKyBwYWdlTnVtYmVyICsgIiZzZWFyY2g9IiArIF9vcHRpb25zLlNlYXJjaFRlcm0gKyAiJmNhdGVnb3JpZXM9IiArIF9vcHRpb25zLkNhdGVnb3JpZXMgKyAiJnN0aWNreXNvcnRpbmc9IiArIF9vcHRpb25zLlN0aWNreVNvcnRpbmcsDQogICAgICAgICAgICAgICAgICAgIGRhdGFUeXBlOiAianNvbiIsDQogICAgICAgICAgICAgICAgICAgIGNvbnRlbnRUeXBlOiAiYXBwbGljYXRpb24vanNvbiIsDQogICAgICAgICAgICAgICAgICAgIHRpbWVvdXQ6IDEwMDAsDQogICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IF9hamF4LmFqYXhTdWNjZXNzLA0KICAgICAgICAgICAgICAgICAgICBlcnJvcjogX2FqYXguYWpheEVycm9yDQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB9LA0KDQogICAgICAgICAgICBhamF4U3VjY2VzczogZnVuY3Rpb24gKGRhdGEpIHsNCiAgICAgICAgICAgICAgICBpZiAoIWRhdGEpIHsNCiAgICAgICAgICAgICAgICAgICAgZGF0YSA9IFtdOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIHZhciBuZXdMaXN0ID0gJyc7DQoNCiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGltZ0h0bWwgPSAnJzsNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIGlmIChkYXRhW2ldLlNJbWFnZSAhPSAnJykgew0KICAgICAgICAgICAgICAgICAgICAgICAgaW1nSHRtbCA9ICc8ZGl2IGNsYXNzPSJsaXN0LWl0ZW0taW1hZ2UgZnJhbWUiPjxpbWcgc3JjPSInICsgZGF0YVtpXS5TSW1hZ2UgKyAnIiAvPjwvZGl2Pic7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIG5ld0xpc3QgKz0gJzxsaT48YSBocmVmPSInICsgZGF0YVtpXS5MaW5rICsgJyI+JyArIGltZ0h0bWwgKyAnPGRpdiBjbGFzcz0ibGlzdC1pdGVtLWNvbnRlbnQiPjxoND4nICsgZGF0YVtpXS5UaXRsZSArICc8L2g0PjxwIGNsYXNzPSJsaXN0LWl0ZW0tZXh0cmEiPicgKyBkYXRhW2ldLkRhdGUgKyAnPC9wPjxwIGNsYXNzPSJsaXN0LWl0ZW0tZGVzY3JpcHRpb24iPicgKyBkYXRhW2ldLkRlc2NyaXB0aW9uICsgJzwvcD48L2Rpdj48L2E+PC9saT4nOw0KICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgIGlmIChuZXdMaXN0ID09ICcnKSB7DQogICAgICAgICAgICAgICAgICAgIG5ld0xpc3QgPSAnPGxpPlRoZXJlIHdhcyBhbiBlcnJvciByZXRyaWV2aW5nIHRoZSBuZXdzIGFydGljbGVzLjwvbGk+JzsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAkKCcubmV3cy1hcmNoaXZlLWxpc3QnKS5odG1sKG5ld0xpc3QpOw0KICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgYWpheEVycm9yOiBmdW5jdGlvbiAoKSB7DQoNCiAgICAgICAgICAgIH0NCiAgICAgICAgfTsNCg0KDQogICAgZnVuY3Rpb24gaW5pdChvcHRpb25zKSB7DQogICAgICAgIF9vcHRpb25zID0gJC5leHRlbmQoX29wdGlvbnMsIG9wdGlvbnMpOw0KDQogICAgICAgICQoIi5uZXdzLXBhZ2luYXRpb24taXRlbVtkYXRhLWFyY2hpdmUtcGFnZV0iKS5jbGljayhmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICBfcGFnaW5nLnBhZ2VDaGFuZ2UoJCh0aGlzKS5hdHRyKCJkYXRhLWFyY2hpdmUtcGFnZSIpKTsNCiAgICAgICAgfSk7DQoNCiAgICAgICAgJCgiLm5ld3MtcGFnaW5hdGlvbi1pdGVtW2RhdGEtYXJjaGl2ZS1wYWdlXSIpLnBhcmVudCgpLmZpcnN0KCkuYWRkQ2xhc3MoJ2FjdGl2ZScpOw0KDQogICAgICAgIC8vU2VhcmNoIFN0dWZmDQogICAgICAgICQoIiNzZWFyY2hCdXR0b24iKS5jbGljayhmdW5jdGlvbiAoYSkgew0KICAgICAgICAgICAgYS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICAgICAgdmFyIHZhbHVlID0gJCgiI3NlYXJjaCIpLnZhbCgpOw0KICAgICAgICAgICAgaWYgKHZhbHVlICE9ICIiICYmIHZhbHVlICE9ICQoIiNzZWFyY2giKS5hdHRyKCJwbGFjZWhvbGRlciIpKSB7DQogICAgICAgICAgICAgICAgX3NlYXJjaC5wcmVmb3JtU2VhcmNoKCk7DQogICAgICAgICAgICB9DQogICAgICAgIH0pOw0KDQogICAgICAgICQoIiNzZWFyY2giKS5rZXlkb3duKGZ1bmN0aW9uIChhKSB7DQogICAgICAgICAgICBhID0gYSB8fCB3aW5kb3cuZXZlbnQ7DQogICAgICAgICAgICBpZiAoYS5rZXlDb2RlID09IDEzIHx8IGEud2hpY2ggPT0gMTMpIHsNCiAgICAgICAgICAgICAgICBhLnByZXZlbnREZWZhdWx0KCk7DQogICAgICAgICAgICAgICAgJCgiI3NlYXJjaEJ1dHRvbiIpLmNsaWNrKCk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgfSk7DQoNCiAgICAgICAgLy9TZXQgc2VhcmNoIHZhbHVlDQogICAgICAgICQoIiNzZWFyY2giKS52YWwoX29wdGlvbnMuU2VhcmNoVGVybSk7DQoNCiAgICAgICAgLy9IYXNodGFncyBmb3IgcGFnZXMNCiAgICAgICAgX2hhc2h0YWcudXJsSW5pdCgpOw0KICAgIH0NCg0KICAgIHJldHVybiB7DQogICAgICAgIEluaXRpYWxpc2U6IGluaXQNCiAgICB9Ow0KDQp9KGpRdWVyeSk7Ow0KLy8gYnVpbGQgbmFtZXNwYWNlDQp2YXIgVUFsYmVydGEgPSBVQWxiZXJ0YSB8fCB7fTsNClVBbGJlcnRhLlNpdGVjb3JlID0gVUFsYmVydGEuU2l0ZWNvcmUgfHwge307DQpVQWxiZXJ0YS5TaXRlY29yZS5OZXdzID0gVUFsYmVydGEuU2l0ZWNvcmUuTmV3cyB8fCB7fTsNCg0KVUFsYmVydGEuU2l0ZWNvcmUuTmV3cy5BcnRpY2xlID0gKGZ1bmN0aW9uICgkKSB7DQoNCiAgICBmdW5jdGlvbiBpbml0KCkgew0KICAgICAgICAvLyBDaGVjayB0aGUgaW1hZ2Ugc2l6ZSwgYW5kIGZsb2F0IGl0IGlmIGl0J3Mgc21hbGwNCiAgICAgICAgdmFyIGltZyA9ICQoIi5pbWFnZS1jYXB0aW9uLWNvbnRhaW5lcjpmaXJzdCBpbWciKTsNCiAgICAgICAgaWYgKGltZy5sZW5ndGgpIHsNCiAgICAgICAgICAgICQoIjxpbWcvPiIpIC8vIE1ha2UgaW4gbWVtb3J5IGNvcHkgb2YgaW1hZ2UgdG8gYXZvaWQgY3NzIGlzc3Vlcw0KICAgICAgICAgICAgICAgIC5hdHRyKCJzcmMiLCAkKGltZykuYXR0cigic3JjIikuc3BsaXQoIj8iKVswXSkNCiAgICAgICAgICAgICAgICAubG9hZChmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLndpZHRoIDwgMzUwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAkKCcuZnJhbWUnKS5jc3Moew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICdmbG9hdCc6ICdyaWdodCcsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3dpZHRoJzogJzUwJScsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ21hcmdpbi1sZWZ0JzogJzFlbScNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgIH0NCg0KICAgICAgICAvLyBHcmFiIGxpbmtzIGZyb20gdGhlIGFydGljbGUgZm9yIHJlbGF0ZWQgbGlua3MNCiAgICAgICAgdmFyIHN0b3J5TGlua3MgPSAkKCdhcnRpY2xlIC5zdG9yeSBwIGEnKTsNCg0KICAgICAgICBpZiAoc3RvcnlMaW5rcy5sZW5ndGgpIHsNCiAgICAgICAgICAgIHN0b3J5TGlua3MuZWFjaChmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgJCgnI3JlbGF0ZWQtbGlua3MnKS5hcHBlbmQoJzxsaT48YSBocmVmPSInICsgJCh0aGlzKS5hdHRyKCdocmVmJykgKyAnIj4nICsgJCh0aGlzKS5odG1sKCkgKyAnPC9hPjwvbGk+Jyk7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfQ0KDQogICAgICAgIC8vIEZldGNoIFRvcCBTdG9yaWVzDQogICAgICAgIC8vIC0tLS0tLS0tLS0tLS0tLS0tLS0tDQogICAgICAgIHZhciBuZXdzRWwgPSAkKCcjdG9wLXN0b3JpZXMnKTsNCg0KICAgICAgICAkLmdldEpTT04oJ2h0dHA6Ly9zYzMtY2RuLnVhbGJlcnRhLmNhL2FwaS9uZXdzL2hlYWRsaW5lcy5qc29ucD9jYWxsYmFjaz0/JywNCiAgICAgICAgICAgIGZ1bmN0aW9uIChkYXRhKSB7DQogICAgICAgICAgICAgICAgbmV3c0VsLnJlbW92ZUNsYXNzKCdsb2FkaW5nJyk7DQogICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSsrKSB7DQogICAgICAgICAgICAgICAgICAgIG5ld3NFbC5hcHBlbmQoJzxsaSBjbGFzcz0ibmV3cy1yb3ciPjxhIGhyZWY9IicgKyBkYXRhW2ldLkxpbmsgKyAnIj4nICsgZGF0YVtpXS5UaXRsZSArICc8L2E+PC9saT4nKTsNCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9DQogICAgICAgICk7DQoNCiAgICAgICAgLy8gRml4IFZpZGVvcyAoVGVtcG9yYXJ5LCBuZWVkcyB0byBiZSBmaXhlZCkNCiAgICAgICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tDQogICAgICAgICQoJy5zdG9yeSBpZnJhbWUnKS5jc3MoJ3dpZHRoJywgJzEwMCUnKTsNCiAgICB9DQoNCiAgICByZXR1cm4gew0KICAgICAgICBJbml0aWFsaXNlOiBpbml0DQogICAgfTsNCg0KfSkoalF1ZXJ5KTsNCjsNCi8qKg0KICogVUFsYmVydGEgR3JhZHVhdGUgUHJvZ3JhbSBTZWFyY2ggRnVuY3Rpb25hbGl0eQ0KICogQXV0aG9yOiBEZWFuIFZpZ29yZW4gLSB2aWdvcmVuQHVhbGJlcnRhLmNhDQogKiBFZGl0ZWQ6IEt5bGUgU2NobWlkdCAtIGt5bGUuc2NobWlkdEB1YWxiZXJ0YS5jYSAoU2VwdCAyMDE0KQ0KICovDQoNCi8vIEJ1aWxkIG5hbWVzcGFjZQ0KdmFyIFVBbGJlcnRhID0gVUFsYmVydGEgfHwge307DQpVQWxiZXJ0YS5TaXRlY29yZSA9IFVBbGJlcnRhLlNpdGVjb3JlIHx8IHt9Ow0KDQpVQWxiZXJ0YS5TaXRlY29yZS5TZWFyY2hHcmFkdWF0ZVByb2dyYW0gPSBmdW5jdGlvbiAoJCkgew0KDQogICAgdmFyIF9kZXBhcnRtZW50TGlzdCA9IG5ldyBEaWN0aW9uYXJ5KCksDQogICAgICAgIF9mYWN1bHR5TGlzdCA9IG5ldyBEaWN0aW9uYXJ5KCksDQogICAgICAgIF9pbnRlcnZhbFByZXZIYXNoID0gIiIsDQogICAgICAgIF91cmxUeXBlID0gbnVsbCwNCg0KICAgICAgICBfdXRpbHMgPSB7DQogICAgICAgICAgICBnZXRGbGF0VGV4dFZhbHVlOiBmdW5jdGlvbiAob2JqKSB7DQogICAgICAgICAgICAgICAgdmFyIHN0cmluZ3MgPSAiIjsNCiAgICAgICAgICAgICAgICBmb3IodmFyIGkgaW4gb2JqKSB7DQogICAgICAgICAgICAgICAgICAgIGlmKCFvYmouaGFzT3duUHJvcGVydHkoaSkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGlmKHR5cGVvZiBvYmpbaV0gPT0gIm9iamVjdCIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHN0cmluZ3MgKz0gIiAiICsgX3V0aWxzLmdldEZsYXRUZXh0VmFsdWUob2JqW2ldKTsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHJlbW92ZSBJRCdzDQogICAgICAgICAgICAgICAgICAgICAgICBpZihvYmpbaV1bMF0gPT0gInsiICYmIG9ialtpXVtvYmpbaV0ubGVuZ3RoIC0gMV0gPT0gIn0iKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICBzdHJpbmdzICs9ICIgIiArIG9ialtpXS5yZXBsYWNlKC9cbi9nLCAiICIpLnRvTG93ZXJDYXNlKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgcmV0dXJuIHN0cmluZ3M7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgX2FqYXggPSB7DQogICAgICAgICAgICBnZXREYXRhOiBmdW5jdGlvbiAoY2FsbGJhY2spIHsNCiAgICAgICAgICAgICAgICAkLmdldEpTT04oIi9hcGkvZ3JhZHByb2dyYW1zIiwgZnVuY3Rpb24gKGRhdGEpIHsgX2FqYXguYWpheFN1Y2Nlc3MoZGF0YSk7IGNhbGxiYWNrKCk7IH0pOw0KICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgYWpheFN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhKSB7DQogICAgICAgICAgICAgICAgaWYgKGRhdGEgJiYgZGF0YS5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZGF0YS5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGQgPSBkYXRhW2ldLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlcGFydG1lbnQgPSBkLkRlcGFydG1lbnQgfHwgIiIsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFjdWx0aWVzID0gZC5GYWN1bHRpZXMgfHwgW107DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmICghX2RlcGFydG1lbnRMaXN0LmNvbnRhaW5zS2V5KGRlcGFydG1lbnQpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZC5fRnVsbFRleHQgPSBfdXRpbHMuZ2V0RmxhdFRleHRWYWx1ZShkKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZGVwYXJ0bWVudExpc3QuYWRkKGRlcGFydG1lbnQsIGQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IGZhY3VsdGllcy5sZW5ndGg7IHgrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICghX2ZhY3VsdHlMaXN0LmNvbnRhaW5zS2V5KGZhY3VsdGllc1t4XS5OYW1lKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZmFjdWx0eUxpc3QuYWRkKGZhY3VsdGllc1t4XS5OYW1lLCBmYWN1bHRpZXNbeF0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICBfbWFpbi5wb3B1bGF0ZUZhY3VsdHlEcm9wRG93bigpOw0KICAgICAgICAgICAgICAgICAgICBfZGVwYXJ0bWVudExpc3Quc29ydEtleXMoKTsNCiAgICAgICAgICAgICAgICAgICAgX2ZhY3VsdHlMaXN0LnNvcnRLZXlzKCk7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgYWpheEVycm9yOiBmdW5jdGlvbiAoKSB7IH0NCiAgICAgICAgfSwNCg0KICAgICAgICBfbmF2aWdhdGlvbiA9IHsNCiAgICAgICAgICAgIHVybFR5cGU6IHsgTWFpbjogMSwgRGV0YWlsczogMiB9LA0KDQogICAgICAgICAgICBwYXJzZVVybDogZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgIHZhciBhbmNob3IgPSB3aW5kb3cubG9jYXRpb24uaGFzaDsNCg0KICAgICAgICAgICAgICAgIC8vRGV0YWlscyBwYWdlDQogICAgICAgICAgICAgICAgaWYgKGFuY2hvciAhPSAiIikgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4geyB1cmxUeXBlOiBfbmF2aWdhdGlvbi51cmxUeXBlLkRldGFpbHMsIHZhbHVlOiBhbmNob3IgfTsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICByZXR1cm4geyB1cmxUeXBlOiBfbmF2aWdhdGlvbi51cmxUeXBlLk1haW4sIHZhbHVlOiAiIiB9Ow0KICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgdXJsQ2hhbmdlOiBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgX3VybFR5cGUgPSBfbmF2aWdhdGlvbi5wYXJzZVVybCgpOw0KICAgICAgICAgICAgICAgIHN3aXRjaCAoX3VybFR5cGUudXJsVHlwZSkgew0KICAgICAgICAgICAgICAgICAgICBjYXNlIF9uYXZpZ2F0aW9uLnVybFR5cGUuTWFpbjoNCiAgICAgICAgICAgICAgICAgICAgICAgICQoIiNncmFkRGV0YWlsc1dyYXBwZXIiKS5zbGlkZVVwKDUwMCwgZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICQoIiNncmFkU2VhcmNoV3JhcHBlciwjc2VhcmNoLWluc3RydWN0aW9ucyIpLnNsaWRlRG93big1MDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9yZXN1bHRzLmRpc3BsYXlSZXN1bHRzKCk7DQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICBjYXNlIF9uYXZpZ2F0aW9uLnVybFR5cGUuRGV0YWlsczoNCiAgICAgICAgICAgICAgICAgICAgICAgICQoIiNncmFkU2VhcmNoV3JhcHBlciwjc2VhcmNoLWluc3RydWN0aW9ucyIpLnNsaWRlVXAoNTAwLCBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgJCgiI2dyYWREZXRhaWxzV3JhcHBlciIpLnNsaWRlRG93big1MDApOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9kZXRhaWxzLmRpc3BsYXlEZXRhaWxzKF91cmxUeXBlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgdXBkYXRlSGFzaDogZnVuY3Rpb24obmV3SGFzaCl7DQogICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhhc2ggPSBuZXdIYXNoOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIF9tYWluID0gew0KICAgICAgICAgICAgcG9wdWxhdGVGYWN1bHR5RHJvcERvd246IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICB2YXIgc2VsZWN0ID0gJCgiI3NGYWN1bHR5TGlzdCIpOw0KICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgX2ZhY3VsdHlMaXN0Lmxlbmd0aCgpOyBpKyspIHsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGRhdGEgPSBfZmFjdWx0eUxpc3QubG9va3VwKF9mYWN1bHR5TGlzdC5sb29rdXBLZXkoaSkpOw0KICAgICAgICAgICAgICAgICAgICBzZWxlY3QuYXBwZW5kKCI8b3B0aW9uIHZhbHVlPSciICsgZGF0YS5JRCArICInPiIgKyBkYXRhLk5hbWUgKyAiPC9vcHRpb24+Iik7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgc2VsZWN0LmNoYW5nZShmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgIF9yZXN1bHRzLmRpc3BsYXlSZXN1bHRzKCk7DQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB9DQogICAgICAgIH0sDQoNCiAgICAgICAgX3Jlc3VsdHMgPSB7DQogICAgICAgICAgICBkaXNwbGF5UmVzdWx0czogZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgIHZhciByZXN1bHRzID0gW10sDQogICAgICAgICAgICAgICAgICAgIGZhY3VsdHlWYWx1ZSA9ICQoIiNzRmFjdWx0eUxpc3QiKS52YWwoKSwNCiAgICAgICAgICAgICAgICAgICAgc2VhcmNoVmFsdWVzID0gJC5ncmVwKCQoIiNncmFkU2VhcmNoQm94IikudmFsKCkudHJpbSgpLnRvTG93ZXJDYXNlKCkuc3BsaXQoJyAnKSwgZnVuY3Rpb24obikgeyByZXR1cm4obik7IH0pOw0KDQogICAgICAgICAgICAgICAgcmVzdWx0TG9vcDogZm9yICh2YXIgaSA9IDA7IGkgPCBfZGVwYXJ0bWVudExpc3QubGVuZ3RoKCk7IGkrKykgew0KICAgICAgICAgICAgICAgICAgICB2YXIga2V5ID0gX2RlcGFydG1lbnRMaXN0Lmxvb2t1cEtleShpKSwNCiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSBfZGVwYXJ0bWVudExpc3QubG9va3VwKGtleSksDQogICAgICAgICAgICAgICAgICAgICAgICBkZWdyZWVzID0gIiIsDQogICAgICAgICAgICAgICAgICAgICAgICBmYWN1bHRpZXMgPSAiIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIHg7DQoNCiAgICAgICAgICAgICAgICAgICAgLy8gZmlsdGVyIG9uIHNlYXJjaA0KICAgICAgICAgICAgICAgICAgICBpZiAoc2VhcmNoVmFsdWVzLmxlbmd0aCA+IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoeCA9IDA7IHggPCBzZWFyY2hWYWx1ZXMubGVuZ3RoOyB4KyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGF0YS5fRnVsbFRleHQuaW5kZXhPZihzZWFyY2hWYWx1ZXNbeF0pID09IC0xKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlIHJlc3VsdExvb3A7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgLy8gZmlsdGVyIGJ5IGZhY3VsdHkNCiAgICAgICAgICAgICAgICAgICAgZm9yICh4ID0gMDsgeCA8IGRhdGEuRmFjdWx0aWVzLmxlbmd0aDsgeCsrKSB7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmYWN1bHR5VmFsdWUgIT0gIiIgJiYgZmFjdWx0eVZhbHVlICE9IGRhdGEuRmFjdWx0aWVzW3hdLklEKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmYWN1bHRpZXMgIT0gIiIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWN1bHRpZXMgKz0gIjxici8+IjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGZhY3VsdGllcyArPSBkYXRhLkZhY3VsdGllc1t4XS5OYW1lOw0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgaWYgKGZhY3VsdGllcyA9PSAiIikgew0KICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7DQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICBmb3IgKHggPSAwOyB4IDwgZGF0YS5EZWdyZWVzLmxlbmd0aDsgeCsrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZGVncmVlcyAhPSAiIikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlZ3JlZXMgKz0gIiwgIjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIGRlZ3JlZXMgKz0gZGF0YS5EZWdyZWVzW3hdLkFiYnJldmlhdGlvbjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIHJlc3VsdHMucHVzaCh7DQogICAgICAgICAgICAgICAgICAgICAgICBEZXBhcnRtZW50OiBkYXRhLkRlcGFydG1lbnQsDQogICAgICAgICAgICAgICAgICAgICAgICBEZWdyZWVzOiBkZWdyZWVzLA0KICAgICAgICAgICAgICAgICAgICAgICAgRmFjdWx0eTogZmFjdWx0aWVzLA0KICAgICAgICAgICAgICAgICAgICAgICAgaGFzaDogZGF0YS5JRC5yZXBsYWNlKC8tfHt8fS9nLCAiIikNCiAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgdmFyIHRhYmxlQm9keSA9ICQoIiNncmFkUmVzdWx0c1RhYmxlID4gdGJvZHkiKTsNCiAgICAgICAgICAgICAgICB0YWJsZUJvZHkuZW1wdHkoKTsNCiAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJlc3VsdHMubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgICAgICAgICAgdGFibGVCb2R5LmFwcGVuZCgiPHRyPjx0ZD48YSBocmVmPSdqYXZhc2NyaXB0OnZvaWQoMCk7JyBvbmNsaWNrPSdVQWxiZXJ0YS5TaXRlY29yZS5TZWFyY2hHcmFkdWF0ZVByb2dyYW0udXBkYXRlSGFzaChcIiMiICsgcmVzdWx0c1tpXS5oYXNoICsgIlwiKTsnPiIgKyByZXN1bHRzW2ldLkRlcGFydG1lbnQgKyAiPC9hPjwvdGQ+PHRkPiIgKyByZXN1bHRzW2ldLkRlZ3JlZXMgKyAiPC90ZD48dGQ+IiArIHJlc3VsdHNbaV0uRmFjdWx0eSArICI8L3RkPjwvdHI+Iik7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIGlmIChyZXN1bHRzLmxlbmd0aCA9PSAwKSB7DQogICAgICAgICAgICAgICAgICAgIHRhYmxlQm9keS5hcHBlbmQoIjx0cj48dGQgY29sc3Bhbj0nMyc+Tm8gcmVzdWx0cyBmb3VuZC48L3RkPjwvdHI+Iik7DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KDQogICAgICAgIF9kZXRhaWxzID0gew0KICAgICAgICAgICAgZGlzcGxheURldGFpbHM6IGZ1bmN0aW9uICh1cmxUeXBlKSB7DQogICAgICAgICAgICAgICAgdmFyIGlkID0gdXJsVHlwZS52YWx1ZS5yZXBsYWNlKCIjIiwgIiIpLA0KICAgICAgICAgICAgICAgICAgICBpdGVtID0gbnVsbCwNCiAgICAgICAgICAgICAgICAgICAgZmFjdWx0aWVzID0gIiIsDQogICAgICAgICAgICAgICAgICAgIGRlZ3JlZXMgPSAiIiwNCiAgICAgICAgICAgICAgICAgICAgaTsNCg0KICAgICAgICAgICAgICAgIGZvciAoaSA9IDA7IGkgPCBfZGVwYXJ0bWVudExpc3QubGVuZ3RoKCk7IGkrKykgew0KICAgICAgICAgICAgICAgICAgICB2YXIga2V5ID0gX2RlcGFydG1lbnRMaXN0Lmxvb2t1cEtleShpKSwNCiAgICAgICAgICAgICAgICAgICAgICAgIGRhdGEgPSBfZGVwYXJ0bWVudExpc3QubG9va3VwKGtleSk7DQoNCiAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGEuSUQucmVwbGFjZSgvLXx7fH0vZywgIiIpID09IGlkKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBpdGVtID0gZGF0YTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IGl0ZW0uRGVncmVlcy5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgICAgICAgICBkZWdyZWVzICs9ICI8bGk+IiArIGl0ZW0uRGVncmVlc1tpXS5OYW1lICsgIjwvbGk+IjsNCiAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICBmb3IgKGkgPSAwOyBpIDwgaXRlbS5GYWN1bHRpZXMubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgICAgICAgICAgaWYgKGZhY3VsdGllcyAhPSAiIikgew0KICAgICAgICAgICAgICAgICAgICAgICAgZmFjdWx0aWVzICs9ICI8YnIvPiI7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgZmFjdWx0aWVzICs9IGl0ZW0uRmFjdWx0aWVzW2ldLk5hbWU7DQogICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgJCgiI2dyYWREZXRhaWxfZGVwYXJ0bWVudCIpLmh0bWwoaXRlbS5EZXBhcnRtZW50KTsNCiAgICAgICAgICAgICAgICAkKCIjZ3JhZERldGFpbF9mYWN1bHR5IikuaHRtbChmYWN1bHRpZXMpOw0KICAgICAgICAgICAgICAgICQoIiNncmFkRGV0YWlsX3dlYnNpdGUiKS5odG1sKGl0ZW0uUHJvZ3JhbVVybCkuYXR0cignaHJlZicsIGl0ZW0uUHJvZ3JhbVVybCk7DQogICAgICAgICAgICAgICAgJCgiI2dyYWREZXRhaWxfZW1haWwiKS5odG1sKGl0ZW0uRW1haWwpLmF0dHIoJ2hyZWYnLCAnbWFpbHRvOicgKyBpdGVtLkVtYWlsKTsNCiAgICAgICAgICAgICAgICAkKCIjZ3JhZERldGFpbF9yZXNlYXJjaCIpLmh0bWwoaXRlbS5SZXNlYXJjaEFyZWFzKTsNCiAgICAgICAgICAgICAgICAkKCIjZ3JhZERldGFpbF9kZWdyZWVzIikuaHRtbChkZWdyZWVzKTsNCg0KICAgICAgICAgICAgICAgIGl0ZW0uR3JhZHVhdGVTdWRlbnRQb3NpdGlvbnNVcmwgIT0gIiIgPyAkKCIjZ3JhZERldGFpbF9zdHVkZW50UG9zIikuaHRtbChpdGVtLkdyYWR1YXRlU3VkZW50UG9zaXRpb25zVXJsKS5hdHRyKCdocmVmJywgaXRlbS5HcmFkdWF0ZVN1ZGVudFBvc2l0aW9uc1VybCkucGFyZW50KCkuc2hvdygpIDogJCgiI2dyYWREZXRhaWxfc3R1ZGVudFBvcyIpLnBhcmVudCgpLmhpZGUoKTsNCiAgICAgICAgICAgIH0NCiAgICAgICAgfTsNCg0KICAgIGZ1bmN0aW9uIGluaXQoKSB7DQogICAgICAgICQoIiNncmFkU2VhcmNoV3JhcHBlciwjc2VhcmNoLWluc3RydWN0aW9ucyIpLnNob3coKTsNCg0KICAgICAgICBqUXVlcnkuZWFzaW5nLmRlZiA9ICJlYXNlSW5DdWJpYyI7DQoNCiAgICAgICAgLy8gY2hlY2sgZm9yIHNlYXJjaCB2aWEgdXJsDQogICAgICAgIGlmICh3aW5kb3cubG9jYXRpb24uaGFzaC5pbmRleE9mKCdzZWFyY2hfJykgIT0gLTEpIHsNCiAgICAgICAgICAgICQoIiNncmFkU2VhcmNoQm94IikudmFsKHdpbmRvdy5sb2NhdGlvbi5oYXNoLnJlcGxhY2UoL15bI10/c2VhcmNoXy9nLCAnJykpOw0KICAgICAgICAgICAgX25hdmlnYXRpb24udXBkYXRlSGFzaCgiIik7DQogICAgICAgIH0NCg0KICAgICAgICBfYWpheC5nZXREYXRhKF9uYXZpZ2F0aW9uLnVybENoYW5nZSk7DQoNCiAgICAgICAgaWYgKCJvbmhhc2hjaGFuZ2UiIGluIHdpbmRvdyAmJiAoZG9jdW1lbnQuZG9jdW1lbnRNb2RlID09PSB1bmRlZmluZWQgfHwgZG9jdW1lbnQuZG9jdW1lbnRNb2RlID4gNyApKSB7DQogICAgICAgICAgICAkKHdpbmRvdykuYmluZCgiaGFzaGNoYW5nZSIsIGZ1bmN0aW9uIChlKSB7DQogICAgICAgICAgICAgICAgX25hdmlnYXRpb24udXJsQ2hhbmdlKCk7DQogICAgICAgICAgICB9KTsNCiAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgIHNldEludGVydmFsKGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICB2YXIgbmV3SGFzaCA9IHdpbmRvdy5sb2NhdGlvbi5oYXNoOw0KICAgICAgICAgICAgICAgIGlmIChfaW50ZXJ2YWxQcmV2SGFzaCAhPT0gbmV3SGFzaCkgew0KICAgICAgICAgICAgICAgICAgICBfaW50ZXJ2YWxQcmV2SGFzaCA9IG5ld0hhc2g7DQogICAgICAgICAgICAgICAgICAgIF9uYXZpZ2F0aW9uLnVybENoYW5nZSgpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sNTApOw0KICAgICAgICB9DQoNCiAgICAgICAgJCgiI2dyYWRTZWFyY2hCb3giKS5rZXl1cChmdW5jdGlvbiAoYSkgew0KICAgICAgICAgICAgYSA9IGEgfHwgd2luZG93LmV2ZW50Ow0KICAgICAgICAgICAgaWYgKGEua2V5Q29kZSA9PSAxMyB8fCBhLndoaWNoID09IDEzKSB7DQogICAgICAgICAgICAgICAgYS5wcmV2ZW50RGVmYXVsdCgpOw0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgIF9yZXN1bHRzLmRpc3BsYXlSZXN1bHRzKCk7DQogICAgICAgIH0pOw0KICAgIH0NCg0KICAgIHJldHVybiB7DQogICAgICAgIGluaXRpYWxpemU6IGluaXQsDQogICAgICAgIHVwZGF0ZUhhc2g6IF9uYXZpZ2F0aW9uLnVwZGF0ZUhhc2gNCiAgICB9Ow0KDQp9IChqUXVlcnkpOw0KDQovKg0KICogRGljdGlvbmFyeSBPYmplY3QNCiAqIENyZWF0ZWQgYnkgRGVhbiBWaWdvcmVuIC0gdmlnb3JlbkB1YWxiZXJ0YS5jYQ0KICovDQpmdW5jdGlvbiBEaWN0aW9uYXJ5KCkgew0KICAgIHRoaXMua2V5cyA9IG5ldyBBcnJheSgpOw0KICAgIHRoaXMuZGF0YSA9IG5ldyBBcnJheSgpOw0KfQ0KDQp3aW5kb3dbJ0RpY3Rpb25hcnknXSA9IERpY3Rpb25hcnk7DQoNCkRpY3Rpb25hcnkucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uICgpIHsNCiAgICBmb3IgKHZhciBjID0gMDsgYyA8IGFyZ3VtZW50cy5sZW5ndGg7IGMgKz0gMikgew0KICAgICAgICB0aGlzLmRhdGFbYXJndW1lbnRzW2NdXSA9IGFyZ3VtZW50c1tjICsgMV07DQogICAgICAgIHRoaXMua2V5c1t0aGlzLmtleXMubGVuZ3RoXSA9IGFyZ3VtZW50c1tjXTsNCiAgICB9DQp9Ow0KDQpEaWN0aW9uYXJ5LnByb3RvdHlwZS5sb29rdXAgPSBmdW5jdGlvbiAoa2V5KSB7DQogICAgcmV0dXJuICh0aGlzLmRhdGFba2V5XSk7DQp9Ow0KDQpEaWN0aW9uYXJ5LnByb3RvdHlwZS5sZW5ndGggPSBmdW5jdGlvbiAoKSB7DQogICAgcmV0dXJuIHRoaXMua2V5cy5sZW5ndGg7DQp9Ow0KDQpEaWN0aW9uYXJ5LnByb3RvdHlwZS5sb29rdXBLZXkgPSBmdW5jdGlvbiAoaW5kZXgpIHsNCiAgICByZXR1cm4gdGhpcy5rZXlzW2luZGV4XTsNCn07DQoNCkRpY3Rpb25hcnkucHJvdG90eXBlLmNvbnRhaW5zS2V5ID0gZnVuY3Rpb24oa2V5KSB7DQogICAgcmV0dXJuICEhKHRoaXMua2V5cy5pbmRleE9mKGtleSkgPiAtMSk7DQp9Ow0KDQpEaWN0aW9uYXJ5LnByb3RvdHlwZS5zb3J0S2V5cyA9IGZ1bmN0aW9uICgpIHsNCiAgICB0aGlzLmtleXMuc29ydCgpOw0KfTs7DQovKioNCiogVUFsYmVydGEgVGVhc2VyIERhdGEgTGlzdA0KKiBBdXRob3I6IEt5bGUgU2NobWlkdCAtIGt5bGUuc2NobWlkdEB1YWxiZXJ0YS5jYQ0KKi8NCg0KLy8gYnVpbGQgbmFtZXNwYWNlDQp2YXIgVUFsYmVydGEgPSBVQWxiZXJ0YSB8fCB7fTsNClVBbGJlcnRhLlNpdGVjb3JlID0gVUFsYmVydGEuU2l0ZWNvcmUgfHwge307DQoNClVBbGJlcnRhLlNpdGVjb3JlLlRlYXNlckRhdGFMaXN0ID0gVUFsYmVydGEuU2l0ZWNvcmUuVGVhc2VyRGF0YUxpc3QgfHwgKGZ1bmN0aW9uICgpIHsNCg0KICAgIGZ1bmN0aW9uIGdldEluc3RhbmNlKCkgew0KICAgICAgICByZXR1cm4gKGZ1bmN0aW9uICgkKSB7DQogICAgICAgICAgICAndXNlIHN0cmljdCc7DQoNCiAgICAgICAgICAgIHZhciBEYXRhID0gew0KICAgICAgICAgICAgICAgIC8vIG9wdGlvbnMNCiAgICAgICAgICAgICAgICBvcHRpb25zOiB7DQogICAgICAgICAgICAgICAgICAgIGlzSW5TaWRlYmFyOiBmYWxzZSwNCiAgICAgICAgICAgICAgICAgICAgY3NzQ2xhc3NQcmVmaXg6ICIiLA0KICAgICAgICAgICAgICAgICAgICBzaG93RGVzY3JpcHRpb25zOiBmYWxzZSwNCiAgICAgICAgICAgICAgICAgICAgc2hvd0RhdGU6IGZhbHNlLA0KICAgICAgICAgICAgICAgICAgICBzaG93SW1hZ2VzOiBmYWxzZSwNCiAgICAgICAgICAgICAgICAgICAgc2hvd1NvdXJjZTogZmFsc2UsDQogICAgICAgICAgICAgICAgICAgIGRpc3BsYXlMaW1pdDogNQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0sDQogICAgICAgICAgICAgICAgQUpBWCA9IHsNCiAgICAgICAgICAgICAgICAgICAgLy8gZ2V0IGl0ZW1zIGZyb20gdGhlIGZlZWQNCiAgICAgICAgICAgICAgICAgICAgZ2V0SXRlbXM6IGZ1bmN0aW9uIChmZWVkVXJsKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAkLmFqYXgoew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhY2hlOiBmYWxzZSwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhVHlwZTogImpzb24iLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiBBSkFYLkV2ZW50cy5lcnJvciwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBBSkFYLkV2ZW50cy5zdWNjZXNzLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVybDogIi9hcGkvbmV3cy9jb252ZXJ0ZmVlZC5qc29uP2ZlZWQ9IiArIGVuY29kZVVSSUNvbXBvbmVudChmZWVkVXJsKQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgICAgICAgICAgRXZlbnRzOiB7DQogICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5pdGVtTGlzdC5maW5kKCIubG9hZGluZyIpLnJlbW92ZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5pdGVtTGlzdC5wcmVwZW5kKCI8bGk+PHA+QW4gZXJyb3Igb2NjdXJyZWQgd2hpbGUgb2J0YWluaW5nIHRoZSBpdGVtIGluZm9ybWF0aW9uLiBQbGVhc2UgcmVmcmVzaCB0aGUgcGFnZSBhbmQgdHJ5IGFnYWluLjwvcD48L2xpPiIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogZnVuY3Rpb24gKGRhdGEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2Uuc2hvd0l0ZW1zKGRhdGEuSXRlbXMpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSwNCiAgICAgICAgICAgICAgICBJbnRlcmZhY2UgPSB7DQogICAgICAgICAgICAgICAgICAgIGl0ZW1MaXN0OiBbXSwgICAgICAgICAgICAgLy8gdGhlIGl0ZW0gbGlzdA0KDQogICAgICAgICAgICAgICAgICAgIC8vIHNldHVwIHRoZSBpbnRlcmZhY2UNCiAgICAgICAgICAgICAgICAgICAgc2V0dXA6IGZ1bmN0aW9uIChjb250YWluZXJJZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLml0ZW1MaXN0ID0gJCgiIyIgKyBjb250YWluZXJJZCArICIgPiB1bCIpOw0KICAgICAgICAgICAgICAgICAgICB9LA0KDQogICAgICAgICAgICAgICAgICAgIC8vIHNob3cgdGhlIGl0ZW1zDQogICAgICAgICAgICAgICAgICAgIHNob3dJdGVtczogZnVuY3Rpb24gKGl0ZW1zKSB7DQogICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UuaXRlbUxpc3QuZmluZCgiLmxvYWRpbmciKS5yZW1vdmUoKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGJvdHRvbVJvdyA9IEludGVyZmFjZS5pdGVtTGlzdC5maW5kKCIuYm90dG9tLXJvdyIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGJvdHRvbVJvd0h0bWwgPSAkKGJvdHRvbVJvdykuY2xvbmUoKS53cmFwKCc8cD4nKS5wYXJlbnQoKS5odG1sKCk7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIGJvdHRvbVJvdy5yZW1vdmUoKTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBpdGVtcy5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpID49IERhdGEub3B0aW9ucy5kaXNwbGF5TGltaXQpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5hZGRJdGVtKGl0ZW1zW2ldKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLml0ZW1MaXN0LmFwcGVuZChib3R0b21Sb3dIdG1sKTsNCiAgICAgICAgICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgICAgICAgICAvLyBhZGQgaXRlbSB0byB0aGUgbGlzdA0KICAgICAgICAgICAgICAgICAgICBhZGRJdGVtOiBmdW5jdGlvbiAoaXRlbSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gZW5zdXJlIHZhbGlkIGl0ZW0NCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpdGVtLlRpdGxlLkNvbnRlbnQgPT0gJycgfHwgaXRlbS5MaW5rcy5sZW5ndGggPT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gY3NzIHByZWZpeA0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNzc1ByZWZpeCA9IERhdGEub3B0aW9ucy5jc3NDbGFzc1ByZWZpeCA9PSAnJyA/ICdkYXRhJyA6IERhdGEub3B0aW9ucy5jc3NDbGFzc1ByZWZpeDsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gZ2V0IGRhdGUgYW5kIGRlc2NyaXB0aW9uIGh0bWwNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsaW5rSHRtbCA9ICc8ZGl2IGNsYXNzPSJsaXN0LWl0ZW0tY29udGVudCI+JzsNCiAgICAgICAgICAgICAgICAgICAgICAgIA0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2V0IHRpdGxlDQogICAgICAgICAgICAgICAgICAgICAgICBsaW5rSHRtbCArPSAnPGg0PicgKyBpdGVtLlRpdGxlLkNvbnRlbnQgKyAnPC9oND4nOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBnZXQgZGF0ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKERhdGEub3B0aW9ucy5zaG93RGF0ZSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmtIdG1sICs9ICc8cCBjbGFzcz0ibGlzdC1pdGVtLWV4dHJhIj4nICsgSW50ZXJmYWNlLmdldERhdGUoaXRlbSkgKyAnPC9wPic7DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNob3cgc291cmNlDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoRGF0YS5vcHRpb25zLnNob3dTb3VyY2UgJiYgaXRlbS5Tb3VyY2VGZWVkICE9IG51bGwgJiYgaXRlbS5Tb3VyY2VGZWVkLlRpdGxlICE9IG51bGwgJiYgaXRlbS5Tb3VyY2VGZWVkLlRpdGxlLkNvbnRlbnQgIT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0aXRsZSA9IGl0ZW0uU291cmNlRmVlZC5UaXRsZS5Db250ZW50Ow0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0uU291cmNlRmVlZC5MaW5rcyAhPSBudWxsICYmIGl0ZW0uU291cmNlRmVlZC5MaW5rcy5sZW5ndGggPiAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRpdGxlID0gJzxhIGhyZWY9IicgKyBpdGVtLlNvdXJjZUZlZWQuTGlua3NbMF0uVXJpICsgJyI+JyArIHRpdGxlICsgJzwvYT4nOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5rSHRtbCArPSAnPHAgY2xhc3M9Imxpc3QtaXRlbS1leHRyYSI+JyArIHRpdGxlICsgIjwvcD4iOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBzaG93IGRlc2NyaXB0aW9uDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoRGF0YS5vcHRpb25zLnNob3dEZXNjcmlwdGlvbnMgJiYgKGl0ZW0uU3VtbWFyeS5Db250ZW50ICE9IG51bGwgfHwgaXRlbS5Db250ZW50LkNvbnRlbnQgIT0gbnVsbCkpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZGVzY3JpcHRpb24gPSBpdGVtLlN1bW1hcnkuQ29udGVudCAhPSBudWxsID8gaXRlbS5TdW1tYXJ5LkNvbnRlbnQgOiBpdGVtLkNvbnRlbnQuQ29udGVudDsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5rSHRtbCArPSAnPHAgY2xhc3M9Imxpc3QtaXRlbS1kZXNjcmlwdGlvbiI+JyArIGRlc2NyaXB0aW9uICsgJzwvcD4nOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICBsaW5rSHRtbCArPSAnPC9kaXY+JzsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gc2V0IGlubmVyIGh0bWwNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpbm5lckh0bWwgPSAnJzsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2hlY2sgaWYgdGhlIGxpc3QgaXMgbm90IGluIHRoZSBzaWRlYmFyDQogICAgICAgICAgICAgICAgICAgICAgICAvL2lmICghRGF0YS5vcHRpb25zLmlzSW5TaWRlYmFyICYmIChEYXRhLm9wdGlvbnMuc2hvd0Rlc2NyaXB0aW9ucyB8fCBEYXRhLm9wdGlvbnMuc2hvd0RhdGUgfHwgRGF0YS5vcHRpb25zLnNob3dJbWFnZXMpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAvLyAgICBpbm5lckh0bWwgPSAnPGg0PicgKyBpbm5lckh0bWwgKyAnPC9oND4nOw0KICAgICAgICAgICAgICAgICAgICAgICAgLy99DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNldCBpbWFnZSBodG1sDQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaW1hZ2VIdG1sID0gJyc7DQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoRGF0YS5vcHRpb25zLnNob3dJbWFnZXMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGl0ZW0uTGlua3MubGVuZ3RoOyBpKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxpbmsgPSBpdGVtLkxpbmtzW2ldOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobGluay5NZWRpYVR5cGUgIT0gbnVsbCAmJiBsaW5rLk1lZGlhVHlwZS50b0xvd2VyQ2FzZSgpLmluZGV4T2YoImltYWdlIikgIT09IC0xKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpbWFnZUh0bWwgPSAnPGRpdiBjbGFzcz0ibGlzdC1pdGVtLWltYWdlIGZyYW1lIj4nICsgJzxpbWcgc3JjPSInICsgbGluay5VcmkgKyAnIiAvPjwvZGl2Pic7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNldCBsaW5rDQogICAgICAgICAgICAgICAgICAgICAgICBpbm5lckh0bWwgPSAnPGEgaHJlZj0iJyArIEludGVyZmFjZS5nZXRMaW5rKGl0ZW0pICsgJyI+JyArIGltYWdlSHRtbCArIGxpbmtIdG1sICsgJzwvYT4nOw0KDQogICAgICAgICAgICAgICAgICAgICAgICAvLyBhZGQgaXRlbQ0KICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLml0ZW1MaXN0LmFwcGVuZCgnPGxpJyArIChEYXRhLm9wdGlvbnMuY3NzQ2xhc3NQcmVmaXggPT0gJycgPyAnJyA6ICcgY2xhc3M9IicgKyBjc3NQcmVmaXggKyAnLXJvdyInKSArICc+JyArIGlubmVySHRtbCArICAnPC9saT4nKTsNCiAgICAgICAgICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgICAgICAgICAvLyBnZXQgdGhlIGl0ZW0gbGluaw0KICAgICAgICAgICAgICAgICAgICBnZXRMaW5rOiBmdW5jdGlvbiAoaXRlbSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0uTGlua3MubGVuZ3RoID4gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgaXRlbS5MaW5rcy5sZW5ndGg7IGkrKykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbGluayA9IGl0ZW0uTGlua3NbaV07DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsaW5rLlJlbGF0aW9uc2hpcFR5cGUgIT0gbnVsbCAmJiBsaW5rLlJlbGF0aW9uc2hpcFR5cGUudG9Mb3dlckNhc2UoKSA9PSAiYWx0ZXJuYXRlIikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxpbmsuVXJpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBpdGVtLkxpbmtzWzBdLlVyaTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAnJzsNCiAgICAgICAgICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgICAgICAgICAvLyBnZXQgdGhlIGl0ZW0gZGF0ZQ0KICAgICAgICAgICAgICAgICAgICBnZXREYXRlOiBmdW5jdGlvbiAoaXRlbSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGl0ZW0uR29vZ2xlQ2FsZW5kYXJXaGVuICE9IG51bGwpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gaXRlbS5Hb29nbGVDYWxlbmRhcldoZW47DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gVUFsYmVydGEuU2l0ZWNvcmUuVXRpbGl0aWVzLkdldERhdGVGcm9tSnNvbihpdGVtLlB1Ymxpc2hEYXRlLCBVQWxiZXJ0YS5TaXRlY29yZS5VdGlsaXRpZXMuRGF0ZUZvcm1hdC5TaG9ydCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9Ow0KDQogICAgICAgICAgICAvLyBpbnN0YW5jZSBpbml0aWFsaXphdGlvbg0KDQogICAgICAgICAgICBmdW5jdGlvbiBpbml0KGNvbnRhaW5lcklkLCBmZWVkVXJsLCBvcHRpb25zKSB7DQogICAgICAgICAgICAgICAgRGF0YS5vcHRpb25zID0gJC5leHRlbmQoRGF0YS5vcHRpb25zLCBvcHRpb25zKTsNCiAgICAgICAgICAgICAgICBJbnRlcmZhY2Uuc2V0dXAoY29udGFpbmVySWQpOw0KICAgICAgICAgICAgICAgIEFKQVguZ2V0SXRlbXMoZmVlZFVybCk7DQogICAgICAgICAgICB9DQoNCiAgICAgICAgICAgIHJldHVybiB7DQogICAgICAgICAgICAgICAgSW5pdGlhbGl6ZTogaW5pdA0KICAgICAgICAgICAgfTsNCiAgICAgICAgfShqUXVlcnkpKTsNCiAgICB9DQoNCiAgICByZXR1cm4gew0KICAgICAgICBHZXRJbnN0YW5jZTogZ2V0SW5zdGFuY2UNCiAgICB9Ow0KfSgpKTs7DQooZnVuY3Rpb24gKCQpIHsNCiAgICAkKGRvY3VtZW50KS5yZWFkeShmdW5jdGlvbiAoKSB7DQoNCiAgICAgICAgLy9BZGQgTW9kYWwgbWFya3VwLCBlbnN1cmVycyBpdCBpcyBvbmx5IGFkZGVkIG9uY2UuDQogICAgICAgIGlmICgkKCIjdmlkZW9Nb2RhbCIpLmxlbmd0aCA9PSAwKSB7DQogICAgICAgICAgICAkKCIjbWFpbmZvcm0iKS5hcHBlbmQoDQogICAgICAgICAgICAgICAgIjxkaXYgaWQ9J3ZpZGVvTW9kYWwnIGNsYXNzPSdtb2RhbCBoaWRlIGZhZGUnPiIgKw0KICAgICAgICAgICAgICAgICAgICAiPGRpdiBjbGFzcz0nbW9kYWwtaGVhZGVyJz4iICsNCiAgICAgICAgICAgICAgICAgICAgICAgICI8YnV0dG9uIHR5cGU9J2J1dHRvbicgY2xhc3M9J2Nsb3NlJyBkYXRhLWRpc21pc3M9J21vZGFsJyBhcmlhLWhpZGRlbj0ndHJ1ZSc+JnRpbWVzOzwvYnV0dG9uPiIgKw0KICAgICAgICAgICAgICAgICAgICAgICAgIjxoMz5WaWRlbyBNb2RhbDwvaDM+IiArDQogICAgICAgICAgICAgICAgICAgICI8L2Rpdj4iICsNCiAgICAgICAgICAgICAgICAgICAgIjxkaXYgY2xhc3M9J21vZGFsLWJvZHknPiIgKw0KICAgICAgICAgICAgICAgICAgICAgICAgIjxkaXYgY2xhc3M9J3ZpZGVvLW1vZC1jb250YWluZXInPiIgKw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICI8aWZyYW1lIHR5cGU9J3RleHQvaHRtbCcgc3JjPScnIGZyYW1lYm9yZGVyPScwJz48L2lmcmFtZT4iICsNCiAgICAgICAgICAgICAgICAgICAgICAgICI8L2Rpdj4iICsNCiAgICAgICAgICAgICAgICAgICAgIjwvZGl2PiIgKw0KICAgICAgICAgICAgICAgICI8L2Rpdj4iKTsNCiAgICAgICAgfQ0KDQogICAgICAgICQoZG9jdW1lbnQpLm9uKCJjbGljayIsICIudmlkZW8tbW9kYWwtbGluayIsIGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgIHZhciB2aWRlb1NyYyA9ICQodGhpcykuYXR0cignaHJlZicpOw0KICAgICAgICAgICAgLy8gbm8gbW9kYWwgZm9yIG1vYmlsZQ0KICAgICAgICAgICAgaWYgKCQod2luZG93KS53aWR0aCgpIDwgNjkwKSB7DQogICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uID0gJCh0aGlzKS5hdHRyKCdkYXRhLW1vYmlsZXVybCcpOw0KICAgICAgICAgICAgICAgIHJldHVybjsNCiAgICAgICAgICAgIH0NCiAgICAgICAgICAgICQoJyN2aWRlb01vZGFsIGlmcmFtZScpLmF0dHIoJ3NyYycsIHZpZGVvU3JjKTsNCiAgICAgICAgICAgICQoJyN2aWRlb01vZGFsIC5tb2RhbC1oZWFkZXIgaDMnKS50ZXh0KCQodGhpcykuZGF0YSgndGl0bGUnKSk7DQogICAgICAgIH0pOw0KDQogICAgICAgICQoJyN2aWRlb01vZGFsJykuYmluZCgnaGlkZGVuJywgZnVuY3Rpb24gKCkgew0KICAgICAgICAgICAgLy8gY2xlYXIgaWZyYW1lDQogICAgICAgICAgICAkKCIjdmlkZW9Nb2RhbCBpZnJhbWUiKS5hdHRyKCdzcmMnLCAnJyk7DQoNCiAgICAgICAgICAgIC8vIHJlc2V0IG90aGVyIHBvc3NpYmxlIGNvbnRhaW5lcnMNCiAgICAgICAgICAgICQoIiN2aWRlb01vZGFsIC52aWRlby1tb2QtY29udGFpbmVyIikuc2hvdygpOw0KICAgICAgICAgICAgJCgiI3ZpZGVvTW9kYWwgLm1vZGFsLWRlc2NyaXB0aW9uIikucmVtb3ZlKCk7DQogICAgICAgICAgICAkKCIjdmlkZW9Nb2RhbCAubW9kYWwtYXVkaW8iKS5yZW1vdmUoKTsNCiAgICAgICAgICAgICQoIiN2aWRlb01vZGFsIC5tb2RhbC1pbWFnZSIpLnJlbW92ZSgpOw0KICAgICAgICB9KTsNCiAgICB9KTsNCn0pKGpRdWVyeSk7DQo7DQovKioNCiogVUFsYmVydGEgV2ViIFNlcnZpY2UgQ29udGVudA0KKiBBdXRob3I6IEt5bGUgU2NobWlkdCAtIGt5bGUuc2NobWlkdEB1YWxiZXJ0YS5jYQ0KKi8NCg0KLy8gYnVpbGQgbmFtZXNwYWNlDQp2YXIgVUFsYmVydGEgPSBVQWxiZXJ0YSB8fCB7fTsNClVBbGJlcnRhLlNpdGVjb3JlID0gVUFsYmVydGEuU2l0ZWNvcmUgfHwge307DQoNClVBbGJlcnRhLlNpdGVjb3JlLldlYlNlcnZpY2VDb250ZW50ID0gVUFsYmVydGEuU2l0ZWNvcmUuV2ViU2VydmljZUNvbnRlbnQgfHwgKGZ1bmN0aW9uICgpIHsNCiAgICBmdW5jdGlvbiBnZXRJbnN0YW5jZSgpIHsNCiAgICAgICAgcmV0dXJuIChmdW5jdGlvbiAoJCkgew0KICAgICAgICAgICAgJ3VzZSBzdHJpY3QnOw0KDQogICAgICAgICAgICB2YXIgQUpBWCA9IHsNCiAgICAgICAgICAgICAgICAgICAgLy8gZ2V0IGNvbnRlbnQgZnJvbSB3ZWIgc2VydmljZQ0KICAgICAgICAgICAgICAgICAgICBnZXRDb250ZW50OiBmdW5jdGlvbiAod2ViU2VydmljZVVybCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gZ2V0IGNvbnRlbnQgZnJvbSB3ZWIgc2VydmljZQ0KICAgICAgICAgICAgICAgICAgICAgICAgJC5hamF4KHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkYXRhVHlwZTogImpzb25wIiwNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlcnJvcjogQUpBWC5FdmVudHMuZXJyb3IsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3VjY2VzczogQUpBWC5FdmVudHMuc3VjY2VzcywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB1cmw6IHdlYlNlcnZpY2VVcmwNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICB9LA0KDQogICAgICAgICAgICAgICAgICAgIEV2ZW50czogew0KICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2Uuc2hvd0NvbnRlbnQoIjxwPkFuIGVycm9yIG9jY3VycmVkIHdoaWxlIGxvYWRpbmcgdGhpcyBjb250ZW50LiBQbGVhc2UgcmVmcmVzaCB0aGUgcGFnZSBhbmQgdHJ5IGFnYWluLjwvcD4iKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChjb250ZW50KSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLnNob3dDb250ZW50KGNvbnRlbnQpOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgICAgIEludGVyZmFjZSA9IHsNCiAgICAgICAgICAgICAgICAgICAgY29udGFpbmVyOiBbXSwgICAgICAgIC8vIHRoZSBjb250YWluZXINCiAgICAgICAgICAgICAgICAgICAgbG9hZGluZ1NlbGVjdG9yOiAiIiwgIC8vIHRoZSBzZWxlY3RvciBmb3IgdGhlIGxvYWRpbmcgc3Bpbm5lcg0KDQogICAgICAgICAgICAgICAgICAgIC8vIHNldHVwIHRoZSBpbnRlcmZhY2UNCiAgICAgICAgICAgICAgICAgICAgc2V0dXA6IGZ1bmN0aW9uIChjb250YWluZXJJZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gZ2V0IGludGVyZmFjZSBjb21wb25lbnRzDQogICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UuY29udGFpbmVyID0gJCgiIyIgKyBjb250YWluZXJJZCk7DQogICAgICAgICAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgICAgICAgICAgLy8gc2hvdyBjb250ZW50DQogICAgICAgICAgICAgICAgICAgIHNob3dDb250ZW50OiBmdW5jdGlvbiAoY29udGVudCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLmNvbnRhaW5lci5odG1sKGNvbnRlbnQpOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgOw0KDQogICAgICAgICAgICAvLyBpbnN0YW5jZSBpbml0aWFsaXphdGlvbg0KICAgICAgICAgICAgZnVuY3Rpb24gaW5pdChjb250YWluZXJJZCwgd2ViU2VydmljZVVybCkgew0KICAgICAgICAgICAgICAgIEludGVyZmFjZS5zZXR1cChjb250YWluZXJJZCk7DQogICAgICAgICAgICAgICAgQUpBWC5nZXRDb250ZW50KHdlYlNlcnZpY2VVcmwpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgIEluaXRpYWxpemU6IGluaXQNCiAgICAgICAgICAgIH07DQogICAgICAgIH0gKGpRdWVyeSkpOw0KICAgIH0NCg0KICAgIHJldHVybiB7DQogICAgICAgIEdldEluc3RhbmNlOiBnZXRJbnN0YW5jZQ0KICAgIH07DQp9ICgpKTs7DQovKioNCiAqIFVBbGJlcnRhIFBlcnNvbiBNZW51DQogKiBBdXRob3I6IERhbmllbCBTYW5hYnJpYQ0KICovDQoNCi8vIGJ1aWxkIG5hbWVzcGFjZQ0KdmFyIFVBbGJlcnRhID0gVUFsYmVydGEgfHwge307DQpVQWxiZXJ0YS5TaXRlY29yZSA9IFVBbGJlcnRhLlNpdGVjb3JlIHx8IHt9Ow0KDQpVQWxiZXJ0YS5TaXRlY29yZS5QZXJzb25MYXlvdXQgPSBmdW5jdGlvbiAoJCkgew0KICAgIGZ1bmN0aW9uIGluaXQoKSB7DQogICAgICAgIC8vIGluaXQNCg0KICAgICAgICAkKCIucGVvcGxlLXNlY3Rpb24tbmF2IC5uYXZpZ2F0aW9uLXRvZ2dsZSIpLm9uKCdjbGljaycsIGZ1bmN0aW9uIChlKSB7DQogICAgICAgICAgICAkKHRoaXMpLnRvZ2dsZUNsYXNzKCdjb2xsYXBzZWQnKTsNCiAgICAgICAgICAgICQoJy5wZW9wbGUtbmF2LWNvbnQnKS50b2dnbGUoKTsNCiAgICAgICAgICAgICQoJy5wZW9wbGUtc2VjdGlvbi1uYXYgLm5hdmlnYXRpb24tdG9nZ2xlIHNwYW4nKS5odG1sKCgkKHRoaXMpLmhhc0NsYXNzKCdjb2xsYXBzZWQnKSA/ICdTaG93JyA6ICdIaWRlJykgKyAnIE5hdmlnYXRpb24nKTsNCiAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7DQogICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgIH0pOw0KDQogICAgICAgIHZhciBuYXZUYWJzID0gJCgnLnBlb3BsZS1uYXYgbGknKTsNCg0KICAgICAgICAvLyBzZXRBY3RpdmUNCiAgICAgICAgbmF2VGFicy5jbGljayhmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICBzZXRBY3RpdmUoJCh0aGlzKS5pbmRleCgpKTsNCiAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgfSk7DQoNCiAgICAgICAgdmFyIHNldEFjdGl2ZSA9IGZ1bmN0aW9uIChpKSB7DQoNCiAgICAgICAgICAgIG5hdlRhYnMucmVtb3ZlQ2xhc3MoJ2FjdGl2ZScpOw0KICAgICAgICAgICAgbmF2VGFicy5lcShpKS5hZGRDbGFzcygnYWN0aXZlJyk7DQoNCiAgICAgICAgICAgICQoJy5wZXJzb24tc2VjdGlvbicpLmhpZGUoKTsNCiAgICAgICAgICAgIHN3aXRjaCAoaSkgew0KICAgICAgICAgICAgICAgIGNhc2UgMToNCiAgICAgICAgICAgICAgICAgICAgJCgnLnBoLXBlcnNvbi1jb3Vyc2VzJykuc2hvdygpOw0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgICAgICBjYXNlIDI6DQogICAgICAgICAgICAgICAgICAgICQoJy5waC1wZXJzb24tYWN0aXZpdGllcycpLnNob3coKTsNCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgY2FzZSAzOg0KICAgICAgICAgICAgICAgICAgICAkKCcucGgtcGVyc29uLXB1YmxpY2F0aW9ucycpLnNob3coKTsNCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgY2FzZSA0Og0KICAgICAgICAgICAgICAgICAgICAkKCcucGgtcGVyc29uLWV2ZW50cycpLnNob3coKTsNCiAgICAgICAgICAgICAgICAgICAgYnJlYWs7DQogICAgICAgICAgICAgICAgZGVmYXVsdDoNCiAgICAgICAgICAgICAgICAgICAgJCgnLnBoLXBlcnNvbi1ob21lJykuc2hvdygpOw0KICAgICAgICAgICAgICAgICAgICBicmVhazsNCiAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICB9Ow0KDQogICAgICAgIHNldEFjdGl2ZSgwKTsNCiAgICB9DQoNCiAgICByZXR1cm4gew0KICAgICAgICBJbml0aWFsaXplOiBpbml0DQogICAgfTsNCn0oalF1ZXJ5KTs7DQovKioNCiogVUFsYmVydGEgUGVyc29uIFByb2ZpbGUNCiogQXV0aG9yOiBEYW5pZWwgU2FuYWJyaWEgLSBzYW5hYnJpYUB1YWxiZXJ0YS5jYQ0KKi8NCg0KLy8gYnVpbGQgbmFtZXNwYWNlDQp2YXIgVUFsYmVydGEgPSBVQWxiZXJ0YSB8fCB7fTsNClVBbGJlcnRhLlNpdGVjb3JlID0gVUFsYmVydGEuU2l0ZWNvcmUgfHwge307DQoNClVBbGJlcnRhLlNpdGVjb3JlLlBlcnNvblByb2ZpbGUgPSBVQWxiZXJ0YS5TaXRlY29yZS5QZXJzb25Qcm9maWxlIHx8IChmdW5jdGlvbiAoKSB7DQogICAgZnVuY3Rpb24gZ2V0SW5zdGFuY2UoKSB7DQogICAgICAgIHJldHVybiAoZnVuY3Rpb24gKCQpIHsNCiAgICAgICAgICAgICd1c2Ugc3RyaWN0JzsNCiAgICAgICAgICAgIHZhciBEYXRhID0gew0KICAgICAgICAgICAgICAgIGl0ZW1zOiBbXSwgLy8gaXRlbXMNCiAgICAgICAgICAgICAgICBpdGVtc1BlclBhZ2U6IDEwLCAvLyBpdGVtcyBwZXIgcGFnZQ0KICAgICAgICAgICAgICAgIC8vIENvbnN0YW50IHZhbHVlcw0KICAgICAgICAgICAgICAgIENvbnN0YW50czogew0KICAgICAgICAgICAgICAgICAgICAvLyBNZWRpYSB0eXBlcw0KICAgICAgICAgICAgICAgICAgICBNb2R1bGVzOiB7DQogICAgICAgICAgICAgICAgICAgICAgICBQdWJsaWNhdGlvbnM6ICJQdWJsaWNhdGlvbnMiLA0KICAgICAgICAgICAgICAgICAgICAgICAgQ291cnNlczogIkNvdXJzZXMiLA0KICAgICAgICAgICAgICAgICAgICAgICAgU2Nob2xhcmx5OiAiU2Nob2xhcmx5Ig0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgQUpBWCA9IHsNCiAgICAgICAgICAgICAgICAvLyBnZXQgY29udGVudCBmcm9tIHdlYiBzZXJ2aWNlDQogICAgICAgICAgICAgICAgZ2V0Q29udGVudDogZnVuY3Rpb24gKHdlYlNlcnZpY2VVcmwpIHsNCiAgICAgICAgICAgICAgICAgICAgLy8gZ2V0IGNvbnRlbnQgZnJvbSB3ZWIgc2VydmljZQ0KICAgICAgICAgICAgICAgICAgICAkLmFqYXgoew0KICAgICAgICAgICAgICAgICAgICAgICAgZGF0YVR5cGU6ICJqc29uIiwNCiAgICAgICAgICAgICAgICAgICAgICAgIHVybDogd2ViU2VydmljZVVybCwNCiAgICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiBBSkFYLkV2ZW50cy5lcnJvciwNCiAgICAgICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uIChkYXRhKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgQUpBWC5FdmVudHMuc3VjY2VzcyhkYXRhKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgICAgIEV2ZW50czogew0KICAgICAgICAgICAgICAgICAgICBlcnJvcjogZnVuY3Rpb24gKGhyLCB0ZXh0U3RhdHVzLCBlcnJvclRocm93bikgew0KICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLnNob3dDb250ZW50KCI8cD5BbiBlcnJvciBvY2N1cnJlZCB3aGlsZSBsb2FkaW5nIHRoaXMgY29udGVudC4gUGxlYXNlIHJlZnJlc2ggdGhlIHBhZ2UgYW5kIHRyeSBhZ2Fpbi48YnI+RXJyb3I6ICIgKyBlcnJvclRocm93bi50ZXh0ICsgIjwvcD4iKTsNCiAgICAgICAgICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoZGF0YSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgRGF0YS5pdGVtcyA9IGRhdGE7DQogICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2Uuc2hvd0l0ZW1zKCk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICB9LA0KDQogICAgICAgICAgICBJbnRlcmZhY2UgPSB7DQogICAgICAgICAgICAgICAgbW9kdWxlOiIiLA0KICAgICAgICAgICAgICAgIGl0ZW1zQ29udHJvbDogW10sIC8vIGl0ZW1zIGNvbnRyb2wNCiAgICAgICAgICAgICAgICBpdGVtc1BhZ2luZ0NvbnRyb2w6IFtdLCAvLyBpdGVtIHBhZ2luZyBjb250cm9sDQogICAgICAgICAgICAgICAgaXRlbXNWaXNpYmxlOiBbXSwgLy8gdGhlIGl0ZW1zIHRoYXQgY2FuIGJlIHNlZW4gKGJhc2VkIG9uIGZpbHRlcnMpLCB1c2VkIGZvciBwYWdpbmcNCg0KICAgICAgICAgICAgICAgIC8vIHNldHVwIHRoZSBpbnRlcmZhY2UNCiAgICAgICAgICAgICAgICBzZXR1cDogZnVuY3Rpb24gKGNvbnRhaW5lcklkLCBtb2R1bGUpIHsNCiAgICAgICAgICAgICAgICAgICAgLy8gZ2V0IGludGVyZmFjZSBjb21wb25lbnRzDQogICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5tb2R1bGUgPSBtb2R1bGU7DQogICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5pdGVtc0NvbnRyb2wgPSAkKCIjIiArIGNvbnRhaW5lcklkICsgIiAjY29udHJvbC1pdGVtcyIpOw0KICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UuaXRlbXNQYWdpbmdDb250cm9sID0gJCgiIyIgKyBjb250YWluZXJJZCArICIgLmV2ZW50cy1wYWdpbmF0aW9uIik7DQogICAgICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgICAgIC8vIHNob3cgaXRlbXMNCiAgICAgICAgICAgICAgICBzaG93SXRlbXM6IGZ1bmN0aW9uICgpIHsNCg0KICAgICAgICAgICAgICAgICAgICB2YXIgcGFnZSA9IDE7DQogICAgICAgICAgICAgICAgICAgIC8vIHJlbW92ZSBsb2FkZXINCiAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLml0ZW1zQ29udHJvbC5maW5kKCJsaTpmaXJzdCIpLnJlbW92ZSgpOw0KDQogICAgICAgICAgICAgICAgICAgIC8vIGlmIG5vIHJlY29yZHMsIHNob3cgbWVzc2FnZQ0KICAgICAgICAgICAgICAgICAgICBpZiAoRGF0YS5pdGVtcy5sZW5ndGggPT0gMCB8fCBEYXRhLml0ZW1zWzBdLkl0ZW1zID09IDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICQoIiNuYXYiICsgSW50ZXJmYWNlLm1vZHVsZSkuaGlkZSgpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgaWYgKEludGVyZmFjZS5tb2R1bGUgPT0gRGF0YS5Db25zdGFudHMuTW9kdWxlcy5QdWJsaWNhdGlvbnMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVtcHR5IHRoZSB2aWV3YWJsZSBpdGVtcyBsaXN0DQogICAgICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UuaXRlbXNWaXNpYmxlLmxlbmd0aCA9IDA7DQoNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vU29ydGluZyBJdGVtcyBieSBEYXRlDQogICAgICAgICAgICAgICAgICAgICAgICBEYXRhLml0ZW1zWzBdLkl0ZW1zLnNvcnQoZnVuY3Rpb24gKGEsIGIpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZDEgPSBEYXRlLnBhcnNlKGEuRGF0ZS5sZW5ndGggPT0gNiA/IGEuRGF0ZS5pbnNlcnQoNCwgMCwgIi0iKSA6IGEuRGF0ZS5sZW5ndGggPT0gOCA/IGEuRGF0ZS5pbnNlcnQoNCwgMCwgIi0iKS5pbnNlcnQoNywgMCwgIi0iKSA6IGEuRGF0ZSk7IC8vICItIiBpcyBhZGRlZCBmb3IgcGFyc2luZw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBkMiA9IERhdGUucGFyc2UoYi5EYXRlLmxlbmd0aCA9PSA2ID8gYi5EYXRlLmluc2VydCg0LCAwLCAiLSIpIDogYi5EYXRlLmxlbmd0aCA9PSA4ID8gYi5EYXRlLmluc2VydCg0LCAwLCAiLSIpLmluc2VydCg3LCAwLCAiLSIpIDogYi5EYXRlKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gKChkMSA8IGQyKSA/IDEgOiAoKGQxID4gZDIpID8gLTEgOiAwKSk7DQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgLy8gcHJvY2VzcyBpdGVtcw0KICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgeCBpbiBEYXRhLml0ZW1zWzBdLkl0ZW1zKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW0gPSBEYXRhLml0ZW1zWzBdLkl0ZW1zW3hdOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEhBQ0s6IEVuc3VyZSB3ZSBhcmUgb25seSBwcm9jZXNzaW5nIGFjdHVhbCBpdGVtcw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpdGVtLklkID09IHVuZGVmaW5lZCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAvLyBhZGQgaXRlbSB0byB2aWV3YWJsZSBsaXN0DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLml0ZW1zVmlzaWJsZS5wdXNoKGl0ZW0pOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLnNob3dQYWdlKHBhZ2UpOw0KICAgICAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgICAgICByZW5kZXJJdGVtczogZnVuY3Rpb24oY2hpbGQsIGFjY29yZGlvbikgew0KICAgICAgICAgICAgICAgICAgICANCiAgICAgICAgICAgICAgICAgICAgdmFyIGh0bWwgPSAiIjsNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIGlmIChhY2NvcmRpb24pIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWwgKz0gIjxsaT48dWwgY2xhc3M9J3Blb3BsZS1hY2NvcmRpb24tY29udGVudCc+IjsNCiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGh0bWwgKz0gIjxsaT48dWw+IjsNCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIHZhciBkYXRlcyA9ICIiOw0KICAgICAgICAgICAgICAgICAgICB2YXIgZmllbGRzVG9FeGNsdWRlID0gWyJUZXJtIiwgIlR5cGUiLCAiQ2F0ZWdvcnkiXTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGJvb2xlYW5GaWVsZHMgPSBbIkluc3RydWN0b3IiLCAiQ29vcmRpbmF0b3IiXTsNCiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgayBpbiBjaGlsZC5GaWVsZHMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjaGlsZC5GaWVsZHNba10gIT0gIiIgJiYgZmllbGRzVG9FeGNsdWRlLmluZGV4T2YoaykgPT0gLTEpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoay50b0xvd2VyQ2FzZSgpLmluZGV4T2YoInRpdGxlIikgPiAtMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sICs9ICI8bGk+PGg1PiIgKyBjaGlsZC5GaWVsZHNba10gKyAiPC9oNT48L2xpPiI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGJvb2xlYW5GaWVsZHMuaW5kZXhPZihrKSA+IC0xKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sICs9ICI8bGk+PHN0cm9uZz4iICsgayArICI8L3N0cm9uZz48L2xpPiI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoay50b0xvd2VyQ2FzZSgpLmluZGV4T2YoImRvY3VtZW50cyBhbmQgaW1hZ2VzIikgPiAtMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsaW5rcyA9IEludGVyZmFjZS5nZXRLZXlMaW5rTGlzdChjaGlsZC5GaWVsZHNba10pOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChsaW5rcyAhPSAiIikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sICs9ICI8bGk+PHN0cm9uZz4iICsgayArICI6IDwvc3Ryb25nPjwvbGk+IiArIGxpbmtzOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoY2hpbGQuRmllbGRzW2tdKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gQ2hlY2tpbmcgaWYgZGF0ZSBpcyB2YWxpZA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjaGlsZC5GaWVsZHNba10ubGVuZ3RoIDwgMjUgJiYgKEludGVyZmFjZS5pc1ZhbGlkRGF0ZShjaGlsZC5GaWVsZHNba10pIHx8IGsudG9Mb3dlckNhc2UoKS5pbmRleE9mKCJkYXRlIikgIT0gLTEpKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB2ZGF0ZSA9IGNoaWxkLkZpZWxkc1trXS5sZW5ndGggPT0gNiA/IGNoaWxkLkZpZWxkc1trXS5pbnNlcnQoNCwgMCwgIi0iKSA6DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNoaWxkLkZpZWxkc1trXS5sZW5ndGggPT0gOCA/IGNoaWxkLkZpZWxkc1trXS5pbnNlcnQoNCwgMCwgIi0iKS5pbnNlcnQoNywwLCItIikgOiBjaGlsZC5GaWVsZHNba10uc3Vic3RyKDAsIDEwKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGsudG9Mb3dlckNhc2UoKS5pbmRleE9mKCJzdGFydCIpICE9IC0xIHx8IGsudG9Mb3dlckNhc2UoKS5pbmRleE9mKCJlbmQiKSAhPSAtMSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGsudG9Mb3dlckNhc2UoKS5pbmRleE9mKCJzdGFydCIpICE9IC0xKSBkYXRlcyA9IHZkYXRlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSBpZiAoay50b0xvd2VyQ2FzZSgpLmluZGV4T2YoImVuZCIpICE9IC0xKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGRhdGVzID09ICIiKSBkYXRlcyA9ICJcIiIgKyB2ZGF0ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGRhdGVzICs9ICIgdG8gIiArIHZkYXRlOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWwgKz0gIjxsaT4iICsgZGF0ZXMudG9TdHJpbmcoJ01NTU0gZCwgeXl5eScpICsgIjwvbGk+IjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWwgKz0gIjxsaT48c3Ryb25nPiIgKyBrICsgIjogPC9zdHJvbmc+IiArIHZkYXRlICsgIjwvbGk+IjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGsudG9Mb3dlckNhc2UoKS5pbmRleE9mKCJhdXRob3IiKSA+IC0xKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sICs9ICI8bGk+PHN0cm9uZz4iICsgayArICIocyk6IDwvc3Ryb25nPiIgKyBjaGlsZC5GaWVsZHNba10gKyAiPC9saT4iOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGsuaW5kZXhPZigiTGluayIpICE9IC0xKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGxpbmsgPSAiPGEgaHJlZj0nIiArIGNoaWxkLkZpZWxkc1trXSArICInIHRhcmdldD0nX2JsYW5rJz4iICsgY2hpbGQuRmllbGRzW2tdICsgIjwvYT4iOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWwgKz0gIjxsaT48c3Ryb25nPiIgKyBrICsgIjogPC9zdHJvbmc+IiArIGxpbmsgKyAiPC9saT4iOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoay50b0xvd2VyQ2FzZSgpLmluZGV4T2YoImRlc2NyaXB0aW9uIikgIT0gLTEgJiYgSW50ZXJmYWNlLm1vZHVsZSA9PSBEYXRhLkNvbnN0YW50cy5Nb2R1bGVzLlB1YmxpY2F0aW9ucykgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sICs9ICI8bGk+PGRpdiBjbGFzcz0ncHVibGljYXRpb24tZGVzY3JpcHRpb24nPjxzdHJvbmc+IiArIGsgKyAiOiA8L3N0cm9uZz4iICsgY2hpbGQuRmllbGRzW2tdICsgIjwvZGl2PjwvbGk+IjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sICs9ICI8bGk+PHN0cm9uZz4iICsgayArICI6IDwvc3Ryb25nPiIgKyBjaGlsZC5GaWVsZHNba10gKyAiPC9saT4iOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICAgICAgICAgIGh0bWwgKz0gIjwvdWw+PC9saT4iOw0KDQogICAgICAgICAgICAgICAgICAgIHJldHVybiBodG1sOw0KICAgICAgICAgICAgICAgIH0sDQoNCiAgICAgICAgICAgICAgICAvLyBzaG93IHNlbGVjdGVkIHBhZ2Ugb2YgaXRlbXMNCiAgICAgICAgICAgICAgICBzaG93UGFnZTogZnVuY3Rpb24gKHBhZ2UpIHsNCiAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5pdGVtc0NvbnRyb2wuaHRtbCgiIik7DQoNCiAgICAgICAgICAgICAgICAgICAgdmFyIGFjY29yZGlvbjsNCiAgICAgICAgICAgICAgICAgICAgdmFyIGh0bWwgPSAiPHVsIGNsYXNzPSdhY2NvcmRpb24tbGlzdCc+IjsNCg0KICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpIGluIERhdGEuaXRlbXMpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBwYXJlbnQgPSBEYXRhLml0ZW1zW2ldOw0KDQogICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFyZW50Lkl0ZW1zICE9IDApIHsNCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjY29yZGlvbiA9IHBhcmVudC5OYW1lICE9ICJJdGVtcyI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFjY29yZGlvbikgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sICs9ICI8bGk+IjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaHRtbCArPSAiPGE+IiArIHBhcmVudC5OYW1lICsgIjwvYT4iOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sICs9ICI8YSBjbGFzcz0nYWNjb3JkaW9uLXRvZ2dsZSBpY29uLXBsdXMnPjwvYT4iOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sICs9ICI8dWwgY2xhc3M9J3Blb3BsZS1hY2NvcmRpb24nPiI7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaHRtbCA9ICI8dWwgY2xhc3M9J3Blb3BsZS1jb250ZW50Jz4iOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChJbnRlcmZhY2UubW9kdWxlID09IERhdGEuQ29uc3RhbnRzLk1vZHVsZXMuUHVibGljYXRpb25zKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGogPSAocGFyc2VJbnQocGFnZSkgLSAxKSAqIERhdGEuaXRlbXNQZXJQYWdlOyBqIDwgRGF0YS5pdGVtc1BlclBhZ2UgKiBwYWdlOyBqKyspIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwYXJlbnQuSXRlbXNbal0gPT0gdW5kZWZpbmVkKSBjb250aW51ZTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWwgKz0gSW50ZXJmYWNlLnJlbmRlckl0ZW1zKHBhcmVudC5JdGVtc1tqXSwgYWNjb3JkaW9uKTsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGsgaW4gcGFyZW50Lkl0ZW1zKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocGFyZW50Lkl0ZW1zW2tdID09IHVuZGVmaW5lZCkgY29udGludWU7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sICs9IEludGVyZmFjZS5yZW5kZXJJdGVtcyhwYXJlbnQuSXRlbXNba10sIGFjY29yZGlvbik7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWNjb3JkaW9uKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWwgKz0gIjwvdWw+PC9saT4iOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWwgKz0gIjwvdWw+IjsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIH0NCg0KICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2UuaXRlbXNDb250cm9sLmFwcGVuZChodG1sKTsNCiAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLml0ZW1zQ29udHJvbC5maW5kKCIuYWNjb3JkaW9uLWxpc3QgbGk6Zmlyc3QtY2hpbGQiKS50b2dnbGVDbGFzcygnZXhwYW5kZWQnKTsNCiAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLml0ZW1zQ29udHJvbC5maW5kKCIuYWNjb3JkaW9uLXRvZ2dsZSIpLmNsaWNrKGZ1bmN0aW9uICgpIHsgJCh0aGlzKS5wYXJlbnQoKS50b2dnbGVDbGFzcygnZXhwYW5kZWQnKTsgcmV0dXJuIGZhbHNlOyB9KTsNCiAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLml0ZW1zQ29udHJvbC5maW5kKCIucHVibGljYXRpb24tZGVzY3JpcHRpb24iKS5zaG9ydGVuKHsgc2hvd0NoYXJzOiA3NSwgbW9yZVRleHQ6ICdyZWFkIG1vcmUnLCBsZXNzVGV4dDogJ3JlYWQgbGVzcycgfSk7DQoNCiAgICAgICAgICAgICAgICAgICAgJCgnLnBlb3BsZS1zZWN0aW9uLW5hdicpLnNob3coKTsNCiAgICAgICAgICAgICAgICAgICAgJCgnLnBlb3BsZS1uYXYtY29udCcpLnNob3coKTsNCg0KICAgICAgICAgICAgICAgICAgICAvLyBzaG93IHBhZ2luZw0KICAgICAgICAgICAgICAgICAgICBJbnRlcmZhY2Uuc2hvd1BhZ2luZyhwYWdlKTsNCiAgICAgICAgICAgICAgICB9LA0KDQogICAgICAgICAgICAgICAgLy8gc2hvdyBwYWdpbmcgbGlua3MNCiAgICAgICAgICAgICAgICBzaG93UGFnaW5nOiBmdW5jdGlvbiAocGFnZSkgew0KICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayBmb3IgZW1wdHkgbGlzdA0KICAgICAgICAgICAgICAgICAgICBpZiAoSW50ZXJmYWNlLml0ZW1zVmlzaWJsZS5sZW5ndGggPT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHZhciBodG1sID0gIiI7DQogICAgICAgICAgICAgICAgICAgIC8vIGFkZCBwYWdlcw0KICAgICAgICAgICAgICAgICAgICB2YXIgYWN0aXZlUGFnZSA9IHBhcnNlSW50KHBhZ2UpOw0KICAgICAgICAgICAgICAgICAgICB2YXIgbWF4UGFnZSA9IE1hdGguY2VpbChJbnRlcmZhY2UuaXRlbXNWaXNpYmxlLmxlbmd0aCAvIERhdGEuaXRlbXNQZXJQYWdlKTsNCiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDE7IGkgPD0gbWF4UGFnZTsgaSsrKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAvLyBjaGVjayBmb3IgYWN0aXZlIHBhZ2UNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpID09IGFjdGl2ZVBhZ2UpIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sICs9ICc8bGkgY2xhc3M9ImFjdGl2ZSI+JyArIGkgKyAnPC9saT4nOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBodG1sICs9ICc8bGk+PGEgaHJlZj0iamF2YXNjcmlwdDp2b2lkKG51bGwpIj4nICsgaSArICc8L2E+PC9saT4nOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQoNCiAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLml0ZW1zUGFnaW5nQ29udHJvbC5odG1sKCIiKTsNCiAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLml0ZW1zUGFnaW5nQ29udHJvbC5hcHBlbmQoaHRtbCk7DQogICAgICAgICAgICAgICAgICAgIC8vIGFkZCBjbGljayBoYW5kbGVyDQogICAgICAgICAgICAgICAgICAgIEludGVyZmFjZS5pdGVtc1BhZ2luZ0NvbnRyb2wuZmluZCgiYSIpLmNsaWNrKEludGVyZmFjZS5wYWdlQ2xpY2tlZCk7DQogICAgICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgICAgIC8vIGEgcGFnZSB3YXMgY2xpY2tlZCBvbiwgY2hhbmdlIHZpZXcgdG8gdGhhdCBwYWdlDQogICAgICAgICAgICAgICAgcGFnZUNsaWNrZWQ6IGZ1bmN0aW9uICgpIHsNCiAgICAgICAgICAgICAgICAgICAgLy8gc2hvdyBjbGlja2VkIHBhZ2UNCiAgICAgICAgICAgICAgICAgICAgSW50ZXJmYWNlLnNob3dQYWdlKCQodGhpcykuaHRtbCgpKTsNCiAgICAgICAgICAgICAgICB9LA0KDQogICAgICAgICAgICAgICAgaW5zZXJ0OiBTdHJpbmcucHJvdG90eXBlLmluc2VydCA9IGZ1bmN0aW9uKCBpZHgsIHJlbSwgc3RyICkgew0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gKHRoaXMuc2xpY2UoMCxpZHgpICsgc3RyICsgdGhpcy5zbGljZShpZHggKyBNYXRoLmFicyhyZW0pKSk7DQogICAgICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgICAgIGlzVmFsaWREYXRlOiBmdW5jdGlvbihkYXRlU3RyKSB7DQogICAgICAgICAgICAgICAgICAgIHZhciBkYXksIG1vbnRoLCB5ZWFyOw0KICAgICAgICAgICAgICAgICAgICBpZiAoZGF0ZVN0ciA9PSBudWxsIHx8IGRhdGVTdHIubGVuZ3RoIDwgOCkgcmV0dXJuIGZhbHNlOw0KDQogICAgICAgICAgICAgICAgICAgIC8vIENoZWNrcyBmb3IgdGhlIGZvbGxvd2luZyB2YWxpZCBkYXRlIGZvcm1hdHM6IFlZWVktTU0tREQNCiAgICAgICAgICAgICAgICAgICAgLy8gQWxzbyBzZXBhcmF0ZXMgZGF0ZSBpbnRvIG1vbnRoLCBkYXksIGFuZCB5ZWFyIHZhcmlhYmxlcw0KICAgICAgICAgICAgICAgICAgICB2YXIgZGF0ZVBhdCA9IC9eKFxkezR9KShbXC8tXSk/KFxkezEsMn0pXDI/KFxkezEsMn0pJC87DQoNCiAgICAgICAgICAgICAgICAgICAgdmFyIG1hdGNoQXJyYXkgPSBkYXRlU3RyLnN1YnN0cmluZygwLDEwKS5tYXRjaChkYXRlUGF0KTsgLy8gaXMgdGhlIGZvcm1hdCBvaz8NCiAgICAgICAgICAgICAgICAgICAgaWYgKG1hdGNoQXJyYXkgPT0gbnVsbCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgLy9jb25zb2xlLmxvZygiRGF0ZSBtdXN0IGJlIGluIFlZWVkvTU0vREQgZm9ybWF0ICgiICsgZGF0ZVN0ciArICIpIik7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgeWVhciA9IG1hdGNoQXJyYXlbMV07ICAgLy8gcGFyc2UgZGF0ZSBpbnRvIHZhcmlhYmxlcw0KICAgICAgICAgICAgICAgICAgICBtb250aCA9IG1hdGNoQXJyYXlbM107IA0KICAgICAgICAgICAgICAgICAgICBkYXkgPSBtYXRjaEFycmF5WzRdOw0KICAgICAgICAgICAgICAgICAgICBpZiAobW9udGggPCAxIHx8IG1vbnRoID4gMTIpIHsgLy8gY2hlY2sgbW9udGggcmFuZ2UNCiAgICAgICAgICAgICAgICAgICAgICAgIC8vYWxlcnQoIk1vbnRoIG11c3QgYmUgYmV0d2VlbiAxIGFuZCAxMiIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGlmIChkYXkgPCAxIHx8IGRheSA+IDMxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAvL2FsZXJ0KCJEYXkgbXVzdCBiZSBiZXR3ZWVuIDEgYW5kIDMxIik7DQogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgaWYgKChtb250aCA9PSA0IHx8IG1vbnRoID09IDYgfHwgbW9udGggPT0gOSB8fCBtb250aCA9PSAxMSkgJiYgZGF5ID09IDMxKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAvL2FsZXJ0KCJNb250aCAiICsgbW9udGggKyAiIGRvZXNuJ3QgaGF2ZSAzMSBkYXlzISIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIGlmIChtb250aCA9PSAyKSB7IC8vIGNoZWNrIGZvciBmZWJydWFyeSAyOXRoDQogICAgICAgICAgICAgICAgICAgICAgICB2YXIgaXNsZWFwID0gKHllYXIgJSA0ID09IDAgJiYgKHllYXIgJSAxMDAgIT0gMCB8fCB5ZWFyICUgNDAwID09IDApKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChkYXkgPiAyOSB8fCAoZGF5ID09IDI5ICYmICFpc2xlYXApKSB7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9hbGVydCgiRmVicnVhcnkgIiArIHllYXIgKyAiIGRvZXNuJ3QgaGF2ZSAiICsgZGF5ICsgIiBkYXlzISIpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsNCiAgICAgICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsgIC8vIGRhdGUgaXMgdmFsaWQNCiAgICAgICAgICAgICAgICB9LA0KDQogICAgICAgICAgICAgICAgZ2V0S2V5TGlua0xpc3Q6IGZ1bmN0aW9uKGFycmF5cykgew0KICAgICAgICAgICAgICAgICAgICB2YXIgbGlua3MgPSBhcnJheXMuc3BsaXQoJ3wnKTsNCiAgICAgICAgICAgICAgICAgICAgdmFyIHJlZ2V4ID0gL15ce1x3ezh9LVx3ezR9LVx3ezR9LVx3ezR9LVx3ezEyfVx9JC87DQogICAgICAgICAgICAgICAgICAgIHZhciBodG1sTGlua3MgPSAiIjsNCiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaXRlbSBpbiBsaW5rcykgew0KICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGl0ZW1JZCA9IGxpbmtzW2l0ZW1dLnJlcGxhY2UoL1xXL2csICcnKTsNCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZWdleC50ZXN0KGxpbmtzW2l0ZW1dKSkgew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxMaW5rcyArPSAiPGxpPjxhIGhyZWY9Jy8tL21lZGlhLyIgKyBpdGVtSWQgKyAiJyB0YXJnZXQgPSAnX2JsYW5rJyA+RG9jdW1lbnQ8L2E+PC9saT4iOw0KICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbGlua3NBcnJheSA9IGV2YWwoJygnICsgbGlua3NbaXRlbV0gKyAnKScpOw0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGh0bWxMaW5rcyArPSAiPGxpPjxhIGhyZWY9JyIgKyBsaW5rc0FycmF5LlVSTCArICInIHRhcmdldCA9ICdfYmxhbmsnID4iICsgbGlua3NBcnJheS5UaXRsZSArICI8L2E+PC9saT4iOw0KICAgICAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgICAgICB9DQogICAgICAgICAgICAgICAgICAgIHJldHVybiBodG1sTGlua3M7DQogICAgICAgICAgICAgICAgfSwNCg0KICAgICAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbiAoKSB7DQogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGNvbnRlbnQpOw0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH07DQoNCiAgICAgICAgICAgIC8vIGluc3RhbmNlIGluaXRpYWxpemF0aW9uDQogICAgICAgICAgICBmdW5jdGlvbiBpbml0KGNvbnRhaW5lcklkLCB3ZWJTZXJ2aWNlVXJsLCBtb2R1bGUpIHsNCiAgICAgICAgICAgICAgICBJbnRlcmZhY2Uuc2V0dXAoY29udGFpbmVySWQsIG1vZHVsZSk7DQogICAgICAgICAgICAgICAgQUpBWC5nZXRDb250ZW50KHdlYlNlcnZpY2VVcmwpOw0KICAgICAgICAgICAgfQ0KDQogICAgICAgICAgICByZXR1cm4gew0KICAgICAgICAgICAgICAgIEluaXRpYWxpemU6IGluaXQNCiAgICAgICAgICAgIH07DQogICAgICAgIH0oalF1ZXJ5KSk7DQogICAgfQ0KDQogICAgcmV0dXJuIHsNCiAgICAgICAgR2V0SW5zdGFuY2U6IGdldEluc3RhbmNlDQogICAgfTsNCn0oKSk7Ow0KLyoNCiAqIGpRdWVyeSBTaG9ydGVuIHBsdWdpbiAxLjEuMA0KICoNCiAqIENvcHlyaWdodCAoYykgMjAxNCBWaXJhbCBQYXRlbA0KICogaHR0cDovL3ZpcmFscGF0ZWwubmV0DQogKg0KICogTGljZW5zZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlOg0KICogICBodHRwOi8vd3d3Lm9wZW5zb3VyY2Uub3JnL2xpY2Vuc2VzL21pdC1saWNlbnNlLnBocA0KICovDQoNCi8qDQoqKiB1cGRhdGVkIGJ5IEplZmYgUmljaGFyZHNvbg0KKiogVXBkYXRlZCB0byB1c2Ugc3RyaWN0LA0KKiogSUUgNyBoYXMgYSAiYnVnIiBJdCBpcyByZXR1cm5pbmcgdW5kZXJmaW5lZCB3aGVuIHRyeWluZyB0byByZWZlcmVuY2Ugc3RyaW5nIGNoYXJhY3RlcnMgaW4gdGhpcyBmb3JtYXQNCioqIGNvbnRlbnRbaV0uIElFIDcgYWxsb3dzIGNvbnRlbnQuY2hhckF0KGkpIFRoaXMgd29ya3MgZmluZSBpbiBhbGwgbW9kZXJuIGJyb3dzZXJzLg0KKiogSSd2ZSBhbHNvIGFkZGVkIGJyYWNrZXRzIHdoZXJlIHRoZXkgd2VyZW50IGFkZGVkIGp1c3QgZm9yIHJlYWRhYmlsaXR5IChtb3N0bHkgZm9yIG1lKS4NCiovDQoNCihmdW5jdGlvbiAoJCkgew0KCSQuZm4uc2hvcnRlbiA9IGZ1bmN0aW9uIChzZXR0aW5ncykgew0KCQkidXNlIHN0cmljdCI7DQoNCgkJdmFyIGNvbmZpZyA9IHsNCgkJCXNob3dDaGFyczogMTAwLA0KCQkJZWxsaXBzZXNUZXh0OiAiLi4uIiwNCgkJCW1vcmVUZXh0OiAibW9yZSIsDQoJCQlsZXNzVGV4dDogImxlc3MiLA0KCQkJZXJyTXNnOiBudWxsLA0KCQkJZm9yY2U6IGZhbHNlDQoJCX07DQoNCgkJaWYgKHNldHRpbmdzKSB7DQoJCQkkLmV4dGVuZChjb25maWcsIHNldHRpbmdzKTsNCgkJfQ0KDQoJCWlmICgkKHRoaXMpLmRhdGEoJ2pxdWVyeS5zaG9ydGVuJykgJiYgIWNvbmZpZy5mb3JjZSkgew0KCQkJcmV0dXJuIGZhbHNlOw0KCQl9DQoJCSQodGhpcykuZGF0YSgnanF1ZXJ5LnNob3J0ZW4nLCB0cnVlKTsNCg0KCQkkKGRvY3VtZW50KS5vZmYoImNsaWNrIiwgJy5tb3JlbGluaycpOw0KDQoJCSQoZG9jdW1lbnQpLm9uKHsNCgkJCWNsaWNrOiBmdW5jdGlvbiAoKSB7DQoNCgkJCQl2YXIgJHRoaXMgPSAkKHRoaXMpOw0KCQkJCWlmICgkdGhpcy5oYXNDbGFzcygnbGVzcycpKSB7DQoJCQkJCSR0aGlzLnJlbW92ZUNsYXNzKCdsZXNzJyk7DQoJCQkJCSR0aGlzLmh0bWwoY29uZmlnLm1vcmVUZXh0KTsNCgkJCQkJJHRoaXMucGFyZW50KCkucHJldigpLnByZXYoKS5zaG93KCk7IC8vIHNob3J0Y29udGVudA0KCQkJCQkkdGhpcy5wYXJlbnQoKS5wcmV2KCkuaGlkZSgpOyAvLyBhbGxjb250ZW50DQoNCgkJCQl9IGVsc2Ugew0KCQkJCQkkdGhpcy5hZGRDbGFzcygnbGVzcycpOw0KCQkJCQkkdGhpcy5odG1sKGNvbmZpZy5sZXNzVGV4dCk7DQoJCQkJCSR0aGlzLnBhcmVudCgpLnByZXYoKS5wcmV2KCkuaGlkZSgpOyAvLyBzaG9ydGNvbnRlbnQNCgkJCQkJJHRoaXMucGFyZW50KCkucHJldigpLnNob3coKTsgLy8gYWxsY29udGVudA0KCQkJCX0NCgkJCQlyZXR1cm4gZmFsc2U7DQoJCQl9DQoJCX0sICcubW9yZWxpbmsnKTsNCg0KCQlyZXR1cm4gdGhpcy5lYWNoKGZ1bmN0aW9uICgpIHsNCgkJCXZhciAkdGhpcyA9ICQodGhpcyk7DQoNCgkJCXZhciBjb250ZW50ID0gJHRoaXMuaHRtbCgpOw0KCQkJdmFyIGNvbnRlbnRsZW4gPSAkdGhpcy50ZXh0KCkubGVuZ3RoOw0KCQkJaWYgKGNvbnRlbnRsZW4gPiBjb25maWcuc2hvd0NoYXJzKSB7DQoJCQkJdmFyIGMgPSBjb250ZW50LnN1YnN0cigwLCBjb25maWcuc2hvd0NoYXJzKTsNCgkJCQlpZiAoYy5pbmRleE9mKCc8JykgPj0gMCkgLy8gSWYgdGhlcmUncyBIVE1MIGRvbid0IHdhbnQgdG8gY3V0IGl0DQoJCQkJew0KCQkJCQl2YXIgaW5UYWcgPSBmYWxzZTsgLy8gSSdtIGluIGEgdGFnPw0KCQkJCQl2YXIgYmFnID0gJyc7IC8vIFB1dCB0aGUgY2hhcmFjdGVycyB0byBiZSBzaG93biBoZXJlDQoJCQkJCXZhciBjb3VudENoYXJzID0gMDsgLy8gQ3VycmVudCBiYWcgc2l6ZQ0KCQkJCQl2YXIgb3BlblRhZ3MgPSBbXTsgLy8gU3RhY2sgZm9yIG9wZW5lZCB0YWdzLCBzbyBJIGNhbiBjbG9zZSB0aGVtIGxhdGVyDQoJCQkJCXZhciB0YWdOYW1lID0gbnVsbDsNCg0KCQkJCQlmb3IgKHZhciBpID0gMCwgciA9IDA7IHIgPD0gY29uZmlnLnNob3dDaGFyczsgaSsrKSB7DQoJCQkJCQlpZiAoY29udGVudFtpXSA9PSAnPCcgJiYgIWluVGFnKSB7DQoJCQkJCQkJaW5UYWcgPSB0cnVlOw0KDQoJCQkJCQkJLy8gVGhpcyBjb3VsZCBiZSAidGFnIiBvciAiL3RhZyINCgkJCQkJCQl0YWdOYW1lID0gY29udGVudC5zdWJzdHJpbmcoaSArIDEsIGNvbnRlbnQuaW5kZXhPZignPicsIGkpKTsNCg0KCQkJCQkJCS8vIElmIGl0cyBhIGNsb3NpbmcgdGFnDQoJCQkJCQkJaWYgKHRhZ05hbWVbMF0gPT0gJy8nKSB7DQoNCg0KCQkJCQkJCQlpZiAodGFnTmFtZSAhPSAnLycgKyBvcGVuVGFnc1swXSkgew0KCQkJCQkJCQkJY29uZmlnLmVyck1zZyA9ICdFUlJPUiBlbiBIVE1MOiB0aGUgdG9wIG9mIHRoZSBzdGFjayBzaG91bGQgYmUgdGhlIHRhZyB0aGF0IGNsb3Nlcyc7DQoJCQkJCQkJCX0gZWxzZSB7DQoJCQkJCQkJCQlvcGVuVGFncy5zaGlmdCgpOyAvLyBQb3BzIHRoZSBsYXN0IHRhZyBmcm9tIHRoZSBvcGVuIHRhZyBzdGFjayAodGhlIHRhZyBpcyBjbG9zZWQgaW4gdGhlIHJldHVsdCBIVE1MISkNCgkJCQkJCQkJfQ0KDQoJCQkJCQkJfSBlbHNlIHsNCgkJCQkJCQkJLy8gVGhlcmUgYXJlIHNvbWUgbmFzdHkgdGFncyB0aGF0IGRvbid0IGhhdmUgYSBjbG9zZSB0YWcgbGlrZSA8YnIvPg0KCQkJCQkJCQlpZiAodGFnTmFtZS50b0xvd2VyQ2FzZSgpICE9ICdicicpIHsNCgkJCQkJCQkJCW9wZW5UYWdzLnVuc2hpZnQodGFnTmFtZSk7IC8vIEFkZCB0byBzdGFydCB0aGUgbmFtZSBvZiB0aGUgdGFnIHRoYXQgb3BlbnMNCgkJCQkJCQkJfQ0KCQkJCQkJCX0NCgkJCQkJCX0NCgkJCQkJCWlmIChpblRhZyAmJiBjb250ZW50W2ldID09ICc+Jykgew0KCQkJCQkJCWluVGFnID0gZmFsc2U7DQoJCQkJCQl9DQoNCgkJCQkJCWlmIChpblRhZykgeyBiYWcgKz0gY29udGVudC5jaGFyQXQoaSk7IH0gLy8gQWRkIHRhZyBuYW1lIGNoYXJzIHRvIHRoZSByZXN1bHQNCgkJCQkJCWVsc2Ugew0KCQkJCQkJCXIrKzsNCgkJCQkJCQlpZiAoY291bnRDaGFycyA8PSBjb25maWcuc2hvd0NoYXJzKSB7DQoJCQkJCQkJCWJhZyArPSBjb250ZW50LmNoYXJBdChpKTsgLy8gRml4IHRvIGllIDcgbm90IGFsbG93aW5nIHlvdSB0byByZWZlcmVuY2Ugc3RyaW5nIGNoYXJhY3RlcnMgdXNpbmcgdGhlIFtdDQoJCQkJCQkJCWNvdW50Q2hhcnMrKzsNCgkJCQkJCQl9IGVsc2UgLy8gTm93IEkgaGF2ZSB0aGUgY2hhcmFjdGVycyBuZWVkZWQNCgkJCQkJCQl7DQoJCQkJCQkJCWlmIChvcGVuVGFncy5sZW5ndGggPiAwKSAvLyBJIGhhdmUgdW5jbG9zZWQgdGFncw0KCQkJCQkJCQl7DQoJCQkJCQkJCQkvL2NvbnNvbGUubG9nKCdUaGV5IHdlcmUgb3BlbiB0YWdzJyk7DQoJCQkJCQkJCQkvL2NvbnNvbGUubG9nKG9wZW5UYWdzKTsNCgkJCQkJCQkJCWZvciAoaiA9IDA7IGogPCBvcGVuVGFncy5sZW5ndGg7IGorKykgew0KCQkJCQkJCQkJCS8vY29uc29sZS5sb2coJ0NpZXJybyB0YWcgJyArIG9wZW5UYWdzW2pdKTsNCgkJCQkJCQkJCQliYWcgKz0gJzwvJyArIG9wZW5UYWdzW2pdICsgJz4nOyAvLyBDbG9zZSBhbGwgdGFncyB0aGF0IHdlcmUgb3BlbmVkDQoNCgkJCQkJCQkJCQkvLyBZb3UgY291bGQgc2hpZnQgdGhlIHRhZyBmcm9tIHRoZSBzdGFjayB0byBjaGVjayBpZiB5b3UgZW5kIHdpdGggYW4gZW1wdHkgc3RhY2ssIHRoYXQgbWVhbnMgeW91IGhhdmUgY2xvc2VkIGFsbCBvcGVuIHRhZ3MNCgkJCQkJCQkJCX0NCgkJCQkJCQkJCWJyZWFrOw0KCQkJCQkJCQl9DQoJCQkJCQkJfQ0KCQkJCQkJfQ0KCQkJCQl9DQoJCQkJCWMgPSAkKCc8ZGl2Lz4nKS5odG1sKGJhZyArICc8c3BhbiBjbGFzcz0iZWxsaXAiPicgKyBjb25maWcuZWxsaXBzZXNUZXh0ICsgJzwvc3Bhbj4nKS5odG1sKCk7DQoJCQkJfSBlbHNlIHsNCgkJCQkJYyArPSBjb25maWcuZWxsaXBzZXNUZXh0Ow0KCQkJCX0NCg0KCQkJCXZhciBodG1sID0gJzxkaXYgY2xhc3M9InNob3J0Y29udGVudCI+JyArIGMgKw0KICAgICAgICAgICAgICAgICAgICAnPC9kaXY+PGRpdiBjbGFzcz0iYWxsY29udGVudCI+JyArIGNvbnRlbnQgKw0KICAgICAgICAgICAgICAgICAgICAnPC9kaXY+PHNwYW4+PGEgaHJlZj0iamF2YXNjcmlwdDovL25vcC8iIGNsYXNzPSJtb3JlbGluayI+JyArIGNvbmZpZy5tb3JlVGV4dCArICc8L2E+PC9zcGFuPic7DQoNCgkJCQkkdGhpcy5odG1sKGh0bWwpOw0KCQkJCSR0aGlzLmZpbmQoIi5hbGxjb250ZW50IikuaGlkZSgpOyAvLyBIaWRlIGFsbCB0ZXh0DQoJCQkJJCgnLnNob3J0Y29udGVudCBwOmxhc3QnLCAkdGhpcykuY3NzKCdtYXJnaW4tYm90dG9tJywgMCk7IC8vUmVtb3ZlIGJvdHRvbSBtYXJnaW4gb24gbGFzdCBwYXJhZ3JhcGggYXMgaXQncyBsaWtlbHkgc2hvcnRlbmVkDQoJCQl9DQoJCX0pOw0KDQoJfTsNCg0KfSkoalF1ZXJ5KTs7DQo=</ActualData>
          </HTTPData>
        </HTTPDataSet>
        <IsExternalData>false</IsExternalData>
      </HTTPBody>
      <TcpPackets>
        <PacketInfo time="1085863625" offset="0" length="332" />
        <PacketInfo time="1085863625" offset="332" length="85830" />
      </TcpPackets>
    </HTTPResponse>
  </HTTPTask>
  <HTTPTask id="6146" hostname="detectportal.firefox.com" path="http://detectportal.firefox.com/success.txt" url="http://detectportal.firefox.com/success.txt" ip="23.15.246.9" port="80" connectionId="61" origin="ExtraRes" frame="1" startDateTime="2019-01-02T11:43:29.611-05:00" startTime="1085864609" endTime="1085864625">
    <HTTPRequest method="GET">
      <HTTPHeaders>
        <HTTPHeaderEntity name="User-Agent" index="0">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>TW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV09XNjQ7IHJ2OjY0LjApIEdlY2tvLzIwMTAwMTAxIEZpcmVmb3gvNjQuMA==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept" index="1">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Ki8q</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept-Language" index="2">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>ZW4tR0IsZW47cT0wLjU=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept-Encoding" index="3">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Z3ppcCwgZGVmbGF0ZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Cache-Control" index="4">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>bm8tY2FjaGU=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Pragma" index="5">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>bm8tY2FjaGU=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Host" index="6">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>ZGV0ZWN0cG9ydGFsLmZpcmVmb3guY29t</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPAllHeaders>
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>R0VUIGh0dHA6Ly9kZXRlY3Rwb3J0YWwuZmlyZWZveC5jb20vc3VjY2Vzcy50eHQgSFRUUC8xLjENClVzZXItQWdlbnQ6IE1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdPVzY0OyBydjo2NC4wKSBHZWNrby8yMDEwMDEwMSBGaXJlZm94LzY0LjANCkFjY2VwdDogKi8qDQpBY2NlcHQtTGFuZ3VhZ2U6IGVuLUdCLGVuO3E9MC41DQpBY2NlcHQtRW5jb2Rpbmc6IGd6aXAsIGRlZmxhdGUNCkNhY2hlLUNvbnRyb2w6IG5vLWNhY2hlDQpQcmFnbWE6IG5vLWNhY2hlDQpIb3N0OiBkZXRlY3Rwb3J0YWwuZmlyZWZveC5jb20NCg0K</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPAllHeaders>
      </HTTPHeaders>
    </HTTPRequest>
    <HTTPResponse>
      <contentLenght>8</contentLenght>
      <HTTPHeaders>
        <HTTPHeaderEntity name="Content-Type" index="0">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>dGV4dC9wbGFpbg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Content-Length" index="1">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>OA==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Last-Modified" index="2">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>TW9uLCAxNSBNYXkgMjAxNyAxODowNDo0MCBHTVQ=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="ETag" index="3">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>ImFlNzgwNTg1ZjQ5Yjk0Y2UxNDQ0ZWI3ZDI4OTA2MTIzIg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept-Ranges" index="4">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Ynl0ZXM=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Server" index="5">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>QW1hem9uUzM=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="X-Amz-Cf-Id" index="6">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>ck9HNTFQaGVJR1JETEw2ZTdMTW00c2N6ZTFhbERDbElaYV9feV8xc0lDQjIyZzRtQnlZeHN3PT0=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Cache-Control" index="7">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>bm8tY2FjaGUsIG5vLXN0b3JlLCBtdXN0LXJldmFsaWRhdGU=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Date" index="8">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>V2VkLCAwMiBKYW4gMjAxOSAxNjo0MzoxMSBHTVQ=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Connection" index="9">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>a2VlcC1hbGl2ZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPAllHeaders>
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>SFRUUC8xLjEgMjAwIE9LDQpDb250ZW50LVR5cGU6IHRleHQvcGxhaW4NCkNvbnRlbnQtTGVuZ3RoOiA4DQpMYXN0LU1vZGlmaWVkOiBNb24sIDE1IE1heSAyMDE3IDE4OjA0OjQwIEdNVA0KRVRhZzogImFlNzgwNTg1ZjQ5Yjk0Y2UxNDQ0ZWI3ZDI4OTA2MTIzIg0KQWNjZXB0LVJhbmdlczogYnl0ZXMNClNlcnZlcjogQW1hem9uUzMNClgtQW16LUNmLUlkOiByT0c1MVBoZUlHUkRMTDZlN0xNbTRzY3plMWFsRENsSVphX195XzFzSUNCMjJnNG1CeVl4c3c9PQ0KQ2FjaGUtQ29udHJvbDogbm8tY2FjaGUsIG5vLXN0b3JlLCBtdXN0LXJldmFsaWRhdGUNCkRhdGU6IFdlZCwgMDIgSmFuIDIwMTkgMTY6NDM6MTEgR01UDQpDb25uZWN0aW9uOiBrZWVwLWFsaXZlDQoNCg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPAllHeaders>
      </HTTPHeaders>
      <HTTPBody>
        <HTTPDataSet>
          <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
            <ActualData>c3VjY2Vzcwo=</ActualData>
          </HTTPData>
        </HTTPDataSet>
        <IsExternalData>false</IsExternalData>
      </HTTPBody>
      <TcpPackets>
        <PacketInfo time="1085864609" offset="0" length="376" />
        <PacketInfo time="1085864625" offset="376" length="8" />
      </TcpPackets>
    </HTTPResponse>
  </HTTPTask>
</HTTPSnapshot>